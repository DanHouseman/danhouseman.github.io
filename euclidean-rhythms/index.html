<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Adjustable Euclidean Rhythms</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    
    <style>
      /*! nouislider - 10.1.0 - 2017-07-28 13:09:54 */.noUi-target,.noUi-target *{-webkit-touch-callout:none;-webkit-tap-highlight-color:transparent;-webkit-user-select:none;-ms-touch-action:none;touch-action:none;-ms-user-select:none;-moz-user-select:none;user-select:none;-moz-box-sizing:border-box;box-sizing:border-box}.noUi-target{position:relative;direction:ltr}.noUi-base{width:100%;height:100%;position:relative;z-index:1}.noUi-connect{position:absolute;right:0;top:0;left:0;bottom:0}.noUi-origin{position:absolute;height:0;width:0}.noUi-handle{position:relative;z-index:1}.noUi-state-tap .noUi-connect,.noUi-state-tap .noUi-origin{-webkit-transition:top .3s,right .3s,bottom .3s,left .3s;transition:top .3s,right .3s,bottom .3s,left .3s}.noUi-state-drag *{cursor:inherit!important}.noUi-base,.noUi-handle{-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}.noUi-horizontal{height:18px}.noUi-horizontal .noUi-handle{width:34px;height:28px;left:-17px;top:-6px}.noUi-vertical{width:18px}.noUi-vertical .noUi-handle{width:28px;height:34px;left:-6px;top:-17px}.noUi-target{background:#FAFAFA;border-radius:4px;border:1px solid #D3D3D3;box-shadow:inset 0 1px 1px #F0F0F0,0 3px 6px -5px #BBB}.noUi-connect{background:#3FB8AF;border-radius:4px;box-shadow:inset 0 0 3px rgba(51,51,51,.45);-webkit-transition:background 450ms;transition:background 450ms}.noUi-draggable{cursor:ew-resize}.noUi-vertical .noUi-draggable{cursor:ns-resize}.noUi-handle{border:1px solid #D9D9D9;border-radius:3px;background:#FFF;cursor:default;box-shadow:inset 0 0 1px #FFF,inset 0 1px 7px #EBEBEB,0 3px 6px -3px #BBB}.noUi-active{box-shadow:inset 0 0 1px #FFF,inset 0 1px 7px #DDD,0 3px 6px -3px #BBB}.noUi-handle:after,.noUi-handle:before{content:"";display:block;position:absolute;height:14px;width:1px;background:#E8E7E6;left:14px;top:6px}.noUi-handle:after{left:17px}.noUi-vertical .noUi-handle:after,.noUi-vertical .noUi-handle:before{width:14px;height:1px;left:6px;top:14px}.noUi-vertical .noUi-handle:after{top:17px}[disabled] .noUi-connect{background:#B8B8B8}[disabled] .noUi-handle,[disabled].noUi-handle,[disabled].noUi-target{cursor:not-allowed}.noUi-pips,.noUi-pips *{-moz-box-sizing:border-box;box-sizing:border-box}.noUi-pips{position:absolute;color:#999}.noUi-value{position:absolute;white-space:nowrap;text-align:center}.noUi-value-sub{color:#ccc;font-size:10px}.noUi-marker{position:absolute;background:#CCC}.noUi-marker-large,.noUi-marker-sub{background:#AAA}.noUi-pips-horizontal{padding:10px 0;height:80px;top:100%;left:0;width:100%}.noUi-value-horizontal{-webkit-transform:translate3d(-50%,50%,0);transform:translate3d(-50%,50%,0)}.noUi-marker-horizontal.noUi-marker{margin-left:-1px;width:2px;height:5px}.noUi-marker-horizontal.noUi-marker-sub{height:10px}.noUi-marker-horizontal.noUi-marker-large{height:15px}.noUi-pips-vertical{padding:0 10px;height:100%;top:0;left:100%}.noUi-value-vertical{-webkit-transform:translate3d(0,50%,0);transform:translate3d(0,50%,0);padding-left:25px}.noUi-marker-vertical.noUi-marker{width:5px;height:2px;margin-top:-1px}.noUi-marker-vertical.noUi-marker-sub{width:10px}.noUi-marker-vertical.noUi-marker-large{width:15px}.noUi-tooltip{display:block;position:absolute;border:1px solid #D9D9D9;border-radius:3px;background:#fff;color:#000;padding:5px;text-align:center;white-space:nowrap}.noUi-horizontal .noUi-tooltip{-webkit-transform:translate(-50%,0);transform:translate(-50%,0);left:50%;bottom:120%}.noUi-vertical .noUi-tooltip{-webkit-transform:translate(0,-50%);transform:translate(0,-50%);top:50%;right:120%}
    </style>
    <style>

    @import url(https://fonts.googleapis.com/css?family=Ubuntu:500);
    @import url(https://fonts.googleapis.com/css?family=Ubuntu+Mono);
    @import url(https://fonts.googleapis.com/css?family=Raleway:400,800);

    * {
        font-family: "Raleway";
        /* Ubuntu */
    }

    html,
    body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
    }

    body {
        background: #536976;
        /* fallback for old browsers */
        background: -webkit-linear-gradient(to right, #292E49, #536976);
        /* Chrome 10-25, Safari 5.1-6 */
        background: linear-gradient(to right, #292E49, #536976);
        /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
    }

    .patterns {
        display: flex;
        width: 100%;
        height: 100%;
    }

    .space {
        flex: 0.33;
    }

    .pattern {
        flex: 1;
        padding: 0 20px;

        display: flex;
        flex-direction: column;
        align-items: stretch;
        justify-content: center;
    }

    .vis {
        width: 100%;
        min-height: 300px;
    }

    .center {
        fill: white;
        stroke: none;
    }

    .hand {
        stroke: white;
        stroke-width: 2;
        stroke-linecap: round;
    }

    .event {
        fill: rgba(150, 150, 150, 0.5);
    }

    .event.active {
        fill: #AFFF00;
    }


    .range {
        margin: 0 30px;
    }

    .noUi-target {
        border-width: 0;
    }

    .noUi-horizontal {
        height: 15px;
    }

    .noUi-handle {
        outline: none;
        box-shadow: none;
    }

    .noUi-connect {
        background-color: #AFFF00;
        box-shadow: none;
    }

    .noUi-horizontal .noUi-tooltip {
        top: 110%;
        bottom: -30px;
        font-size: 18px;
        border-width: 0;
        background: none;
        color: white;
    }

    footer {
        position: absolute;
        left: 0;
        width: 100%;
        bottom: 20px;
        text-align: center;
        color: white;
    }

    footer a {
        color: white;
    }

    @media (max-width: 1023px) {
        .patterns {
            flex-direction: column;
        }

        .vis {
            min-height: auto;
        }

        .space {
            flex: 0;
        }
    }
    </style>
</head>

<body>
    <div class="patterns">
        <div class="space"></div>
        <div class="pattern">
            <svg class="vis"></svg>
            <div class="range"></div>
        </div>
        <div class="pattern">
            <svg class="vis"></svg>
            <div class="range"></div>
        </div>
        <div class="pattern">
            <svg class="vis"></svg>
            <div class="range"></div>
        </div>
        <div class="pattern">
            <svg class="vis"></svg>
            <div class="range"></div>
        </div>
        <div class="space"></div>
    </div>
  
    <script>
    (function() {
        function n(n, t) { return n.set(t[0], t[1]), n }

        function t(n, t) { return n.add(t), n }

        function r(n, t, r) { switch (r.length) {
                case 0:
                    return n.call(t);
                case 1:
                    return n.call(t, r[0]);
                case 2:
                    return n.call(t, r[0], r[1]);
                case 3:
                    return n.call(t, r[0], r[1], r[2]) } return n.apply(t, r) }

        function e(n, t, r, e) { for (var u = -1, i = null == n ? 0 : n.length; ++u < i;) { var o = n[u];
                t(e, o, r(o), n) } return e }

        function u(n, t) { for (var r = -1, e = null == n ? 0 : n.length; ++r < e && t(n[r], r, n) !== !1;); return n }

        function i(n, t) { for (var r = null == n ? 0 : n.length; r-- && t(n[r], r, n) !== !1;); return n }

        function o(n, t) { for (var r = -1, e = null == n ? 0 : n.length; ++r < e;)
                if (!t(n[r], r, n)) return !1; return !0 }

        function f(n, t) { for (var r = -1, e = null == n ? 0 : n.length, u = 0, i = []; ++r < e;) { var o = n[r];
                t(o, r, n) && (i[u++] = o) } return i }

        function a(n, t) { var r = null == n ? 0 : n.length; return !!r && b(n, t, 0) > -1 }

        function c(n, t, r) { for (var e = -1, u = null == n ? 0 : n.length; ++e < u;)
                if (r(t, n[e])) return !0; return !1 }

        function l(n, t) { for (var r = -1, e = null == n ? 0 : n.length, u = Array(e); ++r < e;) u[r] = t(n[r], r, n); return u }

        function s(n, t) { for (var r = -1, e = t.length, u = n.length; ++r < e;) n[u + r] = t[r]; return n }

        function h(n, t, r, e) { var u = -1,
                i = null == n ? 0 : n.length; for (e && i && (r = n[++u]); ++u < i;) r = t(r, n[u], u, n); return r }

        function p(n, t, r, e) { var u = null == n ? 0 : n.length; for (e && u && (r = n[--u]); u--;) r = t(r, n[u], u, n); return r }

        function v(n, t) { for (var r = -1, e = null == n ? 0 : n.length; ++r < e;)
                if (t(n[r], r, n)) return !0; return !1 }

        function _(n) { return n.split("") }

        function g(n) { return n.match(Dt) || [] }

        function y(n, t, r) { var e; return r(n, function(n, r, u) { if (t(n, r, u)) return e = r, !1 }), e }

        function d(n, t, r, e) { for (var u = n.length, i = r + (e ? 1 : -1); e ? i-- : ++i < u;)
                if (t(n[i], i, n)) return i; return -1 }

        function b(n, t, r) { return t === t ? K(n, t, r) : d(n, m, r) }

        function w(n, t, r, e) { for (var u = r - 1, i = n.length; ++u < i;)
                if (e(n[u], t)) return u; return -1 }

        function m(n) { return n !== n }

        function x(n, t) { var r = null == n ? 0 : n.length; return r ? I(n, t) / r : Ln }

        function j(n) { return function(t) { return null == t ? X : t[n] } }

        function A(n) { return function(t) { return null == n ? X : n[t] } }

        function k(n, t, r, e, u) { return u(n, function(n, u, i) { r = e ? (e = !1, n) : t(r, n, u, i) }), r }

        function O(n, t) { var r = n.length; for (n.sort(t); r--;) n[r] = n[r].value; return n }

        function I(n, t) { for (var r, e = -1, u = n.length; ++e < u;) { var i = t(n[e]);
                i !== X && (r = r === X ? i : r + i) } return r }

        function R(n, t) { for (var r = -1, e = Array(n); ++r < n;) e[r] = t(r); return e }

        function z(n, t) { return l(t, function(t) { return [t, n[t]] }) }

        function E(n) { return function(t) { return n(t) } }

        function S(n, t) { return l(t, function(t) { return n[t] }) }

        function W(n, t) { return n.has(t) }

        function L(n, t) { for (var r = -1, e = n.length; ++r < e && b(t, n[r], 0) > -1;); return r }

        function C(n, t) { for (var r = n.length; r-- && b(t, n[r], 0) > -1;); return r }

        function U(n, t) { for (var r = n.length, e = 0; r--;) n[r] === t && ++e; return e }

        function B(n) { return "\\" + Yr[n] }

        function T(n, t) { return null == n ? X : n[t] }

        function $(n) { return Nr.test(n) }

        function D(n) { return Pr.test(n) }

        function M(n) { for (var t, r = []; !(t = n.next()).done;) r.push(t.value); return r }

        function F(n) { var t = -1,
                r = Array(n.size); return n.forEach(function(n, e) { r[++t] = [e, n] }), r }

        function N(n, t) { return function(r) { return n(t(r)) } }

        function P(n, t) { for (var r = -1, e = n.length, u = 0, i = []; ++r < e;) { var o = n[r];
                o !== t && o !== fn || (n[r] = fn, i[u++] = r) } return i }

        function q(n) { var t = -1,
                r = Array(n.size); return n.forEach(function(n) { r[++t] = n }), r }

        function Z(n) { var t = -1,
                r = Array(n.size); return n.forEach(function(n) { r[++t] = [n, n] }), r }

        function K(n, t, r) { for (var e = r - 1, u = n.length; ++e < u;)
                if (n[e] === t) return e; return -1 }

        function V(n, t, r) { for (var e = r + 1; e--;)
                if (n[e] === t) return e; return e }

        function G(n) { return $(n) ? J(n) : ve(n) }

        function H(n) { return $(n) ? Y(n) : _(n) }

        function J(n) { for (var t = Mr.lastIndex = 0; Mr.test(n);) ++t; return t }

        function Y(n) { return n.match(Mr) || [] }

        function Q(n) { return n.match(Fr) || [] }
        var X, nn = "4.17.4",
            tn = 200,
            rn = "Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",
            en = "Expected a function",
            un = "__lodash_hash_undefined__",
            on = 500,
            fn = "__lodash_placeholder__",
            an = 1,
            cn = 2,
            ln = 4,
            sn = 1,
            hn = 2,
            pn = 1,
            vn = 2,
            _n = 4,
            gn = 8,
            yn = 16,
            dn = 32,
            bn = 64,
            wn = 128,
            mn = 256,
            xn = 512,
            jn = 30,
            An = "...",
            kn = 800,
            On = 16,
            In = 1,
            Rn = 2,
            zn = 3,
            En = 1 / 0,
            Sn = 9007199254740991,
            Wn = 1.7976931348623157e308,
            Ln = NaN,
            Cn = 4294967295,
            Un = Cn - 1,
            Bn = Cn >>> 1,
            Tn = [
                ["ary", wn],
                ["bind", pn],
                ["bindKey", vn],
                ["curry", gn],
                ["curryRight", yn],
                ["flip", xn],
                ["partial", dn],
                ["partialRight", bn],
                ["rearg", mn]
            ],
            $n = "[object Arguments]",
            Dn = "[object Array]",
            Mn = "[object AsyncFunction]",
            Fn = "[object Boolean]",
            Nn = "[object Date]",
            Pn = "[object DOMException]",
            qn = "[object Error]",
            Zn = "[object Function]",
            Kn = "[object GeneratorFunction]",
            Vn = "[object Map]",
            Gn = "[object Number]",
            Hn = "[object Null]",
            Jn = "[object Object]",
            Yn = "[object Promise]",
            Qn = "[object Proxy]",
            Xn = "[object RegExp]",
            nt = "[object Set]",
            tt = "[object String]",
            rt = "[object Symbol]",
            et = "[object Undefined]",
            ut = "[object WeakMap]",
            it = "[object WeakSet]",
            ot = "[object ArrayBuffer]",
            ft = "[object DataView]",
            at = "[object Float32Array]",
            ct = "[object Float64Array]",
            lt = "[object Int8Array]",
            st = "[object Int16Array]",
            ht = "[object Int32Array]",
            pt = "[object Uint8Array]",
            vt = "[object Uint8ClampedArray]",
            _t = "[object Uint16Array]",
            gt = "[object Uint32Array]",
            yt = /\b__p \+= '';/g,
            dt = /\b(__p \+=) '' \+/g,
            bt = /(__e\(.*?\)|\b__t\)) \+\n'';/g,
            wt = /&(?:amp|lt|gt|quot|#39);/g,
            mt = /[&<>"']/g,
            xt = RegExp(wt.source),
            jt = RegExp(mt.source),
            At = /<%-([\s\S]+?)%>/g,
            kt = /<%([\s\S]+?)%>/g,
            Ot = /<%=([\s\S]+?)%>/g,
            It = /\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,
            Rt = /^\w*$/,
            zt = /^\./,
            Et = /[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,
            St = /[\\^$.*+?()[\]{}|]/g,
            Wt = RegExp(St.source),
            Lt = /^\s+|\s+$/g,
            Ct = /^\s+/,
            Ut = /\s+$/,
            Bt = /\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,
            Tt = /\{\n\/\* \[wrapped with (.+)\] \*/,
            $t = /,? & /,
            Dt = /[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,
            Mt = /\\(\\)?/g,
            Ft = /\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,
            Nt = /\w*$/,
            Pt = /^[-+]0x[0-9a-f]+$/i,
            qt = /^0b[01]+$/i,
            Zt = /^\[object .+?Constructor\]$/,
            Kt = /^0o[0-7]+$/i,
            Vt = /^(?:0|[1-9]\d*)$/,
            Gt = /[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,
            Ht = /($^)/,
            Jt = /['\n\r\u2028\u2029\\]/g,
            Yt = "\\ud800-\\udfff",
            Qt = "\\u0300-\\u036f",
            Xt = "\\ufe20-\\ufe2f",
            nr = "\\u20d0-\\u20ff",
            tr = Qt + Xt + nr,
            rr = "\\u2700-\\u27bf",
            er = "a-z\\xdf-\\xf6\\xf8-\\xff",
            ur = "\\xac\\xb1\\xd7\\xf7",
            ir = "\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",
            or = "\\u2000-\\u206f",
            fr = " \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",
            ar = "A-Z\\xc0-\\xd6\\xd8-\\xde",
            cr = "\\ufe0e\\ufe0f",
            lr = ur + ir + or + fr,
            sr = "['’]",
            hr = "[" + Yt + "]",
            pr = "[" + lr + "]",
            vr = "[" + tr + "]",
            _r = "\\d+",
            gr = "[" + rr + "]",
            yr = "[" + er + "]",
            dr = "[^" + Yt + lr + _r + rr + er + ar + "]",
            br = "\\ud83c[\\udffb-\\udfff]",
            wr = "(?:" + vr + "|" + br + ")",
            mr = "[^" + Yt + "]",
            xr = "(?:\\ud83c[\\udde6-\\uddff]){2}",
            jr = "[\\ud800-\\udbff][\\udc00-\\udfff]",
            Ar = "[" + ar + "]",
            kr = "\\u200d",
            Or = "(?:" + yr + "|" + dr + ")",
            Ir = "(?:" + Ar + "|" + dr + ")",
            Rr = "(?:" + sr + "(?:d|ll|m|re|s|t|ve))?",
            zr = "(?:" + sr + "(?:D|LL|M|RE|S|T|VE))?",
            Er = wr + "?",
            Sr = "[" + cr + "]?",
            Wr = "(?:" + kr + "(?:" + [mr, xr, jr].join("|") + ")" + Sr + Er + ")*",
            Lr = "\\d*(?:(?:1st|2nd|3rd|(?![123])\\dth)\\b)",
            Cr = "\\d*(?:(?:1ST|2ND|3RD|(?![123])\\dTH)\\b)",
            Ur = Sr + Er + Wr,
            Br = "(?:" + [gr, xr, jr].join("|") + ")" + Ur,
            Tr = "(?:" + [mr + vr + "?", vr, xr, jr, hr].join("|") + ")",
            $r = RegExp(sr, "g"),
            Dr = RegExp(vr, "g"),
            Mr = RegExp(br + "(?=" + br + ")|" + Tr + Ur, "g"),
            Fr = RegExp([Ar + "?" + yr + "+" + Rr + "(?=" + [pr, Ar, "$"].join("|") + ")", Ir + "+" + zr + "(?=" + [pr, Ar + Or, "$"].join("|") + ")", Ar + "?" + Or + "+" + Rr, Ar + "+" + zr, Cr, Lr, _r, Br].join("|"), "g"),
            Nr = RegExp("[" + kr + Yt + tr + cr + "]"),
            Pr = /[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,
            qr = ["Array", "Buffer", "DataView", "Date", "Error", "Float32Array", "Float64Array", "Function", "Int8Array", "Int16Array", "Int32Array", "Map", "Math", "Object", "Promise", "RegExp", "Set", "String", "Symbol", "TypeError", "Uint8Array", "Uint8ClampedArray", "Uint16Array", "Uint32Array", "WeakMap", "_", "clearTimeout", "isFinite", "parseInt", "setTimeout"],
            Zr = -1,
            Kr = {};
        Kr[at] = Kr[ct] = Kr[lt] = Kr[st] = Kr[ht] = Kr[pt] = Kr[vt] = Kr[_t] = Kr[gt] = !0, Kr[$n] = Kr[Dn] = Kr[ot] = Kr[Fn] = Kr[ft] = Kr[Nn] = Kr[qn] = Kr[Zn] = Kr[Vn] = Kr[Gn] = Kr[Jn] = Kr[Xn] = Kr[nt] = Kr[tt] = Kr[ut] = !1;
        var Vr = {};
        Vr[$n] = Vr[Dn] = Vr[ot] = Vr[ft] = Vr[Fn] = Vr[Nn] = Vr[at] = Vr[ct] = Vr[lt] = Vr[st] = Vr[ht] = Vr[Vn] = Vr[Gn] = Vr[Jn] = Vr[Xn] = Vr[nt] = Vr[tt] = Vr[rt] = Vr[pt] = Vr[vt] = Vr[_t] = Vr[gt] = !0, Vr[qn] = Vr[Zn] = Vr[ut] = !1;
        var Gr = { "À": "A", "Á": "A", "Â": "A", "Ã": "A", "Ä": "A", "Å": "A", "à": "a", "á": "a", "â": "a", "ã": "a", "ä": "a", "å": "a", "Ç": "C", "ç": "c", "Ð": "D", "ð": "d", "È": "E", "É": "E", "Ê": "E", "Ë": "E", "è": "e", "é": "e", "ê": "e", "ë": "e", "Ì": "I", "Í": "I", "Î": "I", "Ï": "I", "ì": "i", "í": "i", "î": "i", "ï": "i", "Ñ": "N", "ñ": "n", "Ò": "O", "Ó": "O", "Ô": "O", "Õ": "O", "Ö": "O", "Ø": "O", "ò": "o", "ó": "o", "ô": "o", "õ": "o", "ö": "o", "ø": "o", "Ù": "U", "Ú": "U", "Û": "U", "Ü": "U", "ù": "u", "ú": "u", "û": "u", "ü": "u", "Ý": "Y", "ý": "y", "ÿ": "y", "Æ": "Ae", "æ": "ae", "Þ": "Th", "þ": "th", "ß": "ss", "Ā": "A", "Ă": "A", "Ą": "A", "ā": "a", "ă": "a", "ą": "a", "Ć": "C", "Ĉ": "C", "Ċ": "C", "Č": "C", "ć": "c", "ĉ": "c", "ċ": "c", "č": "c", "Ď": "D", "Đ": "D", "ď": "d", "đ": "d", "Ē": "E", "Ĕ": "E", "Ė": "E", "Ę": "E", "Ě": "E", "ē": "e", "ĕ": "e", "ė": "e", "ę": "e", "ě": "e", "Ĝ": "G", "Ğ": "G", "Ġ": "G", "Ģ": "G", "ĝ": "g", "ğ": "g", "ġ": "g", "ģ": "g", "Ĥ": "H", "Ħ": "H", "ĥ": "h", "ħ": "h", "Ĩ": "I", "Ī": "I", "Ĭ": "I", "Į": "I", "İ": "I", "ĩ": "i", "ī": "i", "ĭ": "i", "į": "i", "ı": "i", "Ĵ": "J", "ĵ": "j", "Ķ": "K", "ķ": "k", "ĸ": "k", "Ĺ": "L", "Ļ": "L", "Ľ": "L", "Ŀ": "L", "Ł": "L", "ĺ": "l", "ļ": "l", "ľ": "l", "ŀ": "l", "ł": "l", "Ń": "N", "Ņ": "N", "Ň": "N", "Ŋ": "N", "ń": "n", "ņ": "n", "ň": "n", "ŋ": "n", "Ō": "O", "Ŏ": "O", "Ő": "O", "ō": "o", "ŏ": "o", "ő": "o", "Ŕ": "R", "Ŗ": "R", "Ř": "R", "ŕ": "r", "ŗ": "r", "ř": "r", "Ś": "S", "Ŝ": "S", "Ş": "S", "Š": "S", "ś": "s", "ŝ": "s", "ş": "s", "š": "s", "Ţ": "T", "Ť": "T", "Ŧ": "T", "ţ": "t", "ť": "t", "ŧ": "t", "Ũ": "U", "Ū": "U", "Ŭ": "U", "Ů": "U", "Ű": "U", "Ų": "U", "ũ": "u", "ū": "u", "ŭ": "u", "ů": "u", "ű": "u", "ų": "u", "Ŵ": "W", "ŵ": "w", "Ŷ": "Y", "ŷ": "y", "Ÿ": "Y", "Ź": "Z", "Ż": "Z", "Ž": "Z", "ź": "z", "ż": "z", "ž": "z", "Ĳ": "IJ", "ĳ": "ij", "Œ": "Oe", "œ": "oe", "ŉ": "'n", "ſ": "s" },
            Hr = { "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#39;" },
            Jr = { "&amp;": "&", "&lt;": "<", "&gt;": ">", "&quot;": '"', "&#39;": "'" },
            Yr = { "\\": "\\", "'": "'", "\n": "n", "\r": "r", "\u2028": "u2028", "\u2029": "u2029" },
            Qr = parseFloat,
            Xr = parseInt,
            ne = "object" == typeof global && global && global.Object === Object && global,
            te = "object" == typeof self && self && self.Object === Object && self,
            re = ne || te || Function("return this")(),
            ee = "object" == typeof exports && exports && !exports.nodeType && exports,
            ue = ee && "object" == typeof module && module && !module.nodeType && module,
            ie = ue && ue.exports === ee,
            oe = ie && ne.process,
            fe = function() { try { return oe && oe.binding && oe.binding("util") } catch (n) {} }(),
            ae = fe && fe.isArrayBuffer,
            ce = fe && fe.isDate,
            le = fe && fe.isMap,
            se = fe && fe.isRegExp,
            he = fe && fe.isSet,
            pe = fe && fe.isTypedArray,
            ve = j("length"),
            _e = A(Gr),
            ge = A(Hr),
            ye = A(Jr),
            de = function _(A) {
                function K(n) { if (la(n) && !mh(n) && !(n instanceof Dt)) { if (n instanceof Y) return n; if (ml.call(n, "__wrapped__")) return io(n) } return new Y(n) }

                function J() {}

                function Y(n, t) { this.__wrapped__ = n, this.__actions__ = [], this.__chain__ = !!t, this.__index__ = 0, this.__values__ = X }

                function Dt(n) { this.__wrapped__ = n, this.__actions__ = [], this.__dir__ = 1, this.__filtered__ = !1, this.__iteratees__ = [], this.__takeCount__ = Cn, this.__views__ = [] }

                function Yt() { var n = new Dt(this.__wrapped__); return n.__actions__ = Mu(this.__actions__), n.__dir__ = this.__dir__, n.__filtered__ = this.__filtered__, n.__iteratees__ = Mu(this.__iteratees__), n.__takeCount__ = this.__takeCount__, n.__views__ = Mu(this.__views__), n }

                function Qt() { if (this.__filtered__) { var n = new Dt(this);
                        n.__dir__ = -1, n.__filtered__ = !0 } else n = this.clone(), n.__dir__ *= -1; return n }

                function Xt() { var n = this.__wrapped__.value(),
                        t = this.__dir__,
                        r = mh(n),
                        e = t < 0,
                        u = r ? n.length : 0,
                        i = zi(0, u, this.__views__),
                        o = i.start,
                        f = i.end,
                        a = f - o,
                        c = e ? f : o - 1,
                        l = this.__iteratees__,
                        s = l.length,
                        h = 0,
                        p = Yl(a, this.__takeCount__); if (!r || !e && u == a && p == a) return mu(n, this.__actions__); var v = [];
                    n: for (; a-- && h < p;) { c += t; for (var _ = -1, g = n[c]; ++_ < s;) { var y = l[_],
                                d = y.iteratee,
                                b = y.type,
                                w = d(g); if (b == Rn) g = w;
                            else if (!w) { if (b == In) continue n; break n } } v[h++] = g }
                    return v }

                function nr(n) { var t = -1,
                        r = null == n ? 0 : n.length; for (this.clear(); ++t < r;) { var e = n[t];
                        this.set(e[0], e[1]) } }

                function tr() { this.__data__ = fs ? fs(null) : {}, this.size = 0 }

                function rr(n) { var t = this.has(n) && delete this.__data__[n]; return this.size -= t ? 1 : 0, t }

                function er(n) { var t = this.__data__; if (fs) { var r = t[n]; return r === un ? X : r } return ml.call(t, n) ? t[n] : X }

                function ur(n) { var t = this.__data__; return fs ? t[n] !== X : ml.call(t, n) }

                function ir(n, t) { var r = this.__data__; return this.size += this.has(n) ? 0 : 1, r[n] = fs && t === X ? un : t, this }

                function or(n) { var t = -1,
                        r = null == n ? 0 : n.length; for (this.clear(); ++t < r;) { var e = n[t];
                        this.set(e[0], e[1]) } }

                function fr() { this.__data__ = [], this.size = 0 }

                function ar(n) { var t = this.__data__,
                        r = Lr(t, n); if (r < 0) return !1; var e = t.length - 1; return r == e ? t.pop() : Ul.call(t, r, 1), --this.size, !0 }

                function cr(n) { var t = this.__data__,
                        r = Lr(t, n); return r < 0 ? X : t[r][1] }

                function lr(n) { return Lr(this.__data__, n) > -1 }

                function sr(n, t) { var r = this.__data__,
                        e = Lr(r, n); return e < 0 ? (++this.size, r.push([n, t])) : r[e][1] = t, this }

                function hr(n) { var t = -1,
                        r = null == n ? 0 : n.length; for (this.clear(); ++t < r;) { var e = n[t];
                        this.set(e[0], e[1]) } }

                function pr() { this.size = 0, this.__data__ = { hash: new nr, map: new(es || or), string: new nr } }

                function vr(n) { var t = ki(this, n).delete(n); return this.size -= t ? 1 : 0, t }

                function _r(n) { return ki(this, n).get(n) }

                function gr(n) { return ki(this, n).has(n) }

                function yr(n, t) { var r = ki(this, n),
                        e = r.size; return r.set(n, t), this.size += r.size == e ? 0 : 1, this }

                function dr(n) { var t = -1,
                        r = null == n ? 0 : n.length; for (this.__data__ = new hr; ++t < r;) this.add(n[t]) }

                function br(n) { return this.__data__.set(n, un), this }

                function wr(n) { return this.__data__.has(n) }

                function mr(n) { var t = this.__data__ = new or(n);
                    this.size = t.size }

                function xr() { this.__data__ = new or, this.size = 0 }

                function jr(n) { var t = this.__data__,
                        r = t.delete(n); return this.size = t.size, r }

                function Ar(n) { return this.__data__.get(n) }

                function kr(n) { return this.__data__.has(n) }

                function Or(n, t) { var r = this.__data__; if (r instanceof or) { var e = r.__data__; if (!es || e.length < tn - 1) return e.push([n, t]), this.size = ++r.size, this;
                        r = this.__data__ = new hr(e) } return r.set(n, t), this.size = r.size, this }

                function Ir(n, t) { var r = mh(n),
                        e = !r && wh(n),
                        u = !r && !e && jh(n),
                        i = !r && !e && !u && Rh(n),
                        o = r || e || u || i,
                        f = o ? R(n.length, vl) : [],
                        a = f.length; for (var c in n) !t && !ml.call(n, c) || o && ("length" == c || u && ("offset" == c || "parent" == c) || i && ("buffer" == c || "byteLength" == c || "byteOffset" == c) || Ti(c, a)) || f.push(c); return f }

                function Rr(n) { var t = n.length; return t ? n[ru(0, t - 1)] : X }

                function zr(n, t) { return to(Mu(n), Fr(t, 0, n.length)) }

                function Er(n) { return to(Mu(n)) }

                function Sr(n, t, r) {
                    (r === X || Jf(n[t], r)) && (r !== X || t in n) || Tr(n, t, r) }

                function Wr(n, t, r) { var e = n[t];
                    ml.call(n, t) && Jf(e, r) && (r !== X || t in n) || Tr(n, t, r) }

                function Lr(n, t) { for (var r = n.length; r--;)
                        if (Jf(n[r][0], t)) return r; return -1 }

                function Cr(n, t, r, e) { return bs(n, function(n, u, i) { t(e, n, r(n), i) }), e }

                function Ur(n, t) { return n && Fu(t, Za(t), n) }

                function Br(n, t) { return n && Fu(t, Ka(t), n) }

                function Tr(n, t, r) { "__proto__" == t && Dl ? Dl(n, t, { configurable: !0, enumerable: !0, value: r, writable: !0 }) : n[t] = r }

                function Mr(n, t) { for (var r = -1, e = t.length, u = fl(e), i = null == n; ++r < e;) u[r] = i ? X : Na(n, t[r]); return u }

                function Fr(n, t, r) { return n === n && (r !== X && (n = n <= r ? n : r), t !== X && (n = n >= t ? n : t)), n }

                function Nr(n, t, r, e, i, o) { var f, a = t & an,
                        c = t & cn,
                        l = t & ln; if (r && (f = i ? r(n, e, i, o) : r(n)), f !== X) return f; if (!ca(n)) return n; var s = mh(n); if (s) { if (f = Wi(n), !a) return Mu(n, f) } else { var h = Ss(n),
                            p = h == Zn || h == Kn; if (jh(n)) return Ru(n, a); if (h == Jn || h == $n || p && !i) { if (f = c || p ? {} : Li(n), !a) return c ? Pu(n, Br(f, n)) : Nu(n, Ur(f, n)) } else { if (!Vr[h]) return i ? n : {};
                            f = Ci(n, h, Nr, a) } } o || (o = new mr); var v = o.get(n); if (v) return v;
                    o.set(n, f); var _ = l ? c ? mi : wi : c ? Ka : Za,
                        g = s ? X : _(n); return u(g || n, function(e, u) { g && (u = e, e = n[u]), Wr(f, u, Nr(e, t, r, u, n, o)) }), f }

                function Pr(n) { var t = Za(n); return function(r) { return Gr(r, n, t) } }

                function Gr(n, t, r) { var e = r.length; if (null == n) return !e; for (n = hl(n); e--;) { var u = r[e],
                            i = t[u],
                            o = n[u]; if (o === X && !(u in n) || !i(o)) return !1 } return !0 }

                function Hr(n, t, r) { if ("function" != typeof n) throw new _l(en); return Cs(function() { n.apply(X, r) }, t) }

                function Jr(n, t, r, e) { var u = -1,
                        i = a,
                        o = !0,
                        f = n.length,
                        s = [],
                        h = t.length; if (!f) return s;
                    r && (t = l(t, E(r))), e ? (i = c, o = !1) : t.length >= tn && (i = W, o = !1, t = new dr(t));
                    n: for (; ++u < f;) { var p = n[u],
                            v = null == r ? p : r(p); if (p = e || 0 !== p ? p : 0, o && v === v) { for (var _ = h; _--;)
                                if (t[_] === v) continue n;
                            s.push(p) } else i(t, v, e) || s.push(p) }
                    return s }

                function Yr(n, t) { var r = !0; return bs(n, function(n, e, u) { return r = !!t(n, e, u) }), r }

                function ne(n, t, r) { for (var e = -1, u = n.length; ++e < u;) { var i = n[e],
                            o = t(i); if (null != o && (f === X ? o === o && !ma(o) : r(o, f))) var f = o,
                            a = i } return a }

                function te(n, t, r, e) { var u = n.length; for (r = Ia(r), r < 0 && (r = -r > u ? 0 : u + r), e = e === X || e > u ? u : Ia(e), e < 0 && (e += u), e = r > e ? 0 : Ra(e); r < e;) n[r++] = t; return n }

                function ee(n, t) { var r = []; return bs(n, function(n, e, u) { t(n, e, u) && r.push(n) }), r }

                function ue(n, t, r, e, u) { var i = -1,
                        o = n.length; for (r || (r = Bi), u || (u = []); ++i < o;) { var f = n[i];
                        t > 0 && r(f) ? t > 1 ? ue(f, t - 1, r, e, u) : s(u, f) : e || (u[u.length] = f) } return u }

                function oe(n, t) { return n && ms(n, t, Za) }

                function fe(n, t) { return n && xs(n, t, Za) }

                function ve(n, t) { return f(t, function(t) { return oa(n[t]) }) }

                function de(n, t) { t = Ou(t, n); for (var r = 0, e = t.length; null != n && r < e;) n = n[ro(t[r++])]; return r && r == e ? n : X }

                function we(n, t, r) { var e = t(n); return mh(n) ? e : s(e, r(n)) }

                function me(n) { return null == n ? n === X ? et : Hn : $l && $l in hl(n) ? Ri(n) : Hi(n) }

                function xe(n, t) { return n > t }

                function je(n, t) { return null != n && ml.call(n, t) }

                function Ae(n, t) { return null != n && t in hl(n) }

                function ke(n, t, r) { return n >= Yl(t, r) && n < Jl(t, r) }

                function Oe(n, t, r) { for (var e = r ? c : a, u = n[0].length, i = n.length, o = i, f = fl(i), s = 1 / 0, h = []; o--;) { var p = n[o];
                        o && t && (p = l(p, E(t))), s = Yl(p.length, s), f[o] = !r && (t || u >= 120 && p.length >= 120) ? new dr(o && p) : X } p = n[0]; var v = -1,
                        _ = f[0];
                    n: for (; ++v < u && h.length < s;) { var g = p[v],
                            y = t ? t(g) : g; if (g = r || 0 !== g ? g : 0, !(_ ? W(_, y) : e(h, y, r))) { for (o = i; --o;) { var d = f[o]; if (!(d ? W(d, y) : e(n[o], y, r))) continue n } _ && _.push(y), h.push(g) } }
                    return h }

                function Ie(n, t, r, e) { return oe(n, function(n, u, i) { t(e, r(n), u, i) }), e }

                function Re(n, t, e) { t = Ou(t, n), n = Yi(n, t); var u = null == n ? n : n[ro(ko(t))]; return null == u ? X : r(u, n, e) }

                function ze(n) { return la(n) && me(n) == $n }

                function Ee(n) { return la(n) && me(n) == ot }

                function Se(n) { return la(n) && me(n) == Nn }

                function We(n, t, r, e, u) { return n === t || (null == n || null == t || !la(n) && !la(t) ? n !== n && t !== t : Le(n, t, r, e, We, u)) }

                function Le(n, t, r, e, u, i) { var o = mh(n),
                        f = mh(t),
                        a = o ? Dn : Ss(n),
                        c = f ? Dn : Ss(t);
                    a = a == $n ? Jn : a, c = c == $n ? Jn : c; var l = a == Jn,
                        s = c == Jn,
                        h = a == c; if (h && jh(n)) { if (!jh(t)) return !1;
                        o = !0, l = !1 } if (h && !l) return i || (i = new mr), o || Rh(n) ? gi(n, t, r, e, u, i) : yi(n, t, a, r, e, u, i); if (!(r & sn)) { var p = l && ml.call(n, "__wrapped__"),
                            v = s && ml.call(t, "__wrapped__"); if (p || v) { var _ = p ? n.value() : n,
                                g = v ? t.value() : t; return i || (i = new mr), u(_, g, r, e, i) } } return !!h && (i || (i = new mr), di(n, t, r, e, u, i)) }

                function Ce(n) { return la(n) && Ss(n) == Vn }

                function Ue(n, t, r, e) { var u = r.length,
                        i = u,
                        o = !e; if (null == n) return !i; for (n = hl(n); u--;) { var f = r[u]; if (o && f[2] ? f[1] !== n[f[0]] : !(f[0] in n)) return !1 } for (; ++u < i;) { f = r[u]; var a = f[0],
                            c = n[a],
                            l = f[1]; if (o && f[2]) { if (c === X && !(a in n)) return !1 } else { var s = new mr; if (e) var h = e(c, l, a, n, t, s); if (!(h === X ? We(l, c, sn | hn, e, s) : h)) return !1 } } return !0 }

                function Be(n) { if (!ca(n) || Ni(n)) return !1; var t = oa(n) ? Il : Zt; return t.test(eo(n)) }

                function Te(n) { return la(n) && me(n) == Xn }

                function $e(n) { return la(n) && Ss(n) == nt }

                function De(n) { return la(n) && aa(n.length) && !!Kr[me(n)] }

                function Me(n) { return "function" == typeof n ? n : null == n ? Uc : "object" == typeof n ? mh(n) ? Ke(n[0], n[1]) : Ze(n) : Pc(n) }

                function Fe(n) { if (!Pi(n)) return Hl(n); var t = []; for (var r in hl(n)) ml.call(n, r) && "constructor" != r && t.push(r); return t }

                function Ne(n) { if (!ca(n)) return Gi(n); var t = Pi(n),
                        r = []; for (var e in n)("constructor" != e || !t && ml.call(n, e)) && r.push(e); return r }

                function Pe(n, t) { return n < t }

                function qe(n, t) { var r = -1,
                        e = Yf(n) ? fl(n.length) : []; return bs(n, function(n, u, i) { e[++r] = t(n, u, i) }), e }

                function Ze(n) { var t = Oi(n); return 1 == t.length && t[0][2] ? Zi(t[0][0], t[0][1]) : function(r) { return r === n || Ue(r, n, t) } }

                function Ke(n, t) { return Di(n) && qi(t) ? Zi(ro(n), t) : function(r) { var e = Na(r, n); return e === X && e === t ? qa(r, n) : We(t, e, sn | hn) } }

                function Ve(n, t, r, e, u) { n !== t && ms(t, function(i, o) { if (ca(i)) u || (u = new mr), Ge(n, t, o, r, Ve, e, u);
                        else { var f = e ? e(n[o], i, o + "", n, t, u) : X;
                            f === X && (f = i), Sr(n, o, f) } }, Ka) }

                function Ge(n, t, r, e, u, i, o) { var f = n[r],
                        a = t[r],
                        c = o.get(a); if (c) return void Sr(n, r, c); var l = i ? i(f, a, r + "", n, t, o) : X,
                        s = l === X; if (s) { var h = mh(a),
                            p = !h && jh(a),
                            v = !h && !p && Rh(a);
                        l = a, h || p || v ? mh(f) ? l = f : Qf(f) ? l = Mu(f) : p ? (s = !1, l = Ru(a, !0)) : v ? (s = !1, l = Uu(a, !0)) : l = [] : da(a) || wh(a) ? (l = f, wh(f) ? l = Ea(f) : (!ca(f) || e && oa(f)) && (l = Li(a))) : s = !1 } s && (o.set(a, l), u(l, a, e, i, o), o.delete(a)), Sr(n, r, l) }

                function He(n, t) { var r = n.length; if (r) return t += t < 0 ? r : 0, Ti(t, r) ? n[t] : X }

                function Je(n, t, r) { var e = -1;
                    t = l(t.length ? t : [Uc], E(Ai())); var u = qe(n, function(n, r, u) { var i = l(t, function(t) { return t(n) }); return { criteria: i, index: ++e, value: n } }); return O(u, function(n, t) { return Tu(n, t, r) }) }

                function Ye(n, t) { return Qe(n, t, function(t, r) { return qa(n, r) }) }

                function Qe(n, t, r) { for (var e = -1, u = t.length, i = {}; ++e < u;) { var o = t[e],
                            f = de(n, o);
                        r(f, o) && au(i, Ou(o, n), f) } return i }

                function Xe(n) { return function(t) { return de(t, n) } }

                function nu(n, t, r, e) { var u = e ? w : b,
                        i = -1,
                        o = t.length,
                        f = n; for (n === t && (t = Mu(t)), r && (f = l(n, E(r))); ++i < o;)
                        for (var a = 0, c = t[i], s = r ? r(c) : c;
                            (a = u(f, s, a, e)) > -1;) f !== n && Ul.call(f, a, 1), Ul.call(n, a, 1); return n }

                function tu(n, t) { for (var r = n ? t.length : 0, e = r - 1; r--;) { var u = t[r]; if (r == e || u !== i) { var i = u;
                            Ti(u) ? Ul.call(n, u, 1) : du(n, u) } } return n }

                function ru(n, t) { return n + ql(ns() * (t - n + 1)) }

                function eu(n, t, r, e) { for (var u = -1, i = Jl(Pl((t - n) / (r || 1)), 0), o = fl(i); i--;) o[e ? i : ++u] = n, n += r; return o }

                function uu(n, t) { var r = ""; if (!n || t < 1 || t > Sn) return r;
                    do t % 2 && (r += n), t = ql(t / 2), t && (n += n); while (t); return r }

                function iu(n, t) { return Us(Ji(n, t, Uc), n + "") }

                function ou(n) { return Rr(uc(n)) }

                function fu(n, t) { var r = uc(n); return to(r, Fr(t, 0, r.length)) }

                function au(n, t, r, e) { if (!ca(n)) return n;
                    t = Ou(t, n); for (var u = -1, i = t.length, o = i - 1, f = n; null != f && ++u < i;) { var a = ro(t[u]),
                            c = r; if (u != o) { var l = f[a];
                            c = e ? e(l, a, f) : X, c === X && (c = ca(l) ? l : Ti(t[u + 1]) ? [] : {}) } Wr(f, a, c), f = f[a] } return n }

                function cu(n) { return to(uc(n)) }

                function lu(n, t, r) { var e = -1,
                        u = n.length;
                    t < 0 && (t = -t > u ? 0 : u + t), r = r > u ? u : r, r < 0 && (r += u), u = t > r ? 0 : r - t >>> 0, t >>>= 0; for (var i = fl(u); ++e < u;) i[e] = n[e + t]; return i }

                function su(n, t) { var r; return bs(n, function(n, e, u) { return r = t(n, e, u), !r }), !!r }

                function hu(n, t, r) { var e = 0,
                        u = null == n ? e : n.length; if ("number" == typeof t && t === t && u <= Bn) { for (; e < u;) { var i = e + u >>> 1,
                                o = n[i];
                            null !== o && !ma(o) && (r ? o <= t : o < t) ? e = i + 1 : u = i } return u } return pu(n, t, Uc, r) }

                function pu(n, t, r, e) { t = r(t); for (var u = 0, i = null == n ? 0 : n.length, o = t !== t, f = null === t, a = ma(t), c = t === X; u < i;) { var l = ql((u + i) / 2),
                            s = r(n[l]),
                            h = s !== X,
                            p = null === s,
                            v = s === s,
                            _ = ma(s); if (o) var g = e || v;
                        else g = c ? v && (e || h) : f ? v && h && (e || !p) : a ? v && h && !p && (e || !_) : !p && !_ && (e ? s <= t : s < t);
                        g ? u = l + 1 : i = l } return Yl(i, Un) }

                function vu(n, t) { for (var r = -1, e = n.length, u = 0, i = []; ++r < e;) { var o = n[r],
                            f = t ? t(o) : o; if (!r || !Jf(f, a)) { var a = f;
                            i[u++] = 0 === o ? 0 : o } } return i }

                function _u(n) { return "number" == typeof n ? n : ma(n) ? Ln : +n }

                function gu(n) { if ("string" == typeof n) return n; if (mh(n)) return l(n, gu) + ""; if (ma(n)) return ys ? ys.call(n) : ""; var t = n + ""; return "0" == t && 1 / n == -En ? "-0" : t }

                function yu(n, t, r) { var e = -1,
                        u = a,
                        i = n.length,
                        o = !0,
                        f = [],
                        l = f; if (r) o = !1, u = c;
                    else if (i >= tn) { var s = t ? null : Is(n); if (s) return q(s);
                        o = !1, u = W, l = new dr } else l = t ? [] : f;
                    n: for (; ++e < i;) { var h = n[e],
                            p = t ? t(h) : h; if (h = r || 0 !== h ? h : 0, o && p === p) { for (var v = l.length; v--;)
                                if (l[v] === p) continue n;
                            t && l.push(p), f.push(h) } else u(l, p, r) || (l !== f && l.push(p), f.push(h)) }
                    return f }

                function du(n, t) { return t = Ou(t, n), n = Yi(n, t), null == n || delete n[ro(ko(t))] }

                function bu(n, t, r, e) { return au(n, t, r(de(n, t)), e) }

                function wu(n, t, r, e) { for (var u = n.length, i = e ? u : -1;
                        (e ? i-- : ++i < u) && t(n[i], i, n);); return r ? lu(n, e ? 0 : i, e ? i + 1 : u) : lu(n, e ? i + 1 : 0, e ? u : i) }

                function mu(n, t) { var r = n; return r instanceof Dt && (r = r.value()), h(t, function(n, t) { return t.func.apply(t.thisArg, s([n], t.args)) }, r) }

                function xu(n, t, r) { var e = n.length; if (e < 2) return e ? yu(n[0]) : []; for (var u = -1, i = fl(e); ++u < e;)
                        for (var o = n[u], f = -1; ++f < e;) f != u && (i[u] = Jr(i[u] || o, n[f], t, r)); return yu(ue(i, 1), t, r) }

                function ju(n, t, r) { for (var e = -1, u = n.length, i = t.length, o = {}; ++e < u;) { var f = e < i ? t[e] : X;
                        r(o, n[e], f) } return o }

                function Au(n) { return Qf(n) ? n : [] }

                function ku(n) { return "function" == typeof n ? n : Uc }

                function Ou(n, t) { return mh(n) ? n : Di(n, t) ? [n] : Bs(Wa(n)) }

                function Iu(n, t, r) { var e = n.length; return r = r === X ? e : r, !t && r >= e ? n : lu(n, t, r) }

                function Ru(n, t) { if (t) return n.slice(); var r = n.length,
                        e = Sl ? Sl(r) : new n.constructor(r); return n.copy(e), e }

                function zu(n) { var t = new n.constructor(n.byteLength); return new El(t).set(new El(n)), t }

                function Eu(n, t) { var r = t ? zu(n.buffer) : n.buffer; return new n.constructor(r, n.byteOffset, n.byteLength) }

                function Su(t, r, e) { var u = r ? e(F(t), an) : F(t); return h(u, n, new t.constructor) }

                function Wu(n) { var t = new n.constructor(n.source, Nt.exec(n)); return t.lastIndex = n.lastIndex, t }

                function Lu(n, r, e) { var u = r ? e(q(n), an) : q(n); return h(u, t, new n.constructor) }

                function Cu(n) { return gs ? hl(gs.call(n)) : {} }

                function Uu(n, t) { var r = t ? zu(n.buffer) : n.buffer; return new n.constructor(r, n.byteOffset, n.length) }

                function Bu(n, t) { if (n !== t) { var r = n !== X,
                            e = null === n,
                            u = n === n,
                            i = ma(n),
                            o = t !== X,
                            f = null === t,
                            a = t === t,
                            c = ma(t); if (!f && !c && !i && n > t || i && o && a && !f && !c || e && o && a || !r && a || !u) return 1; if (!e && !i && !c && n < t || c && r && u && !e && !i || f && r && u || !o && u || !a) return -1 } return 0 }

                function Tu(n, t, r) { for (var e = -1, u = n.criteria, i = t.criteria, o = u.length, f = r.length; ++e < o;) { var a = Bu(u[e], i[e]); if (a) { if (e >= f) return a; var c = r[e]; return a * ("desc" == c ? -1 : 1) } } return n.index - t.index }

                function $u(n, t, r, e) { for (var u = -1, i = n.length, o = r.length, f = -1, a = t.length, c = Jl(i - o, 0), l = fl(a + c), s = !e; ++f < a;) l[f] = t[f]; for (; ++u < o;)(s || u < i) && (l[r[u]] = n[u]); for (; c--;) l[f++] = n[u++]; return l }

                function Du(n, t, r, e) { for (var u = -1, i = n.length, o = -1, f = r.length, a = -1, c = t.length, l = Jl(i - f, 0), s = fl(l + c), h = !e; ++u < l;) s[u] = n[u]; for (var p = u; ++a < c;) s[p + a] = t[a]; for (; ++o < f;)(h || u < i) && (s[p + r[o]] = n[u++]); return s }

                function Mu(n, t) { var r = -1,
                        e = n.length; for (t || (t = fl(e)); ++r < e;) t[r] = n[r]; return t }

                function Fu(n, t, r, e) { var u = !r;
                    r || (r = {}); for (var i = -1, o = t.length; ++i < o;) { var f = t[i],
                            a = e ? e(r[f], n[f], f, r, n) : X;
                        a === X && (a = n[f]), u ? Tr(r, f, a) : Wr(r, f, a) } return r }

                function Nu(n, t) { return Fu(n, zs(n), t) }

                function Pu(n, t) { return Fu(n, Es(n), t) }

                function qu(n, t) { return function(r, u) { var i = mh(r) ? e : Cr,
                            o = t ? t() : {}; return i(r, n, Ai(u, 2), o) } }

                function Zu(n) { return iu(function(t, r) { var e = -1,
                            u = r.length,
                            i = u > 1 ? r[u - 1] : X,
                            o = u > 2 ? r[2] : X; for (i = n.length > 3 && "function" == typeof i ? (u--, i) : X, o && $i(r[0], r[1], o) && (i = u < 3 ? X : i, u = 1), t = hl(t); ++e < u;) { var f = r[e];
                            f && n(t, f, e, i) } return t }) }

                function Ku(n, t) { return function(r, e) { if (null == r) return r; if (!Yf(r)) return n(r, e); for (var u = r.length, i = t ? u : -1, o = hl(r);
                            (t ? i-- : ++i < u) && e(o[i], i, o) !== !1;); return r } }

                function Vu(n) { return function(t, r, e) { for (var u = -1, i = hl(t), o = e(t), f = o.length; f--;) { var a = o[n ? f : ++u]; if (r(i[a], a, i) === !1) break } return t } }

                function Gu(n, t, r) {
                    function e() { var t = this && this !== re && this instanceof e ? i : n; return t.apply(u ? r : this, arguments) } var u = t & pn,
                        i = Yu(n); return e }

                function Hu(n) { return function(t) { t = Wa(t); var r = $(t) ? H(t) : X,
                            e = r ? r[0] : t.charAt(0),
                            u = r ? Iu(r, 1).join("") : t.slice(1); return e[n]() + u } }

                function Ju(n) { return function(t) { return h(Ec(lc(t).replace($r, "")), n, "") } }

                function Yu(n) { return function() { var t = arguments; switch (t.length) {
                            case 0:
                                return new n;
                            case 1:
                                return new n(t[0]);
                            case 2:
                                return new n(t[0], t[1]);
                            case 3:
                                return new n(t[0], t[1], t[2]);
                            case 4:
                                return new n(t[0], t[1], t[2], t[3]);
                            case 5:
                                return new n(t[0], t[1], t[2], t[3], t[4]);
                            case 6:
                                return new n(t[0], t[1], t[2], t[3], t[4], t[5]);
                            case 7:
                                return new n(t[0], t[1], t[2], t[3], t[4], t[5], t[6]) } var r = ds(n.prototype),
                            e = n.apply(r, t); return ca(e) ? e : r } }

                function Qu(n, t, e) {
                    function u() { for (var o = arguments.length, f = fl(o), a = o, c = ji(u); a--;) f[a] = arguments[a]; var l = o < 3 && f[0] !== c && f[o - 1] !== c ? [] : P(f, c); if (o -= l.length, o < e) return ci(n, t, ti, u.placeholder, X, f, l, X, X, e - o); var s = this && this !== re && this instanceof u ? i : n; return r(s, this, f) } var i = Yu(n); return u }

                function Xu(n) { return function(t, r, e) { var u = hl(t); if (!Yf(t)) { var i = Ai(r, 3);
                            t = Za(t), r = function(n) { return i(u[n], n, u) } } var o = n(t, r, e); return o > -1 ? u[i ? t[o] : o] : X } }

                function ni(n) { return bi(function(t) { var r = t.length,
                            e = r,
                            u = Y.prototype.thru; for (n && t.reverse(); e--;) { var i = t[e]; if ("function" != typeof i) throw new _l(en); if (u && !o && "wrapper" == xi(i)) var o = new Y([], !0) } for (e = o ? e : r; ++e < r;) { i = t[e]; var f = xi(i),
                                a = "wrapper" == f ? Rs(i) : X;
                            o = a && Fi(a[0]) && a[1] == (wn | gn | dn | mn) && !a[4].length && 1 == a[9] ? o[xi(a[0])].apply(o, a[3]) : 1 == i.length && Fi(i) ? o[f]() : o.thru(i) } return function() { var n = arguments,
                                e = n[0]; if (o && 1 == n.length && mh(e)) return o.plant(e).value(); for (var u = 0, i = r ? t[u].apply(this, n) : e; ++u < r;) i = t[u].call(this, i); return i } }) }

                function ti(n, t, r, e, u, i, o, f, a, c) {
                    function l() { for (var y = arguments.length, d = fl(y), b = y; b--;) d[b] = arguments[b]; if (v) var w = ji(l),
                            m = U(d, w); if (e && (d = $u(d, e, u, v)), i && (d = Du(d, i, o, v)), y -= m, v && y < c) { var x = P(d, w); return ci(n, t, ti, l.placeholder, r, d, x, f, a, c - y) } var j = h ? r : this,
                            A = p ? j[n] : n; return y = d.length, f ? d = Qi(d, f) : _ && y > 1 && d.reverse(), s && a < y && (d.length = a), this && this !== re && this instanceof l && (A = g || Yu(A)), A.apply(j, d) } var s = t & wn,
                        h = t & pn,
                        p = t & vn,
                        v = t & (gn | yn),
                        _ = t & xn,
                        g = p ? X : Yu(n); return l }

                function ri(n, t) { return function(r, e) { return Ie(r, n, t(e), {}) } }

                function ei(n, t) { return function(r, e) { var u; if (r === X && e === X) return t; if (r !== X && (u = r), e !== X) { if (u === X) return e; "string" == typeof r || "string" == typeof e ? (r = gu(r), e = gu(e)) : (r = _u(r), e = _u(e)), u = n(r, e) } return u } }

                function ui(n) { return bi(function(t) { return t = l(t, E(Ai())), iu(function(e) { var u = this; return n(t, function(n) { return r(n, u, e) }) }) }) }

                function ii(n, t) { t = t === X ? " " : gu(t); var r = t.length; if (r < 2) return r ? uu(t, n) : t; var e = uu(t, Pl(n / G(t))); return $(t) ? Iu(H(e), 0, n).join("") : e.slice(0, n) }

                function oi(n, t, e, u) {
                    function i() { for (var t = -1, a = arguments.length, c = -1, l = u.length, s = fl(l + a), h = this && this !== re && this instanceof i ? f : n; ++c < l;) s[c] = u[c]; for (; a--;) s[c++] = arguments[++t]; return r(h, o ? e : this, s) } var o = t & pn,
                        f = Yu(n); return i }

                function fi(n) { return function(t, r, e) { return e && "number" != typeof e && $i(t, r, e) && (r = e = X), t = Oa(t), r === X ? (r = t, t = 0) : r = Oa(r), e = e === X ? t < r ? 1 : -1 : Oa(e), eu(t, r, e, n) } }

                function ai(n) { return function(t, r) { return "string" == typeof t && "string" == typeof r || (t = za(t), r = za(r)), n(t, r) } }

                function ci(n, t, r, e, u, i, o, f, a, c) { var l = t & gn,
                        s = l ? o : X,
                        h = l ? X : o,
                        p = l ? i : X,
                        v = l ? X : i;
                    t |= l ? dn : bn, t &= ~(l ? bn : dn), t & _n || (t &= ~(pn | vn)); var _ = [n, t, u, p, s, v, h, f, a, c],
                        g = r.apply(X, _); return Fi(n) && Ls(g, _), g.placeholder = e, Xi(g, n, t) }

                function li(n) { var t = sl[n]; return function(n, r) { if (n = za(n), r = null == r ? 0 : Yl(Ia(r), 292)) { var e = (Wa(n) + "e").split("e"),
                                u = t(e[0] + "e" + (+e[1] + r)); return e = (Wa(u) + "e").split("e"), +(e[0] + "e" + (+e[1] - r)) } return t(n) } }

                function si(n) { return function(t) { var r = Ss(t); return r == Vn ? F(t) : r == nt ? Z(t) : z(t, n(t)) } }

                function hi(n, t, r, e, u, i, o, f) { var a = t & vn; if (!a && "function" != typeof n) throw new _l(en); var c = e ? e.length : 0; if (c || (t &= ~(dn | bn), e = u = X), o = o === X ? o : Jl(Ia(o), 0), f = f === X ? f : Ia(f), c -= u ? u.length : 0, t & bn) { var l = e,
                            s = u;
                        e = u = X } var h = a ? X : Rs(n),
                        p = [n, t, r, e, u, l, s, i, o, f]; if (h && Vi(p, h), n = p[0], t = p[1], r = p[2], e = p[3], u = p[4], f = p[9] = p[9] === X ? a ? 0 : n.length : Jl(p[9] - c, 0), !f && t & (gn | yn) && (t &= ~(gn | yn)), t && t != pn) v = t == gn || t == yn ? Qu(n, t, f) : t != dn && t != (pn | dn) || u.length ? ti.apply(X, p) : oi(n, t, r, e);
                    else var v = Gu(n, t, r); var _ = h ? js : Ls; return Xi(_(v, p), n, t) }

                function pi(n, t, r, e) { return n === X || Jf(n, dl[r]) && !ml.call(e, r) ? t : n }

                function vi(n, t, r, e, u, i) { return ca(n) && ca(t) && (i.set(t, n), Ve(n, t, X, vi, i), i.delete(t)), n }

                function _i(n) { return da(n) ? X : n }

                function gi(n, t, r, e, u, i) { var o = r & sn,
                        f = n.length,
                        a = t.length; if (f != a && !(o && a > f)) return !1; var c = i.get(n); if (c && i.get(t)) return c == t; var l = -1,
                        s = !0,
                        h = r & hn ? new dr : X; for (i.set(n, t), i.set(t, n); ++l < f;) { var p = n[l],
                            _ = t[l]; if (e) var g = o ? e(_, p, l, t, n, i) : e(p, _, l, n, t, i); if (g !== X) { if (g) continue;
                            s = !1; break } if (h) { if (!v(t, function(n, t) { if (!W(h, t) && (p === n || u(p, n, r, e, i))) return h.push(t) })) { s = !1; break } } else if (p !== _ && !u(p, _, r, e, i)) { s = !1; break } } return i.delete(n), i.delete(t), s }

                function yi(n, t, r, e, u, i, o) { switch (r) {
                        case ft:
                            if (n.byteLength != t.byteLength || n.byteOffset != t.byteOffset) return !1;
                            n = n.buffer, t = t.buffer;
                        case ot:
                            return !(n.byteLength != t.byteLength || !i(new El(n), new El(t)));
                        case Fn:
                        case Nn:
                        case Gn:
                            return Jf(+n, +t);
                        case qn:
                            return n.name == t.name && n.message == t.message;
                        case Xn:
                        case tt:
                            return n == t + "";
                        case Vn:
                            var f = F;
                        case nt:
                            var a = e & sn; if (f || (f = q), n.size != t.size && !a) return !1; var c = o.get(n); if (c) return c == t;
                            e |= hn, o.set(n, t); var l = gi(f(n), f(t), e, u, i, o); return o.delete(n), l;
                        case rt:
                            if (gs) return gs.call(n) == gs.call(t) } return !1 }

                function di(n, t, r, e, u, i) {
                    var o = r & sn,
                        f = wi(n),
                        a = f.length,
                        c = wi(t),
                        l = c.length;
                    if (a != l && !o) return !1;
                    for (var s = a; s--;) { var h = f[s]; if (!(o ? h in t : ml.call(t, h))) return !1 }
                    var p = i.get(n);
                    if (p && i.get(t)) return p == t;
                    var v = !0;
                    i.set(n, t), i.set(t, n);
                    for (var _ = o; ++s < a;) { h = f[s]; var g = n[h],
                            y = t[h]; if (e) var d = o ? e(y, g, h, t, n, i) : e(g, y, h, n, t, i); if (!(d === X ? g === y || u(g, y, r, e, i) : d)) { v = !1; break } _ || (_ = "constructor" == h) }
                    if (v && !_) {
                        var b = n.constructor,
                            w = t.constructor;
                        b != w && "constructor" in n && "constructor" in t && !("function" == typeof b && b instanceof b && "function" == typeof w && w instanceof w) && (v = !1);
                    }
                    return i.delete(n), i.delete(t), v
                }

                function bi(n) { return Us(Ji(n, X, go), n + "") }

                function wi(n) { return we(n, Za, zs) }

                function mi(n) { return we(n, Ka, Es) }

                function xi(n) { for (var t = n.name + "", r = cs[t], e = ml.call(cs, t) ? r.length : 0; e--;) { var u = r[e],
                            i = u.func; if (null == i || i == n) return u.name } return t }

                function ji(n) { var t = ml.call(K, "placeholder") ? K : n; return t.placeholder }

                function Ai() { var n = K.iteratee || Bc; return n = n === Bc ? Me : n, arguments.length ? n(arguments[0], arguments[1]) : n }

                function ki(n, t) { var r = n.__data__; return Mi(t) ? r["string" == typeof t ? "string" : "hash"] : r.map }

                function Oi(n) { for (var t = Za(n), r = t.length; r--;) { var e = t[r],
                            u = n[e];
                        t[r] = [e, u, qi(u)] } return t }

                function Ii(n, t) { var r = T(n, t); return Be(r) ? r : X }

                function Ri(n) { var t = ml.call(n, $l),
                        r = n[$l]; try { n[$l] = X; var e = !0 } catch (n) {} var u = Al.call(n); return e && (t ? n[$l] = r : delete n[$l]), u }

                function zi(n, t, r) { for (var e = -1, u = r.length; ++e < u;) { var i = r[e],
                            o = i.size; switch (i.type) {
                            case "drop":
                                n += o; break;
                            case "dropRight":
                                t -= o; break;
                            case "take":
                                t = Yl(t, n + o); break;
                            case "takeRight":
                                n = Jl(n, t - o) } } return { start: n, end: t } }

                function Ei(n) { var t = n.match(Tt); return t ? t[1].split($t) : [] }

                function Si(n, t, r) { t = Ou(t, n); for (var e = -1, u = t.length, i = !1; ++e < u;) { var o = ro(t[e]); if (!(i = null != n && r(n, o))) break;
                        n = n[o] } return i || ++e != u ? i : (u = null == n ? 0 : n.length, !!u && aa(u) && Ti(o, u) && (mh(n) || wh(n))) }

                function Wi(n) { var t = n.length,
                        r = n.constructor(t); return t && "string" == typeof n[0] && ml.call(n, "index") && (r.index = n.index, r.input = n.input), r }

                function Li(n) { return "function" != typeof n.constructor || Pi(n) ? {} : ds(Wl(n)) }

                function Ci(n, t, r, e) { var u = n.constructor; switch (t) {
                        case ot:
                            return zu(n);
                        case Fn:
                        case Nn:
                            return new u(+n);
                        case ft:
                            return Eu(n, e);
                        case at:
                        case ct:
                        case lt:
                        case st:
                        case ht:
                        case pt:
                        case vt:
                        case _t:
                        case gt:
                            return Uu(n, e);
                        case Vn:
                            return Su(n, e, r);
                        case Gn:
                        case tt:
                            return new u(n);
                        case Xn:
                            return Wu(n);
                        case nt:
                            return Lu(n, e, r);
                        case rt:
                            return Cu(n) } }

                function Ui(n, t) { var r = t.length; if (!r) return n; var e = r - 1; return t[e] = (r > 1 ? "& " : "") + t[e], t = t.join(r > 2 ? ", " : " "), n.replace(Bt, "{\n/* [wrapped with " + t + "] */\n") }

                function Bi(n) { return mh(n) || wh(n) || !!(Bl && n && n[Bl]) }

                function Ti(n, t) { return t = null == t ? Sn : t, !!t && ("number" == typeof n || Vt.test(n)) && n > -1 && n % 1 == 0 && n < t }

                function $i(n, t, r) { if (!ca(r)) return !1; var e = typeof t; return !!("number" == e ? Yf(r) && Ti(t, r.length) : "string" == e && t in r) && Jf(r[t], n) }

                function Di(n, t) { if (mh(n)) return !1; var r = typeof n; return !("number" != r && "symbol" != r && "boolean" != r && null != n && !ma(n)) || (Rt.test(n) || !It.test(n) || null != t && n in hl(t)) }

                function Mi(n) { var t = typeof n; return "string" == t || "number" == t || "symbol" == t || "boolean" == t ? "__proto__" !== n : null === n }

                function Fi(n) { var t = xi(n),
                        r = K[t]; if ("function" != typeof r || !(t in Dt.prototype)) return !1; if (n === r) return !0; var e = Rs(r); return !!e && n === e[0] }

                function Ni(n) { return !!jl && jl in n }

                function Pi(n) { var t = n && n.constructor,
                        r = "function" == typeof t && t.prototype || dl; return n === r }

                function qi(n) { return n === n && !ca(n) }

                function Zi(n, t) { return function(r) { return null != r && (r[n] === t && (t !== X || n in hl(r))) } }

                function Ki(n) { var t = Bf(n, function(n) { return r.size === on && r.clear(), n }),
                        r = t.cache; return t }

                function Vi(n, t) { var r = n[1],
                        e = t[1],
                        u = r | e,
                        i = u < (pn | vn | wn),
                        o = e == wn && r == gn || e == wn && r == mn && n[7].length <= t[8] || e == (wn | mn) && t[7].length <= t[8] && r == gn; if (!i && !o) return n;
                    e & pn && (n[2] = t[2], u |= r & pn ? 0 : _n); var f = t[3]; if (f) { var a = n[3];
                        n[3] = a ? $u(a, f, t[4]) : f, n[4] = a ? P(n[3], fn) : t[4] } return f = t[5], f && (a = n[5], n[5] = a ? Du(a, f, t[6]) : f, n[6] = a ? P(n[5], fn) : t[6]), f = t[7], f && (n[7] = f), e & wn && (n[8] = null == n[8] ? t[8] : Yl(n[8], t[8])), null == n[9] && (n[9] = t[9]), n[0] = t[0], n[1] = u, n }

                function Gi(n) { var t = []; if (null != n)
                        for (var r in hl(n)) t.push(r); return t }

                function Hi(n) { return Al.call(n) }

                function Ji(n, t, e) { return t = Jl(t === X ? n.length - 1 : t, 0),
                        function() { for (var u = arguments, i = -1, o = Jl(u.length - t, 0), f = fl(o); ++i < o;) f[i] = u[t + i];
                            i = -1; for (var a = fl(t + 1); ++i < t;) a[i] = u[i]; return a[t] = e(f), r(n, this, a) } }

                function Yi(n, t) { return t.length < 2 ? n : de(n, lu(t, 0, -1)) }

                function Qi(n, t) { for (var r = n.length, e = Yl(t.length, r), u = Mu(n); e--;) { var i = t[e];
                        n[e] = Ti(i, r) ? u[i] : X } return n }

                function Xi(n, t, r) { var e = t + ""; return Us(n, Ui(e, uo(Ei(e), r))) }

                function no(n) { var t = 0,
                        r = 0; return function() { var e = Ql(),
                            u = On - (e - r); if (r = e, u > 0) { if (++t >= kn) return arguments[0] } else t = 0; return n.apply(X, arguments) } }

                function to(n, t) { var r = -1,
                        e = n.length,
                        u = e - 1; for (t = t === X ? e : t; ++r < t;) { var i = ru(r, u),
                            o = n[i];
                        n[i] = n[r], n[r] = o } return n.length = t, n }

                function ro(n) { if ("string" == typeof n || ma(n)) return n; var t = n + ""; return "0" == t && 1 / n == -En ? "-0" : t }

                function eo(n) { if (null != n) { try { return wl.call(n) } catch (n) {} try { return n + "" } catch (n) {} } return "" }

                function uo(n, t) { return u(Tn, function(r) { var e = "_." + r[0];
                        t & r[1] && !a(n, e) && n.push(e) }), n.sort() }

                function io(n) { if (n instanceof Dt) return n.clone(); var t = new Y(n.__wrapped__, n.__chain__); return t.__actions__ = Mu(n.__actions__), t.__index__ = n.__index__, t.__values__ = n.__values__, t }

                function oo(n, t, r) { t = (r ? $i(n, t, r) : t === X) ? 1 : Jl(Ia(t), 0); var e = null == n ? 0 : n.length; if (!e || t < 1) return []; for (var u = 0, i = 0, o = fl(Pl(e / t)); u < e;) o[i++] = lu(n, u, u += t); return o }

                function fo(n) { for (var t = -1, r = null == n ? 0 : n.length, e = 0, u = []; ++t < r;) { var i = n[t];
                        i && (u[e++] = i) } return u }

                function ao() { var n = arguments.length; if (!n) return []; for (var t = fl(n - 1), r = arguments[0], e = n; e--;) t[e - 1] = arguments[e]; return s(mh(r) ? Mu(r) : [r], ue(t, 1)) }

                function co(n, t, r) { var e = null == n ? 0 : n.length; return e ? (t = r || t === X ? 1 : Ia(t), lu(n, t < 0 ? 0 : t, e)) : [] }

                function lo(n, t, r) { var e = null == n ? 0 : n.length; return e ? (t = r || t === X ? 1 : Ia(t), t = e - t, lu(n, 0, t < 0 ? 0 : t)) : [] }

                function so(n, t) { return n && n.length ? wu(n, Ai(t, 3), !0, !0) : [] }

                function ho(n, t) { return n && n.length ? wu(n, Ai(t, 3), !0) : [] }

                function po(n, t, r, e) { var u = null == n ? 0 : n.length; return u ? (r && "number" != typeof r && $i(n, t, r) && (r = 0, e = u), te(n, t, r, e)) : [] }

                function vo(n, t, r) { var e = null == n ? 0 : n.length; if (!e) return -1; var u = null == r ? 0 : Ia(r); return u < 0 && (u = Jl(e + u, 0)), d(n, Ai(t, 3), u) }

                function _o(n, t, r) { var e = null == n ? 0 : n.length; if (!e) return -1; var u = e - 1; return r !== X && (u = Ia(r), u = r < 0 ? Jl(e + u, 0) : Yl(u, e - 1)), d(n, Ai(t, 3), u, !0) }

                function go(n) { var t = null == n ? 0 : n.length; return t ? ue(n, 1) : [] }

                function yo(n) { var t = null == n ? 0 : n.length; return t ? ue(n, En) : [] }

                function bo(n, t) { var r = null == n ? 0 : n.length; return r ? (t = t === X ? 1 : Ia(t), ue(n, t)) : [] }

                function wo(n) { for (var t = -1, r = null == n ? 0 : n.length, e = {}; ++t < r;) { var u = n[t];
                        e[u[0]] = u[1] } return e }

                function mo(n) { return n && n.length ? n[0] : X }

                function xo(n, t, r) { var e = null == n ? 0 : n.length; if (!e) return -1; var u = null == r ? 0 : Ia(r); return u < 0 && (u = Jl(e + u, 0)), b(n, t, u) }

                function jo(n) { var t = null == n ? 0 : n.length; return t ? lu(n, 0, -1) : [] }

                function Ao(n, t) { return null == n ? "" : Gl.call(n, t) }

                function ko(n) { var t = null == n ? 0 : n.length; return t ? n[t - 1] : X }

                function Oo(n, t, r) { var e = null == n ? 0 : n.length; if (!e) return -1; var u = e; return r !== X && (u = Ia(r), u = u < 0 ? Jl(e + u, 0) : Yl(u, e - 1)), t === t ? V(n, t, u) : d(n, m, u, !0) }

                function Io(n, t) { return n && n.length ? He(n, Ia(t)) : X }

                function Ro(n, t) { return n && n.length && t && t.length ? nu(n, t) : n }

                function zo(n, t, r) { return n && n.length && t && t.length ? nu(n, t, Ai(r, 2)) : n }

                function Eo(n, t, r) { return n && n.length && t && t.length ? nu(n, t, X, r) : n }

                function So(n, t) { var r = []; if (!n || !n.length) return r; var e = -1,
                        u = [],
                        i = n.length; for (t = Ai(t, 3); ++e < i;) { var o = n[e];
                        t(o, e, n) && (r.push(o), u.push(e)) } return tu(n, u), r }

                function Wo(n) { return null == n ? n : ts.call(n) }

                function Lo(n, t, r) { var e = null == n ? 0 : n.length; return e ? (r && "number" != typeof r && $i(n, t, r) ? (t = 0, r = e) : (t = null == t ? 0 : Ia(t), r = r === X ? e : Ia(r)), lu(n, t, r)) : [] }

                function Co(n, t) { return hu(n, t) }

                function Uo(n, t, r) { return pu(n, t, Ai(r, 2)) }

                function Bo(n, t) { var r = null == n ? 0 : n.length; if (r) { var e = hu(n, t); if (e < r && Jf(n[e], t)) return e } return -1 }

                function To(n, t) { return hu(n, t, !0) }

                function $o(n, t, r) { return pu(n, t, Ai(r, 2), !0) }

                function Do(n, t) { var r = null == n ? 0 : n.length; if (r) { var e = hu(n, t, !0) - 1; if (Jf(n[e], t)) return e } return -1 }

                function Mo(n) { return n && n.length ? vu(n) : [] }

                function Fo(n, t) { return n && n.length ? vu(n, Ai(t, 2)) : [] }

                function No(n) { var t = null == n ? 0 : n.length; return t ? lu(n, 1, t) : [] }

                function Po(n, t, r) { return n && n.length ? (t = r || t === X ? 1 : Ia(t), lu(n, 0, t < 0 ? 0 : t)) : [] }

                function qo(n, t, r) { var e = null == n ? 0 : n.length; return e ? (t = r || t === X ? 1 : Ia(t), t = e - t, lu(n, t < 0 ? 0 : t, e)) : [] }

                function Zo(n, t) { return n && n.length ? wu(n, Ai(t, 3), !1, !0) : [] }

                function Ko(n, t) { return n && n.length ? wu(n, Ai(t, 3)) : [] }

                function Vo(n) { return n && n.length ? yu(n) : [] }

                function Go(n, t) { return n && n.length ? yu(n, Ai(t, 2)) : [] }

                function Ho(n, t) { return t = "function" == typeof t ? t : X, n && n.length ? yu(n, X, t) : [] }

                function Jo(n) { if (!n || !n.length) return []; var t = 0; return n = f(n, function(n) { if (Qf(n)) return t = Jl(n.length, t), !0 }), R(t, function(t) { return l(n, j(t)) }) }

                function Yo(n, t) { if (!n || !n.length) return []; var e = Jo(n); return null == t ? e : l(e, function(n) { return r(t, X, n) }) }

                function Qo(n, t) { return ju(n || [], t || [], Wr) }

                function Xo(n, t) { return ju(n || [], t || [], au) }

                function nf(n) { var t = K(n); return t.__chain__ = !0, t }

                function tf(n, t) { return t(n), n }

                function rf(n, t) { return t(n) }

                function ef() { return nf(this) }

                function uf() { return new Y(this.value(), this.__chain__) }

                function of () { this.__values__ === X && (this.__values__ = ka(this.value())); var n = this.__index__ >= this.__values__.length,
                        t = n ? X : this.__values__[this.__index__++]; return { done: n, value: t } }

                function ff() { return this }

                function af(n) { for (var t, r = this; r instanceof J;) { var e = io(r);
                        e.__index__ = 0, e.__values__ = X, t ? u.__wrapped__ = e : t = e; var u = e;
                        r = r.__wrapped__ } return u.__wrapped__ = n, t }

                function cf() { var n = this.__wrapped__; if (n instanceof Dt) { var t = n; return this.__actions__.length && (t = new Dt(this)), t = t.reverse(), t.__actions__.push({ func: rf, args: [Wo], thisArg: X }), new Y(t, this.__chain__) } return this.thru(Wo) }

                function lf() { return mu(this.__wrapped__, this.__actions__) }

                function sf(n, t, r) { var e = mh(n) ? o : Yr; return r && $i(n, t, r) && (t = X), e(n, Ai(t, 3)) }

                function hf(n, t) { var r = mh(n) ? f : ee; return r(n, Ai(t, 3)) }

                function pf(n, t) { return ue(bf(n, t), 1) }

                function vf(n, t) { return ue(bf(n, t), En) }

                function _f(n, t, r) { return r = r === X ? 1 : Ia(r), ue(bf(n, t), r) }

                function gf(n, t) { var r = mh(n) ? u : bs; return r(n, Ai(t, 3)) }

                function yf(n, t) { var r = mh(n) ? i : ws; return r(n, Ai(t, 3)) }

                function df(n, t, r, e) { n = Yf(n) ? n : uc(n), r = r && !e ? Ia(r) : 0; var u = n.length; return r < 0 && (r = Jl(u + r, 0)), wa(n) ? r <= u && n.indexOf(t, r) > -1 : !!u && b(n, t, r) > -1 }

                function bf(n, t) { var r = mh(n) ? l : qe; return r(n, Ai(t, 3)) }

                function wf(n, t, r, e) { return null == n ? [] : (mh(t) || (t = null == t ? [] : [t]), r = e ? X : r, mh(r) || (r = null == r ? [] : [r]), Je(n, t, r)) }

                function mf(n, t, r) { var e = mh(n) ? h : k,
                        u = arguments.length < 3; return e(n, Ai(t, 4), r, u, bs) }

                function xf(n, t, r) { var e = mh(n) ? p : k,
                        u = arguments.length < 3; return e(n, Ai(t, 4), r, u, ws) }

                function jf(n, t) { var r = mh(n) ? f : ee; return r(n, Tf(Ai(t, 3))) }

                function Af(n) { var t = mh(n) ? Rr : ou; return t(n) }

                function kf(n, t, r) { t = (r ? $i(n, t, r) : t === X) ? 1 : Ia(t); var e = mh(n) ? zr : fu; return e(n, t) }

                function Of(n) { var t = mh(n) ? Er : cu; return t(n) }

                function If(n) { if (null == n) return 0; if (Yf(n)) return wa(n) ? G(n) : n.length; var t = Ss(n); return t == Vn || t == nt ? n.size : Fe(n).length }

                function Rf(n, t, r) { var e = mh(n) ? v : su; return r && $i(n, t, r) && (t = X), e(n, Ai(t, 3)) }

                function zf(n, t) { if ("function" != typeof t) throw new _l(en); return n = Ia(n),
                        function() { if (--n < 1) return t.apply(this, arguments) } }

                function Ef(n, t, r) { return t = r ? X : t, t = n && null == t ? n.length : t, hi(n, wn, X, X, X, X, t) }

                function Sf(n, t) { var r; if ("function" != typeof t) throw new _l(en); return n = Ia(n),
                        function() { return --n > 0 && (r = t.apply(this, arguments)), n <= 1 && (t = X), r } }

                function Wf(n, t, r) { t = r ? X : t; var e = hi(n, gn, X, X, X, X, X, t); return e.placeholder = Wf.placeholder, e }

                function Lf(n, t, r) { t = r ? X : t; var e = hi(n, yn, X, X, X, X, X, t); return e.placeholder = Lf.placeholder, e }

                function Cf(n, t, r) {
                    function e(t) { var r = h,
                            e = p; return h = p = X, d = t, _ = n.apply(e, r) }

                    function u(n) { return d = n, g = Cs(f, t), b ? e(n) : _ }

                    function i(n) { var r = n - y,
                            e = n - d,
                            u = t - r; return w ? Yl(u, v - e) : u }

                    function o(n) { var r = n - y,
                            e = n - d; return y === X || r >= t || r < 0 || w && e >= v }

                    function f() { var n = ch(); return o(n) ? a(n) : void(g = Cs(f, i(n))) }

                    function a(n) { return g = X, m && h ? e(n) : (h = p = X, _) }

                    function c() { g !== X && Os(g), d = 0, h = y = p = g = X }

                    function l() { return g === X ? _ : a(ch()) }

                    function s() { var n = ch(),
                            r = o(n); if (h = arguments, p = this, y = n, r) { if (g === X) return u(y); if (w) return g = Cs(f, t), e(y) } return g === X && (g = Cs(f, t)), _ } var h, p, v, _, g, y, d = 0,
                        b = !1,
                        w = !1,
                        m = !0; if ("function" != typeof n) throw new _l(en); return t = za(t) || 0, ca(r) && (b = !!r.leading, w = "maxWait" in r, v = w ? Jl(za(r.maxWait) || 0, t) : v, m = "trailing" in r ? !!r.trailing : m), s.cancel = c, s.flush = l, s }

                function Uf(n) { return hi(n, xn) }

                function Bf(n, t) { if ("function" != typeof n || null != t && "function" != typeof t) throw new _l(en); var r = function() { var e = arguments,
                            u = t ? t.apply(this, e) : e[0],
                            i = r.cache; if (i.has(u)) return i.get(u); var o = n.apply(this, e); return r.cache = i.set(u, o) || i, o }; return r.cache = new(Bf.Cache || hr), r }

                function Tf(n) { if ("function" != typeof n) throw new _l(en); return function() { var t = arguments; switch (t.length) {
                            case 0:
                                return !n.call(this);
                            case 1:
                                return !n.call(this, t[0]);
                            case 2:
                                return !n.call(this, t[0], t[1]);
                            case 3:
                                return !n.call(this, t[0], t[1], t[2]) } return !n.apply(this, t) } }

                function $f(n) { return Sf(2, n) }

                function Df(n, t) { if ("function" != typeof n) throw new _l(en); return t = t === X ? t : Ia(t), iu(n, t) }

                function Mf(n, t) { if ("function" != typeof n) throw new _l(en); return t = null == t ? 0 : Jl(Ia(t), 0), iu(function(e) { var u = e[t],
                            i = Iu(e, 0, t); return u && s(i, u), r(n, this, i) }) }

                function Ff(n, t, r) { var e = !0,
                        u = !0; if ("function" != typeof n) throw new _l(en); return ca(r) && (e = "leading" in r ? !!r.leading : e, u = "trailing" in r ? !!r.trailing : u), Cf(n, t, { leading: e, maxWait: t, trailing: u }) }

                function Nf(n) { return Ef(n, 1) }

                function Pf(n, t) { return _h(ku(t), n) }

                function qf() { if (!arguments.length) return []; var n = arguments[0]; return mh(n) ? n : [n] }

                function Zf(n) { return Nr(n, ln) }

                function Kf(n, t) { return t = "function" == typeof t ? t : X, Nr(n, ln, t) }

                function Vf(n) { return Nr(n, an | ln) }

                function Gf(n, t) { return t = "function" == typeof t ? t : X, Nr(n, an | ln, t) }

                function Hf(n, t) { return null == t || Gr(n, t, Za(t)) }

                function Jf(n, t) { return n === t || n !== n && t !== t }

                function Yf(n) { return null != n && aa(n.length) && !oa(n) }

                function Qf(n) { return la(n) && Yf(n) }

                function Xf(n) { return n === !0 || n === !1 || la(n) && me(n) == Fn }

                function na(n) { return la(n) && 1 === n.nodeType && !da(n) }

                function ta(n) { if (null == n) return !0; if (Yf(n) && (mh(n) || "string" == typeof n || "function" == typeof n.splice || jh(n) || Rh(n) || wh(n))) return !n.length; var t = Ss(n); if (t == Vn || t == nt) return !n.size; if (Pi(n)) return !Fe(n).length; for (var r in n)
                        if (ml.call(n, r)) return !1; return !0 }

                function ra(n, t) { return We(n, t) }

                function ea(n, t, r) { r = "function" == typeof r ? r : X; var e = r ? r(n, t) : X; return e === X ? We(n, t, X, r) : !!e }

                function ua(n) { if (!la(n)) return !1; var t = me(n); return t == qn || t == Pn || "string" == typeof n.message && "string" == typeof n.name && !da(n) }

                function ia(n) { return "number" == typeof n && Vl(n) }

                function oa(n) { if (!ca(n)) return !1; var t = me(n); return t == Zn || t == Kn || t == Mn || t == Qn }

                function fa(n) { return "number" == typeof n && n == Ia(n) }

                function aa(n) { return "number" == typeof n && n > -1 && n % 1 == 0 && n <= Sn }

                function ca(n) { var t = typeof n; return null != n && ("object" == t || "function" == t) }

                function la(n) { return null != n && "object" == typeof n }

                function sa(n, t) { return n === t || Ue(n, t, Oi(t)) }

                function ha(n, t, r) { return r = "function" == typeof r ? r : X, Ue(n, t, Oi(t), r) }

                function pa(n) { return ya(n) && n != +n }

                function va(n) { if (Ws(n)) throw new cl(rn); return Be(n) }

                function _a(n) { return null === n }

                function ga(n) { return null == n }

                function ya(n) { return "number" == typeof n || la(n) && me(n) == Gn }

                function da(n) { if (!la(n) || me(n) != Jn) return !1; var t = Wl(n); if (null === t) return !0; var r = ml.call(t, "constructor") && t.constructor; return "function" == typeof r && r instanceof r && wl.call(r) == kl }

                function ba(n) { return fa(n) && n >= -Sn && n <= Sn }

                function wa(n) { return "string" == typeof n || !mh(n) && la(n) && me(n) == tt }

                function ma(n) { return "symbol" == typeof n || la(n) && me(n) == rt }

                function xa(n) { return n === X }

                function ja(n) { return la(n) && Ss(n) == ut }

                function Aa(n) { return la(n) && me(n) == it }

                function ka(n) { if (!n) return []; if (Yf(n)) return wa(n) ? H(n) : Mu(n); if (Tl && n[Tl]) return M(n[Tl]()); var t = Ss(n),
                        r = t == Vn ? F : t == nt ? q : uc; return r(n) }

                function Oa(n) { if (!n) return 0 === n ? n : 0; if (n = za(n), n === En || n === -En) { var t = n < 0 ? -1 : 1; return t * Wn } return n === n ? n : 0 }

                function Ia(n) { var t = Oa(n),
                        r = t % 1; return t === t ? r ? t - r : t : 0 }

                function Ra(n) { return n ? Fr(Ia(n), 0, Cn) : 0 }

                function za(n) { if ("number" == typeof n) return n; if (ma(n)) return Ln; if (ca(n)) { var t = "function" == typeof n.valueOf ? n.valueOf() : n;
                        n = ca(t) ? t + "" : t } if ("string" != typeof n) return 0 === n ? n : +n;
                    n = n.replace(Lt, ""); var r = qt.test(n); return r || Kt.test(n) ? Xr(n.slice(2), r ? 2 : 8) : Pt.test(n) ? Ln : +n }

                function Ea(n) { return Fu(n, Ka(n)) }

                function Sa(n) { return n ? Fr(Ia(n), -Sn, Sn) : 0 === n ? n : 0 }

                function Wa(n) { return null == n ? "" : gu(n) }

                function La(n, t) { var r = ds(n); return null == t ? r : Ur(r, t) }

                function Ca(n, t) { return y(n, Ai(t, 3), oe) }

                function Ua(n, t) { return y(n, Ai(t, 3), fe) }

                function Ba(n, t) { return null == n ? n : ms(n, Ai(t, 3), Ka) }

                function Ta(n, t) { return null == n ? n : xs(n, Ai(t, 3), Ka) }

                function $a(n, t) { return n && oe(n, Ai(t, 3)) }

                function Da(n, t) { return n && fe(n, Ai(t, 3)) }

                function Ma(n) { return null == n ? [] : ve(n, Za(n)) }

                function Fa(n) { return null == n ? [] : ve(n, Ka(n)) }

                function Na(n, t, r) { var e = null == n ? X : de(n, t); return e === X ? r : e }

                function Pa(n, t) { return null != n && Si(n, t, je) }

                function qa(n, t) { return null != n && Si(n, t, Ae) }

                function Za(n) { return Yf(n) ? Ir(n) : Fe(n) }

                function Ka(n) { return Yf(n) ? Ir(n, !0) : Ne(n) }

                function Va(n, t) { var r = {}; return t = Ai(t, 3), oe(n, function(n, e, u) { Tr(r, t(n, e, u), n) }), r }

                function Ga(n, t) { var r = {}; return t = Ai(t, 3), oe(n, function(n, e, u) { Tr(r, e, t(n, e, u)) }), r }

                function Ha(n, t) { return Ja(n, Tf(Ai(t))) }

                function Ja(n, t) { if (null == n) return {}; var r = l(mi(n), function(n) { return [n] }); return t = Ai(t), Qe(n, r, function(n, r) { return t(n, r[0]) }) }

                function Ya(n, t, r) { t = Ou(t, n); var e = -1,
                        u = t.length; for (u || (u = 1, n = X); ++e < u;) { var i = null == n ? X : n[ro(t[e])];
                        i === X && (e = u, i = r), n = oa(i) ? i.call(n) : i } return n }

                function Qa(n, t, r) { return null == n ? n : au(n, t, r) }

                function Xa(n, t, r, e) { return e = "function" == typeof e ? e : X, null == n ? n : au(n, t, r, e) }

                function nc(n, t, r) { var e = mh(n),
                        i = e || jh(n) || Rh(n); if (t = Ai(t, 4), null == r) { var o = n && n.constructor;
                        r = i ? e ? new o : [] : ca(n) && oa(o) ? ds(Wl(n)) : {} } return (i ? u : oe)(n, function(n, e, u) { return t(r, n, e, u) }), r }

                function tc(n, t) { return null == n || du(n, t) }

                function rc(n, t, r) { return null == n ? n : bu(n, t, ku(r)) }

                function ec(n, t, r, e) { return e = "function" == typeof e ? e : X, null == n ? n : bu(n, t, ku(r), e) }

                function uc(n) { return null == n ? [] : S(n, Za(n)) }

                function ic(n) { return null == n ? [] : S(n, Ka(n)) }

                function oc(n, t, r) { return r === X && (r = t, t = X), r !== X && (r = za(r), r = r === r ? r : 0), t !== X && (t = za(t), t = t === t ? t : 0), Fr(za(n), t, r) }

                function fc(n, t, r) { return t = Oa(t), r === X ? (r = t, t = 0) : r = Oa(r), n = za(n), ke(n, t, r) }

                function ac(n, t, r) { if (r && "boolean" != typeof r && $i(n, t, r) && (t = r = X), r === X && ("boolean" == typeof t ? (r = t, t = X) : "boolean" == typeof n && (r = n, n = X)), n === X && t === X ? (n = 0, t = 1) : (n = Oa(n), t === X ? (t = n, n = 0) : t = Oa(t)), n > t) { var e = n;
                        n = t, t = e } if (r || n % 1 || t % 1) { var u = ns(); return Yl(n + u * (t - n + Qr("1e-" + ((u + "").length - 1))), t) } return ru(n, t) }

                function cc(n) { return np(Wa(n).toLowerCase()) }

                function lc(n) { return n = Wa(n), n && n.replace(Gt, _e).replace(Dr, "") }

                function sc(n, t, r) { n = Wa(n), t = gu(t); var e = n.length;
                    r = r === X ? e : Fr(Ia(r), 0, e); var u = r; return r -= t.length, r >= 0 && n.slice(r, u) == t }

                function hc(n) { return n = Wa(n), n && jt.test(n) ? n.replace(mt, ge) : n }

                function pc(n) { return n = Wa(n), n && Wt.test(n) ? n.replace(St, "\\$&") : n }

                function vc(n, t, r) { n = Wa(n), t = Ia(t); var e = t ? G(n) : 0; if (!t || e >= t) return n; var u = (t - e) / 2; return ii(ql(u), r) + n + ii(Pl(u), r) }

                function _c(n, t, r) { n = Wa(n), t = Ia(t); var e = t ? G(n) : 0; return t && e < t ? n + ii(t - e, r) : n }

                function gc(n, t, r) { n = Wa(n), t = Ia(t); var e = t ? G(n) : 0; return t && e < t ? ii(t - e, r) + n : n }

                function yc(n, t, r) { return r || null == t ? t = 0 : t && (t = +t), Xl(Wa(n).replace(Ct, ""), t || 0) }

                function dc(n, t, r) { return t = (r ? $i(n, t, r) : t === X) ? 1 : Ia(t), uu(Wa(n), t) }

                function bc() { var n = arguments,
                        t = Wa(n[0]); return n.length < 3 ? t : t.replace(n[1], n[2]) }

                function wc(n, t, r) { return r && "number" != typeof r && $i(n, t, r) && (t = r = X), (r = r === X ? Cn : r >>> 0) ? (n = Wa(n), n && ("string" == typeof t || null != t && !Oh(t)) && (t = gu(t), !t && $(n)) ? Iu(H(n), 0, r) : n.split(t, r)) : [] }

                function mc(n, t, r) { return n = Wa(n), r = null == r ? 0 : Fr(Ia(r), 0, n.length), t = gu(t), n.slice(r, r + t.length) == t }

                function xc(n, t, r) { var e = K.templateSettings;
                    r && $i(n, t, r) && (t = X), n = Wa(n), t = Lh({}, t, e, pi); var u, i, o = Lh({}, t.imports, e.imports, pi),
                        f = Za(o),
                        a = S(o, f),
                        c = 0,
                        l = t.interpolate || Ht,
                        s = "__p += '",
                        h = pl((t.escape || Ht).source + "|" + l.source + "|" + (l === Ot ? Ft : Ht).source + "|" + (t.evaluate || Ht).source + "|$", "g"),
                        p = "//# sourceURL=" + ("sourceURL" in t ? t.sourceURL : "lodash.templateSources[" + ++Zr + "]") + "\n";
                    n.replace(h, function(t, r, e, o, f, a) { return e || (e = o), s += n.slice(c, a).replace(Jt, B), r && (u = !0, s += "' +\n__e(" + r + ") +\n'"), f && (i = !0, s += "';\n" + f + ";\n__p += '"), e && (s += "' +\n((__t = (" + e + ")) == null ? '' : __t) +\n'"), c = a + t.length, t }), s += "';\n"; var v = t.variable;
                    v || (s = "with (obj) {\n" + s + "\n}\n"), s = (i ? s.replace(yt, "") : s).replace(dt, "$1").replace(bt, "$1;"), s = "function(" + (v || "obj") + ") {\n" + (v ? "" : "obj || (obj = {});\n") + "var __t, __p = ''" + (u ? ", __e = _.escape" : "") + (i ? ", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n" : ";\n") + s + "return __p\n}"; var _ = tp(function() { return ll(f, p + "return " + s).apply(X, a) }); if (_.source = s, ua(_)) throw _; return _ }

                function jc(n) { return Wa(n).toLowerCase() }

                function Ac(n) { return Wa(n).toUpperCase() }

                function kc(n, t, r) { if (n = Wa(n), n && (r || t === X)) return n.replace(Lt, ""); if (!n || !(t = gu(t))) return n; var e = H(n),
                        u = H(t),
                        i = L(e, u),
                        o = C(e, u) + 1; return Iu(e, i, o).join("") }

                function Oc(n, t, r) { if (n = Wa(n), n && (r || t === X)) return n.replace(Ut, ""); if (!n || !(t = gu(t))) return n; var e = H(n),
                        u = C(e, H(t)) + 1; return Iu(e, 0, u).join("") }

                function Ic(n, t, r) { if (n = Wa(n), n && (r || t === X)) return n.replace(Ct, ""); if (!n || !(t = gu(t))) return n; var e = H(n),
                        u = L(e, H(t)); return Iu(e, u).join("") }

                function Rc(n, t) { var r = jn,
                        e = An; if (ca(t)) { var u = "separator" in t ? t.separator : u;
                        r = "length" in t ? Ia(t.length) : r, e = "omission" in t ? gu(t.omission) : e } n = Wa(n); var i = n.length; if ($(n)) { var o = H(n);
                        i = o.length } if (r >= i) return n; var f = r - G(e); if (f < 1) return e; var a = o ? Iu(o, 0, f).join("") : n.slice(0, f); if (u === X) return a + e; if (o && (f += a.length - f), Oh(u)) { if (n.slice(f).search(u)) { var c, l = a; for (u.global || (u = pl(u.source, Wa(Nt.exec(u)) + "g")), u.lastIndex = 0; c = u.exec(l);) var s = c.index;
                            a = a.slice(0, s === X ? f : s) } } else if (n.indexOf(gu(u), f) != f) { var h = a.lastIndexOf(u);
                        h > -1 && (a = a.slice(0, h)) } return a + e }

                function zc(n) { return n = Wa(n), n && xt.test(n) ? n.replace(wt, ye) : n }

                function Ec(n, t, r) { return n = Wa(n), t = r ? X : t, t === X ? D(n) ? Q(n) : g(n) : n.match(t) || [] }

                function Sc(n) { var t = null == n ? 0 : n.length,
                        e = Ai(); return n = t ? l(n, function(n) { if ("function" != typeof n[1]) throw new _l(en); return [e(n[0]), n[1]] }) : [], iu(function(e) { for (var u = -1; ++u < t;) { var i = n[u]; if (r(i[0], this, e)) return r(i[1], this, e) } }) }

                function Wc(n) { return Pr(Nr(n, an)) }

                function Lc(n) { return function() { return n } }

                function Cc(n, t) { return null == n || n !== n ? t : n }

                function Uc(n) { return n }

                function Bc(n) { return Me("function" == typeof n ? n : Nr(n, an)) }

                function Tc(n) { return Ze(Nr(n, an)) }

                function $c(n, t) { return Ke(n, Nr(t, an)) }

                function Dc(n, t, r) { var e = Za(t),
                        i = ve(t, e);
                    null != r || ca(t) && (i.length || !e.length) || (r = t, t = n, n = this, i = ve(t, Za(t))); var o = !(ca(r) && "chain" in r && !r.chain),
                        f = oa(n); return u(i, function(r) { var e = t[r];
                        n[r] = e, f && (n.prototype[r] = function() { var t = this.__chain__; if (o || t) { var r = n(this.__wrapped__),
                                    u = r.__actions__ = Mu(this.__actions__); return u.push({ func: e, args: arguments, thisArg: n }), r.__chain__ = t, r } return e.apply(n, s([this.value()], arguments)) }) }), n }

                function Mc() { return re._ === this && (re._ = Ol), this }

                function Fc() {}

                function Nc(n) { return n = Ia(n), iu(function(t) { return He(t, n) }) }

                function Pc(n) { return Di(n) ? j(ro(n)) : Xe(n) }

                function qc(n) { return function(t) { return null == n ? X : de(n, t) } }

                function Zc() { return [] }

                function Kc() { return !1 }

                function Vc() { return {} }

                function Gc() { return "" }

                function Hc() { return !0 }

                function Jc(n, t) { if (n = Ia(n), n < 1 || n > Sn) return []; var r = Cn,
                        e = Yl(n, Cn);
                    t = Ai(t), n -= Cn; for (var u = R(e, t); ++r < n;) t(r); return u }

                function Yc(n) { return mh(n) ? l(n, ro) : ma(n) ? [n] : Mu(Bs(Wa(n))) }

                function Qc(n) { var t = ++xl; return Wa(n) + t }

                function Xc(n) { return n && n.length ? ne(n, Uc, xe) : X }

                function nl(n, t) { return n && n.length ? ne(n, Ai(t, 2), xe) : X }

                function tl(n) { return x(n, Uc) }

                function rl(n, t) { return x(n, Ai(t, 2)) }

                function el(n) { return n && n.length ? ne(n, Uc, Pe) : X }

                function ul(n, t) { return n && n.length ? ne(n, Ai(t, 2), Pe) : X }

                function il(n) { return n && n.length ? I(n, Uc) : 0 }

                function ol(n, t) { return n && n.length ? I(n, Ai(t, 2)) : 0 } A = null == A ? re : be.defaults(re.Object(), A, be.pick(re, qr));
                var fl = A.Array,
                    al = A.Date,
                    cl = A.Error,
                    ll = A.Function,
                    sl = A.Math,
                    hl = A.Object,
                    pl = A.RegExp,
                    vl = A.String,
                    _l = A.TypeError,
                    gl = fl.prototype,
                    yl = ll.prototype,
                    dl = hl.prototype,
                    bl = A["__core-js_shared__"],
                    wl = yl.toString,
                    ml = dl.hasOwnProperty,
                    xl = 0,
                    jl = function() { var n = /[^.]+$/.exec(bl && bl.keys && bl.keys.IE_PROTO || ""); return n ? "Symbol(src)_1." + n : "" }(),
                    Al = dl.toString,
                    kl = wl.call(hl),
                    Ol = re._,
                    Il = pl("^" + wl.call(ml).replace(St, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$"),
                    Rl = ie ? A.Buffer : X,
                    zl = A.Symbol,
                    El = A.Uint8Array,
                    Sl = Rl ? Rl.allocUnsafe : X,
                    Wl = N(hl.getPrototypeOf, hl),
                    Ll = hl.create,
                    Cl = dl.propertyIsEnumerable,
                    Ul = gl.splice,
                    Bl = zl ? zl.isConcatSpreadable : X,
                    Tl = zl ? zl.iterator : X,
                    $l = zl ? zl.toStringTag : X,
                    Dl = function() { try { var n = Ii(hl, "defineProperty"); return n({}, "", {}), n } catch (n) {} }(),
                    Ml = A.clearTimeout !== re.clearTimeout && A.clearTimeout,
                    Fl = al && al.now !== re.Date.now && al.now,
                    Nl = A.setTimeout !== re.setTimeout && A.setTimeout,
                    Pl = sl.ceil,
                    ql = sl.floor,
                    Zl = hl.getOwnPropertySymbols,
                    Kl = Rl ? Rl.isBuffer : X,
                    Vl = A.isFinite,
                    Gl = gl.join,
                    Hl = N(hl.keys, hl),
                    Jl = sl.max,
                    Yl = sl.min,
                    Ql = al.now,
                    Xl = A.parseInt,
                    ns = sl.random,
                    ts = gl.reverse,
                    rs = Ii(A, "DataView"),
                    es = Ii(A, "Map"),
                    us = Ii(A, "Promise"),
                    is = Ii(A, "Set"),
                    os = Ii(A, "WeakMap"),
                    fs = Ii(hl, "create"),
                    as = os && new os,
                    cs = {},
                    ls = eo(rs),
                    ss = eo(es),
                    hs = eo(us),
                    ps = eo(is),
                    vs = eo(os),
                    _s = zl ? zl.prototype : X,
                    gs = _s ? _s.valueOf : X,
                    ys = _s ? _s.toString : X,
                    ds = function() {
                        function n() {} return function(t) { if (!ca(t)) return {}; if (Ll) return Ll(t);
                            n.prototype = t; var r = new n; return n.prototype = X, r } }();
                K.templateSettings = { escape: At, evaluate: kt, interpolate: Ot, variable: "", imports: { _: K } }, K.prototype = J.prototype, K.prototype.constructor = K, Y.prototype = ds(J.prototype), Y.prototype.constructor = Y, Dt.prototype = ds(J.prototype), Dt.prototype.constructor = Dt, nr.prototype.clear = tr, nr.prototype.delete = rr, nr.prototype.get = er, nr.prototype.has = ur, nr.prototype.set = ir, or.prototype.clear = fr, or.prototype.delete = ar, or.prototype.get = cr, or.prototype.has = lr, or.prototype.set = sr, hr.prototype.clear = pr, hr.prototype.delete = vr, hr.prototype.get = _r, hr.prototype.has = gr, hr.prototype.set = yr, dr.prototype.add = dr.prototype.push = br, dr.prototype.has = wr, mr.prototype.clear = xr, mr.prototype.delete = jr, mr.prototype.get = Ar, mr.prototype.has = kr, mr.prototype.set = Or;
                var bs = Ku(oe),
                    ws = Ku(fe, !0),
                    ms = Vu(),
                    xs = Vu(!0),
                    js = as ? function(n, t) { return as.set(n, t), n } : Uc,
                    As = Dl ? function(n, t) { return Dl(n, "toString", { configurable: !0, enumerable: !1, value: Lc(t), writable: !0 }) } : Uc,
                    ks = iu,
                    Os = Ml || function(n) { return re.clearTimeout(n) },
                    Is = is && 1 / q(new is([, -0]))[1] == En ? function(n) { return new is(n) } : Fc,
                    Rs = as ? function(n) { return as.get(n) } : Fc,
                    zs = Zl ? function(n) { return null == n ? [] : (n = hl(n), f(Zl(n), function(t) { return Cl.call(n, t) })) } : Zc,
                    Es = Zl ? function(n) { for (var t = []; n;) s(t, zs(n)), n = Wl(n); return t } : Zc,
                    Ss = me;
                (rs && Ss(new rs(new ArrayBuffer(1))) != ft || es && Ss(new es) != Vn || us && Ss(us.resolve()) != Yn || is && Ss(new is) != nt || os && Ss(new os) != ut) && (Ss = function(n) { var t = me(n),
                        r = t == Jn ? n.constructor : X,
                        e = r ? eo(r) : ""; if (e) switch (e) {
                        case ls:
                            return ft;
                        case ss:
                            return Vn;
                        case hs:
                            return Yn;
                        case ps:
                            return nt;
                        case vs:
                            return ut }
                    return t });
                var Ws = bl ? oa : Kc,
                    Ls = no(js),
                    Cs = Nl || function(n, t) { return re.setTimeout(n, t) },
                    Us = no(As),
                    Bs = Ki(function(n) { var t = []; return zt.test(n) && t.push(""), n.replace(Et, function(n, r, e, u) { t.push(e ? u.replace(Mt, "$1") : r || n) }), t }),
                    Ts = iu(function(n, t) { return Qf(n) ? Jr(n, ue(t, 1, Qf, !0)) : [] }),
                    $s = iu(function(n, t) { var r = ko(t); return Qf(r) && (r = X), Qf(n) ? Jr(n, ue(t, 1, Qf, !0), Ai(r, 2)) : [] }),
                    Ds = iu(function(n, t) { var r = ko(t); return Qf(r) && (r = X), Qf(n) ? Jr(n, ue(t, 1, Qf, !0), X, r) : [] }),
                    Ms = iu(function(n) { var t = l(n, Au); return t.length && t[0] === n[0] ? Oe(t) : [] }),
                    Fs = iu(function(n) { var t = ko(n),
                            r = l(n, Au); return t === ko(r) ? t = X : r.pop(), r.length && r[0] === n[0] ? Oe(r, Ai(t, 2)) : [] }),
                    Ns = iu(function(n) { var t = ko(n),
                            r = l(n, Au); return t = "function" == typeof t ? t : X, t && r.pop(), r.length && r[0] === n[0] ? Oe(r, X, t) : [] }),
                    Ps = iu(Ro),
                    qs = bi(function(n, t) { var r = null == n ? 0 : n.length,
                            e = Mr(n, t); return tu(n, l(t, function(n) { return Ti(n, r) ? +n : n }).sort(Bu)), e }),
                    Zs = iu(function(n) { return yu(ue(n, 1, Qf, !0)) }),
                    Ks = iu(function(n) { var t = ko(n); return Qf(t) && (t = X), yu(ue(n, 1, Qf, !0), Ai(t, 2)) }),
                    Vs = iu(function(n) { var t = ko(n); return t = "function" == typeof t ? t : X, yu(ue(n, 1, Qf, !0), X, t) }),
                    Gs = iu(function(n, t) { return Qf(n) ? Jr(n, t) : [] }),
                    Hs = iu(function(n) { return xu(f(n, Qf)) }),
                    Js = iu(function(n) { var t = ko(n); return Qf(t) && (t = X), xu(f(n, Qf), Ai(t, 2)) }),
                    Ys = iu(function(n) { var t = ko(n); return t = "function" == typeof t ? t : X, xu(f(n, Qf), X, t) }),
                    Qs = iu(Jo),
                    Xs = iu(function(n) { var t = n.length,
                            r = t > 1 ? n[t - 1] : X; return r = "function" == typeof r ? (n.pop(), r) : X, Yo(n, r) }),
                    nh = bi(function(n) { var t = n.length,
                            r = t ? n[0] : 0,
                            e = this.__wrapped__,
                            u = function(t) { return Mr(t, n) }; return !(t > 1 || this.__actions__.length) && e instanceof Dt && Ti(r) ? (e = e.slice(r, +r + (t ? 1 : 0)), e.__actions__.push({ func: rf, args: [u], thisArg: X }), new Y(e, this.__chain__).thru(function(n) { return t && !n.length && n.push(X), n })) : this.thru(u) }),
                    th = qu(function(n, t, r) { ml.call(n, r) ? ++n[r] : Tr(n, r, 1) }),
                    rh = Xu(vo),
                    eh = Xu(_o),
                    uh = qu(function(n, t, r) { ml.call(n, r) ? n[r].push(t) : Tr(n, r, [t]) }),
                    ih = iu(function(n, t, e) { var u = -1,
                            i = "function" == typeof t,
                            o = Yf(n) ? fl(n.length) : []; return bs(n, function(n) { o[++u] = i ? r(t, n, e) : Re(n, t, e) }), o }),
                    oh = qu(function(n, t, r) { Tr(n, r, t) }),
                    fh = qu(function(n, t, r) { n[r ? 0 : 1].push(t) }, function() { return [
                            [],
                            []
                        ] }),
                    ah = iu(function(n, t) { if (null == n) return []; var r = t.length; return r > 1 && $i(n, t[0], t[1]) ? t = [] : r > 2 && $i(t[0], t[1], t[2]) && (t = [t[0]]), Je(n, ue(t, 1), []) }),
                    ch = Fl || function() { return re.Date.now() },
                    lh = iu(function(n, t, r) { var e = pn; if (r.length) { var u = P(r, ji(lh));
                            e |= dn } return hi(n, e, t, r, u) }),
                    sh = iu(function(n, t, r) { var e = pn | vn; if (r.length) { var u = P(r, ji(sh));
                            e |= dn } return hi(t, e, n, r, u) }),
                    hh = iu(function(n, t) { return Hr(n, 1, t) }),
                    ph = iu(function(n, t, r) { return Hr(n, za(t) || 0, r) });
                Bf.Cache = hr;
                var vh = ks(function(n, t) { t = 1 == t.length && mh(t[0]) ? l(t[0], E(Ai())) : l(ue(t, 1), E(Ai())); var e = t.length; return iu(function(u) { for (var i = -1, o = Yl(u.length, e); ++i < o;) u[i] = t[i].call(this, u[i]); return r(n, this, u) }) }),
                    _h = iu(function(n, t) { var r = P(t, ji(_h)); return hi(n, dn, X, t, r) }),
                    gh = iu(function(n, t) { var r = P(t, ji(gh)); return hi(n, bn, X, t, r) }),
                    yh = bi(function(n, t) { return hi(n, mn, X, X, X, t) }),
                    dh = ai(xe),
                    bh = ai(function(n, t) { return n >= t }),
                    wh = ze(function() { return arguments }()) ? ze : function(n) { return la(n) && ml.call(n, "callee") && !Cl.call(n, "callee") },
                    mh = fl.isArray,
                    xh = ae ? E(ae) : Ee,
                    jh = Kl || Kc,
                    Ah = ce ? E(ce) : Se,
                    kh = le ? E(le) : Ce,
                    Oh = se ? E(se) : Te,
                    Ih = he ? E(he) : $e,
                    Rh = pe ? E(pe) : De,
                    zh = ai(Pe),
                    Eh = ai(function(n, t) { return n <= t }),
                    Sh = Zu(function(n, t) { if (Pi(t) || Yf(t)) return void Fu(t, Za(t), n); for (var r in t) ml.call(t, r) && Wr(n, r, t[r]) }),
                    Wh = Zu(function(n, t) { Fu(t, Ka(t), n) }),
                    Lh = Zu(function(n, t, r, e) { Fu(t, Ka(t), n, e) }),
                    Ch = Zu(function(n, t, r, e) { Fu(t, Za(t), n, e) }),
                    Uh = bi(Mr),
                    Bh = iu(function(n) { return n.push(X, pi), r(Lh, X, n) }),
                    Th = iu(function(n) { return n.push(X, vi), r(Nh, X, n) }),
                    $h = ri(function(n, t, r) { n[t] = r }, Lc(Uc)),
                    Dh = ri(function(n, t, r) { ml.call(n, t) ? n[t].push(r) : n[t] = [r] }, Ai),
                    Mh = iu(Re),
                    Fh = Zu(function(n, t, r) { Ve(n, t, r) }),
                    Nh = Zu(function(n, t, r, e) { Ve(n, t, r, e) }),
                    Ph = bi(function(n, t) { var r = {}; if (null == n) return r; var e = !1;
                        t = l(t, function(t) { return t = Ou(t, n), e || (e = t.length > 1), t }), Fu(n, mi(n), r), e && (r = Nr(r, an | cn | ln, _i)); for (var u = t.length; u--;) du(r, t[u]); return r }),
                    qh = bi(function(n, t) { return null == n ? {} : Ye(n, t) }),
                    Zh = si(Za),
                    Kh = si(Ka),
                    Vh = Ju(function(n, t, r) { return t = t.toLowerCase(), n + (r ? cc(t) : t) }),
                    Gh = Ju(function(n, t, r) { return n + (r ? "-" : "") + t.toLowerCase() }),
                    Hh = Ju(function(n, t, r) { return n + (r ? " " : "") + t.toLowerCase() }),
                    Jh = Hu("toLowerCase"),
                    Yh = Ju(function(n, t, r) { return n + (r ? "_" : "") + t.toLowerCase() }),
                    Qh = Ju(function(n, t, r) { return n + (r ? " " : "") + np(t) }),
                    Xh = Ju(function(n, t, r) { return n + (r ? " " : "") + t.toUpperCase() }),
                    np = Hu("toUpperCase"),
                    tp = iu(function(n, t) { try { return r(n, X, t) } catch (n) { return ua(n) ? n : new cl(n) } }),
                    rp = bi(function(n, t) { return u(t, function(t) { t = ro(t), Tr(n, t, lh(n[t], n)) }), n }),
                    ep = ni(),
                    up = ni(!0),
                    ip = iu(function(n, t) { return function(r) { return Re(r, n, t) } }),
                    op = iu(function(n, t) { return function(r) { return Re(n, r, t) } }),
                    fp = ui(l),
                    ap = ui(o),
                    cp = ui(v),
                    lp = fi(),
                    sp = fi(!0),
                    hp = ei(function(n, t) { return n + t }, 0),
                    pp = li("ceil"),
                    vp = ei(function(n, t) { return n / t }, 1),
                    _p = li("floor"),
                    gp = ei(function(n, t) { return n * t }, 1),
                    yp = li("round"),
                    dp = ei(function(n, t) { return n - t }, 0);
                return K.after = zf, K.ary = Ef, K.assign = Sh, K.assignIn = Wh, K.assignInWith = Lh, K.assignWith = Ch, K.at = Uh, K.before = Sf, K.bind = lh, K.bindAll = rp, K.bindKey = sh, K.castArray = qf, K.chain = nf, K.chunk = oo, K.compact = fo, K.concat = ao, K.cond = Sc, K.conforms = Wc, K.constant = Lc, K.countBy = th, K.create = La, K.curry = Wf, K.curryRight = Lf, K.debounce = Cf, K.defaults = Bh, K.defaultsDeep = Th, K.defer = hh, K.delay = ph, K.difference = Ts, K.differenceBy = $s, K.differenceWith = Ds, K.drop = co,
                    K.dropRight = lo, K.dropRightWhile = so, K.dropWhile = ho, K.fill = po, K.filter = hf, K.flatMap = pf, K.flatMapDeep = vf, K.flatMapDepth = _f, K.flatten = go, K.flattenDeep = yo, K.flattenDepth = bo, K.flip = Uf, K.flow = ep, K.flowRight = up, K.fromPairs = wo, K.functions = Ma, K.functionsIn = Fa, K.groupBy = uh, K.initial = jo, K.intersection = Ms, K.intersectionBy = Fs, K.intersectionWith = Ns, K.invert = $h, K.invertBy = Dh, K.invokeMap = ih, K.iteratee = Bc, K.keyBy = oh, K.keys = Za, K.keysIn = Ka, K.map = bf, K.mapKeys = Va, K.mapValues = Ga, K.matches = Tc, K.matchesProperty = $c, K.memoize = Bf, K.merge = Fh, K.mergeWith = Nh, K.method = ip, K.methodOf = op, K.mixin = Dc, K.negate = Tf, K.nthArg = Nc, K.omit = Ph, K.omitBy = Ha, K.once = $f, K.orderBy = wf, K.over = fp, K.overArgs = vh, K.overEvery = ap, K.overSome = cp, K.partial = _h, K.partialRight = gh, K.partition = fh, K.pick = qh, K.pickBy = Ja, K.property = Pc, K.propertyOf = qc, K.pull = Ps, K.pullAll = Ro, K.pullAllBy = zo, K.pullAllWith = Eo, K.pullAt = qs, K.range = lp, K.rangeRight = sp, K.rearg = yh, K.reject = jf, K.remove = So, K.rest = Df, K.reverse = Wo, K.sampleSize = kf, K.set = Qa, K.setWith = Xa, K.shuffle = Of, K.slice = Lo, K.sortBy = ah, K.sortedUniq = Mo, K.sortedUniqBy = Fo, K.split = wc, K.spread = Mf, K.tail = No, K.take = Po, K.takeRight = qo, K.takeRightWhile = Zo, K.takeWhile = Ko, K.tap = tf, K.throttle = Ff, K.thru = rf, K.toArray = ka, K.toPairs = Zh, K.toPairsIn = Kh, K.toPath = Yc, K.toPlainObject = Ea, K.transform = nc, K.unary = Nf, K.union = Zs, K.unionBy = Ks, K.unionWith = Vs, K.uniq = Vo, K.uniqBy = Go, K.uniqWith = Ho, K.unset = tc, K.unzip = Jo, K.unzipWith = Yo, K.update = rc, K.updateWith = ec, K.values = uc, K.valuesIn = ic, K.without = Gs, K.words = Ec, K.wrap = Pf, K.xor = Hs, K.xorBy = Js, K.xorWith = Ys, K.zip = Qs, K.zipObject = Qo, K.zipObjectDeep = Xo, K.zipWith = Xs, K.entries = Zh, K.entriesIn = Kh, K.extend = Wh, K.extendWith = Lh, Dc(K, K), K.add = hp, K.attempt = tp, K.camelCase = Vh, K.capitalize = cc, K.ceil = pp, K.clamp = oc, K.clone = Zf, K.cloneDeep = Vf, K.cloneDeepWith = Gf, K.cloneWith = Kf, K.conformsTo = Hf, K.deburr = lc, K.defaultTo = Cc, K.divide = vp, K.endsWith = sc, K.eq = Jf, K.escape = hc, K.escapeRegExp = pc, K.every = sf, K.find = rh, K.findIndex = vo, K.findKey = Ca, K.findLast = eh, K.findLastIndex = _o, K.findLastKey = Ua, K.floor = _p, K.forEach = gf, K.forEachRight = yf, K.forIn = Ba, K.forInRight = Ta, K.forOwn = $a, K.forOwnRight = Da, K.get = Na, K.gt = dh, K.gte = bh, K.has = Pa, K.hasIn = qa, K.head = mo, K.identity = Uc, K.includes = df, K.indexOf = xo, K.inRange = fc, K.invoke = Mh, K.isArguments = wh, K.isArray = mh, K.isArrayBuffer = xh, K.isArrayLike = Yf, K.isArrayLikeObject = Qf, K.isBoolean = Xf, K.isBuffer = jh, K.isDate = Ah, K.isElement = na, K.isEmpty = ta, K.isEqual = ra, K.isEqualWith = ea, K.isError = ua, K.isFinite = ia, K.isFunction = oa, K.isInteger = fa, K.isLength = aa, K.isMap = kh, K.isMatch = sa, K.isMatchWith = ha, K.isNaN = pa, K.isNative = va, K.isNil = ga, K.isNull = _a, K.isNumber = ya, K.isObject = ca, K.isObjectLike = la, K.isPlainObject = da, K.isRegExp = Oh, K.isSafeInteger = ba, K.isSet = Ih, K.isString = wa, K.isSymbol = ma, K.isTypedArray = Rh, K.isUndefined = xa, K.isWeakMap = ja, K.isWeakSet = Aa, K.join = Ao, K.kebabCase = Gh, K.last = ko, K.lastIndexOf = Oo, K.lowerCase = Hh, K.lowerFirst = Jh, K.lt = zh, K.lte = Eh, K.max = Xc, K.maxBy = nl, K.mean = tl, K.meanBy = rl, K.min = el, K.minBy = ul, K.stubArray = Zc, K.stubFalse = Kc, K.stubObject = Vc, K.stubString = Gc, K.stubTrue = Hc, K.multiply = gp, K.nth = Io, K.noConflict = Mc, K.noop = Fc, K.now = ch, K.pad = vc, K.padEnd = _c, K.padStart = gc, K.parseInt = yc, K.random = ac, K.reduce = mf, K.reduceRight = xf, K.repeat = dc, K.replace = bc, K.result = Ya, K.round = yp, K.runInContext = _, K.sample = Af, K.size = If, K.snakeCase = Yh, K.some = Rf, K.sortedIndex = Co, K.sortedIndexBy = Uo, K.sortedIndexOf = Bo, K.sortedLastIndex = To, K.sortedLastIndexBy = $o, K.sortedLastIndexOf = Do, K.startCase = Qh, K.startsWith = mc, K.subtract = dp, K.sum = il, K.sumBy = ol, K.template = xc, K.times = Jc, K.toFinite = Oa, K.toInteger = Ia, K.toLength = Ra, K.toLower = jc, K.toNumber = za, K.toSafeInteger = Sa, K.toString = Wa, K.toUpper = Ac, K.trim = kc, K.trimEnd = Oc, K.trimStart = Ic, K.truncate = Rc, K.unescape = zc, K.uniqueId = Qc, K.upperCase = Xh, K.upperFirst = np, K.each = gf, K.eachRight = yf, K.first = mo, Dc(K, function() { var n = {}; return oe(K, function(t, r) { ml.call(K.prototype, r) || (n[r] = t) }), n }(), { chain: !1 }), K.VERSION = nn, u(["bind", "bindKey", "curry", "curryRight", "partial", "partialRight"], function(n) { K[n].placeholder = K }), u(["drop", "take"], function(n, t) { Dt.prototype[n] = function(r) { r = r === X ? 1 : Jl(Ia(r), 0); var e = this.__filtered__ && !t ? new Dt(this) : this.clone(); return e.__filtered__ ? e.__takeCount__ = Yl(r, e.__takeCount__) : e.__views__.push({ size: Yl(r, Cn), type: n + (e.__dir__ < 0 ? "Right" : "") }), e }, Dt.prototype[n + "Right"] = function(t) { return this.reverse()[n](t).reverse() } }), u(["filter", "map", "takeWhile"], function(n, t) { var r = t + 1,
                            e = r == In || r == zn;
                        Dt.prototype[n] = function(n) { var t = this.clone(); return t.__iteratees__.push({ iteratee: Ai(n, 3), type: r }), t.__filtered__ = t.__filtered__ || e, t } }), u(["head", "last"], function(n, t) { var r = "take" + (t ? "Right" : "");
                        Dt.prototype[n] = function() { return this[r](1).value()[0] } }), u(["initial", "tail"], function(n, t) { var r = "drop" + (t ? "" : "Right");
                        Dt.prototype[n] = function() { return this.__filtered__ ? new Dt(this) : this[r](1) } }), Dt.prototype.compact = function() { return this.filter(Uc) }, Dt.prototype.find = function(n) { return this.filter(n).head() }, Dt.prototype.findLast = function(n) { return this.reverse().find(n) }, Dt.prototype.invokeMap = iu(function(n, t) { return "function" == typeof n ? new Dt(this) : this.map(function(r) { return Re(r, n, t) }) }), Dt.prototype.reject = function(n) { return this.filter(Tf(Ai(n))) }, Dt.prototype.slice = function(n, t) { n = Ia(n); var r = this; return r.__filtered__ && (n > 0 || t < 0) ? new Dt(r) : (n < 0 ? r = r.takeRight(-n) : n && (r = r.drop(n)), t !== X && (t = Ia(t), r = t < 0 ? r.dropRight(-t) : r.take(t - n)), r) }, Dt.prototype.takeRightWhile = function(n) { return this.reverse().takeWhile(n).reverse() }, Dt.prototype.toArray = function() { return this.take(Cn) }, oe(Dt.prototype, function(n, t) { var r = /^(?:filter|find|map|reject)|While$/.test(t),
                            e = /^(?:head|last)$/.test(t),
                            u = K[e ? "take" + ("last" == t ? "Right" : "") : t],
                            i = e || /^find/.test(t);
                        u && (K.prototype[t] = function() { var t = this.__wrapped__,
                                o = e ? [1] : arguments,
                                f = t instanceof Dt,
                                a = o[0],
                                c = f || mh(t),
                                l = function(n) { var t = u.apply(K, s([n], o)); return e && h ? t[0] : t };
                            c && r && "function" == typeof a && 1 != a.length && (f = c = !1); var h = this.__chain__,
                                p = !!this.__actions__.length,
                                v = i && !h,
                                _ = f && !p; if (!i && c) { t = _ ? t : new Dt(this); var g = n.apply(t, o); return g.__actions__.push({ func: rf, args: [l], thisArg: X }), new Y(g, h) } return v && _ ? n.apply(this, o) : (g = this.thru(l), v ? e ? g.value()[0] : g.value() : g) }) }), u(["pop", "push", "shift", "sort", "splice", "unshift"], function(n) { var t = gl[n],
                            r = /^(?:push|sort|unshift)$/.test(n) ? "tap" : "thru",
                            e = /^(?:pop|shift)$/.test(n);
                        K.prototype[n] = function() { var n = arguments; if (e && !this.__chain__) { var u = this.value(); return t.apply(mh(u) ? u : [], n) } return this[r](function(r) { return t.apply(mh(r) ? r : [], n) }) } }), oe(Dt.prototype, function(n, t) { var r = K[t]; if (r) { var e = r.name + "",
                                u = cs[e] || (cs[e] = []);
                            u.push({ name: t, func: r }) } }), cs[ti(X, vn).name] = [{ name: "wrapper", func: X }], Dt.prototype.clone = Yt, Dt.prototype.reverse = Qt, Dt.prototype.value = Xt, K.prototype.at = nh, K.prototype.chain = ef, K.prototype.commit = uf, K.prototype.next = of , K.prototype.plant = af, K.prototype.reverse = cf, K.prototype.toJSON = K.prototype.valueOf = K.prototype.value = lf, K.prototype.first = K.prototype.head, Tl && (K.prototype[Tl] = ff), K
            },
            be = de();
        "function" == typeof define && "object" == typeof define.amd && define.amd ? (re._ = be, define(function() { return be })) : ue ? ((ue.exports = be)._ = be, ee._ = be) : re._ = be
    }).call(this);
    //# sourceMappingURL=lodash.min.js.map

    ! function(t, e) { "function" == typeof define && define.amd ? define(function() { return e() }) : "object" == typeof module ? module.exports = e() : t.Tone = e() }(this, function() {
        "use strict";

        function t(t) { t(e) }
        var e;
        /**
         *  Tone.js
         *  @author Yotam Mann
         *  @license http://opensource.org/licenses/MIT MIT License
         *  @copyright 2014-2017 Yotam Mann
         */
        return function(t) { e = t() }(function() { var t = function() {}; return t.prototype.toString = function() { var e, i, n; for (e in t)
                    if (i = e[0].match(/^[A-Z]$/), n = t[e] === this.constructor, t.isFunction(t[e]) && i && n) return e; return "Tone" }, t.prototype.dispose = function() { return this }, t.prototype.set = function(e, i, n) { var s, o, r, a, l, h, u;
                t.isObject(e) ? n = i : t.isString(e) && (s = {}, s[e] = i, e = s);
                t: for (o in e) { if (i = e[o], r = this, -1 !== o.indexOf(".")) { for (a = o.split("."), l = 0; l < a.length - 1; l++)
                            if ((r = r[a[l]]) instanceof t) { a.splice(0, l + 1), h = a.join("."), r.set(h, i); continue t } o = a[a.length - 1] } u = r[o], t.isUndef(u) || (t.Signal && u instanceof t.Signal || t.Param && u instanceof t.Param ? u.value !== i && (t.isUndef(n) ? u.value = i : u.rampTo(i, n)) : u instanceof AudioParam ? u.value !== i && (u.value = i) : u instanceof t ? u.set(i) : u !== i && (r[o] = i)) }
                return this }, t.prototype.get = function(e) { var i, n, s, o, r, a, l, h, u; for (t.isUndef(e) ? e = this._collectDefaults(this.constructor) : t.isString(e) && (e = [e]), i = {}, n = 0; n < e.length; n++) { if (s = e[n], o = this, r = i, -1 !== s.indexOf(".")) { for (a = s.split("."), l = 0; l < a.length - 1; l++) h = a[l], r[h] = r[h] || {}, r = r[h], o = o[h];
                        s = a[a.length - 1] } u = o[s], t.isObject(e[s]) ? r[s] = u.get() : t.Signal && u instanceof t.Signal ? r[s] = u.value : t.Param && u instanceof t.Param ? r[s] = u.value : u instanceof AudioParam ? r[s] = u.value : u instanceof t ? r[s] = u.get() : t.isFunction(u) || t.isUndef(u) || (r[s] = u) } return i }, t.prototype._collectDefaults = function(e) { var i, n, s = []; if (t.isUndef(e.defaults) || (s = Object.keys(e.defaults)), !t.isUndef(e._super))
                    for (i = this._collectDefaults(e._super), n = 0; n < i.length; n++) - 1 === s.indexOf(i[n]) && s.push(i[n]); return s }, t.defaults = function(e, i, n) { var s, o = {}; if (1 === e.length && t.isObject(e[0])) o = e[0];
                else
                    for (s = 0; s < i.length; s++) o[i[s]] = e[s]; return t.isUndef(n.defaults) ? t.isObject(n) ? t.defaultArg(o, n) : o : t.defaultArg(o, n.defaults) }, t.defaultArg = function(e, i) { var n, s, o; if (t.isObject(e) && t.isObject(i)) { n = {}; for (s in e) n[s] = t.defaultArg(i[s], e[s]); for (o in i) n[o] = t.defaultArg(e[o], i[o]); return n } return t.isUndef(e) ? i : e }, t.connectSeries = function() { var e, i, n = arguments[0]; for (e = 1; e < arguments.length; e++) i = arguments[e], n.connect(i), n = i; return t }, t.isUndef = function(t) { return void 0 === t }, t.isFunction = function(t) { return "function" == typeof t }, t.isNumber = function(t) { return "number" == typeof t }, t.isObject = function(t) { return "[object Object]" === Object.prototype.toString.call(t) && t.constructor === Object }, t.isBoolean = function(t) { return "boolean" == typeof t }, t.isArray = function(t) { return Array.isArray(t) }, t.isString = function(t) { return "string" == typeof t }, t.isNote = function(e) { return t.isString(e) && /^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(e) }, t.noOp = function() {}, t.prototype._readOnly = function(t) { if (Array.isArray(t))
                    for (var e = 0; e < t.length; e++) this._readOnly(t[e]);
                else Object.defineProperty(this, t, { writable: !1, enumerable: !0 }) }, t.prototype._writable = function(t) { if (Array.isArray(t))
                    for (var e = 0; e < t.length; e++) this._writable(t[e]);
                else Object.defineProperty(this, t, { writable: !0 }) }, t.State = { Started: "started", Stopped: "stopped", Paused: "paused" }, t.equalPowerScale = function(t) { var e = .5 * Math.PI; return Math.sin(t * e) }, t.dbToGain = function(t) { return Math.pow(2, t / 6) }, t.gainToDb = function(t) { return Math.log(t) / Math.LN10 * 20 }, t.intervalToFrequencyRatio = function(t) { return Math.pow(2, t / 12) }, t.prototype.now = function() { return t.context.now() }, t.now = function() { return t.context.now() }, t.isPast = function(e) { e < t.context.currentTime && console.warn("Time '" + e + "' is in the past. Scheduled time must be ≥ AudioContext.currentTime") }, t.extend = function(e, i) {
                function n() {} t.isUndef(i) && (i = t), n.prototype = i.prototype, e.prototype = new n, e.prototype.constructor = e, e._super = i }, Object.defineProperty(t, "context", { get: function() { return window.TONE_AUDIO_CONTEXT }, set: function(e) { window.TONE_AUDIO_CONTEXT = t.Context && e instanceof t.Context ? e : new t.Context(e), t.Context.emit("init", window.TONE_AUDIO_CONTEXT) } }), Object.defineProperty(t.prototype, "context", { get: function() { return t.context } }), t.setContext = function(e) { t.context = e }, Object.defineProperty(t.prototype, "blockTime", { get: function() { return 128 / this.context.sampleRate } }), Object.defineProperty(t.prototype, "sampleTime", { get: function() { return 1 / this.context.sampleRate } }), Object.defineProperty(t, "supported", { get: function() { var t = window.hasOwnProperty("AudioContext") || window.hasOwnProperty("webkitAudioContext"),
                        e = window.hasOwnProperty("Promise"),
                        i = window.hasOwnProperty("Worker"); return t && e && i } }), Object.defineProperty(t, "initialized", { get: function() { return !t.isUndef(window.TONE_AUDIO_CONTEXT) } }), t.getContext = function(e) { if (t.initialized) e(t.context);
                else { var i = function() { e(t.context), t.Context.off("init", i) };
                    t.Context.on("init", i) } return t }, t.version = "r12-dev", t }), t(function(t) { return t.Emitter = function() { t.call(this), this._events = {} }, t.extend(t.Emitter), t.Emitter.prototype.on = function(t, e) { var i, n, s = t.split(/\W+/); for (i = 0; i < s.length; i++) n = s[i], this._events.hasOwnProperty(n) || (this._events[n] = []), this._events[n].push(e); return this }, t.Emitter.prototype.off = function(e, i) { var n, s, o, r = e.split(/\W+/); for (n = 0; n < r.length; n++)
                    if (e = r[n], this._events.hasOwnProperty(e))
                        if (t.isUndef(i)) this._events[e] = [];
                        else
                            for (s = this._events[e], o = 0; o < s.length; o++) s[o] === i && s.splice(o, 1); return this }, t.Emitter.prototype.emit = function(t) { var e, i, n, s; if (this._events && (e = Array.apply(null, arguments).slice(1), this._events.hasOwnProperty(t)))
                    for (i = this._events[t], n = 0, s = i.length; n < s; n++) i[n].apply(this, e); return this }, t.Emitter.mixin = function(e) { var i, n, s, o = ["on", "off", "emit"]; for (e._events = {}, i = 0; i < o.length; i++) n = o[i], s = t.Emitter.prototype[n], e[n] = s; return t.Emitter }, t.Emitter.prototype.dispose = function() { return t.prototype.dispose.call(this), this._events = null, this }, t.Emitter }), t(function(t) { return t.Timeline = function() { var e = t.defaults(arguments, ["memory"], t.Timeline);
                t.call(this), this._timeline = [], this._toRemove = [], this._toAdd = [], this._iterating = !1, this.memory = e.memory }, t.extend(t.Timeline), t.Timeline.defaults = { memory: 1 / 0 }, Object.defineProperty(t.Timeline.prototype, "length", { get: function() { return this._timeline.length } }), t.Timeline.prototype.add = function(e) { var i, n; if (t.isUndef(e.time)) throw new Error("Tone.Timeline: events must have a time attribute"); return this._iterating ? this._toAdd.push(e) : (i = this._search(e.time), this._timeline.splice(i + 1, 0, e), this.length > this.memory && (n = this.length - this.memory, this._timeline.splice(0, n))), this }, t.Timeline.prototype.remove = function(t) { if (this._iterating) this._toRemove.push(t);
                else { var e = this._timeline.indexOf(t); - 1 !== e && this._timeline.splice(e, 1) } return this }, t.Timeline.prototype.get = function(e, i) { i = t.defaultArg(i, "time"); var n = this._search(e, i); return -1 !== n ? this._timeline[n] : null }, t.Timeline.prototype.peek = function() { return this._timeline[0] }, t.Timeline.prototype.shift = function() { return this._timeline.shift() }, t.Timeline.prototype.getAfter = function(e, i) { i = t.defaultArg(i, "time"); var n = this._search(e, i); return n + 1 < this._timeline.length ? this._timeline[n + 1] : null }, t.Timeline.prototype.getBefore = function(e, i) { var n, s; return i = t.defaultArg(i, "time"), (n = this._timeline.length) > 0 && this._timeline[n - 1][i] < e ? this._timeline[n - 1] : (s = this._search(e, i), s - 1 >= 0 ? this._timeline[s - 1] : null) }, t.Timeline.prototype.cancel = function(t) { var e, i; if (this._timeline.length > 1)
                    if ((e = this._search(t)) >= 0)
                        if (this._timeline[e].time === t) { for (i = e; i >= 0 && this._timeline[i].time === t; i--) e = i;
                            this._timeline = this._timeline.slice(0, e) } else this._timeline = this._timeline.slice(0, e + 1);
                else this._timeline = [];
                else 1 === this._timeline.length && this._timeline[0].time >= t && (this._timeline = []); return this }, t.Timeline.prototype.cancelBefore = function(t) { var e = this._search(t); return e >= 0 && (this._timeline = this._timeline.slice(e + 1)), this }, t.Timeline.prototype.previousEvent = function(t) { var e = this._timeline.indexOf(t); return e > 0 ? this._timeline[e - 1] : null }, t.Timeline.prototype._search = function(e, i) { var n, s, o, r, a, l, h, u; if (0 === this._timeline.length) return -1; if (i = t.defaultArg(i, "time"), n = 0, s = this._timeline.length, o = s, s > 0 && this._timeline[s - 1][i] <= e) return s - 1; for (; n < o;) { if (r = Math.floor(n + (o - n) / 2), a = this._timeline[r], l = this._timeline[r + 1], a[i] === e) { for (h = r; h < this._timeline.length; h++) u = this._timeline[h], u[i] === e && (r = h); return r } if (a[i] < e && l[i] > e) return r;
                    a[i] > e ? o = r : n = r + 1 } return -1 }, t.Timeline.prototype._iterate = function(e, i, n) { this._iterating = !0, i = t.defaultArg(i, 0), n = t.defaultArg(n, this._timeline.length - 1); for (var s = i; s <= n; s++) e.call(this, this._timeline[s]);
                this._iterating = !1, this._toRemove.forEach(function(t) { this.remove(t) }.bind(this)), this._toRemove = [], this._toAdd.forEach(function(t) { this.add(t) }.bind(this)), this._toAdd = [] }, t.Timeline.prototype.forEach = function(t) { return this._iterate(t), this }, t.Timeline.prototype.forEachBefore = function(t, e) { var i = this._search(t); return -1 !== i && this._iterate(e, 0, i), this }, t.Timeline.prototype.forEachAfter = function(t, e) { var i = this._search(t); return this._iterate(e, i + 1), this }, t.Timeline.prototype.forEachFrom = function(t, e) { for (var i = this._search(t); i >= 0 && this._timeline[i].time >= t;) i--; return this._iterate(e, i + 1), this }, t.Timeline.prototype.forEachAtTime = function(t, e) { var i = this._search(t); return -1 !== i && this._iterate(function(i) { i.time === t && e.call(this, i) }, 0, i), this }, t.Timeline.prototype.dispose = function() { return t.prototype.dispose.call(this), this._timeline = null, this._toRemove = null, this._toAdd = null, this }, t.Timeline }), t(function(t) { t.supported && (!window.hasOwnProperty("AudioContext") && window.hasOwnProperty("webkitAudioContext") && (window.AudioContext = window.webkitAudioContext), AudioContext.prototype.close || (AudioContext.prototype.close = function() { return t.isFunction(this.suspend) ? this.suspend() : Promise.resolve() }), AudioContext.prototype.resume || (AudioContext.prototype.resume = function() { return Promise.resolve() }), !AudioContext.prototype.createGain && AudioContext.prototype.createGainNode && (AudioContext.prototype.createGain = AudioContext.prototype.createGainNode), !AudioContext.prototype.createDelay && AudioContext.prototype.createDelayNode && (AudioContext.prototype.createDelay = AudioContext.prototype.createDelayNode)) }), t(function(t) { t.Context = function() { var i, n; if (t.Emitter.call(this), i = t.defaults(arguments, ["context"], t.Context), !i.context && (i.context = new window.AudioContext, !i.context)) throw new Error("could not create AudioContext. Possibly too many AudioContexts running already.");
                this._context = i.context; for (n in this._context) this._defineProperty(this._context, n);
                this._latencyHint = i.latencyHint, this._constants = {}, this.lookAhead = i.lookAhead, this._computedUpdateInterval = 0, this._ticker = new e(this.emit.bind(this, "tick"), i.clockSource, i.updateInterval), this._timeouts = new t.Timeline, this._timeoutIds = 0, this.on("tick", this._timeoutLoop.bind(this)) }, t.extend(t.Context, t.Emitter), t.Emitter.mixin(t.Context), t.Context.defaults = { clockSource: "worker", latencyHint: "interactive", lookAhead: .1, updateInterval: .03 }, t.Context.prototype._defineProperty = function(e, i) { t.isUndef(this[i]) && Object.defineProperty(this, i, { get: function() { return "function" == typeof e[i] ? e[i].bind(e) : e[i] }, set: function(t) { e[i] = t } }) }, t.Context.prototype.now = function() { return this._context.currentTime + this.lookAhead }, t.Context.prototype.ready = function() { return new Promise(function(t) { "running" === this._context.state ? t() : this._context.resume().then(function() { t() }) }.bind(this)) }, t.Context.prototype.close = function() { return this._context.close().then(function() { t.Context.emit("close", this) }.bind(this)) }, t.Context.prototype.getConstant = function(t) { var e, i, n, s; if (this._constants[t]) return this._constants[t]; for (e = this._context.createBuffer(1, 128, this._context.sampleRate), i = e.getChannelData(0), n = 0; n < i.length; n++) i[n] = t; return s = this._context.createBufferSource(), s.channelCount = 1, s.channelCountMode = "explicit", s.buffer = e, s.loop = !0, s.start(0), this._constants[t] = s, s }, t.Context.prototype._timeoutLoop = function() { for (var t = this.now(); this._timeouts && this._timeouts.length && this._timeouts.peek().time <= t;) this._timeouts.shift().callback() }, t.Context.prototype.setTimeout = function(t, e) { this._timeoutIds++; var i = this.now(); return this._timeouts.add({ callback: t, time: i + e, id: this._timeoutIds }), this._timeoutIds }, t.Context.prototype.clearTimeout = function(t) { return this._timeouts.forEach(function(e) { e.id === t && this.remove(e) }), this }, Object.defineProperty(t.Context.prototype, "updateInterval", { get: function() { return this._ticker.updateInterval }, set: function(t) { this._ticker.updateInterval = t } }), Object.defineProperty(t.Context.prototype, "clockSource", { get: function() { return this._ticker.type }, set: function(t) { this._ticker.type = t } }), Object.defineProperty(t.Context.prototype, "latencyHint", { get: function() { return this._latencyHint }, set: function(e) { var i = e; if (this._latencyHint = e, t.isString(e)) switch (e) {
                        case "interactive":
                            i = .1, this._context.latencyHint = e; break;
                        case "playback":
                            i = .8, this._context.latencyHint = e; break;
                        case "balanced":
                            i = .25, this._context.latencyHint = e; break;
                        case "fastest":
                            this._context.latencyHint = "interactive", i = .01 } this.lookAhead = i, this.updateInterval = i / 3 } }), t.Context.prototype.dispose = function() { return this.close().then(function() { t.Emitter.prototype.dispose.call(this), this._ticker.dispose(), this._ticker = null, this._timeouts.dispose(), this._timeouts = null; for (var e in this._constants) this._constants[e].disconnect();
                    this._constants = null }.bind(this)) }; var e = function(e, i, n) { this._type = i, this._updateInterval = n, this._callback = t.defaultArg(e, t.noOp), this._createClock() }; return e.Type = { Worker: "worker", Timeout: "timeout", Offline: "offline" }, e.prototype._createWorker = function() { var t, e, i;
                window.URL = window.URL || window.webkitURL, t = new Blob(["var timeoutTime = " + (1e3 * this._updateInterval).toFixed(1) + ";self.onmessage = function(msg){\ttimeoutTime = parseInt(msg.data);};function tick(){\tsetTimeout(tick, timeoutTime);\tself.postMessage('tick');}tick();"]), e = URL.createObjectURL(t), i = new Worker(e), i.onmessage = this._callback.bind(this), this._worker = i }, e.prototype._createTimeout = function() { this._timeout = setTimeout(function() { this._createTimeout(), this._callback() }.bind(this), 1e3 * this._updateInterval) }, e.prototype._createClock = function() { if (this._type === e.Type.Worker) try { this._createWorker() } catch (t) { this._type = e.Type.Timeout, this._createClock() } else this._type === e.Type.Timeout && this._createTimeout() }, Object.defineProperty(e.prototype, "updateInterval", { get: function() { return this._updateInterval }, set: function(t) { this._updateInterval = Math.max(t, 128 / 44100), this._type === e.Type.Worker && this._worker.postMessage(Math.max(1e3 * t, 1)) } }), Object.defineProperty(e.prototype, "type", { get: function() { return this._type }, set: function(t) { this._disposeClock(), this._type = t, this._createClock() } }), e.prototype._disposeClock = function() { this._timeout && (clearTimeout(this._timeout), this._timeout = null), this._worker && (this._worker.terminate(), this._worker.onmessage = null, this._worker = null) }, e.prototype.dispose = function() { this._disposeClock(), this._callback = null }, t.getContext(function() {
                function e(e, i, s) { if (e.input) s = t.defaultArg(s, 0), t.isArray(e.input) ? this.connect(e.input[s]) : this.connect(e.input, i, s);
                    else try { e instanceof AudioNode ? n.call(this, e, i, s) : n.call(this, e, i) } catch (t) { throw new Error("error connecting to node: " + e + "\n" + t) } }

                function i(e, i, n) { if (e && e.input && t.isArray(e.input)) n = t.defaultArg(n, 0), this.disconnect(e.input[n], i, 0);
                    else if (e && e.input) this.disconnect(e.input, i, n);
                    else try { s.apply(this, arguments) } catch (t) { throw new Error("error disconnecting node: " + e + "\n" + t) } } var n = AudioNode.prototype.connect,
                    s = AudioNode.prototype.disconnect;
                AudioNode.prototype.connect !== e && (AudioNode.prototype.connect = e, AudioNode.prototype.disconnect = i) }), t.supported && !t.initialized ? (t.context = new t.Context, window.TONE_SILENCE_VERSION_LOGGING || console.log("%c * Tone.js " + t.version + " * ", "background: #000; color: #fff")) : t.supported || console.warn("This browser does not support Tone.js"), t.Context }), t(function(t) { return t.AudioNode = function() { t.call(this); var e = t.defaults(arguments, ["context"], { context: t.context });
                this._context = e.context }, t.extend(t.AudioNode), Object.defineProperty(t.AudioNode.prototype, "context", { get: function() { return this._context } }), t.AudioNode.prototype.createInsOuts = function(t, e) { 1 === t ? this.input = this.context.createGain() : t > 1 && (this.input = new Array(t)), 1 === e ? this.output = this.context.createGain() : e > 1 && (this.output = new Array(e)) }, Object.defineProperty(t.AudioNode.prototype, "numberOfInputs", { get: function() { return this.input ? t.isArray(this.input) ? this.input.length : 1 : 0 } }), Object.defineProperty(t.AudioNode.prototype, "numberOfOutputs", { get: function() { return this.output ? t.isArray(this.output) ? this.output.length : 1 : 0 } }), t.AudioNode.prototype.connect = function(e, i, n) { return t.isArray(this.output) ? (i = t.defaultArg(i, 0), this.output[i].connect(e, 0, n)) : this.output.connect(e, i, n), this }, t.AudioNode.prototype.disconnect = function(e, i, n) { t.isArray(this.output) ? t.isNumber(e) ? this.output[e].disconnect() : (i = t.defaultArg(i, 0), this.output[i].disconnect(e, 0, n)) : this.output.disconnect.apply(this.output, arguments) }, t.AudioNode.prototype.chain = function() { var t, e, i = this; for (t = 0; t < arguments.length; t++) e = arguments[t], i.connect(e), i = e; return this }, t.AudioNode.prototype.fan = function() { for (var t = 0; t < arguments.length; t++) this.connect(arguments[t]); return this }, window.AudioNode && (AudioNode.prototype.chain = t.AudioNode.prototype.chain, AudioNode.prototype.fan = t.AudioNode.prototype.fan), t.AudioNode.prototype.dispose = function() { return t.isUndef(this.input) || (this.input instanceof AudioNode && this.input.disconnect(), this.input = null), t.isUndef(this.output) || (this.output instanceof AudioNode && this.output.disconnect(), this.output = null), this._context = null, this }, t.AudioNode }), t(function(t) { return t.SignalBase = function() { t.AudioNode.call(this) }, t.extend(t.SignalBase, t.AudioNode), t.SignalBase.prototype.connect = function(e, i, n) { return t.Signal && t.Signal === e.constructor || t.Param && t.Param === e.constructor || t.TimelineSignal && t.TimelineSignal === e.constructor ? (e._param.cancelScheduledValues(0), e._param.value = 0, e.overridden = !0) : e instanceof AudioParam && (e.cancelScheduledValues(0), e.value = 0), t.AudioNode.prototype.connect.call(this, e, i, n), this }, t.SignalBase }), t(function(t) { return t.WaveShaper = function(e, i) { t.SignalBase.call(this), this._shaper = this.input = this.output = this.context.createWaveShaper(), this._curve = null, Array.isArray(e) ? this.curve = e : isFinite(e) || t.isUndef(e) ? this._curve = new Float32Array(t.defaultArg(e, 1024)) : t.isFunction(e) && (this._curve = new Float32Array(t.defaultArg(i, 1024)), this.setMap(e)) }, t.extend(t.WaveShaper, t.SignalBase), t.WaveShaper.prototype.setMap = function(t) { var e, i, n; for (e = 0, i = this._curve.length; e < i; e++) n = e / (i - 1) * 2 - 1, this._curve[e] = t(n, e); return this._shaper.curve = this._curve, this }, Object.defineProperty(t.WaveShaper.prototype, "curve", { get: function() { return this._shaper.curve }, set: function(t) { this._curve = new Float32Array(t), this._shaper.curve = this._curve } }), Object.defineProperty(t.WaveShaper.prototype, "oversample", { get: function() { return this._shaper.oversample }, set: function(t) { if (-1 === ["none", "2x", "4x"].indexOf(t)) throw new RangeError("Tone.WaveShaper: oversampling must be either 'none', '2x', or '4x'");
                    this._shaper.oversample = t } }), t.WaveShaper.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._shaper.disconnect(), this._shaper = null, this._curve = null, this }, t.WaveShaper }), t(function(t) { return t.TimeBase = function(e, i) { if (!(this instanceof t.TimeBase)) return new t.TimeBase(e, i); if (this._expr = this._noOp, e instanceof t.TimeBase) this.copy(e);
                else if (!t.isUndef(i) || t.isNumber(e)) { i = t.defaultArg(i, this._defaultUnits); var n = this._primaryExpressions[i].method;
                    this._expr = n.bind(this, e) } else t.isString(e) ? this.set(e) : t.isUndef(e) && (this._expr = this._defaultExpr()) }, t.extend(t.TimeBase), t.TimeBase.prototype.set = function(t) { return this._expr = this._parseExprString(t), this }, t.TimeBase.prototype.clone = function() { var t = new this.constructor; return t.copy(this), t }, t.TimeBase.prototype.copy = function(t) { var e = t._expr(); return this.set(e) }, t.TimeBase.prototype._primaryExpressions = { n: { regexp: /^(\d+)n/i, method: function(t) { return t = parseInt(t), 1 === t ? this._beatsToUnits(this._timeSignature()) : this._beatsToUnits(4 / t) } }, t: { regexp: /^(\d+)t/i, method: function(t) { return t = parseInt(t), this._beatsToUnits(8 / (3 * parseInt(t))) } }, m: { regexp: /^(\d+)m/i, method: function(t) { return this._beatsToUnits(parseInt(t) * this._timeSignature()) } }, i: { regexp: /^(\d+)i/i, method: function(t) { return this._ticksToUnits(parseInt(t)) } }, hz: { regexp: /^(\d+(?:\.\d+)?)hz/i, method: function(t) { return this._frequencyToUnits(parseFloat(t)) } }, tr: { regexp: /^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/, method: function(t, e, i) { var n = 0; return t && "0" !== t && (n += this._beatsToUnits(this._timeSignature() * parseFloat(t))), e && "0" !== e && (n += this._beatsToUnits(parseFloat(e))), i && "0" !== i && (n += this._beatsToUnits(parseFloat(i) / 4)), n } }, s: { regexp: /^(\d+(?:\.\d+)?s)/, method: function(t) { return this._secondsToUnits(parseFloat(t)) } }, samples: { regexp: /^(\d+)samples/, method: function(t) { return parseInt(t) / this.context.sampleRate } }, default: { regexp: /^(\d+(?:\.\d+)?)/, method: function(t) { return this._primaryExpressions[this._defaultUnits].method.call(this, t) } } }, t.TimeBase.prototype._binaryExpressions = { "+": { regexp: /^\+/, precedence: 2, method: function(t, e) { return t() + e() } }, "-": { regexp: /^-/, precedence: 2, method: function(t, e) { return t() - e() } }, "*": { regexp: /^\*/, precedence: 1, method: function(t, e) { return t() * e() } }, "/": { regexp: /^\//, precedence: 1, method: function(t, e) { return t() / e() } } }, t.TimeBase.prototype._unaryExpressions = { neg: { regexp: /^-/, method: function(t) { return -t() } } }, t.TimeBase.prototype._syntaxGlue = { "(": { regexp: /^\(/ }, ")": { regexp: /^\)/ } }, t.TimeBase.prototype._tokenize = function(t) { for (var e, i = -1, n = []; t.length > 0;) t = t.trim(), e = function(t, e) { var i, n, s, o, r, a, l = ["_binaryExpressions", "_unaryExpressions", "_primaryExpressions", "_syntaxGlue"]; for (i = 0; i < l.length; i++) { n = e[l[i]]; for (s in n)
                            if (o = n[s], r = o.regexp, null !== (a = t.match(r))) return { method: o.method, precedence: o.precedence, regexp: o.regexp, value: a[0] } } throw new SyntaxError("Tone.TimeBase: Unexpected token " + t) }(t, this), n.push(e), t = t.substr(e.value.length); return { next: function() { return n[++i] }, peek: function() { return n[i + 1] } } }, t.TimeBase.prototype._matchGroup = function(e, i, n) { var s, o, r = !1; if (!t.isUndef(e))
                    for (s in i)
                        if (o = i[s], o.regexp.test(e.value)) { if (t.isUndef(n)) return o; if (o.precedence === n) return o } return r }, t.TimeBase.prototype._parseBinary = function(e, i) { var n, s; for (t.isUndef(i) && (i = 2), n = i < 0 ? this._parseUnary(e) : this._parseBinary(e, i - 1), s = e.peek(); s && this._matchGroup(s, this._binaryExpressions, i);) s = e.next(), n = s.method.bind(this, n, this._parseBinary(e, i - 1)), s = e.peek(); return n }, t.TimeBase.prototype._parseUnary = function(t) { var e, i = t.peek(),
                    n = this._matchGroup(i, this._unaryExpressions); return n ? (i = t.next(), e = this._parseUnary(t), n.method.bind(this, e)) : this._parsePrimary(t) }, t.TimeBase.prototype._parsePrimary = function(e) { var i, n, s = e.peek(); if (t.isUndef(s)) throw new SyntaxError("Tone.TimeBase: Unexpected end of expression"); if (this._matchGroup(s, this._primaryExpressions)) return s = e.next(), n = s.value.match(s.regexp), s.method.bind(this, n[1], n[2], n[3]); if (s && "(" === s.value) { if (e.next(), i = this._parseBinary(e), !(s = e.next()) || ")" !== s.value) throw new SyntaxError("Expected )"); return i } throw new SyntaxError("Tone.TimeBase: Cannot process token " + s.value) }, t.TimeBase.prototype._parseExprString = function(e) { var i; return t.isString(e) || (e = e.toString()), i = this._tokenize(e), this._parseBinary(i) }, t.TimeBase.prototype._noOp = function() { return 0 }, t.TimeBase.prototype._defaultExpr = function() { return this._noOp }, t.TimeBase.prototype._defaultUnits = "s", t.TimeBase.prototype._frequencyToUnits = function(t) { return 1 / t }, t.TimeBase.prototype._beatsToUnits = function(e) { return 60 / t.Transport.bpm.value * e }, t.TimeBase.prototype._secondsToUnits = function(t) { return t }, t.TimeBase.prototype._ticksToUnits = function(e) { return e * (this._beatsToUnits(1) / t.Transport.PPQ) }, t.TimeBase.prototype._timeSignature = function() { return t.Transport.timeSignature }, t.TimeBase.prototype._pushExpr = function(e, i, n) { return e instanceof t.TimeBase || (e = new this.constructor(e, n)), this._expr = this._binaryExpressions[i].method.bind(this, this._expr, e._expr), this }, t.TimeBase.prototype.add = function(t, e) { return this._pushExpr(t, "+", e) }, t.TimeBase.prototype.sub = function(t, e) { return this._pushExpr(t, "-", e) }, t.TimeBase.prototype.mult = function(t, e) { return this._pushExpr(t, "*", e) }, t.TimeBase.prototype.div = function(t, e) { return this._pushExpr(t, "/", e) }, t.TimeBase.prototype.valueOf = function() { return this._expr() }, t.TimeBase.prototype.dispose = function() { this._expr = null }, t.TimeBase }), t(function(t) { return t.Time = function(e, i) { if (!(this instanceof t.Time)) return new t.Time(e, i);
                this._plusNow = !1, t.TimeBase.call(this, e, i) }, t.extend(t.Time, t.TimeBase), t.Time.prototype._unaryExpressions = Object.create(t.TimeBase.prototype._unaryExpressions), t.Time.prototype._unaryExpressions.quantize = { regexp: /^@/, method: function(e) { return t.Transport.nextSubdivision(e()) } }, t.Time.prototype._unaryExpressions.now = { regexp: /^\+/, method: function(t) { return this._plusNow = !0, t() } }, t.Time.prototype.quantize = function(e, i) { return i = t.defaultArg(i, 1), this._expr = function(t, e, i) { var n, s, o; return t = t(), e = e.toSeconds(), n = Math.round(t / e), s = n * e, o = s - t, t + o * i }.bind(this, this._expr, new this.constructor(e), i), this }, t.Time.prototype.addNow = function() { return this._plusNow = !0, this }, t.Time.prototype._defaultExpr = function() { return this._plusNow = !0, this._noOp }, t.Time.prototype.copy = function(e) { return t.TimeBase.prototype.copy.call(this, e), this._plusNow = e._plusNow, this }, t.Time.prototype.toNotation = function() { var t = this.toSeconds(),
                    e = ["1m", "2n", "4n", "8n", "16n", "32n", "64n", "128n"],
                    i = this._toNotationHelper(t, e),
                    n = ["1m", "2n", "2t", "4n", "4t", "8n", "8t", "16n", "16t", "32n", "32t", "64n", "64t", "128n"],
                    s = this._toNotationHelper(t, n); return s.split("+").length < i.split("+").length ? s : i }, t.Time.prototype._toNotationHelper = function(t, e) { var i, n, s, o, r = this._notationToUnits(e[e.length - 1]),
                    a = ""; for (i = 0; i < e.length; i++)
                    if (n = this._notationToUnits(e[i]), s = t / n, o = 1e-6, 1 - s % 1 < o && (s += o), (s = Math.floor(s)) > 0) { if (a += 1 === s ? e[i] : s.toString() + "*" + e[i], (t -= s * n) < r) break;
                        a += " + " } return "" === a && (a = "0"), a }, t.Time.prototype._notationToUnits = function(t) { var e, i, n, s = this._primaryExpressions,
                    o = [s.n, s.t, s.m]; for (e = 0; e < o.length; e++)
                    if (i = o[e], n = t.match(i.regexp)) return i.method.call(this, n[1]) }, t.Time.prototype.toBarsBeatsSixteenths = function() { var t, e = this._beatsToUnits(1),
                    i = this.toSeconds() / e,
                    n = Math.floor(i / this._timeSignature()),
                    s = i % 1 * 4; return i = Math.floor(i) % this._timeSignature(), s = s.toString(), s.length > 3 && (s = parseFloat(parseFloat(s).toFixed(3))), t = [n, i, s], t.join(":") }, t.Time.prototype.toTicks = function() { var e = this._beatsToUnits(1),
                    i = this.valueOf() / e; return Math.round(i * t.Transport.PPQ) }, t.Time.prototype.toSamples = function() { return this.toSeconds() * this.context.sampleRate }, t.Time.prototype.toFrequency = function() { return 1 / this.toSeconds() }, t.Time.prototype.toSeconds = function() { return this.valueOf() }, t.Time.prototype.toMilliseconds = function() { return 1e3 * this.toSeconds() }, t.Time.prototype.valueOf = function() { return this._expr() + (this._plusNow ? this.now() : 0) }, t.Time }), t(function(t) { var e, i; return t.Frequency = function(e, i) { if (!(this instanceof t.Frequency)) return new t.Frequency(e, i);
                t.TimeBase.call(this, e, i) }, t.extend(t.Frequency, t.TimeBase), t.Frequency.prototype._primaryExpressions = Object.create(t.TimeBase.prototype._primaryExpressions), t.Frequency.prototype._primaryExpressions.midi = { regexp: /^(\d+(?:\.\d+)?midi)/, method: function(t) { return this.midiToFrequency(t) } }, t.Frequency.prototype._primaryExpressions.note = { regexp: /^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i, method: function(t, i) { var n = e[t.toLowerCase()],
                        s = n + 12 * (parseInt(i) + 1); return this.midiToFrequency(s) } }, t.Frequency.prototype._primaryExpressions.tr = { regexp: /^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/, method: function(t, e, i) { var n = 1; return t && "0" !== t && (n *= this._beatsToUnits(this._timeSignature() * parseFloat(t))), e && "0" !== e && (n *= this._beatsToUnits(parseFloat(e))), i && "0" !== i && (n *= this._beatsToUnits(parseFloat(i) / 4)), n } }, t.Frequency.prototype.transpose = function(e) { return this._expr = function(e, i) { return e() * t.intervalToFrequencyRatio(i) }.bind(this, this._expr, e), this }, t.Frequency.prototype.harmonize = function(e) { return this._expr = function(e, i) { var n, s = e(),
                        o = []; for (n = 0; n < i.length; n++) o[n] = s * t.intervalToFrequencyRatio(i[n]); return o }.bind(this, this._expr, e), this }, t.Frequency.prototype.toMidi = function() { return this.frequencyToMidi(this.valueOf()) }, t.Frequency.prototype.toNote = function() { var e = this.valueOf(),
                    n = Math.log(e / t.Frequency.A4) / Math.LN2,
                    s = Math.round(12 * n) + 57,
                    o = Math.floor(s / 12); return o < 0 && (s += -12 * o), i[s % 12] + o.toString() }, t.Frequency.prototype.toSeconds = function() { return 1 / this.valueOf() }, t.Frequency.prototype.toFrequency = function() { return this.valueOf() }, t.Frequency.prototype.toTicks = function() { var e = this._beatsToUnits(1),
                    i = this.valueOf() / e; return Math.floor(i * t.Transport.PPQ) }, t.Frequency.prototype._frequencyToUnits = function(t) { return t }, t.Frequency.prototype._ticksToUnits = function(e) { return 1 / (60 * e / (t.Transport.bpm.value * t.Transport.PPQ)) }, t.Frequency.prototype._beatsToUnits = function(e) { return 1 / t.TimeBase.prototype._beatsToUnits.call(this, e) }, t.Frequency.prototype._secondsToUnits = function(t) { return 1 / t }, t.Frequency.prototype._defaultUnits = "hz", e = { cbb: -2, cb: -1, c: 0, "c#": 1, cx: 2, dbb: 0, db: 1, d: 2, "d#": 3, dx: 4, ebb: 2, eb: 3, e: 4, "e#": 5, ex: 6, fbb: 3, fb: 4, f: 5, "f#": 6, fx: 7, gbb: 5, gb: 6, g: 7, "g#": 8, gx: 9, abb: 7, ab: 8, a: 9, "a#": 10, ax: 11, bbb: 9, bb: 10, b: 11, "b#": 12, bx: 13 }, i = ["C", "C#", "D", "D#", "E", "F", "F#", "G", "G#", "A", "A#", "B"], t.Frequency.A4 = 440, t.Frequency.prototype.midiToFrequency = function(e) { return t.Frequency.A4 * Math.pow(2, (e - 69) / 12) }, t.Frequency.prototype.frequencyToMidi = function(e) { return 69 + Math.round(12 * Math.log(e / t.Frequency.A4) / Math.LN2) }, t.Frequency }), t(function(t) { return t.TransportTime = function(e, i) { if (!(this instanceof t.TransportTime)) return new t.TransportTime(e, i);
                t.Time.call(this, e, i) }, t.extend(t.TransportTime, t.Time), t.TransportTime.prototype._unaryExpressions = Object.create(t.Time.prototype._unaryExpressions), t.TransportTime.prototype._unaryExpressions.quantize = { regexp: /^@/, method: function(e) { var i = this._secondsToTicks(e()),
                        n = Math.ceil(t.Transport.ticks / i); return this._ticksToUnits(n * i) } }, t.TransportTime.prototype._secondsToTicks = function(e) { var i = this._beatsToUnits(1),
                    n = e / i; return Math.round(n * t.Transport.PPQ) }, t.TransportTime.prototype.valueOf = function() { return this._secondsToTicks(this._expr()) + (this._plusNow ? t.Transport.ticks : 0) }, t.TransportTime.prototype.toTicks = function() { return this.valueOf() }, t.TransportTime.prototype.toSeconds = function() { return this._expr() + (this._plusNow ? t.Transport.seconds : 0) }, t.TransportTime.prototype.toFrequency = function() { return 1 / this.toSeconds() }, t.TransportTime }), t(function(t) { return t.Type = { Default: "number", Time: "time", Frequency: "frequency", TransportTime: "transportTime", Ticks: "ticks", NormalRange: "normalRange", AudioRange: "audioRange", Decibels: "db", Interval: "interval", BPM: "bpm", Positive: "positive", Gain: "gain", Cents: "cents", Degrees: "degrees", MIDI: "midi", BarsBeatsSixteenths: "barsBeatsSixteenths", Samples: "samples", Hertz: "hertz", Note: "note", Milliseconds: "milliseconds", Seconds: "seconds", Notation: "notation" }, t.prototype.toSeconds = function(e) { return t.isNumber(e) ? e : t.isUndef(e) ? this.now() : t.isString(e) ? new t.Time(e).toSeconds() : e instanceof t.TimeBase ? e.toSeconds() : void 0 }, t.prototype.toFrequency = function(e) { return t.isNumber(e) ? e : t.isString(e) || t.isUndef(e) ? new t.Frequency(e).valueOf() : e instanceof t.TimeBase ? e.toFrequency() : void 0 }, t.prototype.toTicks = function(e) { return t.isNumber(e) || t.isString(e) ? new t.TransportTime(e).toTicks() : t.isUndef(e) ? t.Transport.ticks : e instanceof t.TimeBase ? e.toTicks() : void 0 }, t }), t(function(t) {
            function e(e) { e._events || (e._events = new t.Timeline(1e3)) }
            var i = function(t, e, i, n, s) { return i + (e - i) * Math.exp(-(s - t) / n) },
                n = function(t, e, i, n, s) { return e + (s - t) / (i - t) * (n - e) },
                s = function(t, e, i, n, s) { return e * Math.pow(n / e, (s - t) / (i - t)) },
                o = { Linear: "linearRampToValueAtTime", Exponential: "exponentialRampToValueAtTime", Target: "setTargetAtTime", SetValue: "setValueAtTime" };
            t.supported && (Object.defineProperty(AudioParam.prototype, "value", {
                get: function() {
                    var e = t.context.currentTime;
                    return this.getValueAtTime(e)
                },
                set: function(e) { this._initialValue = e; var i = t.context.currentTime;
                    this.setValueAtTime(e, i) }
            }), AudioParam.prototype.hasOwnProperty("defaultValue") || Object.defineProperty(AudioParam.prototype, "defaultValue", { get: function() { return 1 } }), AudioParam.prototype.hasOwnProperty("minValue") || Object.defineProperty(AudioParam.prototype, "minValue", { get: function() { return -3.4028235e38 } }), AudioParam.prototype.hasOwnProperty("maxValue") || Object.defineProperty(AudioParam.prototype, "maxValue", { get: function() { return 3.4028235e38 } }), ["setValueAtTime", "linearRampToValueAtTime", "exponentialRampToValueAtTime"].forEach(function(t) { var i = "_native_" + t;
                AudioParam.prototype[i] || (AudioParam.prototype[i] = AudioParam.prototype[t], AudioParam.prototype[t] = function(n, s) { if (e(this), t === o.Exponential) { var r = this._events.get(s); if (r && this.getValueAtTime(r.time) <= 0) throw new Error("exponentialRampToValueAtTime must ramp from a value > 0") } return this._events.add({ type: t, time: s, value: n }), AudioParam.prototype[i].call(this, n, s) }) }), AudioParam.prototype._native_setTargetAtTime || (AudioParam.prototype._native_setTargetAtTime = AudioParam.prototype.setTargetAtTime, AudioParam.prototype.setTargetAtTime = function(t, i, n) { return e(this), this._events.add({ type: o.Target, value: t, time: i, constant: n }), this._native_setTargetAtTime(t, i, n) }), AudioParam.prototype._native_setValueCurveAtTime || (AudioParam.prototype._native_setValueCurveAtTime = AudioParam.prototype.setValueCurveAtTime, AudioParam.prototype.setValueCurveAtTime = function(t, i, n) { var s, r; for (e(this), this._events.add({ type: o.SetValue, value: t[0], time: i }), s = n / (t.length - 1), r = 1; r < t.length; r++) this._events.add({ type: o.Linear, value: t[r], time: i + r * s }); return this._native_setValueCurveAtTime(t, i, n) }), AudioParam.prototype._native_cancelScheduledValues || (AudioParam.prototype._native_cancelScheduledValues = AudioParam.prototype.cancelScheduledValues, AudioParam.prototype.cancelScheduledValues = function(t) { return e(this), this._events.cancel(t), this._native_cancelScheduledValues(t) }), AudioParam.prototype._native_cancelAndHoldAtTime || (AudioParam.prototype._native_cancelAndHoldAtTime = AudioParam.prototype.cancelAndHoldAtTime, AudioParam.prototype.cancelAndHoldAtTime = function(t) { var i, n, s; return e(this), i = this.getValueAtTime(t), n = this._events.get(t), s = this._events.getAfter(t), n && n.time === t ? s ? this._events.cancel(s.time) : this._events.cancel(t + 1e-6) : s && (this._events.cancel(s.time), this._native_cancelAndHoldAtTime || this._native_cancelScheduledValues(t), s.type === o.Linear ? this._native_cancelAndHoldAtTime ? this._events.add({ type: o.Linear, value: i, time: t }) : this.linearRampToValueAtTime(i, t) : s.type === o.Exponential && (this._native_cancelAndHoldAtTime ? this._events.add({ type: o.Exponential, value: i, time: t }) : this.exponentialRampToValueAtTime(i, t))), this._events.add({ type: o.SetValue, value: i, time: t }), this._native_cancelAndHoldAtTime ? this._native_cancelAndHoldAtTime(t) : this._native_setValueAtTime(i, t) }), AudioParam.prototype.getValueAtTime = function(r) { var a, l, h, u, p; return e(this), a = this._events.getAfter(r), l = this._events.get(r), h = t.defaultArg(this._initialValue, this.defaultValue), null === l ? h : l.type === o.Target ? (u = this._events.getBefore(l.time), p = null === u ? h : u.value, i(l.time, p, l.value, l.constant, r)) : null === a ? l.value : a.type === o.Linear ? n(l.time, l.value, a.time, a.value, r) : a.type === o.Exponential ? s(l.time, l.value, a.time, a.value, r) : l.value })
        }), t(function(t) { return t.Param = function() { var e = t.defaults(arguments, ["param", "units", "convert"], t.Param);
                t.AudioNode.call(this), this._param = this.input = e.param, this.units = e.units, this.convert = e.convert, this.overridden = !1, t.isUndef(e.value) || (this.value = e.value) }, t.extend(t.Param, t.AudioNode), t.Param.defaults = { units: t.Type.Default, convert: !0, param: void 0 }, Object.defineProperty(t.Param.prototype, "value", { get: function() { return this._toUnits(this._param.value) }, set: function(t) { var e = this._fromUnits(t);
                    this._param.cancelScheduledValues(0), this._param.value = e } }), t.Param.prototype._fromUnits = function(e) { if (!this.convert && !t.isUndef(this.convert)) return e; switch (this.units) {
                    case t.Type.Time:
                        return this.toSeconds(e);
                    case t.Type.Frequency:
                        return this.toFrequency(e);
                    case t.Type.Decibels:
                        return t.dbToGain(e);
                    case t.Type.NormalRange:
                        return Math.min(Math.max(e, 0), 1);
                    case t.Type.AudioRange:
                        return Math.min(Math.max(e, -1), 1);
                    case t.Type.Positive:
                        return Math.max(e, 0);
                    default:
                        return e } }, t.Param.prototype._toUnits = function(e) { if (!this.convert && !t.isUndef(this.convert)) return e; switch (this.units) {
                    case t.Type.Decibels:
                        return t.gainToDb(e);
                    default:
                        return e } }, t.Param.prototype._minOutput = 1e-5, t.Param.prototype.setValueAtTime = function(e, i) { return i = this.toSeconds(i), t.isPast(i), this._param.setValueAtTime(this._fromUnits(e), i), this }, t.Param.prototype.getValueAtTime = function(t) { return t = this.toSeconds(t), this._fromUnits(this._param.getValueAtTime(t)) }, t.Param.prototype.setRampPoint = function(t) { t = this.toSeconds(t); var e = this.getValueAtTime(t); return this.cancelAndHoldAtTime(t), 0 === e && (e = this._minOutput), this._param.setValueAtTime(e, t), this }, t.Param.prototype.linearRampToValueAtTime = function(e, i) { return e = this._fromUnits(e), i = this.toSeconds(i), t.isPast(i), this._param.linearRampToValueAtTime(e, i), this }, t.Param.prototype.exponentialRampToValueAtTime = function(e, i) { return e = this._fromUnits(e), e = Math.max(this._minOutput, e), i = this.toSeconds(i), t.isPast(i), this._param.exponentialRampToValueAtTime(e, i), this }, t.Param.prototype.exponentialRampTo = function(t, e, i) { return i = this.toSeconds(i), this.setRampPoint(i), this.exponentialRampToValueAtTime(t, i + this.toSeconds(e)), this }, t.Param.prototype.linearRampTo = function(t, e, i) { return i = this.toSeconds(i), this.setRampPoint(i), this.linearRampToValueAtTime(t, i + this.toSeconds(e)), this }, t.Param.prototype.targetRampTo = function(t, e, i) { return i = this.toSeconds(i), this.setRampPoint(i), this.exponentialAppraochValueAtTime(t, i, e), this }, t.Param.prototype.exponentialAppraochValueAtTime = function(e, i, n) { var s = Math.log(this.toSeconds(n) + 1) / Math.log(200); return i = this.toSeconds(i), t.isPast(i), this.setTargetAtTime(e, i, s) }, t.Param.prototype.setTargetAtTime = function(t, e, i) { if (t = this._fromUnits(t), i <= 0) throw new Error("timeConstant must be greater than 0"); return this._param.setTargetAtTime(t, this.toSeconds(e), i), this }, t.Param.prototype.setValueCurveAtTime = function(e, i, n, s) { var o, r; for (s = t.defaultArg(s, 1), n = this.toSeconds(n), i = this.toSeconds(i), this.setValueAtTime(e[0] * s, i), o = n / (e.length - 1), r = 1; r < e.length; r++) this._param.linearRampToValueAtTime(this._fromUnits(e[r] * s), i + r * o); return this }, t.Param.prototype.cancelScheduledValues = function(t) { return this._param.cancelScheduledValues(this.toSeconds(t)), this }, t.Param.prototype.cancelAndHoldAtTime = function(t) { return this._param.cancelAndHoldAtTime(this.toSeconds(t)), this }, t.Param.prototype.rampTo = function(e, i, n) { return i = t.defaultArg(i, .1), this.units === t.Type.Frequency || this.units === t.Type.BPM || this.units === t.Type.Decibels ? this.exponentialRampTo(e, i, n) : this.linearRampTo(e, i, n), this }, t.Param.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._param = null, this }, t.Param }), t(function(t) { return t.Gain = function() { var e = t.defaults(arguments, ["gain", "units"], t.Gain);
                t.AudioNode.call(this), this.input = this.output = this._gainNode = this.context.createGain(), this.gain = new t.Param({ param: this._gainNode.gain, units: e.units, value: e.gain, convert: e.convert }), this._readOnly("gain") }, t.extend(t.Gain, t.AudioNode), t.Gain.defaults = { gain: 1, convert: !0 }, t.Gain.prototype.dispose = function() { t.AudioNode.prototype.dispose.call(this), this._gainNode.disconnect(), this._gainNode = null, this._writable("gain"), this.gain.dispose(), this.gain = null }, t.Gain }), t(function(t) { if (t.supported && !window.ConstantSourceNode) { var e = function(t) { var e, i, n, s; for (this.context = t, e = t.createBuffer(1, 128, t.sampleRate), i = e.getChannelData(0), n = 0; n < i.length; n++) i[n] = 1;
                    this._bufferSource = t.createBufferSource(), this._bufferSource.channelCount = 1, this._bufferSource.channelCountMode = "explicit", this._bufferSource.buffer = e, this._bufferSource.loop = !0, s = this._output = t.createGain(), this.offset = s.gain, this._bufferSource.connect(s) };
                e.prototype.start = function(t) { return this._bufferSource.start(t), this }, e.prototype.stop = function(t) { return this._bufferSource.stop(t), this }, e.prototype.connect = function() { return this._output.connect.apply(this._output, arguments), this }, e.prototype.disconnect = function() { return this._output.disconnect.apply(this._output, arguments), this }, AudioContext.prototype.createConstantSource = function() { return new e(this) }, t.Context.prototype.createConstantSource = function() { return new e(this) } } }), t(function(t) { return t.Signal = function() { var e = t.defaults(arguments, ["value", "units"], t.Signal),
                    i = t.context.createConstantSource();
                i.start(0), e.param = i.offset, t.Param.call(this, e), this.output = i, this.input = this._param = this.output.offset }, t.extend(t.Signal, t.Param), t.Signal.defaults = { value: 0, units: t.Type.Default, convert: !0 }, t.Signal.prototype.connect = t.SignalBase.prototype.connect, t.Signal.prototype.dispose = function() { return t.Param.prototype.dispose.call(this), this }, t.Signal }), t(function(t) { return t.TimelineSignal = function() { var e = t.defaults(arguments, ["value", "units"], t.Signal);
                t.Signal.call(this, e), this._events = new t.Timeline(100), this._initial = this._fromUnits(this._param.value), this.value = e.value, delete this.input }, t.extend(t.TimelineSignal, t.Signal), t.TimelineSignal.Type = { Linear: "linear", Exponential: "exponential", Target: "target", Set: "set" }, Object.defineProperty(t.TimelineSignal.prototype, "value", { get: function() { var t = this.now(),
                        e = this.getValueAtTime(t); return this._toUnits(e) }, set: function(t) { if (this._events) { var e = this._fromUnits(t);
                        this._initial = e, this.cancelScheduledValues(), this._param.value = e } } }), t.TimelineSignal.prototype.setValueAtTime = function(e, i) { return e = this._fromUnits(e), i = this.toSeconds(i), this._events.add({ type: t.TimelineSignal.Type.Set, value: e, time: i }), this._param.setValueAtTime(e, i), this }, t.TimelineSignal.prototype.linearRampToValueAtTime = function(e, i) { return e = this._fromUnits(e), i = this.toSeconds(i), this._events.add({ type: t.TimelineSignal.Type.Linear, value: e, time: i }), this._param.linearRampToValueAtTime(e, i), this }, t.TimelineSignal.prototype.exponentialRampToValueAtTime = function(e, i) { var n, s; return i = this.toSeconds(i), n = this._searchBefore(i), n && 0 === n.value && this.setValueAtTime(this._minOutput, n.time), e = this._fromUnits(e), s = Math.max(e, this._minOutput), this._events.add({ type: t.TimelineSignal.Type.Exponential, value: s, time: i }), e < this._minOutput ? (this._param.exponentialRampToValueAtTime(this._minOutput, i - this.sampleTime), this.setValueAtTime(0, i)) : this._param.exponentialRampToValueAtTime(e, i), this }, t.TimelineSignal.prototype.setTargetAtTime = function(e, i, n) { return e = this._fromUnits(e), e = Math.max(this._minOutput, e), n = Math.max(this._minOutput, n), i = this.toSeconds(i), this._events.add({ type: t.TimelineSignal.Type.Target, value: e, time: i, constant: n }), this._param.setTargetAtTime(e, i, n), this }, t.TimelineSignal.prototype.setValueCurveAtTime = function(e, i, n, s) { var o, r; for (s = t.defaultArg(s, 1), n = this.toSeconds(n), i = this.toSeconds(i), o = n / (e.length - 1), this.setValueAtTime(e[0] * s, i), r = 1; r < e.length; r++) this.linearRampToValueAtTime(e[r] * s, i + r * o); return this }, t.TimelineSignal.prototype.cancelScheduledValues = function(t) { return t = this.toSeconds(t), this._events.cancel(t), this._param.cancelScheduledValues(t), this }, t.TimelineSignal.prototype.cancelAndHoldAtTime = function(t) { return this.setRampPoint(this.toSeconds(t)), this }, t.TimelineSignal.prototype.setRampPoint = function(e) { var i, n, s; return e = this.toSeconds(e), i = this._toUnits(this.getValueAtTime(e)), n = this._searchBefore(e), n && n.time === e ? this.cancelScheduledValues(e + this.sampleTime) : (s = this._searchAfter(e)) && (this.cancelScheduledValues(e), s.type === t.TimelineSignal.Type.Linear ? this.linearRampToValueAtTime(i, e) : s.type === t.TimelineSignal.Type.Exponential && this.exponentialRampToValueAtTime(i, e)), this.setValueAtTime(i, e), this }, t.TimelineSignal.prototype.linearRampToValueBetween = function(t, e, i) { return this.setRampPoint(e), this.linearRampToValueAtTime(t, i), this }, t.TimelineSignal.prototype.exponentialRampToValueBetween = function(t, e, i) { return this.setRampPoint(e), this.exponentialRampToValueAtTime(t, i), this }, t.TimelineSignal.prototype._searchBefore = function(t) { return this._events.get(t) }, t.TimelineSignal.prototype._searchAfter = function(t) { return this._events.getAfter(t) }, t.TimelineSignal.prototype.getValueAtTime = function(e) { var i, n, s, o, r; return e = this.toSeconds(e), i = this._searchAfter(e), n = this._searchBefore(e), s = this._initial, null === n ? s = this._initial : n.type === t.TimelineSignal.Type.Target ? (o = this._events.getBefore(n.time), r = null === o ? this._initial : o.value, s = this._exponentialApproach(n.time, r, n.value, n.constant, e)) : s = null === i ? n.value : i.type === t.TimelineSignal.Type.Linear ? this._linearInterpolate(n.time, n.value, i.time, i.value, e) : i.type === t.TimelineSignal.Type.Exponential ? this._exponentialInterpolate(n.time, n.value, i.time, i.value, e) : n.value, s }, t.TimelineSignal.prototype.connect = t.SignalBase.prototype.connect, t.TimelineSignal.prototype._exponentialApproach = function(t, e, i, n, s) { return i + (e - i) * Math.exp(-(s - t) / n) }, t.TimelineSignal.prototype._linearInterpolate = function(t, e, i, n, s) { return e + (s - t) / (i - t) * (n - e) }, t.TimelineSignal.prototype._exponentialInterpolate = function(t, e, i, n, s) { return (e = Math.max(this._minOutput, e)) * Math.pow(n / e, (s - t) / (i - t)) }, t.TimelineSignal.prototype.dispose = function() { t.Signal.prototype.dispose.call(this), this._events.dispose(), this._events = null }, t.TimelineSignal }), t(function(t) { return t.Pow = function(e) { t.SignalBase.call(this), this._exp = t.defaultArg(e, 1), this._expScaler = this.input = this.output = new t.WaveShaper(this._expFunc(this._exp), 8192) }, t.extend(t.Pow, t.SignalBase), Object.defineProperty(t.Pow.prototype, "value", { get: function() { return this._exp }, set: function(t) { this._exp = t, this._expScaler.setMap(this._expFunc(this._exp)) } }), t.Pow.prototype._expFunc = function(t) { return function(e) { return Math.pow(Math.abs(e), t) } }, t.Pow.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._expScaler.dispose(), this._expScaler = null, this }, t.Pow }), t(function(t) { return t.Envelope = function() { var e = t.defaults(arguments, ["attack", "decay", "sustain", "release"], t.Envelope);
                    t.AudioNode.call(this), this.attack = e.attack, this.decay = e.decay, this.sustain = e.sustain, this.release = e.release, this._attackCurve = "linear", this._releaseCurve = "exponential", this._sig = this.output = new t.Signal(0), this.attackCurve = e.attackCurve, this.releaseCurve = e.releaseCurve }, t.extend(t.Envelope, t.AudioNode), t.Envelope.defaults = { attack: .01, decay: .1, sustain: .5, release: 1, attackCurve: "linear", releaseCurve: "exponential" }, Object.defineProperty(t.Envelope.prototype, "value", { get: function() { return this.getValueAtTime(this.now()) } }), Object.defineProperty(t.Envelope.prototype, "attackCurve", { get: function() { if (t.isString(this._attackCurve)) return this._attackCurve; if (t.isArray(this._attackCurve)) { for (var e in t.Envelope.Type)
                                if (t.Envelope.Type[e].In === this._attackCurve) return e; return this._attackCurve } }, set: function(e) { if (t.Envelope.Type.hasOwnProperty(e)) { var i = t.Envelope.Type[e];
                            t.isObject(i) ? this._attackCurve = i.In : this._attackCurve = i } else { if (!t.isArray(e)) throw new Error("Tone.Envelope: invalid curve: " + e);
                            this._attackCurve = e } } }), Object.defineProperty(t.Envelope.prototype, "releaseCurve", { get: function() { if (t.isString(this._releaseCurve)) return this._releaseCurve; if (t.isArray(this._releaseCurve)) { for (var e in t.Envelope.Type)
                                if (t.Envelope.Type[e].Out === this._releaseCurve) return e; return this._releaseCurve } }, set: function(e) { if (t.Envelope.Type.hasOwnProperty(e)) { var i = t.Envelope.Type[e];
                            t.isObject(i) ? this._releaseCurve = i.Out : this._releaseCurve = i } else { if (!t.isArray(e)) throw new Error("Tone.Envelope: invalid curve: " + e);
                            this._releaseCurve = e } } }), t.Envelope.prototype.triggerAttack = function(e, i) { var n, s, o, r, a, l, h, u, p; return e = this.toSeconds(e), n = this.toSeconds(this.attack), s = n, o = this.toSeconds(this.decay), i = t.defaultArg(i, 1), r = this.getValueAtTime(e), r > 0 && (a = 1 / s, l = 1 - r, s = l / a), "linear" === this._attackCurve ? this._sig.linearRampTo(i, s, e) : "exponential" === this._attackCurve ? this._sig.targetRampTo(i, s, e) : s > 0 && (this._sig.cancelAndHoldAtTime(e), h = this._attackCurve, s < n && (u = 1 - s / n, p = Math.floor(u * this._attackCurve.length), h = this._attackCurve.slice(p), h[0] = r), this._sig.setValueCurveAtTime(h, e, s, i)), o && this._sig.targetRampTo(i * this.sustain, o, s + e), this }, t.Envelope.prototype.triggerRelease = function(e) { var i, n, s; return e = this.toSeconds(e), i = this.getValueAtTime(e), i > 0 && (n = this.toSeconds(this.release), "linear" === this._releaseCurve ? this._sig.linearRampTo(0, n, e) : "exponential" === this._releaseCurve ? this._sig.targetRampTo(0, n, e) : (s = this._releaseCurve, t.isArray(s) && (this._sig.cancelAndHoldAtTime(e), this._sig.setValueCurveAtTime(s, e, n, i)))), this }, t.Envelope.prototype.getValueAtTime = function(t) { return this._sig.getValueAtTime(t) }, t.Envelope.prototype.triggerAttackRelease = function(t, e, i) { return e = this.toSeconds(e), this.triggerAttack(e, i), this.triggerRelease(e + this.toSeconds(t)), this }, t.Envelope.prototype.cancel = function(t) { return this._sig.cancelScheduledValues(t), this }, t.Envelope.prototype.connect = t.Signal.prototype.connect,
                function() {
                    function e(t) { var e, i = new Array(t.length); for (e = 0; e < t.length; e++) i[e] = 1 - t[e]; return i } var i, n, s, o, r, a, l, h, u, p, c, d = 128,
                        f = []; for (i = 0; i < d; i++) f[i] = Math.sin(i / (d - 1) * (Math.PI / 2)); for (s = [], o = 6.4, i = 0; i < d - 1; i++) n = i / (d - 1), r = Math.sin(n * (2 * Math.PI) * o - Math.PI / 2) + 1, s[i] = r / 10 + .83 * n; for (s[d - 1] = 1, a = [], l = 5, i = 0; i < d; i++) a[i] = Math.ceil(i / (d - 1) * l) / l; for (h = [], i = 0; i < d; i++) n = i / (d - 1), h[i] = .5 * (1 - Math.cos(Math.PI * n)); for (u = [], i = 0; i < d; i++) n = i / (d - 1), p = 4 * Math.pow(n, 3) + .2, c = Math.cos(p * Math.PI * 2 * n), u[i] = Math.abs(c * (1 - n));
                    t.Envelope.Type = { linear: "linear", exponential: "exponential", bounce: { In: e(u), Out: u }, cosine: { In: f, Out: function(t) { return t.slice(0).reverse() }(f) }, step: { In: a, Out: e(a) }, ripple: { In: s, Out: e(s) }, sine: { In: h, Out: e(h) } } }(), t.Envelope.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._sig.dispose(), this._sig = null, this._attackCurve = null, this._releaseCurve = null, this }, t.Envelope }), t(function(t) { return t.AmplitudeEnvelope = function() { t.Envelope.apply(this, arguments), this.input = this.output = new t.Gain, this._sig.connect(this.output.gain) }, t.extend(t.AmplitudeEnvelope, t.Envelope), t.AmplitudeEnvelope.prototype.dispose = function() { return t.Envelope.prototype.dispose.call(this), this }, t.AmplitudeEnvelope }), t(function(t) { t.supported && (AnalyserNode.prototype.getFloatTimeDomainData || (AnalyserNode.prototype.getFloatTimeDomainData = function(t) { var e, i = new Uint8Array(t.length); for (this.getByteTimeDomainData(i), e = 0; e < i.length; e++) t[e] = (i[e] - 128) / 128 })) }), t(function(t) { return t.Analyser = function() { var e = t.defaults(arguments, ["type", "size"], t.Analyser);
                t.AudioNode.call(this), this._analyser = this.input = this.output = this.context.createAnalyser(), this._type = e.type, this._buffer = null, this.size = e.size, this.type = e.type }, t.extend(t.Analyser, t.AudioNode), t.Analyser.defaults = { size: 1024, type: "fft", smoothing: .8 }, t.Analyser.Type = { Waveform: "waveform", FFT: "fft" }, t.Analyser.prototype.getValue = function() { return this._type === t.Analyser.Type.FFT ? this._analyser.getFloatFrequencyData(this._buffer) : this._type === t.Analyser.Type.Waveform && this._analyser.getFloatTimeDomainData(this._buffer), this._buffer }, Object.defineProperty(t.Analyser.prototype, "size", { get: function() { return this._analyser.frequencyBinCount }, set: function(t) { this._analyser.fftSize = 2 * t, this._buffer = new Float32Array(t) } }), Object.defineProperty(t.Analyser.prototype, "type", { get: function() { return this._type }, set: function(e) { if (e !== t.Analyser.Type.Waveform && e !== t.Analyser.Type.FFT) throw new TypeError("Tone.Analyser: invalid type: " + e);
                    this._type = e } }), Object.defineProperty(t.Analyser.prototype, "smoothing", { get: function() { return this._analyser.smoothingTimeConstant }, set: function(t) { this._analyser.smoothingTimeConstant = t } }), t.Analyser.prototype.dispose = function() { t.AudioNode.prototype.dispose.call(this), this._analyser.disconnect(), this._analyser = null, this._buffer = null }, t.Analyser }), t(function(t) { return t.Compressor = function() { var e = t.defaults(arguments, ["threshold", "ratio"], t.Compressor);
                t.AudioNode.call(this), this._compressor = this.input = this.output = this.context.createDynamicsCompressor(), this.threshold = new t.Param({ param: this._compressor.threshold, units: t.Type.Decibels, convert: !1 }), this.attack = new t.Param(this._compressor.attack, t.Type.Time), this.release = new t.Param(this._compressor.release, t.Type.Time), this.knee = new t.Param({ param: this._compressor.knee, units: t.Type.Decibels, convert: !1 }), this.ratio = new t.Param({ param: this._compressor.ratio, convert: !1 }), this._readOnly(["knee", "release", "attack", "ratio", "threshold"]), this.set(e) }, t.extend(t.Compressor, t.AudioNode), t.Compressor.defaults = { ratio: 12, threshold: -24, release: .25, attack: .003, knee: 30 }, t.Compressor.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._writable(["knee", "release", "attack", "ratio", "threshold"]), this._compressor.disconnect(), this._compressor = null, this.attack.dispose(), this.attack = null, this.release.dispose(), this.release = null, this.threshold.dispose(), this.threshold = null, this.ratio.dispose(), this.ratio = null, this.knee.dispose(), this.knee = null, this }, t.Compressor }), t(function(t) { return t.Add = function(e) { t.Signal.call(this), this.createInsOuts(2, 0), this._sum = this.input[0] = this.input[1] = this.output = new t.Gain, this._param = this.input[1] = new t.Signal(e), this._param.connect(this._sum) }, t.extend(t.Add, t.Signal), t.Add.prototype.dispose = function() { return t.Signal.prototype.dispose.call(this), this._sum.dispose(), this._sum = null, this }, t.Add }), t(function(t) { return t.Multiply = function(e) { t.Signal.call(this), this.createInsOuts(2, 0), this._mult = this.input[0] = this.output = new t.Gain, this._param = this.input[1] = this.output.gain, this._param.value = t.defaultArg(e, 0) }, t.extend(t.Multiply, t.Signal), t.Multiply.prototype.dispose = function() { return t.Signal.prototype.dispose.call(this), this._mult.dispose(), this._mult = null, this._param = null, this }, t.Multiply }), t(function(t) { return t.Negate = function() { t.SignalBase.call(this), this._multiply = this.input = this.output = new t.Multiply(-1) }, t.extend(t.Negate, t.SignalBase), t.Negate.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._multiply.dispose(), this._multiply = null, this }, t.Negate }), t(function(t) { return t.Subtract = function(e) { t.Signal.call(this), this.createInsOuts(2, 0), this._sum = this.input[0] = this.output = new t.Gain, this._neg = new t.Negate, this._param = this.input[1] = new t.Signal(e), this._param.chain(this._neg, this._sum) }, t.extend(t.Subtract, t.Signal), t.Subtract.prototype.dispose = function() { return t.Signal.prototype.dispose.call(this), this._neg.dispose(), this._neg = null, this._sum.disconnect(), this._sum = null, this }, t.Subtract }), t(function(t) { return t.EqualPowerGain = function() { t.SignalBase.call(this), this._eqPower = this.input = this.output = new t.WaveShaper(function(e) { return Math.abs(e) < .001 ? 0 : t.equalPowerScale(e) }.bind(this), 4096) }, t.extend(t.EqualPowerGain, t.SignalBase), t.EqualPowerGain.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._eqPower.dispose(), this._eqPower = null, this }, t.EqualPowerGain }), t(function(t) { return t.CrossFade = function(e) { t.AudioNode.call(this), this.createInsOuts(2, 1), this.a = this.input[0] = new t.Gain, this.b = this.input[1] = new t.Gain, this.fade = new t.Signal(t.defaultArg(e, .5), t.Type.NormalRange), this._equalPowerA = new t.EqualPowerGain, this._equalPowerB = new t.EqualPowerGain, this._one = this.context.getConstant(1), this._invert = new t.Subtract, this.a.connect(this.output), this.b.connect(this.output), this.fade.chain(this._equalPowerB, this.b.gain), this._one.connect(this._invert, 0, 0), this.fade.connect(this._invert, 0, 1), this._invert.chain(this._equalPowerA, this.a.gain), this._readOnly("fade") }, t.extend(t.CrossFade, t.AudioNode), t.CrossFade.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._writable("fade"), this._equalPowerA.dispose(), this._equalPowerA = null, this._equalPowerB.dispose(), this._equalPowerB = null, this.fade.dispose(), this.fade = null, this._invert.dispose(), this._invert = null, this._one = null, this.a.dispose(), this.a = null, this.b.dispose(), this.b = null, this }, t.CrossFade }), t(function(t) { return t.Filter = function() { var e = t.defaults(arguments, ["frequency", "type", "rolloff"], t.Filter);
                t.AudioNode.call(this), this.createInsOuts(1, 1), this._filters = [], this.frequency = new t.Signal(e.frequency, t.Type.Frequency), this.detune = new t.Signal(0, t.Type.Cents), this.gain = new t.Signal({ value: e.gain, convert: !1 }), this.Q = new t.Signal(e.Q), this._type = e.type, this._rolloff = e.rolloff, this.rolloff = e.rolloff, this._readOnly(["detune", "frequency", "gain", "Q"]) }, t.extend(t.Filter, t.AudioNode), t.Filter.defaults = { type: "lowpass", frequency: 350, rolloff: -12, Q: 1, gain: 0 }, Object.defineProperty(t.Filter.prototype, "type", { get: function() { return this._type }, set: function(t) { var e; if (-1 === ["lowpass", "highpass", "bandpass", "lowshelf", "highshelf", "notch", "allpass", "peaking"].indexOf(t)) throw new TypeError("Tone.Filter: invalid type " + t); for (this._type = t, e = 0; e < this._filters.length; e++) this._filters[e].type = t } }), Object.defineProperty(t.Filter.prototype, "rolloff", { get: function() { return this._rolloff }, set: function(e) { var i, n, s, o, r, a; if (e = parseInt(e, 10), i = [-12, -24, -48, -96], -1 === (n = i.indexOf(e))) throw new RangeError("Tone.Filter: rolloff can only be -12, -24, -48 or -96"); for (n += 1, this._rolloff = e, this.input.disconnect(), s = 0; s < this._filters.length; s++) this._filters[s].disconnect(), this._filters[s] = null; for (this._filters = new Array(n), o = 0; o < n; o++) r = this.context.createBiquadFilter(), r.type = this._type, this.frequency.connect(r.frequency), this.detune.connect(r.detune), this.Q.connect(r.Q), this.gain.connect(r.gain), this._filters[o] = r;
                    a = [this.input].concat(this._filters).concat([this.output]), t.connectSeries.apply(t, a) } }), t.Filter.prototype.dispose = function() { t.AudioNode.prototype.dispose.call(this); for (var e = 0; e < this._filters.length; e++) this._filters[e].disconnect(), this._filters[e] = null; return this._filters = null, this._writable(["detune", "frequency", "gain", "Q"]), this.frequency.dispose(), this.Q.dispose(), this.frequency = null, this.Q = null, this.detune.dispose(), this.detune = null, this.gain.dispose(), this.gain = null, this }, t.Filter }), t(function(t) { return t.MultibandSplit = function() { var e = t.defaults(arguments, ["lowFrequency", "highFrequency"], t.MultibandSplit);
                t.AudioNode.call(this), this.input = new t.Gain, this.output = new Array(3), this.low = this.output[0] = new t.Filter(0, "lowpass"), this._lowMidFilter = new t.Filter(0, "highpass"), this.mid = this.output[1] = new t.Filter(0, "lowpass"), this.high = this.output[2] = new t.Filter(0, "highpass"), this.lowFrequency = new t.Signal(e.lowFrequency, t.Type.Frequency), this.highFrequency = new t.Signal(e.highFrequency, t.Type.Frequency), this.Q = new t.Signal(e.Q), this.input.fan(this.low, this.high), this.input.chain(this._lowMidFilter, this.mid), this.lowFrequency.connect(this.low.frequency), this.lowFrequency.connect(this._lowMidFilter.frequency), this.highFrequency.connect(this.mid.frequency), this.highFrequency.connect(this.high.frequency), this.Q.connect(this.low.Q), this.Q.connect(this._lowMidFilter.Q), this.Q.connect(this.mid.Q), this.Q.connect(this.high.Q), this._readOnly(["high", "mid", "low", "highFrequency", "lowFrequency"]) }, t.extend(t.MultibandSplit, t.AudioNode), t.MultibandSplit.defaults = { lowFrequency: 400, highFrequency: 2500, Q: 1 }, t.MultibandSplit.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._writable(["high", "mid", "low", "highFrequency", "lowFrequency"]), this.low.dispose(), this.low = null, this._lowMidFilter.dispose(), this._lowMidFilter = null, this.mid.dispose(), this.mid = null, this.high.dispose(), this.high = null, this.lowFrequency.dispose(), this.lowFrequency = null, this.highFrequency.dispose(), this.highFrequency = null, this.Q.dispose(), this.Q = null, this }, t.MultibandSplit }), t(function(t) { return t.EQ3 = function() { var e = t.defaults(arguments, ["low", "mid", "high"], t.EQ3);
                t.AudioNode.call(this), this.output = new t.Gain, this._multibandSplit = this.input = new t.MultibandSplit({ lowFrequency: e.lowFrequency, highFrequency: e.highFrequency }), this._lowGain = new t.Gain(e.low, t.Type.Decibels), this._midGain = new t.Gain(e.mid, t.Type.Decibels), this._highGain = new t.Gain(e.high, t.Type.Decibels), this.low = this._lowGain.gain, this.mid = this._midGain.gain, this.high = this._highGain.gain, this.Q = this._multibandSplit.Q, this.lowFrequency = this._multibandSplit.lowFrequency, this.highFrequency = this._multibandSplit.highFrequency, this._multibandSplit.low.chain(this._lowGain, this.output), this._multibandSplit.mid.chain(this._midGain, this.output), this._multibandSplit.high.chain(this._highGain, this.output), this._readOnly(["low", "mid", "high", "lowFrequency", "highFrequency"]) }, t.extend(t.EQ3, t.AudioNode), t.EQ3.defaults = { low: 0, mid: 0, high: 0, lowFrequency: 400, highFrequency: 2500 }, t.EQ3.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._writable(["low", "mid", "high", "lowFrequency", "highFrequency"]), this._multibandSplit.dispose(), this._multibandSplit = null, this.lowFrequency = null, this.highFrequency = null, this._lowGain.dispose(), this._lowGain = null, this._midGain.dispose(), this._midGain = null, this._highGain.dispose(), this._highGain = null, this.low = null, this.mid = null, this.high = null, this.Q = null, this }, t.EQ3 }), t(function(t) { return t.Scale = function(e, i) { t.SignalBase.call(this), this._outputMin = t.defaultArg(e, 0), this._outputMax = t.defaultArg(i, 1), this._scale = this.input = new t.Multiply(1), this._add = this.output = new t.Add(0), this._scale.connect(this._add), this._setRange() }, t.extend(t.Scale, t.SignalBase), Object.defineProperty(t.Scale.prototype, "min", { get: function() { return this._outputMin }, set: function(t) { this._outputMin = t, this._setRange() } }), Object.defineProperty(t.Scale.prototype, "max", { get: function() { return this._outputMax }, set: function(t) { this._outputMax = t, this._setRange() } }), t.Scale.prototype._setRange = function() { this._add.value = this._outputMin, this._scale.value = this._outputMax - this._outputMin }, t.Scale.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._add.dispose(), this._add = null, this._scale.dispose(), this._scale = null, this }, t.Scale }), t(function(t) { return t.ScaleExp = function(e, i, n) { t.SignalBase.call(this), this._scale = this.output = new t.Scale(e, i), this._exp = this.input = new t.Pow(t.defaultArg(n, 2)), this._exp.connect(this._scale) }, t.extend(t.ScaleExp, t.SignalBase), Object.defineProperty(t.ScaleExp.prototype, "exponent", { get: function() { return this._exp.value }, set: function(t) { this._exp.value = t } }), Object.defineProperty(t.ScaleExp.prototype, "min", { get: function() { return this._scale.min }, set: function(t) { this._scale.min = t } }), Object.defineProperty(t.ScaleExp.prototype, "max", { get: function() { return this._scale.max }, set: function(t) { this._scale.max = t } }), t.ScaleExp.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._scale.dispose(), this._scale = null, this._exp.dispose(), this._exp = null, this }, t.ScaleExp }), t(function(t) { return t.Delay = function() { var e = t.defaults(arguments, ["delayTime", "maxDelay"], t.Delay);
                t.AudioNode.call(this), this._delayNode = this.input = this.output = this.context.createDelay(this.toSeconds(e.maxDelay)), this.delayTime = new t.Param({ param: this._delayNode.delayTime, units: t.Type.Time, value: e.delayTime }), this._readOnly("delayTime") }, t.extend(t.Delay, t.AudioNode), t.Delay.defaults = { maxDelay: 1, delayTime: 0 }, t.Delay.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._delayNode.disconnect(), this._delayNode = null, this._writable("delayTime"), this.delayTime = null, this }, t.Delay }), t(function(t) {
            return t.FeedbackCombFilter = function() { var e = t.defaults(arguments, ["delayTime", "resonance"], t.FeedbackCombFilter);
                t.AudioNode.call(this), this._delay = this.input = this.output = new t.Delay(e.delayTime), this.delayTime = this._delay.delayTime, this._feedback = new t.Gain(e.resonance, t.Type.NormalRange), this.resonance = this._feedback.gain, this._delay.chain(this._feedback, this._delay), this._readOnly(["resonance", "delayTime"]) }, t.extend(t.FeedbackCombFilter, t.AudioNode), t.FeedbackCombFilter.defaults = { delayTime: .1, resonance: .5 }, t.FeedbackCombFilter.prototype.dispose = function() {
                return t.AudioNode.prototype.dispose.call(this), this._writable(["resonance", "delayTime"]), this._delay.dispose(), this._delay = null, this.delayTime = null, this._feedback.dispose(), this._feedback = null, this.resonance = null, this
            }, t.FeedbackCombFilter
        }), t(function(t) { return t.FFT = function() { var e = t.defaults(arguments, ["size"], t.FFT);
                e.type = t.Analyser.Type.FFT, t.AudioNode.call(this), this._analyser = this.input = this.output = new t.Analyser(e) }, t.extend(t.FFT, t.AudioNode), t.FFT.defaults = { size: 1024 }, t.FFT.prototype.getValue = function() { return this._analyser.getValue() }, Object.defineProperty(t.FFT.prototype, "size", { get: function() { return this._analyser.size }, set: function(t) { this._analyser.size = t } }), t.FFT.prototype.dispose = function() { t.AudioNode.prototype.dispose.call(this), this._analyser.dispose(), this._analyser = null }, t.FFT }), t(function(t) { return t.Abs = function() { t.SignalBase.call(this), this._abs = this.input = this.output = new t.WaveShaper(function(t) { return Math.abs(t) < .001 ? 0 : Math.abs(t) }, 1024) }, t.extend(t.Abs, t.SignalBase), t.Abs.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._abs.dispose(), this._abs = null, this }, t.Abs }), t(function(t) { return t.Follower = function() { var e = t.defaults(arguments, ["attack", "release"], t.Follower);
                t.AudioNode.call(this), this.createInsOuts(1, 1), this._abs = new t.Abs, this._filter = this.context.createBiquadFilter(), this._filter.type = "lowpass", this._filter.frequency.value = 0, this._filter.Q.value = -100, this._frequencyValues = new t.WaveShaper, this._sub = new t.Subtract, this._delay = new t.Delay(this.blockTime), this._mult = new t.Multiply(1e4), this._attack = e.attack, this._release = e.release, this.input.chain(this._abs, this._filter, this.output), this._abs.connect(this._sub, 0, 1), this._filter.chain(this._delay, this._sub), this._sub.chain(this._mult, this._frequencyValues, this._filter.frequency), this._setAttackRelease(this._attack, this._release) }, t.extend(t.Follower, t.AudioNode), t.Follower.defaults = { attack: .05, release: .5 }, t.Follower.prototype._setAttackRelease = function(e, i) { var n = this.blockTime;
                e = t.Time(e).toFrequency(), i = t.Time(i).toFrequency(), e = Math.max(e, n), i = Math.max(i, n), this._frequencyValues.setMap(function(t) { return t <= 0 ? e : i }) }, Object.defineProperty(t.Follower.prototype, "attack", { get: function() { return this._attack }, set: function(t) { this._attack = t, this._setAttackRelease(this._attack, this._release) } }), Object.defineProperty(t.Follower.prototype, "release", { get: function() { return this._release }, set: function(t) { this._release = t, this._setAttackRelease(this._attack, this._release) } }), t.Follower.prototype.connect = t.Signal.prototype.connect, t.Follower.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._filter.disconnect(), this._filter = null, this._frequencyValues.disconnect(), this._frequencyValues = null, this._delay.dispose(), this._delay = null, this._sub.disconnect(), this._sub = null, this._abs.dispose(), this._abs = null, this._mult.dispose(), this._mult = null, this._curve = null, this }, t.Follower }), t(function(t) { return t.ScaledEnvelope = function() { var e = t.defaults(arguments, ["attack", "decay", "sustain", "release"], t.Envelope);
                t.Envelope.call(this, e), e = t.defaultArg(e, t.ScaledEnvelope.defaults), this._exp = this.output = new t.Pow(e.exponent), this._scale = this.output = new t.Scale(e.min, e.max), this._sig.chain(this._exp, this._scale) }, t.extend(t.ScaledEnvelope, t.Envelope), t.ScaledEnvelope.defaults = { min: 0, max: 1, exponent: 1 }, Object.defineProperty(t.ScaledEnvelope.prototype, "min", { get: function() { return this._scale.min }, set: function(t) { this._scale.min = t } }), Object.defineProperty(t.ScaledEnvelope.prototype, "max", { get: function() { return this._scale.max }, set: function(t) { this._scale.max = t } }), Object.defineProperty(t.ScaledEnvelope.prototype, "exponent", { get: function() { return this._exp.value }, set: function(t) { this._exp.value = t } }), t.ScaledEnvelope.prototype.dispose = function() { return t.Envelope.prototype.dispose.call(this), this._scale.dispose(), this._scale = null, this._exp.dispose(), this._exp = null, this }, t.ScaledEnvelope }), t(function(t) { return t.FrequencyEnvelope = function() { var e = t.defaults(arguments, ["attack", "decay", "sustain", "release"], t.Envelope);
                t.ScaledEnvelope.call(this, e), e = t.defaultArg(e, t.FrequencyEnvelope.defaults), this._octaves = e.octaves, this.baseFrequency = e.baseFrequency, this.octaves = e.octaves }, t.extend(t.FrequencyEnvelope, t.Envelope), t.FrequencyEnvelope.defaults = { baseFrequency: 200, octaves: 4, exponent: 2 }, Object.defineProperty(t.FrequencyEnvelope.prototype, "baseFrequency", { get: function() { return this._scale.min }, set: function(t) { this._scale.min = this.toFrequency(t), this.octaves = this._octaves } }), Object.defineProperty(t.FrequencyEnvelope.prototype, "octaves", { get: function() { return this._octaves }, set: function(t) { this._octaves = t, this._scale.max = this.baseFrequency * Math.pow(2, t) } }), Object.defineProperty(t.FrequencyEnvelope.prototype, "exponent", { get: function() { return this._exp.value }, set: function(t) { this._exp.value = t } }), t.FrequencyEnvelope.prototype.dispose = function() { return t.ScaledEnvelope.prototype.dispose.call(this), this }, t.FrequencyEnvelope }), t(function(t) { return t.GreaterThanZero = function() { t.SignalBase.call(this), this._thresh = this.output = new t.WaveShaper(function(t) { return t <= 0 ? 0 : 1 }, 127), this._scale = this.input = new t.Multiply(1e4), this._scale.connect(this._thresh) }, t.extend(t.GreaterThanZero, t.SignalBase), t.GreaterThanZero.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._scale.dispose(), this._scale = null, this._thresh.dispose(), this._thresh = null, this }, t.GreaterThanZero }), t(function(t) { return t.GreaterThan = function(e) { t.Signal.call(this), this.createInsOuts(2, 0), this._param = this.input[0] = new t.Subtract(e), this.input[1] = this._param.input[1], this._gtz = this.output = new t.GreaterThanZero, this._param.connect(this._gtz) }, t.extend(t.GreaterThan, t.Signal), t.GreaterThan.prototype.dispose = function() { return t.Signal.prototype.dispose.call(this), this._gtz.dispose(), this._gtz = null, this }, t.GreaterThan }), t(function(t) { return t.Gate = function() { var e = t.defaults(arguments, ["threshold", "attack", "release"], t.Gate);
                t.AudioNode.call(this), this.createInsOuts(1, 1), this._follower = new t.Follower(e.attack, e.release), this._gt = new t.GreaterThan(t.dbToGain(e.threshold)), this.input.connect(this.output), this.input.chain(this._gt, this._follower, this.output.gain) }, t.extend(t.Gate, t.AudioNode), t.Gate.defaults = { attack: .1, release: .1, threshold: -40 }, Object.defineProperty(t.Gate.prototype, "threshold", { get: function() { return t.gainToDb(this._gt.value) }, set: function(e) { this._gt.value = t.dbToGain(e) } }), Object.defineProperty(t.Gate.prototype, "attack", { get: function() { return this._follower.attack }, set: function(t) { this._follower.attack = t } }), Object.defineProperty(t.Gate.prototype, "release", { get: function() { return this._follower.release }, set: function(t) { this._follower.release = t } }), t.Gate.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._follower.dispose(), this._gt.dispose(), this._follower = null, this._gt = null, this }, t.Gate }), t(function(t) {
            function e(t) { return function(e, i) { var n, s, o; return i = this.toSeconds(i), t.apply(this, arguments), n = this._events.get(i), s = this._events.previousEvent(n), o = this._getTickUntilEvent(s, i - this.sampleTime), n.ticks = Math.max(o, 0), this } } return t.TickSignal = function(e) { e = t.defaultArg(e, 1), t.TimelineSignal.call(this, { units: t.Type.Ticks, value: e }), this._events.memory = 1 / 0 }, t.extend(t.TickSignal, t.TimelineSignal), t.TickSignal.prototype.setValueAtTime = e(t.TimelineSignal.prototype.setValueAtTime), t.TickSignal.prototype.linearRampToValueAtTime = e(t.TimelineSignal.prototype.linearRampToValueAtTime), t.TickSignal.prototype.setTargetAtTime = function(t, e, i) { var n, s, o, r, a; for (e = this.toSeconds(e), this.setRampPoint(e), t = this._fromUnits(t), n = this._events.get(e), s = 5, o = 0; o <= s; o++) r = i * o + e, a = this._exponentialApproach(n.time, n.value, t, i, r), this.linearRampToValueAtTime(this._toUnits(a), r); return this }, t.TickSignal.prototype.exponentialRampToValueAtTime = function(t, e) { var i, n, s, o, r, a; for (e = this.toSeconds(e), t = this._fromUnits(t), i = this._events.get(e), null === i && (i = { value: this._initial, time: 0 }), n = 5, s = (e - i.time) / n, o = 0; o <= n; o++) r = s * o + i.time, a = this._exponentialInterpolate(i.time, i.value, e, t, r), this.linearRampToValueAtTime(this._toUnits(a), r); return this }, t.TickSignal.prototype._getTickUntilEvent = function(t, e) { var i, n; return null === t && (t = { ticks: 0, time: 0 }), i = this.getValueAtTime(t.time), n = this.getValueAtTime(e), .5 * (e - t.time) * (i + n) + t.ticks }, t.TickSignal.prototype.getTickAtTime = function(t) { t = this.toSeconds(t); var e = this._events.get(t); return this._getTickUntilEvent(e, t) }, t.TickSignal.prototype.getDurationOfTicks = function(t, e) { e = this.toSeconds(e); var i = this.getTickAtTime(e); return this.getTimeOfTick(i + t) - e }, t.TickSignal.prototype.getTimeOfTick = function(e) { var i, n, s, o, r, a, l = this._events.get(e, "ticks"),
                    h = this._events.getAfter(e, "ticks"); return l && l.ticks === e ? l.time : l && h && h.type === t.TimelineSignal.Type.Linear && l.value !== h.value ? (i = this.getValueAtTime(l.time), n = this.getValueAtTime(h.time), s = (n - i) / (h.time - l.time), o = Math.sqrt(Math.pow(i, 2) - 2 * s * (l.ticks - e)), r = (-i + o) / s, a = (-i - o) / s, (r > 0 ? r : a) + l.time) : l ? 0 === l.value ? 1 / 0 : l.time + (e - l.ticks) / l.value : e / this._initial }, t.TickSignal }), t(function(t) { return t.TimelineState = function(e) { t.Timeline.call(this), this._initial = e }, t.extend(t.TimelineState, t.Timeline), t.TimelineState.prototype.getValueAtTime = function(t) { var e = this.get(t); return null !== e ? e.state : this._initial }, t.TimelineState.prototype.setStateAtTime = function(t, e) { return this.add({ state: t, time: e }), this }, t.TimelineState }), t(function(t) { return t.Clock = function() { var e = t.defaults(arguments, ["callback", "frequency"], t.Clock);
                t.Emitter.call(this), this.callback = e.callback, this._nextTick = 0, this._lastState = t.State.Stopped, this.frequency = new t.TickSignal(e.frequency, t.Type.Frequency), this._readOnly("frequency"), this.ticks = 0, this._state = new t.TimelineState(t.State.Stopped), this._boundLoop = this._loop.bind(this), this.context.on("tick", this._boundLoop) }, t.extend(t.Clock, t.Emitter), t.Clock.defaults = { callback: t.noOp, frequency: 1 }, Object.defineProperty(t.Clock.prototype, "state", { get: function() { return this._state.getValueAtTime(this.now()) } }), t.Clock.prototype.start = function(e, i) { return e = this.toSeconds(e), this._state.getValueAtTime(e) !== t.State.Started && (this._state.setStateAtTime(t.State.Started, e), this._state.get(e).offset = i), this }, t.Clock.prototype.stop = function(e) { return e = this.toSeconds(e), this._state.cancel(e), this._state.setStateAtTime(t.State.Stopped, e), this }, t.Clock.prototype.pause = function(e) { return e = this.toSeconds(e), this._state.getValueAtTime(e) === t.State.Started && this._state.setStateAtTime(t.State.Paused, e), this }, t.Clock.prototype._loop = function() { var e, i = this.now() + this.context.updateInterval,
                    n = this._state.get(i); if (n) { if (n.state !== this._lastState) switch (this._lastState = n.state, n.state) {
                        case t.State.Started:
                            t.isUndef(n.offset) || (this.ticks = n.offset), this._nextTick = n.time, this.emit("start", n.time, this.ticks); break;
                        case t.State.Stopped:
                            this.ticks = 0, this.emit("stop", n.time); break;
                        case t.State.Paused:
                            this.emit("pause", n.time) }
                    for (; i > this._nextTick && this._state;)
                        if (e = this._nextTick, this.frequency && (this._nextTick += this.frequency.getDurationOfTicks(1, this._nextTick), n.state === t.State.Started)) try { this.callback(e), this.ticks++ } catch (t) { throw this.ticks++, t } } }, t.Clock.prototype.getStateAtTime = function(t) { return t = this.toSeconds(t), this._state.getValueAtTime(t) }, t.Clock.prototype.dispose = function() { t.Emitter.prototype.dispose.call(this), this.context.off("tick", this._boundLoop), this._writable("frequency"), this.frequency.dispose(), this.frequency = null, this._boundLoop = null, this._nextTick = 1 / 0, this.callback = null, this._state.dispose(), this._state = null }, t.Clock }), t(function(t) { t.IntervalTimeline = function() { t.call(this), this._root = null, this._length = 0 }, t.extend(t.IntervalTimeline), t.IntervalTimeline.prototype.add = function(i) { if (t.isUndef(i.time) || t.isUndef(i.duration)) throw new Error("Tone.IntervalTimeline: events must have time and duration parameters"); var n = new e(i.time, i.time + i.duration, i); for (null === this._root ? this._root = n : this._root.insert(n), this._length++; null !== n;) n.updateHeight(), n.updateMax(), this._rebalance(n), n = n.parent; return this }, t.IntervalTimeline.prototype.remove = function(t) { var e, i, n; if (null !== this._root)
                    for (e = [], this._root.search(t.time, e), i = 0; i < e.length; i++)
                        if (n = e[i], n.event === t) { this._removeNode(n), this._length--; break } return this }, Object.defineProperty(t.IntervalTimeline.prototype, "length", { get: function() { return this._length } }), t.IntervalTimeline.prototype.cancel = function(t) { return this.forEachAfter(t, function(t) { this.remove(t) }.bind(this)), this }, t.IntervalTimeline.prototype._setRoot = function(t) { this._root = t, null !== this._root && (this._root.parent = null) }, t.IntervalTimeline.prototype._replaceNodeInParent = function(t, e) { null !== t.parent ? (t.isLeftChild() ? t.parent.left = e : t.parent.right = e, this._rebalance(t.parent)) : this._setRoot(e) }, t.IntervalTimeline.prototype._removeNode = function(t) { var e, i; if (null === t.left && null === t.right) this._replaceNodeInParent(t, null);
                else if (null === t.right) this._replaceNodeInParent(t, t.left);
                else if (null === t.left) this._replaceNodeInParent(t, t.right);
                else { if (t.getBalance() > 0)
                        if (null === t.left.right) e = t.left, e.right = t.right, i = e;
                        else { for (e = t.left.right; null !== e.right;) e = e.right;
                            e.parent.right = e.left, i = e.parent, e.left = t.left, e.right = t.right } else if (null === t.right.left) e = t.right, e.left = t.left, i = e;
                    else { for (e = t.right.left; null !== e.left;) e = e.left;
                        e.parent = e.parent, e.parent.left = e.right, i = e.parent, e.left = t.left, e.right = t.right } null !== t.parent ? t.isLeftChild() ? t.parent.left = e : t.parent.right = e : this._setRoot(e), this._rebalance(i) } t.dispose() }, t.IntervalTimeline.prototype._rotateLeft = function(t) { var e = t.parent,
                    i = t.isLeftChild(),
                    n = t.right;
                t.right = n.left, n.left = t, null !== e ? i ? e.left = n : e.right = n : this._setRoot(n) }, t.IntervalTimeline.prototype._rotateRight = function(t) { var e = t.parent,
                    i = t.isLeftChild(),
                    n = t.left;
                t.left = n.right, n.right = t, null !== e ? i ? e.left = n : e.right = n : this._setRoot(n) }, t.IntervalTimeline.prototype._rebalance = function(t) { var e = t.getBalance();
                e > 1 ? t.left.getBalance() < 0 ? this._rotateLeft(t.left) : this._rotateRight(t) : e < -1 && (t.right.getBalance() > 0 ? this._rotateRight(t.right) : this._rotateLeft(t)) }, t.IntervalTimeline.prototype.get = function(t) { var e, i, n; if (null !== this._root && (e = [], this._root.search(t, e), e.length > 0)) { for (i = e[0], n = 1; n < e.length; n++) e[n].low > i.low && (i = e[n]); return i.event } return null }, t.IntervalTimeline.prototype.forEach = function(t) { var e, i, n; if (null !== this._root)
                    for (e = [], this._root.traverse(function(t) { e.push(t) }), i = 0; i < e.length; i++)(n = e[i].event) && t(n); return this }, t.IntervalTimeline.prototype.forEachAtTime = function(t, e) { var i, n, s; if (null !== this._root)
                    for (i = [], this._root.search(t, i), n = i.length - 1; n >= 0; n--)(s = i[n].event) && e(s); return this }, t.IntervalTimeline.prototype.forEachAfter = function(t, e) { var i, n, s; if (null !== this._root)
                    for (i = [], this._root.searchAfter(t, i), n = i.length - 1; n >= 0; n--) s = i[n].event, e(s); return this }, t.IntervalTimeline.prototype.dispose = function() { var t, e = []; for (null !== this._root && this._root.traverse(function(t) { e.push(t) }), t = 0; t < e.length; t++) e[t].dispose(); return e = null, this._root = null, this }; var e = function(t, e, i) { this.event = i, this.low = t, this.high = e, this.max = this.high, this._left = null, this._right = null, this.parent = null, this.height = 0 }; return e.prototype.insert = function(t) { t.low <= this.low ? null === this.left ? this.left = t : this.left.insert(t) : null === this.right ? this.right = t : this.right.insert(t) }, e.prototype.search = function(t, e) { t > this.max || (null !== this.left && this.left.search(t, e), this.low <= t && this.high > t && e.push(this), this.low > t || null !== this.right && this.right.search(t, e)) }, e.prototype.searchAfter = function(t, e) { this.low >= t && (e.push(this), null !== this.left && this.left.searchAfter(t, e)), null !== this.right && this.right.searchAfter(t, e) }, e.prototype.traverse = function(t) { t(this), null !== this.left && this.left.traverse(t), null !== this.right && this.right.traverse(t) }, e.prototype.updateHeight = function() { null !== this.left && null !== this.right ? this.height = Math.max(this.left.height, this.right.height) + 1 : null !== this.right ? this.height = this.right.height + 1 : null !== this.left ? this.height = this.left.height + 1 : this.height = 0 }, e.prototype.updateMax = function() { this.max = this.high, null !== this.left && (this.max = Math.max(this.max, this.left.max)), null !== this.right && (this.max = Math.max(this.max, this.right.max)) }, e.prototype.getBalance = function() { var t = 0; return null !== this.left && null !== this.right ? t = this.left.height - this.right.height : null !== this.left ? t = this.left.height + 1 : null !== this.right && (t = -(this.right.height + 1)), t }, e.prototype.isLeftChild = function() { return null !== this.parent && this.parent.left === this }, Object.defineProperty(e.prototype, "left", { get: function() { return this._left }, set: function(t) { this._left = t, null !== t && (t.parent = this), this.updateHeight(), this.updateMax() } }), Object.defineProperty(e.prototype, "right", { get: function() { return this._right }, set: function(t) { this._right = t, null !== t && (t.parent = this), this.updateHeight(), this.updateMax() } }), e.prototype.dispose = function() { this.parent = null, this._left = null, this._right = null, this.event = null }, t.IntervalTimeline }), t(function(t) { return t.TransportEvent = function(e, i) { i = t.defaultArg(i, t.TransportEvent.defaults), t.call(this), this.Transport = e, this.id = t.TransportEvent._eventId++, this.time = i.time, this.callback = i.callback, this._once = i.once }, t.extend(t.TransportEvent), t.TransportEvent.defaults = { once: !1, callback: t.noOp }, t.TransportEvent._eventId = 0, t.TransportEvent.prototype.invoke = function(t) { this.callback && (this.callback(t), this._once && this.Transport && this.Transport.clear(this.id)) }, t.TransportEvent.prototype.dispose = function() { return t.prototype.dispose.call(this), this.Transport = null, this.callback = null, this }, t.TransportEvent }), t(function(t) { return t.TransportRepeatEvent = function(e, i) { t.TransportEvent.call(this, e, i), i = t.defaultArg(i, t.TransportRepeatEvent.defaults), this.duration = i.duration, this._interval = i.interval, this._currentId = -1, this._nextId = -1, this._nextTick = this.time, this._boundRestart = this._restart.bind(this), this.Transport.on("start loopStart", this._boundRestart), this._restart() }, t.extend(t.TransportRepeatEvent, t.TransportEvent), t.TransportRepeatEvent.defaults = { duration: 1 / 0, interval: 1 }, t.TransportRepeatEvent.prototype.invoke = function(e) { this._createEvents(), t.TransportEvent.prototype.invoke.call(this, e) }, t.TransportRepeatEvent.prototype._createEvents = function() { var e = this.Transport.ticks;
                e >= this.time && e >= this._nextTick && this._nextTick + this._interval < this.time + this.duration && (this._nextTick += this._interval, this._currentId = this._nextId, this._nextId = this.Transport.scheduleOnce(this.invoke.bind(this), t.TransportTime(this._nextTick, "i"))) }, t.TransportRepeatEvent.prototype._restart = function() { this.Transport.clear(this._currentId), this.Transport.clear(this._nextId); var e = this.Transport.ticks;
                this._nextTick = this.time, e > this.time && (this._nextTick = this.time + Math.ceil((e - this.time) / this._interval) * this._interval), this._currentId = this.Transport.scheduleOnce(this.invoke.bind(this), t.TransportTime(this._nextTick, "i")), this._nextTick += this._interval, this._nextId = this.Transport.scheduleOnce(this.invoke.bind(this), t.TransportTime(this._nextTick, "i")) }, t.TransportRepeatEvent.prototype.dispose = function() { return this.Transport.clear(this._currentId), this.Transport.clear(this._nextId), this.Transport.off("start loopStart", this._boundRestart), this._boundCreateEvents = null, t.TransportEvent.prototype.dispose.call(this), this }, t.TransportRepeatEvent }), t(function(t) { t.Transport = function() { t.Emitter.call(this), t.getContext(function() { this.loop = !1, this._loopStart = 0, this._loopEnd = 0, this._ppq = e.defaults.PPQ, this._clock = new t.Clock({ callback: this._processTick.bind(this), frequency: 0 }), this._bindClockEvents(), this.bpm = this._clock.frequency, this.bpm._toUnits = this._toUnits.bind(this), this.bpm._fromUnits = this._fromUnits.bind(this), this.bpm.units = t.Type.BPM, this.bpm.value = e.defaults.bpm, this._readOnly("bpm"), this._timeSignature = e.defaults.timeSignature, this._scheduledEvents = {}, this._timeline = new t.Timeline, this._repeatedEvents = new t.IntervalTimeline, this._syncedSignals = [], this._swingTicks = e.defaults.PPQ / 2, this._swingAmount = 0 }.bind(this)) }, t.extend(t.Transport, t.Emitter), t.Transport.defaults = { bpm: 120, swing: 0, swingSubdivision: "8n", timeSignature: 4, loopStart: 0, loopEnd: "4m", PPQ: 192 }, t.Transport.prototype._processTick = function(e) { var i, n, s = this._clock.ticks;
                this._swingAmount > 0 && s % this._ppq != 0 && s % (2 * this._swingTicks) != 0 && (i = s % (2 * this._swingTicks) / (2 * this._swingTicks), n = Math.sin(i * Math.PI) * this._swingAmount, e += t.Time(2 * this._swingTicks / 3, "i") * n), this.loop && s >= this._loopEnd && (this.emit("loopEnd", e), this._clock.ticks = this._loopStart, s = this._loopStart, this.emit("loopStart", e, this.seconds), this.emit("loop", e)), this._timeline.forEachAtTime(s, function(t) { t.invoke(e) }) }, t.Transport.prototype.schedule = function(e, i) { var n = new t.TransportEvent(this, { time: this.toTicks(i), callback: e }); return this._addEvent(n, this._timeline) }, t.Transport.prototype.scheduleRepeat = function(e, i, n, s) { var o = new t.TransportRepeatEvent(this, { callback: e, interval: this.toTicks(i), time: this.toTicks(n), duration: this.toTicks(t.defaultArg(s, 1 / 0)) }); return this._addEvent(o, this._repeatedEvents) }, t.Transport.prototype.scheduleOnce = function(e, i) { var n = new t.TransportEvent(this, { time: this.toTicks(i), callback: e, once: !0 }); return this._addEvent(n, this._timeline) }, t.Transport.prototype.clear = function(t) { if (this._scheduledEvents.hasOwnProperty(t)) { var e = this._scheduledEvents[t.toString()];
                    e.timeline.remove(e.event), e.event.dispose(), delete this._scheduledEvents[t.toString()] } return this }, t.Transport.prototype._addEvent = function(t, e) { return this._scheduledEvents[t.id.toString()] = { event: t, timeline: e }, e.add(t), t.id }, t.Transport.prototype.cancel = function(e) { return e = t.defaultArg(e, 0), e = this.toTicks(e), this._timeline.cancel(e), this._repeatedEvents.cancel(e), this }, t.Transport.prototype._bindClockEvents = function() { this._clock.on("start", function(e, i) { i = t.Time(this._clock.ticks, "i").toSeconds(), this.emit("start", e, i) }.bind(this)), this._clock.on("stop", function(t) { this.emit("stop", t) }.bind(this)), this._clock.on("pause", function(t) { this.emit("pause", t) }.bind(this)) }, Object.defineProperty(t.Transport.prototype, "state", { get: function() { return this._clock.getStateAtTime(this.now()) } }), t.Transport.prototype.start = function(e, i) { return t.isUndef(i) || (i = this.toTicks(i)), this._clock.start(e, i), this }, t.Transport.prototype.stop = function(t) { return this._clock.stop(t), this }, t.Transport.prototype.pause = function(t) { return this._clock.pause(t), this }, t.Transport.prototype.toggle = function(e) { return e = this.toSeconds(e), this._clock.getStateAtTime(e) !== t.State.Started ? this.start(e) : this.stop(e), this }, Object.defineProperty(t.Transport.prototype, "timeSignature", { get: function() { return this._timeSignature }, set: function(e) { t.isArray(e) && (e = e[0] / e[1] * 4), this._timeSignature = e } }), Object.defineProperty(t.Transport.prototype, "loopStart", { get: function() { return t.TransportTime(this._loopStart, "i").toSeconds() }, set: function(t) { this._loopStart = this.toTicks(t) } }), Object.defineProperty(t.Transport.prototype, "loopEnd", { get: function() { return t.TransportTime(this._loopEnd, "i").toSeconds() }, set: function(t) { this._loopEnd = this.toTicks(t) } }), t.Transport.prototype.setLoopPoints = function(t, e) { return this.loopStart = t, this.loopEnd = e, this }, Object.defineProperty(t.Transport.prototype, "swing", { get: function() { return this._swingAmount }, set: function(t) { this._swingAmount = t } }), Object.defineProperty(t.Transport.prototype, "swingSubdivision", { get: function() { return t.Time(this._swingTicks, "i").toNotation() }, set: function(t) { this._swingTicks = this.toTicks(t) } }), Object.defineProperty(t.Transport.prototype, "position", { get: function() { return t.TransportTime(this.ticks, "i").toBarsBeatsSixteenths() }, set: function(t) { var e = this.toTicks(t);
                    this.ticks = e } }), Object.defineProperty(t.Transport.prototype, "seconds", { get: function() { return t.TransportTime(this.ticks, "i").toSeconds() }, set: function(t) { var e = this.toTicks(t);
                    this.ticks = e } }), Object.defineProperty(t.Transport.prototype, "progress", { get: function() { return this.loop ? (this.ticks - this._loopStart) / (this._loopEnd - this._loopStart) : 0 } }), Object.defineProperty(t.Transport.prototype, "ticks", { get: function() { return this._clock.ticks }, set: function(e) { if (this._clock.ticks !== e) { var i = this.now();
                        this.state === t.State.Started ? (this.emit("stop", i), this._clock.ticks = e, this.emit("start", i, this.seconds)) : this._clock.ticks = e } } }), Object.defineProperty(t.Transport.prototype, "PPQ", { get: function() { return this._ppq }, set: function(t) { var e = this.bpm.value;
                    this._ppq = t, this.bpm.value = e } }), t.Transport.prototype._fromUnits = function(t) { return 1 / (60 / t / this.PPQ) }, t.Transport.prototype._toUnits = function(t) { return t / this.PPQ * 60 }, t.Transport.prototype.nextSubdivision = function(e) { var i, n, s; return e = this.toSeconds(e), this.state !== t.State.Started ? 0 : (i = this._clock._nextTick, n = t.Time(this.ticks, "i"), s = e - n % e, 0 === s && (s = e), i + s) }, t.Transport.prototype.syncSignal = function(e, i) { i || (i = 0 !== e._param.value ? e._param.value / this.bpm._param.value : 0); var n = new t.Gain(i); return this.bpm.chain(n, e._param), this._syncedSignals.push({ ratio: n, signal: e, initial: e._param.value }), e._param.value = 0, this }, t.Transport.prototype.unsyncSignal = function(t) { var e, i; for (e = this._syncedSignals.length - 1; e >= 0; e--) i = this._syncedSignals[e], i.signal === t && (i.ratio.dispose(), i.signal._param.value = i.initial, this._syncedSignals.splice(e, 1)); return this }, t.Transport.prototype.dispose = function() { return t.Emitter.prototype.dispose.call(this), this._clock.dispose(), this._clock = null, this._writable("bpm"), this.bpm = null, this._timeline.dispose(), this._timeline = null, this._repeatedEvents.dispose(), this._repeatedEvents = null, this }; var e = t.Transport; return t.Transport = new e, t.Context.on("init", function(i) { i.Transport instanceof e ? t.Transport = i.Transport : t.Transport = new e, i.Transport = t.Transport }), t.Context.on("close", function(t) { t.Transport instanceof e && t.Transport.dispose() }), t.Transport }), t(function(t) { return t.Volume = function() { var e = t.defaults(arguments, ["volume"], t.Volume);
                t.AudioNode.call(this), this.output = this.input = new t.Gain(e.volume, t.Type.Decibels), this._unmutedVolume = e.volume, this.volume = this.output.gain, this._readOnly("volume"), this.mute = e.mute }, t.extend(t.Volume, t.AudioNode), t.Volume.defaults = { volume: 0, mute: !1 }, Object.defineProperty(t.Volume.prototype, "mute", { get: function() { return this.volume.value === -1 / 0 }, set: function(t) {!this.mute && t ? (this._unmutedVolume = this.volume.value, this.volume.value = -1 / 0) : this.mute && !t && (this.volume.value = this._unmutedVolume) } }), t.Volume.prototype.dispose = function() { return this.input.dispose(), t.AudioNode.prototype.dispose.call(this), this._writable("volume"), this.volume.dispose(), this.volume = null, this }, t.Volume }), t(function(t) { t.Master = function() { t.AudioNode.call(this), t.getContext(function() { this.createInsOuts(1, 0), this._volume = this.output = new t.Volume, this.volume = this._volume.volume, this._readOnly("volume"), this.input.chain(this.output, this.context.destination) }.bind(this)) }, t.extend(t.Master, t.AudioNode), t.Master.defaults = { volume: 0, mute: !1 }, Object.defineProperty(t.Master.prototype, "mute", { get: function() { return this._volume.mute }, set: function(t) { this._volume.mute = t } }), t.Master.prototype.chain = function() { this.input.disconnect(), this.input.chain.apply(this.input, arguments), arguments[arguments.length - 1].connect(this.output) }, t.Master.prototype.dispose = function() { t.AudioNode.prototype.dispose.call(this), this._writable("volume"), this._volume.dispose(), this._volume = null, this.volume = null }, t.AudioNode.prototype.toMaster = function() { return this.connect(t.Master), this }, window.AudioNode && (AudioNode.prototype.toMaster = function() { return this.connect(t.Master), this }); var e = t.Master; return t.Master = new e, t.Context.on("init", function(i) { i.Master instanceof e ? t.Master = i.Master : t.Master = new e, i.Master = t.Master }), t.Context.on("close", function(t) { t.Master instanceof e && t.Master.dispose() }), t.Master }), t(function(t) { return t.Source = function(e) { e = t.defaultArg(e, t.Source.defaults), t.AudioNode.call(this), this._volume = this.output = new t.Volume(e.volume), this.volume = this._volume.volume, this._readOnly("volume"), this._state = new t.TimelineState(t.State.Stopped), this._state.memory = 100, this._synced = !1, this._scheduled = [], this._volume.output.output.channelCount = 2, this._volume.output.output.channelCountMode = "explicit", this.mute = e.mute }, t.extend(t.Source, t.AudioNode), t.Source.defaults = { volume: 0, mute: !1 }, Object.defineProperty(t.Source.prototype, "state", { get: function() { return this._synced ? t.Transport.state === t.State.Started ? this._state.getValueAtTime(t.Transport.seconds) : t.State.Stopped : this._state.getValueAtTime(this.now()) } }), Object.defineProperty(t.Source.prototype, "mute", { get: function() { return this._volume.mute }, set: function(t) { this._volume.mute = t } }), t.Source.prototype._start = t.noOp, t.Source.prototype._stop = t.noOp, t.Source.prototype.start = function(e, i, n) { var s, o; return e = t.isUndef(e) && this._synced ? t.Transport.seconds : this.toSeconds(e), this.retrigger || this._state.getValueAtTime(e) !== t.State.Started || this.stop(e), this._state.setStateAtTime(t.State.Started, e), this._synced ? (s = this._state.get(e), s.offset = t.defaultArg(i, 0), s.duration = n, o = t.Transport.schedule(function(t) { this._start(t, i, n) }.bind(this), e), this._scheduled.push(o)) : this._start.apply(this, arguments), this }, t.Source.prototype.stop = function(e) { if (e = t.isUndef(e) && this._synced ? t.Transport.seconds : this.toSeconds(e), this._synced) { var i = t.Transport.schedule(this._stop.bind(this), e);
                    this._scheduled.push(i) } else this._stop.apply(this, arguments); return this._state.cancel(e), this._state.setStateAtTime(t.State.Stopped, e), this }, t.Source.prototype.sync = function() { return this._synced = !0, this._syncedStart = function(e, i) { var n, s, o;
                    i > 0 && (n = this._state.get(i)) && n.state === t.State.Started && n.time !== i && (s = i - this.toSeconds(n.time), n.duration && (o = this.toSeconds(n.duration) - s), this._start(e, this.toSeconds(n.offset) + s, o)) }.bind(this), this._syncedStop = function(e) { this._state.getValueAtTime(t.Transport.seconds) === t.State.Started && this._stop(e) }.bind(this), t.Transport.on("start loopStart", this._syncedStart), t.Transport.on("stop pause loopEnd", this._syncedStop), this }, t.Source.prototype.unsync = function() { var e, i; for (this._synced && (t.Transport.off("stop pause loopEnd", this._syncedStop), t.Transport.off("start loopStart", this._syncedStart)), this._synced = !1, e = 0; e < this._scheduled.length; e++) i = this._scheduled[e], t.Transport.clear(i); return this._scheduled = [], this._state.cancel(0), this }, t.Source.prototype.dispose = function() { t.AudioNode.prototype.dispose.call(this), this.unsync(), this._scheduled = null, this._writable("volume"), this._volume.dispose(), this._volume = null, this.volume = null, this._state.dispose(), this._state = null }, t.Source }), t(function(t) {
            return t.Oscillator = function() { var e = t.defaults(arguments, ["frequency", "type"], t.Oscillator);
                t.Source.call(this, e), this._oscillator = null, this.frequency = new t.Signal(e.frequency, t.Type.Frequency), this.detune = new t.Signal(e.detune, t.Type.Cents), this._wave = null, this._partials = t.defaultArg(e.partials, [1]), this._phase = e.phase, this._type = null, this.type = e.type, this.phase = this._phase, this._readOnly(["frequency", "detune"]) }, t.extend(t.Oscillator, t.Source), t.Oscillator.defaults = { type: "sine", frequency: 440, detune: 0, phase: 0, partials: [] }, t.Oscillator.Type = { Sine: "sine", Triangle: "triangle", Sawtooth: "sawtooth", Square: "square", Custom: "custom" }, t.Oscillator.prototype._start = function(e) { this._oscillator = this.context.createOscillator(), this._oscillator.setPeriodicWave(this._wave), this._oscillator.connect(this.output), this.frequency.connect(this._oscillator.frequency), this.detune.connect(this._oscillator.detune), e = this.toSeconds(e), t.isPast(e), this._oscillator.start(e) }, t.Oscillator.prototype._stop = function(e) { return this._oscillator && (e = this.toSeconds(e), t.isPast(e), this._oscillator.stop(e), this._oscillator = null), this }, t.Oscillator.prototype.syncFrequency = function() { return t.Transport.syncSignal(this.frequency), this }, t.Oscillator.prototype.unsyncFrequency = function() { return t.Transport.unsyncSignal(this.frequency), this }, Object.defineProperty(t.Oscillator.prototype, "type", {
                get: function() {
                    return this._type
                },
                set: function(t) { var e = this._getRealImaginary(t, this._phase),
                        i = this.context.createPeriodicWave(e[0], e[1]);
                    this._wave = i, null !== this._oscillator && this._oscillator.setPeriodicWave(this._wave), this._type = t }
            }), t.Oscillator.prototype._getRealImaginary = function(e, i) { var n, s, o, r, a = 4096,
                    l = a / 2,
                    h = new Float32Array(l),
                    u = new Float32Array(l),
                    p = 1; for (e === t.Oscillator.Type.Custom ? (p = this._partials.length + 1, l = p) : (n = /^(sine|triangle|square|sawtooth)(\d+)$/.exec(e)) && (p = parseInt(n[2]) + 1, e = n[1], p = Math.max(p, 2), l = p), s = 1; s < l; ++s) { switch (o = 2 / (s * Math.PI), e) {
                        case t.Oscillator.Type.Sine:
                            r = s <= p ? 1 : 0; break;
                        case t.Oscillator.Type.Square:
                            r = 1 & s ? 2 * o : 0; break;
                        case t.Oscillator.Type.Sawtooth:
                            r = o * (1 & s ? 1 : -1); break;
                        case t.Oscillator.Type.Triangle:
                            r = 1 & s ? o * o * 2 * (s - 1 >> 1 & 1 ? -1 : 1) : 0; break;
                        case t.Oscillator.Type.Custom:
                            r = this._partials[s - 1]; break;
                        default:
                            throw new TypeError("Tone.Oscillator: invalid type: " + e) } 0 !== r ? (h[s] = -r * Math.sin(i * s), u[s] = r * Math.cos(i * s)) : (h[s] = 0, u[s] = 0) } return [h, u] }, t.Oscillator.prototype._inverseFFT = function(t, e, i) { var n, s = 0,
                    o = t.length; for (n = 0; n < o; n++) s += t[n] * Math.cos(n * i) + e[n] * Math.sin(n * i); return s }, t.Oscillator.prototype._getInitialValue = function() { var t, e = this._getRealImaginary(this._type, 0),
                    i = e[0],
                    n = e[1],
                    s = 0,
                    o = 2 * Math.PI; for (t = 0; t < 8; t++) s = Math.max(this._inverseFFT(i, n, t / 8 * o), s); return -this._inverseFFT(i, n, this._phase) / s }, Object.defineProperty(t.Oscillator.prototype, "partials", { get: function() { return this._type !== t.Oscillator.Type.Custom ? [] : this._partials }, set: function(e) { this._partials = e, this.type = t.Oscillator.Type.Custom } }), Object.defineProperty(t.Oscillator.prototype, "phase", { get: function() { return this._phase * (180 / Math.PI) }, set: function(t) { this._phase = t * Math.PI / 180, this.type = this._type } }), t.Oscillator.prototype.dispose = function() { return t.Source.prototype.dispose.call(this), null !== this._oscillator && (this._oscillator.disconnect(), this._oscillator = null), this._wave = null, this._writable(["frequency", "detune"]), this.frequency.dispose(), this.frequency = null, this.detune.dispose(), this.detune = null, this._partials = null, this }, t.Oscillator
        }), t(function(t) { return t.AudioToGain = function() { t.SignalBase.call(this), this._norm = this.input = this.output = new t.WaveShaper(function(t) { return (t + 1) / 2 }) }, t.extend(t.AudioToGain, t.SignalBase), t.AudioToGain.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._norm.dispose(), this._norm = null, this }, t.AudioToGain }), t(function(t) { return t.Zero = function() { t.SignalBase.call(this), this._gain = this.input = this.output = new t.Gain, this.context.getConstant(0).connect(this._gain) }, t.extend(t.Zero, t.SignalBase), t.Zero.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._gain.dispose(), this._gain = null, this }, t.Zero }), t(function(t) { return t.LFO = function() { var e = t.defaults(arguments, ["frequency", "min", "max"], t.LFO);
                t.AudioNode.call(this), this._oscillator = new t.Oscillator({ frequency: e.frequency, type: e.type }), this.frequency = this._oscillator.frequency, this.amplitude = this._oscillator.volume, this.amplitude.units = t.Type.NormalRange, this.amplitude.value = e.amplitude, this._stoppedSignal = new t.Signal(0, t.Type.AudioRange), this._zeros = new t.Zero, this._stoppedValue = 0, this._a2g = new t.AudioToGain, this._scaler = this.output = new t.Scale(e.min, e.max), this._units = t.Type.Default, this.units = e.units, this._oscillator.chain(this._a2g, this._scaler), this._zeros.connect(this._a2g), this._stoppedSignal.connect(this._a2g), this._readOnly(["amplitude", "frequency"]), this.phase = e.phase }, t.extend(t.LFO, t.AudioNode), t.LFO.defaults = { type: "sine", min: 0, max: 1, phase: 0, frequency: "4n", amplitude: 1, units: t.Type.Default }, t.LFO.prototype.start = function(t) { return t = this.toSeconds(t), this._stoppedSignal.setValueAtTime(0, t), this._oscillator.start(t), this }, t.LFO.prototype.stop = function(t) { return t = this.toSeconds(t), this._stoppedSignal.setValueAtTime(this._stoppedValue, t), this._oscillator.stop(t), this }, t.LFO.prototype.sync = function() { return this._oscillator.sync(), this._oscillator.syncFrequency(), this }, t.LFO.prototype.unsync = function() { return this._oscillator.unsync(), this._oscillator.unsyncFrequency(), this }, Object.defineProperty(t.LFO.prototype, "min", { get: function() { return this._toUnits(this._scaler.min) }, set: function(t) { t = this._fromUnits(t), this._scaler.min = t } }), Object.defineProperty(t.LFO.prototype, "max", { get: function() { return this._toUnits(this._scaler.max) }, set: function(t) { t = this._fromUnits(t), this._scaler.max = t } }), Object.defineProperty(t.LFO.prototype, "type", { get: function() { return this._oscillator.type }, set: function(t) { this._oscillator.type = t, this._stoppedValue = this._oscillator._getInitialValue(), this._stoppedSignal.value = this._stoppedValue } }), Object.defineProperty(t.LFO.prototype, "phase", { get: function() { return this._oscillator.phase }, set: function(t) { this._oscillator.phase = t, this._stoppedValue = this._oscillator._getInitialValue(), this._stoppedSignal.value = this._stoppedValue } }), Object.defineProperty(t.LFO.prototype, "units", { get: function() { return this._units }, set: function(t) { var e = this.min,
                        i = this.max;
                    this._units = t, this.min = e, this.max = i } }), Object.defineProperty(t.LFO.prototype, "mute", { get: function() { return this._oscillator.mute }, set: function(t) { this._oscillator.mute = t } }), Object.defineProperty(t.LFO.prototype, "state", { get: function() { return this._oscillator.state } }), t.LFO.prototype.connect = function(e) { return e.constructor !== t.Signal && e.constructor !== t.Param && e.constructor !== t.TimelineSignal || (this.convert = e.convert, this.units = e.units), t.Signal.prototype.connect.apply(this, arguments), this }, t.LFO.prototype._fromUnits = t.Param.prototype._fromUnits, t.LFO.prototype._toUnits = t.Param.prototype._toUnits, t.LFO.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._writable(["amplitude", "frequency"]), this._oscillator.dispose(), this._oscillator = null, this._stoppedSignal.dispose(), this._stoppedSignal = null, this._zeros.dispose(), this._zeros = null, this._scaler.dispose(), this._scaler = null, this._a2g.dispose(), this._a2g = null, this.frequency = null, this.amplitude = null, this }, t.LFO }), t(function(t) { return t.Limiter = function() { var e = t.defaults(arguments, ["threshold"], t.Limiter);
                t.AudioNode.call(this), this._compressor = this.input = this.output = new t.Compressor({ attack: .001, decay: .001, threshold: e.threshold }), this.threshold = this._compressor.threshold, this._readOnly("threshold") }, t.extend(t.Limiter, t.AudioNode), t.Limiter.defaults = { threshold: -12 }, t.Limiter.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._compressor.dispose(), this._compressor = null, this._writable("threshold"), this.threshold = null, this }, t.Limiter }), t(function(t) { return t.LowpassCombFilter = function() { var e = t.defaults(arguments, ["delayTime", "resonance", "dampening"], t.LowpassCombFilter);
                t.AudioNode.call(this), this.createInsOuts(1, 1), this._delay = this.input = new t.Delay(e.delayTime), this.delayTime = this._delay.delayTime, this._lowpass = this.output = this.context.createBiquadFilter(), this._lowpass.Q.value = -3.0102999566398125, this._lowpass.type = "lowpass", this.dampening = new t.Param({ param: this._lowpass.frequency, units: t.Type.Frequency, value: e.dampening }), this._feedback = new t.Gain(e.resonance, t.Type.NormalRange), this.resonance = this._feedback.gain, this._delay.chain(this._lowpass, this._feedback, this._delay), this._readOnly(["dampening", "resonance", "delayTime"]) }, t.extend(t.LowpassCombFilter, t.AudioNode), t.LowpassCombFilter.defaults = { delayTime: .1, resonance: .5, dampening: 3e3 }, t.LowpassCombFilter.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._writable(["dampening", "resonance", "delayTime"]), this.dampening.dispose(), this.dampening = null, this.resonance.dispose(), this.resonance = null, this._delay.dispose(), this._delay = null, this.delayTime = null, this._lowpass.disconnect(), this._lowpass = null, this._feedback.disconnect(), this._feedback = null, this }, t.LowpassCombFilter }), t(function(t) { return t.Merge = function() { t.AudioNode.call(this), this.createInsOuts(2, 0), this.left = this.input[0] = new t.Gain, this.right = this.input[1] = new t.Gain, this._merger = this.output = this.context.createChannelMerger(2), this.left.connect(this._merger, 0, 0), this.right.connect(this._merger, 0, 1), this.left.channelCount = 1, this.right.channelCount = 1, this.left.channelCountMode = "explicit", this.right.channelCountMode = "explicit" }, t.extend(t.Merge, t.AudioNode), t.Merge.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this.left.dispose(), this.left = null, this.right.dispose(), this.right = null, this._merger.disconnect(), this._merger = null, this }, t.Merge }), t(function(t) { return t.Meter = function() { var e = t.defaults(arguments, ["smoothing"], t.Meter);
                t.AudioNode.call(this), this.input = this.output = this._analyser = new t.Analyser("waveform", 1024), this.smoothing = e.smoothing }, t.extend(t.Meter, t.AudioNode), t.Meter.defaults = { smoothing: .8 }, t.Meter.prototype.getLevel = function() { var t, e; return this._analyser.type = "fft", t = this._analyser.getValue(), e = 28, Math.max.apply(this, t) + e }, t.Meter.prototype.getValue = function() { return this._analyser.type = "waveform", this._analyser.getValue()[0] }, Object.defineProperty(t.Meter.prototype, "smoothing", { get: function() { return this._analyser.smoothing }, set: function(t) { this._analyser.smoothing = t } }), t.Meter.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._analyser.dispose(), this._analyser = null, this }, t.Meter }), t(function(t) { return t.Split = function() { t.AudioNode.call(this), this.createInsOuts(0, 2), this._splitter = this.input = this.context.createChannelSplitter(2), this._splitter.channelCount = 2, this._splitter.channelCountMode = "explicit", this.left = this.output[0] = new t.Gain, this.right = this.output[1] = new t.Gain, this._splitter.connect(this.left, 0, 0), this._splitter.connect(this.right, 1, 0) }, t.extend(t.Split, t.AudioNode), t.Split.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._splitter.disconnect(), this.left.dispose(), this.left = null, this.right.dispose(), this.right = null, this._splitter = null, this }, t.Split }), t(function(t) { return t.MidSideSplit = function() { t.AudioNode.call(this), this.createInsOuts(0, 2), this._split = this.input = new t.Split, this._midAdd = new t.Add, this.mid = this.output[0] = new t.Multiply(Math.SQRT1_2), this._sideSubtract = new t.Subtract, this.side = this.output[1] = new t.Multiply(Math.SQRT1_2), this._split.connect(this._midAdd, 0, 0), this._split.connect(this._midAdd, 1, 1), this._split.connect(this._sideSubtract, 0, 0), this._split.connect(this._sideSubtract, 1, 1), this._midAdd.connect(this.mid), this._sideSubtract.connect(this.side) }, t.extend(t.MidSideSplit, t.AudioNode), t.MidSideSplit.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this.mid.dispose(), this.mid = null, this.side.dispose(), this.side = null, this._midAdd.dispose(), this._midAdd = null, this._sideSubtract.dispose(), this._sideSubtract = null, this._split.dispose(), this._split = null, this }, t.MidSideSplit }), t(function(t) { return t.MidSideMerge = function() { t.AudioNode.call(this), this.createInsOuts(2, 0), this.mid = this.input[0] = new t.Gain, this._left = new t.Add, this._timesTwoLeft = new t.Multiply(Math.SQRT1_2), this.side = this.input[1] = new t.Gain, this._right = new t.Subtract, this._timesTwoRight = new t.Multiply(Math.SQRT1_2), this._merge = this.output = new t.Merge, this.mid.connect(this._left, 0, 0), this.side.connect(this._left, 0, 1), this.mid.connect(this._right, 0, 0), this.side.connect(this._right, 0, 1), this._left.connect(this._timesTwoLeft), this._right.connect(this._timesTwoRight), this._timesTwoLeft.connect(this._merge, 0, 0), this._timesTwoRight.connect(this._merge, 0, 1) }, t.extend(t.MidSideMerge, t.AudioNode), t.MidSideMerge.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this.mid.dispose(), this.mid = null, this.side.dispose(), this.side = null, this._left.dispose(), this._left = null, this._timesTwoLeft.dispose(), this._timesTwoLeft = null, this._right.dispose(), this._right = null, this._timesTwoRight.dispose(), this._timesTwoRight = null, this._merge.dispose(), this._merge = null, this }, t.MidSideMerge }), t(function(t) { return t.MidSideCompressor = function(e) { t.AudioNode.call(this), e = t.defaultArg(e, t.MidSideCompressor.defaults), this._midSideSplit = this.input = new t.MidSideSplit, this._midSideMerge = this.output = new t.MidSideMerge, this.mid = new t.Compressor(e.mid), this.side = new t.Compressor(e.side), this._midSideSplit.mid.chain(this.mid, this._midSideMerge.mid), this._midSideSplit.side.chain(this.side, this._midSideMerge.side), this._readOnly(["mid", "side"]) }, t.extend(t.MidSideCompressor, t.AudioNode), t.MidSideCompressor.defaults = { mid: { ratio: 3, threshold: -24, release: .03, attack: .02, knee: 16 }, side: { ratio: 6, threshold: -30, release: .25, attack: .03, knee: 10 } }, t.MidSideCompressor.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._writable(["mid", "side"]), this.mid.dispose(), this.mid = null, this.side.dispose(), this.side = null, this._midSideSplit.dispose(), this._midSideSplit = null, this._midSideMerge.dispose(), this._midSideMerge = null, this }, t.MidSideCompressor }), t(function(t) { return t.Mono = function() { t.AudioNode.call(this), this.createInsOuts(1, 0), this._merge = this.output = new t.Merge, this.input.connect(this._merge, 0, 0), this.input.connect(this._merge, 0, 1), this.input.gain.value = t.dbToGain(-10) }, t.extend(t.Mono), t.Mono.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._merge.dispose(), this._merge = null, this }, t.Mono }), t(function(t) { return t.MultibandCompressor = function(e) { t.AudioNode.call(this), e = t.defaultArg(arguments, t.MultibandCompressor.defaults), this._splitter = this.input = new t.MultibandSplit({ lowFrequency: e.lowFrequency, highFrequency: e.highFrequency }), this.lowFrequency = this._splitter.lowFrequency, this.highFrequency = this._splitter.highFrequency, this.output = new t.Gain, this.low = new t.Compressor(e.low), this.mid = new t.Compressor(e.mid), this.high = new t.Compressor(e.high), this._splitter.low.chain(this.low, this.output), this._splitter.mid.chain(this.mid, this.output), this._splitter.high.chain(this.high, this.output), this._readOnly(["high", "mid", "low", "highFrequency", "lowFrequency"]) }, t.extend(t.MultibandCompressor, t.AudioNode), t.MultibandCompressor.defaults = { low: t.Compressor.defaults, mid: t.Compressor.defaults, high: t.Compressor.defaults, lowFrequency: 250, highFrequency: 2e3 }, t.MultibandCompressor.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._splitter.dispose(), this._writable(["high", "mid", "low", "highFrequency", "lowFrequency"]), this.low.dispose(), this.mid.dispose(), this.high.dispose(), this._splitter = null, this.low = null, this.mid = null, this.high = null, this.lowFrequency = null, this.highFrequency = null, this }, t.MultibandCompressor }), t(function(t) { if (t.supported && !window.StereoPannerNode) { var e = function(e) { var i, n, s, o, r, a, l;
                    this.context = e, this.pan = new t.Signal(0, t.Type.AudioRange), i = new t.WaveShaper(function(e) { return t.equalPowerScale((e + 1) / 2) }, 4096), n = new t.WaveShaper(function(e) { return t.equalPowerScale(1 - (e + 1) / 2) }, 4096), s = new t.Gain, o = new t.Gain, r = this.input = new t.Split, a = new t.Zero, a.fan(i, n), l = this.output = new t.Merge, r.left.chain(s, l.left), r.right.chain(o, l.right), this.pan.chain(n, s.gain), this.pan.chain(i, o.gain) };
                e.prototype.disconnect = function() { this.output.disconnect.apply(this.output, arguments) }, e.prototype.connect = function() { this.output.connect.apply(this.output, arguments) }, AudioContext.prototype.createStereoPanner = function() { return new e(this) }, t.Context.prototype.createStereoPanner = function() { return new e(this) } } }), t(function(t) { return t.Panner = function(e) { t.AudioNode.call(this), this._panner = this.input = this.output = this.context.createStereoPanner(), this.pan = this._panner.pan, this.pan.value = t.defaultArg(e, 0), this._readOnly("pan") }, t.extend(t.Panner, t.AudioNode), t.Panner.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._writable("pan"), this._panner.disconnect(), this._panner = null, this.pan = null, this }, t.Panner }), t(function(t) { return t.Panner3D = function() { var e = t.defaults(arguments, ["positionX", "positionY", "positionZ"], t.Panner3D);
                t.AudioNode.call(this), this._panner = this.input = this.output = this.context.createPanner(), this._panner.panningModel = e.panningModel, this._panner.maxDistance = e.maxDistance, this._panner.distanceModel = e.distanceModel, this._panner.coneOuterGain = e.coneOuterGain, this._panner.coneOuterAngle = e.coneOuterAngle, this._panner.coneInnerAngle = e.coneInnerAngle, this._panner.refDistance = e.refDistance, this._panner.rolloffFactor = e.rolloffFactor, this._orientation = [e.orientationX, e.orientationY, e.orientationZ], this._position = [e.positionX, e.positionY, e.positionZ], this.orientationX = e.orientationX, this.orientationY = e.orientationY, this.orientationZ = e.orientationZ, this.positionX = e.positionX, this.positionY = e.positionY, this.positionZ = e.positionZ }, t.extend(t.Panner3D, t.AudioNode), t.Panner3D.defaults = { positionX: 0, positionY: 0, positionZ: 0, orientationX: 0, orientationY: 0, orientationZ: 0, panningModel: "equalpower", maxDistance: 1e4, distanceModel: "inverse", coneOuterGain: 0, coneOuterAngle: 360, coneInnerAngle: 360, refDistance: 1, rolloffFactor: 1 }, t.Panner3D.prototype._rampTimeConstant = .01, t.Panner3D.prototype.setPosition = function(t, e, i) { if (this._panner.positionX) { var n = this.now();
                    this._panner.positionX.setTargetAtTime(t, n, this._rampTimeConstant), this._panner.positionY.setTargetAtTime(e, n, this._rampTimeConstant), this._panner.positionZ.setTargetAtTime(i, n, this._rampTimeConstant) } else this._panner.setPosition(t, e, i); return this._position = Array.prototype.slice.call(arguments), this }, t.Panner3D.prototype.setOrientation = function(t, e, i) { if (this._panner.orientationX) { var n = this.now();
                    this._panner.orientationX.setTargetAtTime(t, n, this._rampTimeConstant), this._panner.orientationY.setTargetAtTime(e, n, this._rampTimeConstant), this._panner.orientationZ.setTargetAtTime(i, n, this._rampTimeConstant) } else this._panner.setOrientation(t, e, i); return this._orientation = Array.prototype.slice.call(arguments), this }, Object.defineProperty(t.Panner3D.prototype, "positionX", { set: function(t) { this._position[0] = t, this.setPosition.apply(this, this._position) }, get: function() { return this._position[0] } }), Object.defineProperty(t.Panner3D.prototype, "positionY", { set: function(t) { this._position[1] = t, this.setPosition.apply(this, this._position) }, get: function() { return this._position[1] } }), Object.defineProperty(t.Panner3D.prototype, "positionZ", { set: function(t) { this._position[2] = t, this.setPosition.apply(this, this._position) }, get: function() { return this._position[2] } }), Object.defineProperty(t.Panner3D.prototype, "orientationX", { set: function(t) { this._orientation[0] = t, this.setOrientation.apply(this, this._orientation) }, get: function() { return this._orientation[0] } }), Object.defineProperty(t.Panner3D.prototype, "orientationY", { set: function(t) { this._orientation[1] = t, this.setOrientation.apply(this, this._orientation) }, get: function() { return this._orientation[1] } }), Object.defineProperty(t.Panner3D.prototype, "orientationZ", { set: function(t) { this._orientation[2] = t, this.setOrientation.apply(this, this._orientation) }, get: function() { return this._orientation[2] } }), t.Panner3D._aliasProperty = function(e) { Object.defineProperty(t.Panner3D.prototype, e, { set: function(t) { this._panner[e] = t }, get: function() { return this._panner[e] } }) }, t.Panner3D._aliasProperty("panningModel"), t.Panner3D._aliasProperty("refDistance"), t.Panner3D._aliasProperty("rolloffFactor"), t.Panner3D._aliasProperty("distanceModel"), t.Panner3D._aliasProperty("coneInnerAngle"), t.Panner3D._aliasProperty("coneOuterAngle"), t.Panner3D._aliasProperty("coneOuterGain"), t.Panner3D._aliasProperty("maxDistance"), t.Panner3D.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._panner.disconnect(), this._panner = null, this._orientation = null, this._position = null, this }, t.Panner3D }), t(function(t) { return t.PanVol = function() { var e = t.defaults(arguments, ["pan", "volume"], t.PanVol);
                t.AudioNode.call(this), this._panner = this.input = new t.Panner(e.pan), this.pan = this._panner.pan, this._volume = this.output = new t.Volume(e.volume), this.volume = this._volume.volume, this._panner.connect(this._volume), this.mute = e.mute, this._readOnly(["pan", "volume"]) }, t.extend(t.PanVol, t.AudioNode), t.PanVol.defaults = { pan: 0, volume: 0, mute: !1 }, Object.defineProperty(t.PanVol.prototype, "mute", { get: function() { return this._volume.mute }, set: function(t) { this._volume.mute = t } }), t.PanVol.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._writable(["pan", "volume"]), this._panner.dispose(), this._panner = null, this.pan = null, this._volume.dispose(), this._volume = null, this.volume = null, this }, t.PanVol }), t(function(t) { return t.Solo = function() { var e = t.defaults(arguments, ["solo"], t.Solo);
                t.AudioNode.call(this), this.input = this.output = new t.Gain, this._soloBind = this._soloed.bind(this), this.context.on("solo", this._soloBind), this.solo = e.solo }, t.extend(t.Solo, t.AudioNode), t.Solo.defaults = { solo: !1 }, Object.defineProperty(t.Solo.prototype, "solo", { get: function() { return this._isSoloed() }, set: function(t) { t ? this._addSolo() : this._removeSolo(), this.context.emit("solo", this) } }), Object.defineProperty(t.Solo.prototype, "muted", { get: function() { return 0 === this.input.gain.value } }), t.Solo.prototype._addSolo = function() { t.isArray(this.context._currentSolo) || (this.context._currentSolo = []), this._isSoloed() || this.context._currentSolo.push(this) }, t.Solo.prototype._removeSolo = function() { if (this._isSoloed()) { var t = this.context._currentSolo.indexOf(this);
                    this.context._currentSolo.splice(t, 1) } }, t.Solo.prototype._isSoloed = function() { return !!t.isArray(this.context._currentSolo) && (0 !== this.context._currentSolo.length && -1 !== this.context._currentSolo.indexOf(this)) }, t.Solo.prototype._noSolos = function() { return !t.isArray(this.context._currentSolo) || 0 === this.context._currentSolo.length }, t.Solo.prototype._soloed = function() { this._isSoloed() ? this.input.gain.value = 1 : this._noSolos() ? this.input.gain.value = 1 : this.input.gain.value = 0 }, t.Solo.prototype.dispose = function() { return this.context.off("solo", this._soloBind), this._removeSolo(), this._soloBind = null, t.AudioNode.prototype.dispose.call(this), this }, t.Solo }), t(function(t) { return t.Waveform = function() { var e = t.defaults(arguments, ["size"], t.Waveform);
                e.type = t.Analyser.Type.Waveform, t.AudioNode.call(this), this._analyser = this.input = this.output = new t.Analyser(e) }, t.extend(t.Waveform, t.AudioNode), t.Waveform.defaults = { size: 1024 }, t.Waveform.prototype.getValue = function() { return this._analyser.getValue() }, Object.defineProperty(t.Waveform.prototype, "size", { get: function() { return this._analyser.size }, set: function(t) { this._analyser.size = t } }), t.Waveform.prototype.dispose = function() { t.AudioNode.prototype.dispose.call(this), this._analyser.dispose(), this._analyser = null }, t.Waveform }), t(function(t) { return t.CtrlInterpolate = function() { var e = t.defaults(arguments, ["values", "index"], t.CtrlInterpolate);
                t.call(this), this.values = e.values, this.index = e.index }, t.extend(t.CtrlInterpolate), t.CtrlInterpolate.defaults = { index: 0, values: [] }, Object.defineProperty(t.CtrlInterpolate.prototype, "value", { get: function() { var t, e, i, n = this.index; return n = Math.min(n, this.values.length - 1), t = Math.floor(n), e = this.values[t], i = this.values[Math.ceil(n)], this._interpolate(n - t, e, i) } }), t.CtrlInterpolate.prototype._interpolate = function(e, i, n) { var s, o, r, a; if (t.isArray(i)) { for (s = [], o = 0; o < i.length; o++) s[o] = this._interpolate(e, i[o], n[o]); return s } if (t.isObject(i)) { r = {}; for (a in i) r[a] = this._interpolate(e, i[a], n[a]); return r } return i = this._toNumber(i), n = this._toNumber(n), (1 - e) * i + e * n }, t.CtrlInterpolate.prototype._toNumber = function(e) { return t.isNumber(e) ? e : this.toSeconds(e) }, t.CtrlInterpolate.prototype.dispose = function() { this.values = null }, t.CtrlInterpolate }), t(function(t) { return t.CtrlMarkov = function(e, i) { t.call(this), this.values = t.defaultArg(e, {}), this.value = t.defaultArg(i, Object.keys(this.values)[0]) }, t.extend(t.CtrlMarkov), t.CtrlMarkov.prototype.next = function() { var e, i, n, s, o, r, a; if (this.values.hasOwnProperty(this.value))
                    if (e = this.values[this.value], t.isArray(e))
                        for (i = this._getProbDistribution(e), n = Math.random(), s = 0, o = 0; o < i.length; o++) r = i[o], n > s && n < s + r && (a = e[o], t.isObject(a) ? this.value = a.value : this.value = a), s += r;
                    else this.value = e; return this.value }, t.CtrlMarkov.prototype._getProbDistribution = function(e) { var i, n, s, o = [],
                    r = 0,
                    a = !1; for (i = 0; i < e.length; i++) n = e[i], t.isObject(n) ? (a = !0, o[i] = n.probability) : o[i] = 1 / e.length, r += o[i]; if (a)
                    for (s = 0; s < o.length; s++) o[s] = o[s] / r; return o }, t.CtrlMarkov.prototype.dispose = function() { this.values = null }, t.CtrlMarkov }), t(function(t) { return t.CtrlPattern = function() { var e = t.defaults(arguments, ["values", "type"], t.CtrlPattern);
                t.call(this), this.values = e.values, this.index = 0, this._type = null, this._shuffled = null, this._direction = null, this.type = e.type }, t.extend(t.CtrlPattern), t.CtrlPattern.Type = { Up: "up", Down: "down", UpDown: "upDown", DownUp: "downUp", AlternateUp: "alternateUp", AlternateDown: "alternateDown", Random: "random", RandomWalk: "randomWalk", RandomOnce: "randomOnce" }, t.CtrlPattern.defaults = { type: t.CtrlPattern.Type.Up, values: [] }, Object.defineProperty(t.CtrlPattern.prototype, "value", { get: function() { if (0 !== this.values.length) { if (1 === this.values.length) return this.values[0];
                        this.index = Math.min(this.index, this.values.length - 1); var e = this.values[this.index]; return this.type === t.CtrlPattern.Type.RandomOnce && (this.values.length !== this._shuffled.length && this._shuffleValues(), e = this.values[this._shuffled[this.index]]), e } } }), Object.defineProperty(t.CtrlPattern.prototype, "type", { get: function() { return this._type }, set: function(e) { this._type = e, this._shuffled = null, this._type === t.CtrlPattern.Type.Up || this._type === t.CtrlPattern.Type.UpDown || this._type === t.CtrlPattern.Type.RandomOnce || this._type === t.CtrlPattern.Type.AlternateUp ? this.index = 0 : this._type !== t.CtrlPattern.Type.Down && this._type !== t.CtrlPattern.Type.DownUp && this._type !== t.CtrlPattern.Type.AlternateDown || (this.index = this.values.length - 1), this._type === t.CtrlPattern.Type.UpDown || this._type === t.CtrlPattern.Type.AlternateUp ? this._direction = t.CtrlPattern.Type.Up : this._type !== t.CtrlPattern.Type.DownUp && this._type !== t.CtrlPattern.Type.AlternateDown || (this._direction = t.CtrlPattern.Type.Down), this._type === t.CtrlPattern.Type.RandomOnce ? this._shuffleValues() : this._type === t.CtrlPattern.Random && (this.index = Math.floor(Math.random() * this.values.length)) } }), t.CtrlPattern.prototype.next = function() { var e = this.type; return e === t.CtrlPattern.Type.Up ? ++this.index >= this.values.length && (this.index = 0) : e === t.CtrlPattern.Type.Down ? --this.index < 0 && (this.index = this.values.length - 1) : e === t.CtrlPattern.Type.UpDown || e === t.CtrlPattern.Type.DownUp ? (this._direction === t.CtrlPattern.Type.Up ? this.index++ : this.index--, this.index < 0 ? (this.index = 1, this._direction = t.CtrlPattern.Type.Up) : this.index >= this.values.length && (this.index = this.values.length - 2, this._direction = t.CtrlPattern.Type.Down)) : e === t.CtrlPattern.Type.Random ? this.index = Math.floor(Math.random() * this.values.length) : e === t.CtrlPattern.Type.RandomWalk ? Math.random() < .5 ? (this.index--, this.index = Math.max(this.index, 0)) : (this.index++, this.index = Math.min(this.index, this.values.length - 1)) : e === t.CtrlPattern.Type.RandomOnce ? ++this.index >= this.values.length && (this.index = 0, this._shuffleValues()) : e === t.CtrlPattern.Type.AlternateUp ? (this._direction === t.CtrlPattern.Type.Up ? (this.index += 2, this._direction = t.CtrlPattern.Type.Down) : (this.index -= 1, this._direction = t.CtrlPattern.Type.Up), this.index >= this.values.length && (this.index = 0, this._direction = t.CtrlPattern.Type.Up)) : e === t.CtrlPattern.Type.AlternateDown && (this._direction === t.CtrlPattern.Type.Up ? (this.index += 1, this._direction = t.CtrlPattern.Type.Down) : (this.index -= 2, this._direction = t.CtrlPattern.Type.Up), this.index < 0 && (this.index = this.values.length - 1, this._direction = t.CtrlPattern.Type.Down)), this.value }, t.CtrlPattern.prototype._shuffleValues = function() { var t, e, i = []; for (this._shuffled = [], t = 0; t < this.values.length; t++) i[t] = t; for (; i.length > 0;) e = i.splice(Math.floor(i.length * Math.random()), 1), this._shuffled.push(e[0]) }, t.CtrlPattern.prototype.dispose = function() { this._shuffled = null, this.values = null }, t.CtrlPattern }), t(function(t) { return t.CtrlRandom = function() { var e = t.defaults(arguments, ["min", "max"], t.CtrlRandom);
                t.call(this), this.min = e.min, this.max = e.max, this.integer = e.integer }, t.extend(t.CtrlRandom), t.CtrlRandom.defaults = { min: 0, max: 1, integer: !1 }, Object.defineProperty(t.CtrlRandom.prototype, "value", { get: function() { var t = this.toSeconds(this.min),
                        e = this.toSeconds(this.max),
                        i = Math.random(),
                        n = i * t + (1 - i) * e; return this.integer && (n = Math.floor(n)), n } }), t.CtrlRandom }), t(function(t) { t.supported && (AudioBuffer.prototype.copyToChannel || (AudioBuffer.prototype.copyToChannel = function(t, e, i) { var n, s = this.getChannelData(e); for (i = i || 0, n = 0; n < s.length; n++) s[n + i] = t[n] }, AudioBuffer.prototype.copyFromChannel = function(t, e, i) { var n, s = this.getChannelData(e); for (i = i || 0, n = 0; n < t.length; n++) t[n] = s[n + i] })) }), t(function(t) {
            return t.Buffer = function() { var e = t.defaults(arguments, ["url", "onload", "onerror"], t.Buffer);
                t.call(this), this._buffer = null, this._reversed = e.reverse, this._xhr = null, e.url instanceof AudioBuffer || e.url instanceof t.Buffer ? (this.set(e.url), e.onload && e.onload(this)) : t.isString(e.url) && this.load(e.url, e.onload, e.onerror) }, t.extend(t.Buffer), t.Buffer.defaults = { url: void 0, reverse: !1 }, t.Buffer.prototype.set = function(e) { return e instanceof t.Buffer ? this._buffer = e.get() : this._buffer = e, this }, t.Buffer.prototype.get = function() { return this._buffer }, t.Buffer.prototype.load = function(e, i, n) { return new Promise(function(s, o) { this._xhr = t.Buffer.load(e, function(t) { this._xhr = null, this.set(t), s(this), i && i(this) }.bind(this), function(t) { this._xhr = null, o(t), n && n(t) }.bind(this)) }.bind(this)) }, t.Buffer.prototype.dispose = function() { return t.prototype.dispose.call(this), this._buffer = null, this._xhr && (t.Buffer._removeFromDownloadQueue(this._xhr), this._xhr.abort(), this._xhr = null), this }, Object.defineProperty(t.Buffer.prototype, "loaded", { get: function() { return this.length > 0 } }), Object.defineProperty(t.Buffer.prototype, "duration", { get: function() { return this._buffer ? this._buffer.duration : 0 } }), Object.defineProperty(t.Buffer.prototype, "length", { get: function() { return this._buffer ? this._buffer.length : 0 } }), Object.defineProperty(t.Buffer.prototype, "numberOfChannels", { get: function() { return this._buffer ? this._buffer.numberOfChannels : 0 } }), t.Buffer.prototype.fromArray = function(t) { var e, i = t[0].length > 0,
                    n = i ? t.length : 1,
                    s = i ? t[0].length : t.length,
                    o = this.context.createBuffer(n, s, this.context.sampleRate); for (i || 1 !== n || (t = [t]), e = 0; e < n; e++) o.copyToChannel(t[e], e); return this._buffer = o, this }, t.Buffer.prototype.toMono = function(e) { var i, n, s, o, r; if (t.isNumber(e)) this.fromArray(this.toArray(e));
                else { for (i = new Float32Array(this.length), n = this.numberOfChannels, s = 0; s < n; s++)
                        for (o = this.toArray(s), r = 0; r < o.length; r++) i[r] += o[r];
                    i = i.map(function(t) { return t / n }), this.fromArray(i) } return this }, t.Buffer.prototype.toArray = function(e) { var i, n; if (t.isNumber(e)) return this.getChannelData(e); if (1 === this.numberOfChannels) return this.toArray(0); for (i = [], n = 0; n < this.numberOfChannels; n++) i[n] = this.getChannelData(n); return i }, t.Buffer.prototype.getChannelData = function(t) { return this._buffer.getChannelData(t) }, t.Buffer.prototype.slice = function(e, i) { var n, s, o, r; for (i = t.defaultArg(i, this.duration), n = Math.floor(this.context.sampleRate * this.toSeconds(e)), s = Math.floor(this.context.sampleRate * this.toSeconds(i)), o = [], r = 0; r < this.numberOfChannels; r++) o[r] = this.toArray(r).slice(n, s); return (new t.Buffer).fromArray(o) }, t.Buffer.prototype._reverse = function() { if (this.loaded)
                    for (var t = 0; t < this.numberOfChannels; t++) Array.prototype.reverse.call(this.getChannelData(t)); return this }, Object.defineProperty(t.Buffer.prototype, "reverse", { get: function() { return this._reversed }, set: function(t) { this._reversed !== t && (this._reversed = t, this._reverse()) } }), t.Emitter.mixin(t.Buffer), t.Buffer._downloadQueue = [], t.Buffer.baseUrl = "", t.Buffer.fromArray = function(e) { return (new t.Buffer).fromArray(e) }, t.Buffer._removeFromDownloadQueue = function(e) { var i = t.Buffer._downloadQueue.indexOf(e); - 1 !== i && t.Buffer._downloadQueue.splice(i, 1) }, t.Buffer.load = function(e, i, n) {
                function s(e) { if (t.Buffer._removeFromDownloadQueue(u), t.Buffer.emit("error", e), !n) throw e;
                    n(e) }

                function o() { var e, i = 0; for (e = 0; e < t.Buffer._downloadQueue.length; e++) i += t.Buffer._downloadQueue[e].progress;
                    t.Buffer.emit("progress", i / t.Buffer._downloadQueue.length) }
                var r, a, l, h, u;
                if (i = t.defaultArg(i, t.noOp), r = e.match(/\[(.+\|?)+\]$/)) { for (a = r[1].split("|"), l = a[0], h = 0; h < a.length; h++)
                        if (t.Buffer.supportsType(a[h])) { l = a[h]; break } e = e.replace(r[0], l) }
                return u = new XMLHttpRequest, u.open("GET", t.Buffer.baseUrl + e, !0), u.responseType = "arraybuffer", u.progress = 0, t.Buffer._downloadQueue.push(u), u.addEventListener("load", function() { 200 === u.status ? t.context.decodeAudioData(u.response, function(e) { u.progress = 1, o(), i(e), t.Buffer._removeFromDownloadQueue(u), 0 === t.Buffer._downloadQueue.length && t.Buffer.emit("load") }, function() { t.Buffer._removeFromDownloadQueue(u), s("Tone.Buffer: could not decode audio data: " + e) }) : s("Tone.Buffer: could not locate file: " + e) }), u.addEventListener("error", s), u.addEventListener("progress", function(t) { t.lengthComputable && (u.progress = t.loaded / t.total * .95, o()) }), u.send(), u
            }, t.Buffer.cancelDownloads = function() { return t.Buffer._downloadQueue.slice().forEach(function(e) { t.Buffer._removeFromDownloadQueue(e), e.abort() }), t.Buffer }, t.Buffer.supportsType = function(t) { var e = t.split("."); return e = e[e.length - 1], "" !== document.createElement("audio").canPlayType("audio/" + e) }, t.loaded = function() {
                function e() { t.Buffer.off("load", i), t.Buffer.off("error", n) } var i, n; return new Promise(function(e, s) { i = function() { e() }, n = function() { s() }, t.Buffer.on("load", i), t.Buffer.on("error", n) }).then(e).catch(function(t) { throw e(), new Error(t) }) }, t.Buffer
        }), t(function(t) { return t.Buffers = function(e) { var i, n, s = Array.prototype.slice.call(arguments);
                s.shift(), i = t.defaults(s, ["onload", "baseUrl"], t.Buffers), t.call(this), this._buffers = {}, this.baseUrl = i.baseUrl, this._loadingCount = 0; for (n in e) this._loadingCount++, this.add(n, e[n], this._bufferLoaded.bind(this, i.onload)) }, t.extend(t.Buffers), t.Buffers.defaults = { onload: t.noOp, baseUrl: "" }, t.Buffers.prototype.has = function(t) { return this._buffers.hasOwnProperty(t) }, t.Buffers.prototype.get = function(t) { if (this.has(t)) return this._buffers[t]; throw new Error("Tone.Buffers: no buffer named " + t) }, t.Buffers.prototype._bufferLoaded = function(t) { 0 === --this._loadingCount && t && t(this) }, Object.defineProperty(t.Buffers.prototype, "loaded", { get: function() { var t, e, i = !0; for (t in this._buffers) e = this.get(t), i = i && e.loaded; return i } }), t.Buffers.prototype.add = function(e, i, n) { return n = t.defaultArg(n, t.noOp), i instanceof t.Buffer ? (this._buffers[e] = i, n(this)) : i instanceof AudioBuffer ? (this._buffers[e] = new t.Buffer(i), n(this)) : t.isString(i) && (this._buffers[e] = new t.Buffer(this.baseUrl + i, n)), this }, t.Buffers.prototype.dispose = function() { t.prototype.dispose.call(this); for (var e in this._buffers) this._buffers[e].dispose(); return this._buffers = null, this }, t.Buffers }), t(function(t) { var e = {}; return t.prototype.send = function(i, n) { e.hasOwnProperty(i) || (e[i] = this.context.createGain()), n = t.defaultArg(n, 0); var s = new t.Gain(n, t.Type.Decibels); return this.output.chain(s, e[i]), s }, t.prototype.receive = function(t, i) { return e.hasOwnProperty(t) || (e[t] = this.context.createGain()), e[t].connect(this, 0, i), this }, t.Context.on("init", function(t) { t.Buses ? e = t.Buses : (e = {}, t.Buses = e) }), t }), t(function(t) { return t.Draw = function() { t.call(this), this._events = new t.Timeline, this.expiration = .25, this.anticipation = .008, this._boundDrawLoop = this._drawLoop.bind(this) }, t.extend(t.Draw), t.Draw.prototype.schedule = function(t, e) { return this._events.add({ callback: t, time: this.toSeconds(e) }), 1 === this._events.length && requestAnimationFrame(this._boundDrawLoop), this }, t.Draw.prototype.cancel = function(t) { return this._events.cancel(this.toSeconds(t)), this }, t.Draw.prototype._drawLoop = function() { for (var e, i = t.now(); this._events.length && this._events.peek().time - this.anticipation <= i;) e = this._events.shift(), i - e.time <= this.expiration && e.callback();
                this._events.length > 0 && requestAnimationFrame(this._boundDrawLoop) }, t.Draw = new t.Draw, t.Draw }), t(function(t) { t.Listener = function() { t.call(this), this._orientation = [0, 0, 0, 0, 0, 0], this._position = [0, 0, 0], t.getContext(function() { this.set(e.defaults) }.bind(this)) }, t.extend(t.Listener), t.Listener.defaults = { positionX: 0, positionY: 0, positionZ: 0, forwardX: 0, forwardY: 0, forwardZ: 1, upX: 0, upY: 1, upZ: 0 }, t.Listener.prototype._rampTimeConstant = .01, t.Listener.prototype.setPosition = function(t, e, i) { if (this.context.listener.positionX) { var n = this.now();
                    this.context.listener.positionX.setTargetAtTime(t, n, this._rampTimeConstant), this.context.listener.positionY.setTargetAtTime(e, n, this._rampTimeConstant), this.context.listener.positionZ.setTargetAtTime(i, n, this._rampTimeConstant) } else this.context.listener.setPosition(t, e, i); return this._position = Array.prototype.slice.call(arguments), this }, t.Listener.prototype.setOrientation = function(t, e, i, n, s, o) { if (this.context.listener.forwardX) { var r = this.now();
                    this.context.listener.forwardX.setTargetAtTime(t, r, this._rampTimeConstant), this.context.listener.forwardY.setTargetAtTime(e, r, this._rampTimeConstant), this.context.listener.forwardZ.setTargetAtTime(i, r, this._rampTimeConstant), this.context.listener.upX.setTargetAtTime(n, r, this._rampTimeConstant), this.context.listener.upY.setTargetAtTime(s, r, this._rampTimeConstant), this.context.listener.upZ.setTargetAtTime(o, r, this._rampTimeConstant) } else this.context.listener.setOrientation(t, e, i, n, s, o); return this._orientation = Array.prototype.slice.call(arguments), this }, Object.defineProperty(t.Listener.prototype, "positionX", { set: function(t) { this._position[0] = t, this.setPosition.apply(this, this._position) }, get: function() { return this._position[0] } }), Object.defineProperty(t.Listener.prototype, "positionY", { set: function(t) { this._position[1] = t, this.setPosition.apply(this, this._position) }, get: function() { return this._position[1] } }), Object.defineProperty(t.Listener.prototype, "positionZ", { set: function(t) { this._position[2] = t, this.setPosition.apply(this, this._position) }, get: function() { return this._position[2] } }), Object.defineProperty(t.Listener.prototype, "forwardX", { set: function(t) { this._orientation[0] = t, this.setOrientation.apply(this, this._orientation) }, get: function() { return this._orientation[0] } }), Object.defineProperty(t.Listener.prototype, "forwardY", { set: function(t) { this._orientation[1] = t, this.setOrientation.apply(this, this._orientation) }, get: function() { return this._orientation[1] } }), Object.defineProperty(t.Listener.prototype, "forwardZ", { set: function(t) { this._orientation[2] = t, this.setOrientation.apply(this, this._orientation) }, get: function() { return this._orientation[2] } }), Object.defineProperty(t.Listener.prototype, "upX", { set: function(t) { this._orientation[3] = t, this.setOrientation.apply(this, this._orientation) }, get: function() { return this._orientation[3] } }), Object.defineProperty(t.Listener.prototype, "upY", { set: function(t) { this._orientation[4] = t, this.setOrientation.apply(this, this._orientation) }, get: function() { return this._orientation[4] } }), Object.defineProperty(t.Listener.prototype, "upZ", { set: function(t) { this._orientation[5] = t, this.setOrientation.apply(this, this._orientation) }, get: function() { return this._orientation[5] } }), t.Listener.prototype.dispose = function() { return this._orientation = null, this._position = null, this }; var e = t.Listener; return t.Listener = new e, t.Context.on("init", function(i) { i.Listener instanceof e ? t.Listener = i.Listener : t.Listener = new e, i.Listener = t.Listener }), t.Listener }), t(function(t) { var e;
            t.supported && (!window.hasOwnProperty("OfflineAudioContext") && window.hasOwnProperty("webkitOfflineAudioContext") && (window.OfflineAudioContext = window.webkitOfflineAudioContext), e = new OfflineAudioContext(1, 1, 44100), e.startRendering() instanceof Promise || (OfflineAudioContext.prototype._native_startRendering = OfflineAudioContext.prototype.startRendering, OfflineAudioContext.prototype.startRendering = function() { return new Promise(function(t) { this.oncomplete = function(e) { t(e.renderedBuffer) }, this._native_startRendering() }.bind(this)) })) }), t(function(t) { return t.OfflineContext = function(e, i, n) { var s = new OfflineAudioContext(e, i * n, n);
                t.Context.call(this, { context: s, clockSource: "offline", lookAhead: 0, updateInterval: 128 / n }), this._duration = i, this._currentTime = 0 }, t.extend(t.OfflineContext, t.Context), t.OfflineContext.prototype.now = function() { return this._currentTime }, t.OfflineContext.prototype.render = function() { for (; this._duration - this._currentTime >= 0;) this.emit("tick"), this._currentTime += this.blockTime; return this._context.startRendering() }, t.OfflineContext.prototype.close = function() { return this._context = null, Promise.resolve() }, t.OfflineContext }), t(function(t) { return t.Offline = function(e, i) { var n, s = t.context.sampleRate,
                    o = t.context,
                    r = new t.OfflineContext(2, i, s); return t.context = r, e(t.Transport), n = r.render(), t.context = o, n.then(function(e) { return new t.Buffer(e) }) }, t.Offline }), t(function(t) { return t.Effect = function() { var e = t.defaults(arguments, ["wet"], t.Effect);
                t.AudioNode.call(this), this.createInsOuts(1, 1), this._dryWet = new t.CrossFade(e.wet), this.wet = this._dryWet.fade, this.effectSend = new t.Gain, this.effectReturn = new t.Gain, this.input.connect(this._dryWet.a), this.input.connect(this.effectSend), this.effectReturn.connect(this._dryWet.b), this._dryWet.connect(this.output), this._readOnly(["wet"]) }, t.extend(t.Effect, t.AudioNode), t.Effect.defaults = { wet: 1 }, t.Effect.prototype.connectEffect = function(t) { return this.effectSend.chain(t, this.effectReturn), this }, t.Effect.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._dryWet.dispose(), this._dryWet = null, this.effectSend.dispose(), this.effectSend = null, this.effectReturn.dispose(), this.effectReturn = null, this._writable(["wet"]), this.wet = null, this }, t.Effect }), t(function(t) { return t.AutoFilter = function() { var e = t.defaults(arguments, ["frequency", "baseFrequency", "octaves"], t.AutoFilter);
                t.Effect.call(this, e), this._lfo = new t.LFO({ frequency: e.frequency, amplitude: e.depth }), this.depth = this._lfo.amplitude, this.frequency = this._lfo.frequency, this.filter = new t.Filter(e.filter), this._octaves = 0, this.connectEffect(this.filter), this._lfo.connect(this.filter.frequency), this.type = e.type, this._readOnly(["frequency", "depth"]), this.octaves = e.octaves, this.baseFrequency = e.baseFrequency }, t.extend(t.AutoFilter, t.Effect), t.AutoFilter.defaults = { frequency: 1, type: "sine", depth: 1, baseFrequency: 200, octaves: 2.6, filter: { type: "lowpass", rolloff: -12, Q: 1 } }, t.AutoFilter.prototype.start = function(t) { return this._lfo.start(t), this }, t.AutoFilter.prototype.stop = function(t) { return this._lfo.stop(t), this }, t.AutoFilter.prototype.sync = function(t) { return this._lfo.sync(t), this }, t.AutoFilter.prototype.unsync = function() { return this._lfo.unsync(), this }, Object.defineProperty(t.AutoFilter.prototype, "type", { get: function() { return this._lfo.type }, set: function(t) { this._lfo.type = t } }), Object.defineProperty(t.AutoFilter.prototype, "baseFrequency", { get: function() { return this._lfo.min }, set: function(t) { this._lfo.min = this.toFrequency(t), this.octaves = this._octaves } }), Object.defineProperty(t.AutoFilter.prototype, "octaves", { get: function() { return this._octaves }, set: function(t) { this._octaves = t, this._lfo.max = this.baseFrequency * Math.pow(2, t) } }), t.AutoFilter.prototype.dispose = function() { return t.Effect.prototype.dispose.call(this), this._lfo.dispose(), this._lfo = null, this.filter.dispose(), this.filter = null, this._writable(["frequency", "depth"]), this.frequency = null, this.depth = null, this }, t.AutoFilter }), t(function(t) { return t.AutoPanner = function() { var e = t.defaults(arguments, ["frequency"], t.AutoPanner);
                t.Effect.call(this, e), this._lfo = new t.LFO({ frequency: e.frequency, amplitude: e.depth, min: -1, max: 1 }), this.depth = this._lfo.amplitude, this._panner = new t.Panner, this.frequency = this._lfo.frequency, this.connectEffect(this._panner), this._lfo.connect(this._panner.pan), this.type = e.type, this._readOnly(["depth", "frequency"]) }, t.extend(t.AutoPanner, t.Effect), t.AutoPanner.defaults = { frequency: 1, type: "sine", depth: 1 }, t.AutoPanner.prototype.start = function(t) { return this._lfo.start(t), this }, t.AutoPanner.prototype.stop = function(t) { return this._lfo.stop(t), this }, t.AutoPanner.prototype.sync = function(t) { return this._lfo.sync(t), this }, t.AutoPanner.prototype.unsync = function() { return this._lfo.unsync(), this }, Object.defineProperty(t.AutoPanner.prototype, "type", { get: function() { return this._lfo.type }, set: function(t) { this._lfo.type = t } }), t.AutoPanner.prototype.dispose = function() { return t.Effect.prototype.dispose.call(this), this._lfo.dispose(), this._lfo = null, this._panner.dispose(), this._panner = null, this._writable(["depth", "frequency"]), this.frequency = null, this.depth = null, this }, t.AutoPanner }), t(function(t) { return t.AutoWah = function() { var e = t.defaults(arguments, ["baseFrequency", "octaves", "sensitivity"], t.AutoWah);
                t.Effect.call(this, e), this.follower = new t.Follower(e.follower), this._sweepRange = new t.ScaleExp(0, 1, .5), this._baseFrequency = e.baseFrequency, this._octaves = e.octaves, this._inputBoost = new t.Gain, this._bandpass = new t.Filter({ rolloff: -48, frequency: 0, Q: e.Q }), this._peaking = new t.Filter(0, "peaking"), this._peaking.gain.value = e.gain, this.gain = this._peaking.gain, this.Q = this._bandpass.Q, this.effectSend.chain(this._inputBoost, this.follower, this._sweepRange), this._sweepRange.connect(this._bandpass.frequency), this._sweepRange.connect(this._peaking.frequency), this.effectSend.chain(this._bandpass, this._peaking, this.effectReturn), this._setSweepRange(), this.sensitivity = e.sensitivity, this._readOnly(["gain", "Q"]) }, t.extend(t.AutoWah, t.Effect), t.AutoWah.defaults = { baseFrequency: 100, octaves: 6, sensitivity: 0, Q: 2, gain: 2, follower: { attack: .3, release: .5 } }, Object.defineProperty(t.AutoWah.prototype, "octaves", { get: function() { return this._octaves }, set: function(t) { this._octaves = t, this._setSweepRange() } }), Object.defineProperty(t.AutoWah.prototype, "baseFrequency", { get: function() { return this._baseFrequency }, set: function(t) { this._baseFrequency = t, this._setSweepRange() } }), Object.defineProperty(t.AutoWah.prototype, "sensitivity", { get: function() { return t.gainToDb(1 / this._inputBoost.gain.value) }, set: function(e) { this._inputBoost.gain.value = 1 / t.dbToGain(e) } }), t.AutoWah.prototype._setSweepRange = function() { this._sweepRange.min = this._baseFrequency, this._sweepRange.max = Math.min(this._baseFrequency * Math.pow(2, this._octaves), this.context.sampleRate / 2) }, t.AutoWah.prototype.dispose = function() { return t.Effect.prototype.dispose.call(this), this.follower.dispose(), this.follower = null, this._sweepRange.dispose(), this._sweepRange = null, this._bandpass.dispose(), this._bandpass = null, this._peaking.dispose(), this._peaking = null, this._inputBoost.dispose(), this._inputBoost = null, this._writable(["gain", "Q"]), this.gain = null, this.Q = null, this }, t.AutoWah }), t(function(t) { return t.Modulo = function(e) { t.SignalBase.call(this), this.createInsOuts(1, 0), this._shaper = new t.WaveShaper(Math.pow(2, 16)), this._multiply = new t.Multiply, this._subtract = this.output = new t.Subtract, this._modSignal = new t.Signal(e), this.input.fan(this._shaper, this._subtract), this._modSignal.connect(this._multiply, 0, 0), this._shaper.connect(this._multiply, 0, 1), this._multiply.connect(this._subtract, 0, 1), this._setWaveShaper(e) }, t.extend(t.Modulo, t.SignalBase), t.Modulo.prototype._setWaveShaper = function(t) { this._shaper.setMap(function(e) { return Math.floor((e + 1e-4) / t) }) }, Object.defineProperty(t.Modulo.prototype, "value", { get: function() { return this._modSignal.value }, set: function(t) { this._modSignal.value = t, this._setWaveShaper(t) } }), t.Modulo.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._shaper.dispose(), this._shaper = null, this._multiply.dispose(), this._multiply = null, this._subtract.dispose(), this._subtract = null, this._modSignal.dispose(), this._modSignal = null, this }, t.Modulo }), t(function(t) { return t.BitCrusher = function() { var e, i = t.defaults(arguments, ["bits"], t.BitCrusher);
                t.Effect.call(this, i), e = 1 / Math.pow(2, i.bits - 1), this._subtract = new t.Subtract, this._modulo = new t.Modulo(e), this._bits = i.bits, this.effectSend.fan(this._subtract, this._modulo), this._modulo.connect(this._subtract, 0, 1), this._subtract.connect(this.effectReturn) }, t.extend(t.BitCrusher, t.Effect), t.BitCrusher.defaults = { bits: 4 }, Object.defineProperty(t.BitCrusher.prototype, "bits", { get: function() { return this._bits }, set: function(t) { this._bits = t; var e = 1 / Math.pow(2, t - 1);
                    this._modulo.value = e } }), t.BitCrusher.prototype.dispose = function() { return t.Effect.prototype.dispose.call(this), this._subtract.dispose(), this._subtract = null, this._modulo.dispose(), this._modulo = null, this }, t.BitCrusher }), t(function(t) { return t.Chebyshev = function() { var e = t.defaults(arguments, ["order"], t.Chebyshev);
                t.Effect.call(this, e), this._shaper = new t.WaveShaper(4096), this._order = e.order, this.connectEffect(this._shaper), this.order = e.order, this.oversample = e.oversample }, t.extend(t.Chebyshev, t.Effect), t.Chebyshev.defaults = { order: 1, oversample: "none" }, t.Chebyshev.prototype._getCoefficient = function(t, e, i) { return i.hasOwnProperty(e) ? i[e] : (i[e] = 0 === e ? 0 : 1 === e ? t : 2 * t * this._getCoefficient(t, e - 1, i) - this._getCoefficient(t, e - 2, i), i[e]) }, Object.defineProperty(t.Chebyshev.prototype, "order", { get: function() { return this._order }, set: function(t) { var e, i, n, s; for (this._order = t, e = new Array(4096), i = e.length, n = 0; n < i; ++n) s = 2 * n / i - 1, e[n] = 0 === s ? 0 : this._getCoefficient(s, t, {});
                    this._shaper.curve = e } }), Object.defineProperty(t.Chebyshev.prototype, "oversample", { get: function() { return this._shaper.oversample }, set: function(t) { this._shaper.oversample = t } }), t.Chebyshev.prototype.dispose = function() { return t.Effect.prototype.dispose.call(this), this._shaper.dispose(), this._shaper = null, this }, t.Chebyshev }), t(function(t) { return t.StereoEffect = function() { t.AudioNode.call(this); var e = t.defaults(arguments, ["wet"], t.Effect);
                this.createInsOuts(1, 1), this._dryWet = new t.CrossFade(e.wet), this.wet = this._dryWet.fade, this._split = new t.Split, this.effectSendL = this._split.left, this.effectSendR = this._split.right, this._merge = new t.Merge, this.effectReturnL = this._merge.left, this.effectReturnR = this._merge.right, this.input.connect(this._split), this.input.connect(this._dryWet, 0, 0), this._merge.connect(this._dryWet, 0, 1), this._dryWet.connect(this.output), this._readOnly(["wet"]) }, t.extend(t.StereoEffect, t.Effect), t.StereoEffect.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._dryWet.dispose(), this._dryWet = null, this._split.dispose(), this._split = null, this._merge.dispose(), this._merge = null, this.effectSendL = null, this.effectSendR = null, this.effectReturnL = null, this.effectReturnR = null, this._writable(["wet"]), this.wet = null, this }, t.StereoEffect }), t(function(t) { return t.Chorus = function() { var e = t.defaults(arguments, ["frequency", "delayTime", "depth"], t.Chorus);
                t.StereoEffect.call(this, e), this._depth = e.depth, this._delayTime = e.delayTime / 1e3, this._lfoL = new t.LFO({ frequency: e.frequency, min: 0, max: 1 }), this._lfoR = new t.LFO({ frequency: e.frequency, min: 0, max: 1, phase: 180 }), this._delayNodeL = new t.Delay, this._delayNodeR = new t.Delay, this.frequency = this._lfoL.frequency, this.effectSendL.chain(this._delayNodeL, this.effectReturnL), this.effectSendR.chain(this._delayNodeR, this.effectReturnR), this.effectSendL.connect(this.effectReturnL), this.effectSendR.connect(this.effectReturnR), this._lfoL.connect(this._delayNodeL.delayTime), this._lfoR.connect(this._delayNodeR.delayTime), this._lfoL.start(), this._lfoR.start(), this._lfoL.frequency.connect(this._lfoR.frequency), this.depth = this._depth, this.frequency.value = e.frequency, this.type = e.type, this._readOnly(["frequency"]), this.spread = e.spread }, t.extend(t.Chorus, t.StereoEffect), t.Chorus.defaults = { frequency: 1.5, delayTime: 3.5, depth: .7, type: "sine", spread: 180 }, Object.defineProperty(t.Chorus.prototype, "depth", { get: function() { return this._depth }, set: function(t) { this._depth = t; var e = this._delayTime * t;
                    this._lfoL.min = Math.max(this._delayTime - e, 0), this._lfoL.max = this._delayTime + e, this._lfoR.min = Math.max(this._delayTime - e, 0), this._lfoR.max = this._delayTime + e } }), Object.defineProperty(t.Chorus.prototype, "delayTime", { get: function() { return 1e3 * this._delayTime }, set: function(t) { this._delayTime = t / 1e3, this.depth = this._depth } }), Object.defineProperty(t.Chorus.prototype, "type", { get: function() { return this._lfoL.type }, set: function(t) { this._lfoL.type = t, this._lfoR.type = t } }), Object.defineProperty(t.Chorus.prototype, "spread", { get: function() { return this._lfoR.phase - this._lfoL.phase }, set: function(t) { this._lfoL.phase = 90 - t / 2, this._lfoR.phase = t / 2 + 90 } }), t.Chorus.prototype.dispose = function() { return t.StereoEffect.prototype.dispose.call(this), this._lfoL.dispose(), this._lfoL = null, this._lfoR.dispose(), this._lfoR = null, this._delayNodeL.dispose(), this._delayNodeL = null, this._delayNodeR.dispose(), this._delayNodeR = null, this._writable("frequency"), this.frequency = null, this }, t.Chorus }), t(function(t) { return t.Convolver = function() { var e = t.defaults(arguments, ["url", "onload"], t.Convolver);
                t.Effect.call(this, e), this._convolver = this.context.createConvolver(), this._buffer = new t.Buffer, t.isString(e.url) ? this._buffer.load(e.url, function(t) { this.buffer = t, e.onload() }.bind(this)) : e.url && (this.buffer = e.url, e.onload()), this.connectEffect(this._convolver) }, t.extend(t.Convolver, t.Effect), t.Convolver.defaults = { onload: t.noOp }, Object.defineProperty(t.Convolver.prototype, "buffer", { get: function() { return this._buffer.get() }, set: function(t) { this._buffer.set(t), this._convolver.buffer = this._buffer.get() } }), t.Convolver.prototype.load = function(t, e) { return this._buffer.load(t, function(t) { this.buffer = t, e && e() }.bind(this)) }, t.Convolver.prototype.dispose = function() { return t.Effect.prototype.dispose.call(this), this._convolver.disconnect(), this._convolver = null, this._buffer.dispose(), this._buffer = null, this }, t.Convolver }), t(function(t) { return t.Distortion = function() { var e = t.defaults(arguments, ["distortion"], t.Distortion);
                t.Effect.call(this, e), this._shaper = new t.WaveShaper(4096), this._distortion = e.distortion, this.connectEffect(this._shaper), this.distortion = e.distortion, this.oversample = e.oversample }, t.extend(t.Distortion, t.Effect), t.Distortion.defaults = { distortion: .4, oversample: "none" }, Object.defineProperty(t.Distortion.prototype, "distortion", { get: function() { return this._distortion }, set: function(t) { var e, i;
                    this._distortion = t, e = 100 * t, i = Math.PI / 180, this._shaper.setMap(function(t) { return Math.abs(t) < .001 ? 0 : (3 + e) * t * 20 * i / (Math.PI + e * Math.abs(t)) }) } }), Object.defineProperty(t.Distortion.prototype, "oversample", { get: function() { return this._shaper.oversample }, set: function(t) { this._shaper.oversample = t } }), t.Distortion.prototype.dispose = function() { return t.Effect.prototype.dispose.call(this), this._shaper.dispose(), this._shaper = null, this }, t.Distortion }), t(function(t) { return t.FeedbackEffect = function() { var e = t.defaults(arguments, ["feedback"], t.FeedbackEffect);
                t.Effect.call(this, e), this._feedbackGain = new t.Gain(e.feedback, t.Type.NormalRange), this.feedback = this._feedbackGain.gain, this.effectReturn.chain(this._feedbackGain, this.effectSend), this._readOnly(["feedback"]) }, t.extend(t.FeedbackEffect, t.Effect), t.FeedbackEffect.defaults = { feedback: .125 }, t.FeedbackEffect.prototype.dispose = function() { return t.Effect.prototype.dispose.call(this), this._writable(["feedback"]), this._feedbackGain.dispose(), this._feedbackGain = null, this.feedback = null, this }, t.FeedbackEffect }), t(function(t) { return t.FeedbackDelay = function() { var e = t.defaults(arguments, ["delayTime", "feedback"], t.FeedbackDelay);
                t.FeedbackEffect.call(this, e), this._delayNode = new t.Delay(e.delayTime), this.delayTime = this._delayNode.delayTime, this.connectEffect(this._delayNode), this._readOnly(["delayTime"]) }, t.extend(t.FeedbackDelay, t.FeedbackEffect), t.FeedbackDelay.defaults = { delayTime: .25 }, t.FeedbackDelay.prototype.dispose = function() { return t.FeedbackEffect.prototype.dispose.call(this), this._delayNode.dispose(), this._delayNode = null, this._writable(["delayTime"]), this.delayTime = null, this }, t.FeedbackDelay }), t(function(t) { var e = [1557 / 44100, 1617 / 44100, 1491 / 44100, 1422 / 44100, 1277 / 44100, 1356 / 44100, 1188 / 44100, 1116 / 44100],
                i = [225, 556, 441, 341]; return t.Freeverb = function() { var n, s, o, r, a, l, h = t.defaults(arguments, ["roomSize", "dampening"], t.Freeverb); for (t.StereoEffect.call(this, h), this.roomSize = new t.Signal(h.roomSize, t.Type.NormalRange), this.dampening = new t.Signal(h.dampening, t.Type.Frequency), this._combFilters = [], this._allpassFiltersL = [], this._allpassFiltersR = [], n = 0; n < i.length; n++) s = this.context.createBiquadFilter(), s.type = "allpass", s.frequency.value = i[n], this._allpassFiltersL.push(s); for (o = 0; o < i.length; o++) r = this.context.createBiquadFilter(), r.type = "allpass", r.frequency.value = i[o], this._allpassFiltersR.push(r); for (a = 0; a < e.length; a++) l = new t.LowpassCombFilter(e[a]), a < e.length / 2 ? this.effectSendL.chain(l, this._allpassFiltersL[0]) : this.effectSendR.chain(l, this._allpassFiltersR[0]), this.roomSize.connect(l.resonance), this.dampening.connect(l.dampening), this._combFilters.push(l);
                t.connectSeries.apply(t, this._allpassFiltersL), t.connectSeries.apply(t, this._allpassFiltersR), this._allpassFiltersL[this._allpassFiltersL.length - 1].connect(this.effectReturnL), this._allpassFiltersR[this._allpassFiltersR.length - 1].connect(this.effectReturnR), this._readOnly(["roomSize", "dampening"]) }, t.extend(t.Freeverb, t.StereoEffect), t.Freeverb.defaults = { roomSize: .7, dampening: 3e3 }, t.Freeverb.prototype.dispose = function() { var e, i, n; for (t.StereoEffect.prototype.dispose.call(this), e = 0; e < this._allpassFiltersL.length; e++) this._allpassFiltersL[e].disconnect(), this._allpassFiltersL[e] = null; for (this._allpassFiltersL = null, i = 0; i < this._allpassFiltersR.length; i++) this._allpassFiltersR[i].disconnect(), this._allpassFiltersR[i] = null; for (this._allpassFiltersR = null, n = 0; n < this._combFilters.length; n++) this._combFilters[n].dispose(), this._combFilters[n] = null; return this._combFilters = null, this._writable(["roomSize", "dampening"]), this.roomSize.dispose(), this.roomSize = null, this.dampening.dispose(), this.dampening = null, this }, t.Freeverb }), t(function(t) { var e = [.06748, .06404, .08212, .09004],
                i = [.773, .802, .753, .733],
                n = [347, 113, 37]; return t.JCReverb = function() { var s, o, r, a, l = t.defaults(arguments, ["roomSize"], t.JCReverb); for (t.StereoEffect.call(this, l), this.roomSize = new t.Signal(l.roomSize, t.Type.NormalRange), this._scaleRoomSize = new t.Scale(-.733, .197), this._allpassFilters = [], this._feedbackCombFilters = [], s = 0; s < n.length; s++) o = this.context.createBiquadFilter(), o.type = "allpass", o.frequency.value = n[s], this._allpassFilters.push(o); for (r = 0; r < e.length; r++) a = new t.FeedbackCombFilter(e[r], .1), this._scaleRoomSize.connect(a.resonance), a.resonance.value = i[r], this._allpassFilters[this._allpassFilters.length - 1].connect(a), r < e.length / 2 ? a.connect(this.effectReturnL) : a.connect(this.effectReturnR), this._feedbackCombFilters.push(a);
                this.roomSize.connect(this._scaleRoomSize), t.connectSeries.apply(t, this._allpassFilters), this.effectSendL.connect(this._allpassFilters[0]), this.effectSendR.connect(this._allpassFilters[0]), this._readOnly(["roomSize"]) }, t.extend(t.JCReverb, t.StereoEffect), t.JCReverb.defaults = { roomSize: .5 }, t.JCReverb.prototype.dispose = function() { var e, i; for (t.StereoEffect.prototype.dispose.call(this), e = 0; e < this._allpassFilters.length; e++) this._allpassFilters[e].disconnect(), this._allpassFilters[e] = null; for (this._allpassFilters = null, i = 0; i < this._feedbackCombFilters.length; i++) this._feedbackCombFilters[i].dispose(), this._feedbackCombFilters[i] = null; return this._feedbackCombFilters = null, this._writable(["roomSize"]), this.roomSize.dispose(), this.roomSize = null, this._scaleRoomSize.dispose(), this._scaleRoomSize = null, this }, t.JCReverb }), t(function(t) { return t.MidSideEffect = function() { t.Effect.apply(this, arguments), this._midSideSplit = new t.MidSideSplit, this._midSideMerge = new t.MidSideMerge, this.midSend = this._midSideSplit.mid, this.sideSend = this._midSideSplit.side, this.midReturn = this._midSideMerge.mid, this.sideReturn = this._midSideMerge.side, this.effectSend.connect(this._midSideSplit), this._midSideMerge.connect(this.effectReturn) }, t.extend(t.MidSideEffect, t.Effect), t.MidSideEffect.prototype.dispose = function() { return t.Effect.prototype.dispose.call(this), this._midSideSplit.dispose(), this._midSideSplit = null, this._midSideMerge.dispose(), this._midSideMerge = null, this.midSend = null, this.sideSend = null, this.midReturn = null, this.sideReturn = null, this }, t.MidSideEffect }), t(function(t) { return t.Phaser = function() { var e = t.defaults(arguments, ["frequency", "octaves", "baseFrequency"], t.Phaser);
                t.StereoEffect.call(this, e), this._lfoL = new t.LFO(e.frequency, 0, 1), this._lfoR = new t.LFO(e.frequency, 0, 1), this._lfoR.phase = 180, this._baseFrequency = e.baseFrequency, this._octaves = e.octaves, this.Q = new t.Signal(e.Q, t.Type.Positive), this._filtersL = this._makeFilters(e.stages, this._lfoL, this.Q), this._filtersR = this._makeFilters(e.stages, this._lfoR, this.Q), this.frequency = this._lfoL.frequency, this.frequency.value = e.frequency, this.effectSendL.connect(this._filtersL[0]), this.effectSendR.connect(this._filtersR[0]), this._filtersL[e.stages - 1].connect(this.effectReturnL), this._filtersR[e.stages - 1].connect(this.effectReturnR), this._lfoL.frequency.connect(this._lfoR.frequency), this.baseFrequency = e.baseFrequency, this.octaves = e.octaves, this._lfoL.start(), this._lfoR.start(), this._readOnly(["frequency", "Q"]) }, t.extend(t.Phaser, t.StereoEffect), t.Phaser.defaults = { frequency: .5, octaves: 3, stages: 10, Q: 10, baseFrequency: 350 }, t.Phaser.prototype._makeFilters = function(e, i, n) { var s, o, r = new Array(e); for (s = 0; s < e; s++) o = this.context.createBiquadFilter(), o.type = "allpass", n.connect(o.Q), i.connect(o.frequency), r[s] = o; return t.connectSeries.apply(t, r), r }, Object.defineProperty(t.Phaser.prototype, "octaves", { get: function() { return this._octaves }, set: function(t) { this._octaves = t; var e = this._baseFrequency * Math.pow(2, t);
                    this._lfoL.max = e, this._lfoR.max = e } }), Object.defineProperty(t.Phaser.prototype, "baseFrequency", { get: function() { return this._baseFrequency }, set: function(t) { this._baseFrequency = t, this._lfoL.min = t, this._lfoR.min = t, this.octaves = this._octaves } }), t.Phaser.prototype.dispose = function() { var e, i; for (t.StereoEffect.prototype.dispose.call(this), this._writable(["frequency", "Q"]), this.Q.dispose(), this.Q = null, this._lfoL.dispose(), this._lfoL = null, this._lfoR.dispose(), this._lfoR = null, e = 0; e < this._filtersL.length; e++) this._filtersL[e].disconnect(), this._filtersL[e] = null; for (this._filtersL = null, i = 0; i < this._filtersR.length; i++) this._filtersR[i].disconnect(), this._filtersR[i] = null; return this._filtersR = null, this.frequency = null, this }, t.Phaser }), t(function(t) { return t.StereoXFeedbackEffect = function() { var e = t.defaults(arguments, ["feedback"], t.FeedbackEffect);
                t.StereoEffect.call(this, e), this.feedback = new t.Signal(e.feedback, t.Type.NormalRange), this._feedbackLR = new t.Gain, this._feedbackRL = new t.Gain, this.effectReturnL.chain(this._feedbackLR, this.effectSendR), this.effectReturnR.chain(this._feedbackRL, this.effectSendL), this.feedback.fan(this._feedbackLR.gain, this._feedbackRL.gain), this._readOnly(["feedback"]) }, t.extend(t.StereoXFeedbackEffect, t.StereoEffect), t.StereoXFeedbackEffect.prototype.dispose = function() { return t.StereoEffect.prototype.dispose.call(this), this._writable(["feedback"]), this.feedback.dispose(), this.feedback = null, this._feedbackLR.dispose(), this._feedbackLR = null, this._feedbackRL.dispose(), this._feedbackRL = null, this }, t.StereoXFeedbackEffect }), t(function(t) { return t.PingPongDelay = function() { var e = t.defaults(arguments, ["delayTime", "feedback"], t.PingPongDelay);
                t.StereoXFeedbackEffect.call(this, e), this._leftDelay = new t.Delay(0, e.maxDelayTime), this._rightDelay = new t.Delay(0, e.maxDelayTime), this._rightPreDelay = new t.Delay(0, e.maxDelayTime), this.delayTime = new t.Signal(e.delayTime, t.Type.Time), this.effectSendL.chain(this._leftDelay, this.effectReturnL), this.effectSendR.chain(this._rightPreDelay, this._rightDelay, this.effectReturnR), this.delayTime.fan(this._leftDelay.delayTime, this._rightDelay.delayTime, this._rightPreDelay.delayTime), this._feedbackLR.disconnect(), this._feedbackLR.connect(this._rightDelay), this._readOnly(["delayTime"]) }, t.extend(t.PingPongDelay, t.StereoXFeedbackEffect), t.PingPongDelay.defaults = { delayTime: .25, maxDelayTime: 1 }, t.PingPongDelay.prototype.dispose = function() { return t.StereoXFeedbackEffect.prototype.dispose.call(this), this._leftDelay.dispose(), this._leftDelay = null, this._rightDelay.dispose(), this._rightDelay = null, this._rightPreDelay.dispose(), this._rightPreDelay = null, this._writable(["delayTime"]), this.delayTime.dispose(), this.delayTime = null, this }, t.PingPongDelay }), t(function(t) {
            return t.PitchShift = function() {
                var e, i = t.defaults(arguments, ["pitch"], t.PitchShift);
                t.FeedbackEffect.call(this, i), this._frequency = new t.Signal(0), this._delayA = new t.Delay(0, 1), this._lfoA = new t.LFO({
                    min: 0,
                    max: .1,
                    type: "sawtooth"
                }).connect(this._delayA.delayTime), this._delayB = new t.Delay(0, 1), this._lfoB = new t.LFO({ min: 0, max: .1, type: "sawtooth", phase: 180 }).connect(this._delayB.delayTime), this._crossFade = new t.CrossFade, this._crossFadeLFO = new t.LFO({ min: 0, max: 1, type: "triangle", phase: 90 }).connect(this._crossFade.fade), this._feedbackDelay = new t.Delay(i.delayTime), this.delayTime = this._feedbackDelay.delayTime, this._readOnly("delayTime"), this._pitch = i.pitch, this._windowSize = i.windowSize, this._delayA.connect(this._crossFade.a), this._delayB.connect(this._crossFade.b), this._frequency.fan(this._lfoA.frequency, this._lfoB.frequency, this._crossFadeLFO.frequency), this.effectSend.fan(this._delayA, this._delayB), this._crossFade.chain(this._feedbackDelay, this.effectReturn), e = this.now(), this._lfoA.start(e), this._lfoB.start(e), this._crossFadeLFO.start(e), this.windowSize = this._windowSize
            }, t.extend(t.PitchShift, t.FeedbackEffect), t.PitchShift.defaults = { pitch: 0, windowSize: .1, delayTime: 0, feedback: 0 }, Object.defineProperty(t.PitchShift.prototype, "pitch", { get: function() { return this._pitch }, set: function(e) { this._pitch = e; var i = 0;
                    e < 0 ? (this._lfoA.min = 0, this._lfoA.max = this._windowSize, this._lfoB.min = 0, this._lfoB.max = this._windowSize, i = t.intervalToFrequencyRatio(e - 1) + 1) : (this._lfoA.min = this._windowSize, this._lfoA.max = 0, this._lfoB.min = this._windowSize, this._lfoB.max = 0, i = t.intervalToFrequencyRatio(e) - 1), this._frequency.value = i * (1.2 / this._windowSize) } }), Object.defineProperty(t.PitchShift.prototype, "windowSize", { get: function() { return this._windowSize }, set: function(t) { this._windowSize = this.toSeconds(t), this.pitch = this._pitch } }), t.PitchShift.prototype.dispose = function() { return t.FeedbackEffect.prototype.dispose.call(this), this._frequency.dispose(), this._frequency = null, this._delayA.disconnect(), this._delayA = null, this._delayB.disconnect(), this._delayB = null, this._lfoA.dispose(), this._lfoA = null, this._lfoB.dispose(), this._lfoB = null, this._crossFade.dispose(), this._crossFade = null, this._crossFadeLFO.dispose(), this._crossFadeLFO = null, this._writable("delayTime"), this._feedbackDelay.dispose(), this._feedbackDelay = null, this.delayTime = null, this }, t.PitchShift
        }), t(function(t) { return t.StereoFeedbackEffect = function() { var e = t.defaults(arguments, ["feedback"], t.FeedbackEffect);
                t.StereoEffect.call(this, e), this.feedback = new t.Signal(e.feedback, t.Type.NormalRange), this._feedbackL = new t.Gain, this._feedbackR = new t.Gain, this.effectReturnL.chain(this._feedbackL, this.effectSendL), this.effectReturnR.chain(this._feedbackR, this.effectSendR), this.feedback.fan(this._feedbackL.gain, this._feedbackR.gain), this._readOnly(["feedback"]) }, t.extend(t.StereoFeedbackEffect, t.StereoEffect), t.StereoFeedbackEffect.prototype.dispose = function() { return t.StereoEffect.prototype.dispose.call(this), this._writable(["feedback"]), this.feedback.dispose(), this.feedback = null, this._feedbackL.dispose(), this._feedbackL = null, this._feedbackR.dispose(), this._feedbackR = null, this }, t.StereoFeedbackEffect }), t(function(t) { return t.StereoWidener = function() { var e = t.defaults(arguments, ["width"], t.StereoWidener);
                t.MidSideEffect.call(this, e), this.width = new t.Signal(e.width, t.Type.NormalRange), this._readOnly(["width"]), this._twoTimesWidthMid = new t.Multiply(2), this._twoTimesWidthSide = new t.Multiply(2), this._midMult = new t.Multiply, this._twoTimesWidthMid.connect(this._midMult, 0, 1), this.midSend.chain(this._midMult, this.midReturn), this._oneMinusWidth = new t.Subtract, this._oneMinusWidth.connect(this._twoTimesWidthMid), this.context.getConstant(1).connect(this._oneMinusWidth, 0, 0), this.width.connect(this._oneMinusWidth, 0, 1), this._sideMult = new t.Multiply, this.width.connect(this._twoTimesWidthSide), this._twoTimesWidthSide.connect(this._sideMult, 0, 1), this.sideSend.chain(this._sideMult, this.sideReturn) }, t.extend(t.StereoWidener, t.MidSideEffect), t.StereoWidener.defaults = { width: .5 }, t.StereoWidener.prototype.dispose = function() { return t.MidSideEffect.prototype.dispose.call(this), this._writable(["width"]), this.width.dispose(), this.width = null, this._midMult.dispose(), this._midMult = null, this._sideMult.dispose(), this._sideMult = null, this._twoTimesWidthMid.dispose(), this._twoTimesWidthMid = null, this._twoTimesWidthSide.dispose(), this._twoTimesWidthSide = null, this._oneMinusWidth.dispose(), this._oneMinusWidth = null, this }, t.StereoWidener }), t(function(t) { return t.Tremolo = function() { var e = t.defaults(arguments, ["frequency", "depth"], t.Tremolo);
                t.StereoEffect.call(this, e), this._lfoL = new t.LFO({ phase: e.spread, min: 1, max: 0 }), this._lfoR = new t.LFO({ phase: e.spread, min: 1, max: 0 }), this._amplitudeL = new t.Gain, this._amplitudeR = new t.Gain, this.frequency = new t.Signal(e.frequency, t.Type.Frequency), this.depth = new t.Signal(e.depth, t.Type.NormalRange), this._readOnly(["frequency", "depth"]), this.effectSendL.chain(this._amplitudeL, this.effectReturnL), this.effectSendR.chain(this._amplitudeR, this.effectReturnR), this._lfoL.connect(this._amplitudeL.gain), this._lfoR.connect(this._amplitudeR.gain), this.frequency.fan(this._lfoL.frequency, this._lfoR.frequency), this.depth.fan(this._lfoR.amplitude, this._lfoL.amplitude), this.type = e.type, this.spread = e.spread }, t.extend(t.Tremolo, t.StereoEffect), t.Tremolo.defaults = { frequency: 10, type: "sine", depth: .5, spread: 180 }, t.Tremolo.prototype.start = function(t) { return this._lfoL.start(t), this._lfoR.start(t), this }, t.Tremolo.prototype.stop = function(t) { return this._lfoL.stop(t), this._lfoR.stop(t), this }, t.Tremolo.prototype.sync = function(t) { return this._lfoL.sync(t), this._lfoR.sync(t), this }, t.Tremolo.prototype.unsync = function() { return this._lfoL.unsync(), this._lfoR.unsync(), this }, Object.defineProperty(t.Tremolo.prototype, "type", { get: function() { return this._lfoL.type }, set: function(t) { this._lfoL.type = t, this._lfoR.type = t } }), Object.defineProperty(t.Tremolo.prototype, "spread", { get: function() { return this._lfoR.phase - this._lfoL.phase }, set: function(t) { this._lfoL.phase = 90 - t / 2, this._lfoR.phase = t / 2 + 90 } }), t.Tremolo.prototype.dispose = function() { return t.StereoEffect.prototype.dispose.call(this), this._writable(["frequency", "depth"]), this._lfoL.dispose(), this._lfoL = null, this._lfoR.dispose(), this._lfoR = null, this._amplitudeL.dispose(), this._amplitudeL = null, this._amplitudeR.dispose(), this._amplitudeR = null, this.frequency = null, this.depth = null, this }, t.Tremolo }), t(function(t) { return t.Vibrato = function() { var e = t.defaults(arguments, ["frequency", "depth"], t.Vibrato);
                t.Effect.call(this, e), this._delayNode = new t.Delay(0, e.maxDelay), this._lfo = new t.LFO({ type: e.type, min: 0, max: e.maxDelay, frequency: e.frequency, phase: -90 }).start().connect(this._delayNode.delayTime), this.frequency = this._lfo.frequency, this.depth = this._lfo.amplitude, this.depth.value = e.depth, this._readOnly(["frequency", "depth"]), this.effectSend.chain(this._delayNode, this.effectReturn) }, t.extend(t.Vibrato, t.Effect), t.Vibrato.defaults = { maxDelay: .005, frequency: 5, depth: .1, type: "sine" }, Object.defineProperty(t.Vibrato.prototype, "type", { get: function() { return this._lfo.type }, set: function(t) { this._lfo.type = t } }), t.Vibrato.prototype.dispose = function() { t.Effect.prototype.dispose.call(this), this._delayNode.dispose(), this._delayNode = null, this._lfo.dispose(), this._lfo = null, this._writable(["frequency", "depth"]), this.frequency = null, this.depth = null }, t.Vibrato }), t(function(t) { return t.Event = function() { var e = t.defaults(arguments, ["callback", "value"], t.Event);
                t.call(this), this._loop = e.loop, this.callback = e.callback, this.value = e.value, this._loopStart = this.toTicks(e.loopStart), this._loopEnd = this.toTicks(e.loopEnd), this._state = new t.TimelineState(t.State.Stopped), this._playbackRate = 1, this._startOffset = 0, this._probability = e.probability, this._humanize = e.humanize, this.mute = e.mute, this.playbackRate = e.playbackRate }, t.extend(t.Event), t.Event.defaults = { callback: t.noOp, loop: !1, loopEnd: "1m", loopStart: 0, playbackRate: 1, value: null, probability: 1, mute: !1, humanize: !1 }, t.Event.prototype._rescheduleEvents = function(e) { return e = t.defaultArg(e, -1), this._state.forEachFrom(e, function(e) { var i, n, s, o;
                    e.state === t.State.Started && (t.isUndef(e.id) || t.Transport.clear(e.id), n = e.time + Math.round(this.startOffset / this._playbackRate), this._loop ? (i = 1 / 0, t.isNumber(this._loop) && (i = this._loop * this._getLoopDuration()), s = this._state.getAfter(n), null !== s && (i = Math.min(i, s.time - n)), i !== 1 / 0 && (this._state.setStateAtTime(t.State.Stopped, n + i + 1), i = t.Time(i, "i")), o = t.Time(this._getLoopDuration(), "i"), e.id = t.Transport.scheduleRepeat(this._tick.bind(this), o, t.TransportTime(n, "i"), i)) : e.id = t.Transport.schedule(this._tick.bind(this), n + "i")) }.bind(this)), this }, Object.defineProperty(t.Event.prototype, "state", { get: function() { return this._state.getValueAtTime(t.Transport.ticks) } }), Object.defineProperty(t.Event.prototype, "startOffset", { get: function() { return this._startOffset }, set: function(t) { this._startOffset = t } }), Object.defineProperty(t.Event.prototype, "probability", { get: function() { return this._probability }, set: function(t) { this._probability = t } }), Object.defineProperty(t.Event.prototype, "humanize", { get: function() { return this._humanize }, set: function(t) { this._humanize = t } }), t.Event.prototype.start = function(e) { return e = this.toTicks(e), this._state.getValueAtTime(e) === t.State.Stopped && (this._state.add({ state: t.State.Started, time: e, id: void 0 }), this._rescheduleEvents(e)), this }, t.Event.prototype.stop = function(e) { var i, n; return this.cancel(e), e = this.toTicks(e), this._state.getValueAtTime(e) === t.State.Started && (this._state.setStateAtTime(t.State.Stopped, e), i = this._state.getBefore(e), n = e, null !== i && (n = i.time), this._rescheduleEvents(n)), this }, t.Event.prototype.cancel = function(e) { return e = t.defaultArg(e, -1 / 0), e = this.toTicks(e), this._state.forEachFrom(e, function(e) { t.Transport.clear(e.id) }), this._state.cancel(e), this }, t.Event.prototype._tick = function(e) { if (!this.mute && this._state.getValueAtTime(t.Transport.ticks) === t.State.Started) { if (this.probability < 1 && Math.random() > this.probability) return; if (this.humanize) { var i = .02;
                        t.isBoolean(this.humanize) || (i = this.toSeconds(this.humanize)), e += (2 * Math.random() - 1) * i } this.callback(e, this.value) } }, t.Event.prototype._getLoopDuration = function() { return Math.round((this._loopEnd - this._loopStart) / this._playbackRate) }, Object.defineProperty(t.Event.prototype, "loop", { get: function() { return this._loop }, set: function(t) { this._loop = t, this._rescheduleEvents() } }), Object.defineProperty(t.Event.prototype, "playbackRate", { get: function() { return this._playbackRate }, set: function(t) { this._playbackRate = t, this._rescheduleEvents() } }), Object.defineProperty(t.Event.prototype, "loopEnd", { get: function() { return t.TransportTime(this._loopEnd, "i").toNotation() }, set: function(t) { this._loopEnd = this.toTicks(t), this._loop && this._rescheduleEvents() } }), Object.defineProperty(t.Event.prototype, "loopStart", { get: function() { return t.TransportTime(this._loopStart, "i").toNotation() }, set: function(t) { this._loopStart = this.toTicks(t), this._loop && this._rescheduleEvents() } }), Object.defineProperty(t.Event.prototype, "progress", { get: function() { var e, i, n; return this._loop ? (e = t.Transport.ticks, i = this._state.get(e), null !== i && i.state === t.State.Started ? (n = this._getLoopDuration(), (e - i.time) % n / n) : 0) : 0 } }), t.Event.prototype.dispose = function() { this.cancel(), this._state.dispose(), this._state = null, this.callback = null, this.value = null }, t.Event }), t(function(t) { return t.Loop = function() { var e = t.defaults(arguments, ["callback", "interval"], t.Loop);
                t.call(this), this._event = new t.Event({ callback: this._tick.bind(this), loop: !0, loopEnd: e.interval, playbackRate: e.playbackRate, probability: e.probability }), this.callback = e.callback, this.iterations = e.iterations }, t.extend(t.Loop), t.Loop.defaults = { interval: "4n", callback: t.noOp, playbackRate: 1, iterations: 1 / 0, probability: !0, mute: !1 }, t.Loop.prototype.start = function(t) { return this._event.start(t), this }, t.Loop.prototype.stop = function(t) { return this._event.stop(t), this }, t.Loop.prototype.cancel = function(t) { return this._event.cancel(t), this }, t.Loop.prototype._tick = function(t) { this.callback(t) }, Object.defineProperty(t.Loop.prototype, "state", { get: function() { return this._event.state } }), Object.defineProperty(t.Loop.prototype, "progress", { get: function() { return this._event.progress } }), Object.defineProperty(t.Loop.prototype, "interval", { get: function() { return this._event.loopEnd }, set: function(t) { this._event.loopEnd = t } }), Object.defineProperty(t.Loop.prototype, "playbackRate", { get: function() { return this._event.playbackRate }, set: function(t) { this._event.playbackRate = t } }), Object.defineProperty(t.Loop.prototype, "humanize", { get: function() { return this._event.humanize }, set: function(t) { this._event.humanize = t } }), Object.defineProperty(t.Loop.prototype, "probability", { get: function() { return this._event.probability }, set: function(t) { this._event.probability = t } }), Object.defineProperty(t.Loop.prototype, "mute", { get: function() { return this._event.mute }, set: function(t) { this._event.mute = t } }), Object.defineProperty(t.Loop.prototype, "iterations", { get: function() { return !0 === this._event.loop ? 1 / 0 : this._event.loop }, set: function(t) { this._event.loop = t === 1 / 0 || t } }), t.Loop.prototype.dispose = function() { this._event.dispose(), this._event = null, this.callback = null }, t.Loop }), t(function(t) { return t.Part = function() { var e, i = t.defaults(arguments, ["callback", "events"], t.Part); for (t.Event.call(this, i), this._events = [], e = 0; e < i.events.length; e++) Array.isArray(i.events[e]) ? this.add(i.events[e][0], i.events[e][1]) : this.add(i.events[e]) }, t.extend(t.Part, t.Event), t.Part.defaults = { callback: t.noOp, loop: !1, loopEnd: "1m", loopStart: 0, playbackRate: 1, probability: 1, humanize: !1, mute: !1, events: [] }, t.Part.prototype.start = function(e, i) { var n = this.toTicks(e); return this._state.getValueAtTime(n) !== t.State.Started && (i = this._loop ? t.defaultArg(i, this._loopStart) : t.defaultArg(i, 0), i = this.toTicks(i), this._state.add({ state: t.State.Started, time: n, offset: i }), this._forEach(function(t) { this._startNote(t, n, i) })), this }, t.Part.prototype._startNote = function(e, i, n) { i -= n, this._loop ? e.startOffset >= this._loopStart && e.startOffset < this._loopEnd ? (e.startOffset < n && (i += this._getLoopDuration()), e.start(t.TransportTime(i, "i"))) : e.startOffset < this._loopStart && e.startOffset >= n && (e.loop = !1, e.start(t.TransportTime(i, "i"))) : e.startOffset >= n && e.start(t.TransportTime(i, "i")) }, Object.defineProperty(t.Part.prototype, "startOffset", { get: function() { return this._startOffset }, set: function(t) { this._startOffset = t, this._forEach(function(t) { t.startOffset += this._startOffset }) } }), t.Part.prototype.stop = function(e) { var i = this.toTicks(e); return this._state.cancel(i), this._state.setStateAtTime(t.State.Stopped, i), this._forEach(function(t) { t.stop(e) }), this }, t.Part.prototype.at = function(e, i) { var n, s, o; for (e = t.TransportTime(e), n = t.Time(1, "i").toSeconds(), s = 0; s < this._events.length; s++)
                    if (o = this._events[s], Math.abs(e.toTicks() - o.startOffset) < n) return t.isUndef(i) || (o.value = i), o; return t.isUndef(i) ? null : (this.add(e, i), this._events[this._events.length - 1]) }, t.Part.prototype.add = function(e, i) { e.hasOwnProperty("time") && (i = e, e = i.time), e = this.toTicks(e); var n; return i instanceof t.Event ? (n = i, n.callback = this._tick.bind(this)) : n = new t.Event({ callback: this._tick.bind(this), value: i }), n.startOffset = e, n.set({ loopEnd: this.loopEnd, loopStart: this.loopStart, loop: this.loop, humanize: this.humanize, playbackRate: this.playbackRate, probability: this.probability }), this._events.push(n), this._restartEvent(n), this }, t.Part.prototype._restartEvent = function(e) { this._state.forEach(function(i) { i.state === t.State.Started ? this._startNote(e, i.time, i.offset) : e.stop(t.TransportTime(i.time, "i")) }.bind(this)) }, t.Part.prototype.remove = function(e, i) { var n, s; for (e.hasOwnProperty("time") && (i = e, e = i.time), e = this.toTicks(e), n = this._events.length - 1; n >= 0; n--) s = this._events[n], s instanceof t.Part ? s.remove(e, i) : s.startOffset === e && (t.isUndef(i) || !t.isUndef(i) && s.value === i) && (this._events.splice(n, 1), s.dispose()); return this }, t.Part.prototype.removeAll = function() { return this._forEach(function(t) { t.dispose() }), this._events = [], this }, t.Part.prototype.cancel = function(t) { return this._forEach(function(e) { e.cancel(t) }), this._state.cancel(this.toTicks(t)), this }, t.Part.prototype._forEach = function(e, i) { var n, s; if (this._events)
                    for (i = t.defaultArg(i, this), n = this._events.length - 1; n >= 0; n--) s = this._events[n], s instanceof t.Part ? s._forEach(e, i) : e.call(i, s); return this }, t.Part.prototype._setAll = function(t, e) { this._forEach(function(i) { i[t] = e }) }, t.Part.prototype._tick = function(t, e) { this.mute || this.callback(t, e) }, t.Part.prototype._testLoopBoundries = function(e) { e.startOffset < this._loopStart || e.startOffset >= this._loopEnd ? e.cancel(0) : e.state === t.State.Stopped && this._restartEvent(e) }, Object.defineProperty(t.Part.prototype, "probability", { get: function() { return this._probability }, set: function(t) { this._probability = t, this._setAll("probability", t) } }), Object.defineProperty(t.Part.prototype, "humanize", { get: function() { return this._humanize }, set: function(t) { this._humanize = t, this._setAll("humanize", t) } }), Object.defineProperty(t.Part.prototype, "loop", { get: function() { return this._loop }, set: function(t) { this._loop = t, this._forEach(function(e) { e._loopStart = this._loopStart, e._loopEnd = this._loopEnd, e.loop = t, this._testLoopBoundries(e) }) } }), Object.defineProperty(t.Part.prototype, "loopEnd", { get: function() { return t.TransportTime(this._loopEnd, "i").toNotation() }, set: function(t) { this._loopEnd = this.toTicks(t), this._loop && this._forEach(function(e) { e.loopEnd = t, this._testLoopBoundries(e) }) } }), Object.defineProperty(t.Part.prototype, "loopStart", { get: function() { return t.TransportTime(this._loopStart, "i").toNotation() }, set: function(t) { this._loopStart = this.toTicks(t), this._loop && this._forEach(function(t) { t.loopStart = this.loopStart, this._testLoopBoundries(t) }) } }), Object.defineProperty(t.Part.prototype, "playbackRate", { get: function() { return this._playbackRate }, set: function(t) { this._playbackRate = t, this._setAll("playbackRate", t) } }), Object.defineProperty(t.Part.prototype, "length", { get: function() { return this._events.length } }), t.Part.prototype.dispose = function() { return this.removeAll(), this._state.dispose(), this._state = null, this.callback = null, this._events = null, this }, t.Part }), t(function(t) { return t.Pattern = function() { var e = t.defaults(arguments, ["callback", "values", "pattern"], t.Pattern);
                t.Loop.call(this, e), this._pattern = new t.CtrlPattern({ values: e.values, type: e.pattern, index: e.index }) }, t.extend(t.Pattern, t.Loop), t.Pattern.defaults = { pattern: t.CtrlPattern.Type.Up, callback: t.noOp, values: [] }, t.Pattern.prototype._tick = function(t) { this.callback(t, this._pattern.value), this._pattern.next() }, Object.defineProperty(t.Pattern.prototype, "index", { get: function() { return this._pattern.index }, set: function(t) { this._pattern.index = t } }), Object.defineProperty(t.Pattern.prototype, "values", { get: function() { return this._pattern.values }, set: function(t) { this._pattern.values = t } }), Object.defineProperty(t.Pattern.prototype, "value", { get: function() { return this._pattern.value } }), Object.defineProperty(t.Pattern.prototype, "pattern", { get: function() { return this._pattern.type }, set: function(t) { this._pattern.type = t } }), t.Pattern.prototype.dispose = function() { t.Loop.prototype.dispose.call(this), this._pattern.dispose(), this._pattern = null }, t.Pattern }), t(function(t) { return t.Sequence = function() { var e, i = t.defaults(arguments, ["callback", "events", "subdivision"], t.Sequence),
                    n = i.events; if (delete i.events, t.Part.call(this, i), this._subdivision = this.toTicks(i.subdivision), t.isUndef(i.loopEnd) && !t.isUndef(n) && (this._loopEnd = n.length * this._subdivision), this._loop = !0, !t.isUndef(n))
                    for (e = 0; e < n.length; e++) this.add(e, n[e]) }, t.extend(t.Sequence, t.Part), t.Sequence.defaults = { subdivision: "4n" }, Object.defineProperty(t.Sequence.prototype, "subdivision", { get: function() { return t.Time(this._subdivision, "i").toNotation() } }), t.Sequence.prototype.at = function(e, i) { return t.isArray(i) && this.remove(e), t.Part.prototype.at.call(this, this._indexTime(e), i) }, t.Sequence.prototype.add = function(e, i) { if (null === i) return this; if (t.isArray(i)) { var n = Math.round(this._subdivision / i.length);
                    i = new t.Sequence(this._tick.bind(this), i, t.Time(n, "i")) } return t.Part.prototype.add.call(this, this._indexTime(e), i), this }, t.Sequence.prototype.remove = function(e, i) { return t.Part.prototype.remove.call(this, this._indexTime(e), i), this }, t.Sequence.prototype._indexTime = function(e) { return e instanceof t.TransportTime ? e : t.TransportTime(e * this._subdivision + this.startOffset, "i") }, t.Sequence.prototype.dispose = function() { return t.Part.prototype.dispose.call(this), this }, t.Sequence }), t(function(t) { return t.PulseOscillator = function() { var e = t.defaults(arguments, ["frequency", "width"], t.Oscillator);
                t.Source.call(this, e), this.width = new t.Signal(e.width, t.Type.NormalRange), this._widthGate = new t.Gain, this._sawtooth = new t.Oscillator({ frequency: e.frequency, detune: e.detune, type: "sawtooth", phase: e.phase }), this.frequency = this._sawtooth.frequency, this.detune = this._sawtooth.detune, this._thresh = new t.WaveShaper(function(t) { return t < 0 ? -1 : 1 }), this._sawtooth.chain(this._thresh, this.output), this.width.chain(this._widthGate, this._thresh), this._readOnly(["width", "frequency", "detune"]) }, t.extend(t.PulseOscillator, t.Source), t.PulseOscillator.defaults = { frequency: 440, detune: 0, phase: 0, width: .2 }, t.PulseOscillator.prototype._start = function(t) { t = this.toSeconds(t), this._sawtooth.start(t), this._widthGate.gain.setValueAtTime(1, t) }, t.PulseOscillator.prototype._stop = function(t) { t = this.toSeconds(t), this._sawtooth.stop(t), this._widthGate.gain.setValueAtTime(0, t) }, Object.defineProperty(t.PulseOscillator.prototype, "phase", { get: function() { return this._sawtooth.phase }, set: function(t) { this._sawtooth.phase = t } }), Object.defineProperty(t.PulseOscillator.prototype, "type", { get: function() { return "pulse" } }), Object.defineProperty(t.PulseOscillator.prototype, "partials", { get: function() { return [] } }), t.PulseOscillator.prototype.dispose = function() { return t.Source.prototype.dispose.call(this), this._sawtooth.dispose(), this._sawtooth = null, this._writable(["width", "frequency", "detune"]), this.width.dispose(), this.width = null, this._widthGate.dispose(), this._widthGate = null, this._thresh.dispose(), this._thresh = null, this.frequency = null, this.detune = null, this }, t.PulseOscillator }), t(function(t) { return t.PWMOscillator = function() { var e = t.defaults(arguments, ["frequency", "modulationFrequency"], t.PWMOscillator);
                t.Source.call(this, e), this._pulse = new t.PulseOscillator(e.modulationFrequency), this._pulse._sawtooth.type = "sine", this._modulator = new t.Oscillator({ frequency: e.frequency, detune: e.detune, phase: e.phase }), this._scale = new t.Multiply(2), this.frequency = this._modulator.frequency, this.detune = this._modulator.detune, this.modulationFrequency = this._pulse.frequency, this._modulator.chain(this._scale, this._pulse.width), this._pulse.connect(this.output), this._readOnly(["modulationFrequency", "frequency", "detune"]) }, t.extend(t.PWMOscillator, t.Source), t.PWMOscillator.defaults = { frequency: 440, detune: 0, phase: 0, modulationFrequency: .4 }, t.PWMOscillator.prototype._start = function(t) { t = this.toSeconds(t), this._modulator.start(t), this._pulse.start(t) }, t.PWMOscillator.prototype._stop = function(t) { t = this.toSeconds(t), this._modulator.stop(t), this._pulse.stop(t) }, Object.defineProperty(t.PWMOscillator.prototype, "type", { get: function() { return "pwm" } }), Object.defineProperty(t.PWMOscillator.prototype, "partials", { get: function() { return [] } }), Object.defineProperty(t.PWMOscillator.prototype, "phase", { get: function() { return this._modulator.phase }, set: function(t) { this._modulator.phase = t } }), t.PWMOscillator.prototype.dispose = function() { return t.Source.prototype.dispose.call(this), this._pulse.dispose(), this._pulse = null, this._scale.dispose(), this._scale = null, this._modulator.dispose(), this._modulator = null, this._writable(["modulationFrequency", "frequency", "detune"]), this.frequency = null, this.detune = null, this.modulationFrequency = null, this }, t.PWMOscillator }), t(function(t) { return t.FMOscillator = function() { var e = t.defaults(arguments, ["frequency", "type", "modulationType"], t.FMOscillator);
                t.Source.call(this, e), this._carrier = new t.Oscillator(e.frequency, e.type), this.frequency = new t.Signal(e.frequency, t.Type.Frequency), this.detune = this._carrier.detune, this.detune.value = e.detune, this.modulationIndex = new t.Multiply(e.modulationIndex), this.modulationIndex.units = t.Type.Positive, this._modulator = new t.Oscillator(e.frequency, e.modulationType), this.harmonicity = new t.Multiply(e.harmonicity), this.harmonicity.units = t.Type.Positive, this._modulationNode = new t.Gain(0), this.frequency.connect(this._carrier.frequency), this.frequency.chain(this.harmonicity, this._modulator.frequency), this.frequency.chain(this.modulationIndex, this._modulationNode), this._modulator.connect(this._modulationNode.gain), this._modulationNode.connect(this._carrier.frequency), this._carrier.connect(this.output), this.detune.connect(this._modulator.detune), this.phase = e.phase, this._readOnly(["modulationIndex", "frequency", "detune", "harmonicity"]) }, t.extend(t.FMOscillator, t.Source), t.FMOscillator.defaults = { frequency: 440, detune: 0, phase: 0, modulationIndex: 2, modulationType: "square", harmonicity: 1 }, t.FMOscillator.prototype._start = function(t) { t = this.toSeconds(t), this._modulator.start(t), this._carrier.start(t) }, t.FMOscillator.prototype._stop = function(t) { t = this.toSeconds(t), this._modulator.stop(t), this._carrier.stop(t) }, Object.defineProperty(t.FMOscillator.prototype, "type", { get: function() { return this._carrier.type }, set: function(t) { this._carrier.type = t } }), Object.defineProperty(t.FMOscillator.prototype, "modulationType", { get: function() { return this._modulator.type }, set: function(t) { this._modulator.type = t } }), Object.defineProperty(t.FMOscillator.prototype, "phase", { get: function() { return this._carrier.phase }, set: function(t) { this._carrier.phase = t, this._modulator.phase = t } }), Object.defineProperty(t.FMOscillator.prototype, "partials", { get: function() { return this._carrier.partials }, set: function(t) { this._carrier.partials = t } }), t.FMOscillator.prototype.dispose = function() { return t.Source.prototype.dispose.call(this), this._writable(["modulationIndex", "frequency", "detune", "harmonicity"]), this.frequency.dispose(), this.frequency = null, this.detune = null, this.harmonicity.dispose(), this.harmonicity = null, this._carrier.dispose(), this._carrier = null, this._modulator.dispose(), this._modulator = null, this._modulationNode.dispose(), this._modulationNode = null, this.modulationIndex.dispose(), this.modulationIndex = null, this }, t.FMOscillator }), t(function(t) { return t.AMOscillator = function() { var e = t.defaults(arguments, ["frequency", "type", "modulationType"], t.AMOscillator);
                t.Source.call(this, e), this._carrier = new t.Oscillator(e.frequency, e.type), this.frequency = this._carrier.frequency, this.detune = this._carrier.detune, this.detune.value = e.detune, this._modulator = new t.Oscillator(e.frequency, e.modulationType), this._modulationScale = new t.AudioToGain, this.harmonicity = new t.Multiply(e.harmonicity), this.harmonicity.units = t.Type.Positive, this._modulationNode = new t.Gain(0), this.frequency.chain(this.harmonicity, this._modulator.frequency), this.detune.connect(this._modulator.detune), this._modulator.chain(this._modulationScale, this._modulationNode.gain), this._carrier.chain(this._modulationNode, this.output), this.phase = e.phase, this._readOnly(["frequency", "detune", "harmonicity"]) }, t.extend(t.AMOscillator, t.Oscillator), t.AMOscillator.defaults = { frequency: 440, detune: 0, phase: 0, modulationType: "square", harmonicity: 1 }, t.AMOscillator.prototype._start = function(t) { t = this.toSeconds(t), this._modulator.start(t), this._carrier.start(t) }, t.AMOscillator.prototype._stop = function(t) { t = this.toSeconds(t), this._modulator.stop(t), this._carrier.stop(t) }, Object.defineProperty(t.AMOscillator.prototype, "type", { get: function() { return this._carrier.type }, set: function(t) { this._carrier.type = t } }), Object.defineProperty(t.AMOscillator.prototype, "modulationType", { get: function() { return this._modulator.type }, set: function(t) { this._modulator.type = t } }), Object.defineProperty(t.AMOscillator.prototype, "phase", { get: function() { return this._carrier.phase }, set: function(t) { this._carrier.phase = t, this._modulator.phase = t } }), Object.defineProperty(t.AMOscillator.prototype, "partials", { get: function() { return this._carrier.partials }, set: function(t) { this._carrier.partials = t } }), t.AMOscillator.prototype.dispose = function() { return t.Source.prototype.dispose.call(this), this._writable(["frequency", "detune", "harmonicity"]), this.frequency = null, this.detune = null, this.harmonicity.dispose(), this.harmonicity = null, this._carrier.dispose(), this._carrier = null, this._modulator.dispose(), this._modulator = null, this._modulationNode.dispose(), this._modulationNode = null, this._modulationScale.dispose(), this._modulationScale = null, this }, t.AMOscillator }), t(function(t) { return t.FatOscillator = function() { var e = t.defaults(arguments, ["frequency", "type", "spread"], t.FatOscillator);
                t.Source.call(this, e), this.frequency = new t.Signal(e.frequency, t.Type.Frequency), this.detune = new t.Signal(e.detune, t.Type.Cents), this._oscillators = [], this._spread = e.spread, this._type = e.type, this._phase = e.phase, this._partials = t.defaultArg(e.partials, []), this.count = e.count, this._readOnly(["frequency", "detune"]) }, t.extend(t.FatOscillator, t.Source), t.FatOscillator.defaults = { frequency: 440, detune: 0, phase: 0, spread: 20, count: 3, type: "sawtooth" }, t.FatOscillator.prototype._start = function(t) { t = this.toSeconds(t), this._forEach(function(e) { e.start(t) }) }, t.FatOscillator.prototype._stop = function(t) { t = this.toSeconds(t), this._forEach(function(e) { e.stop(t) }) }, t.FatOscillator.prototype._forEach = function(t) { for (var e = 0; e < this._oscillators.length; e++) t.call(this, this._oscillators[e], e) }, Object.defineProperty(t.FatOscillator.prototype, "type", { get: function() { return this._type }, set: function(t) { this._type = t, this._forEach(function(e) { e.type = t }) } }), Object.defineProperty(t.FatOscillator.prototype, "spread", { get: function() { return this._spread }, set: function(t) { var e, i;
                    this._spread = t, this._oscillators.length > 1 && (e = -t / 2, i = t / (this._oscillators.length - 1), this._forEach(function(t, n) { t.detune.value = e + i * n })) } }), Object.defineProperty(t.FatOscillator.prototype, "count", { get: function() { return this._oscillators.length }, set: function(e) { var i, n; if (e = Math.max(e, 1), this._oscillators.length !== e) { for (this._forEach(function(t) { t.dispose() }), this._oscillators = [], i = 0; i < e; i++) n = new t.Oscillator, this.type === t.Oscillator.Type.Custom ? n.partials = this._partials : n.type = this._type, n.phase = this._phase, n.volume.value = -6 - 1.1 * e, this.frequency.connect(n.frequency), this.detune.connect(n.detune), n.connect(this.output), this._oscillators[i] = n;
                        this.spread = this._spread, this.state === t.State.Started && this._forEach(function(t) { t.start() }) } } }), Object.defineProperty(t.FatOscillator.prototype, "phase", { get: function() { return this._phase }, set: function(t) { this._phase = t, this._forEach(function(e) { e.phase = t }) } }), Object.defineProperty(t.FatOscillator.prototype, "partials", { get: function() { return this._partials }, set: function(e) { this._partials = e, this._type = t.Oscillator.Type.Custom, this._forEach(function(t) { t.partials = e }) } }), t.FatOscillator.prototype.dispose = function() { return t.Source.prototype.dispose.call(this), this._writable(["frequency", "detune"]), this.frequency.dispose(), this.frequency = null, this.detune.dispose(), this.detune = null, this._forEach(function(t) { t.dispose() }), this._oscillators = null, this._partials = null, this }, t.FatOscillator }), t(function(t) {
            t.OmniOscillator = function() { var e = t.defaults(arguments, ["frequency", "type"], t.OmniOscillator);
                t.Source.call(this, e), this.frequency = new t.Signal(e.frequency, t.Type.Frequency), this.detune = new t.Signal(e.detune, t.Type.Cents), this._sourceType = void 0, this._oscillator = null, this.type = e.type, this._readOnly(["frequency", "detune"]), this.set(e) }, t.extend(t.OmniOscillator, t.Source), t.OmniOscillator.defaults = { frequency: 440, detune: 0, type: "sine", phase: 0 };
            var e = { Pulse: "PulseOscillator", PWM: "PWMOscillator", Osc: "Oscillator", FM: "FMOscillator", AM: "AMOscillator", Fat: "FatOscillator" };
            return t.OmniOscillator.prototype._start = function(t) { this._oscillator.start(t) }, t.OmniOscillator.prototype._stop = function(t) { this._oscillator.stop(t) }, Object.defineProperty(t.OmniOscillator.prototype, "type", {
                get: function() { var t = ""; return this._sourceType === e.FM ? t = "fm" : this._sourceType === e.AM ? t = "am" : this._sourceType === e.Fat && (t = "fat"), t + this._oscillator.type },
                set: function(t) {
                    "fm" === t.substr(0, 2) ? (this._createNewOscillator(e.FM), this._oscillator.type = t.substr(2)) : "am" === t.substr(0, 2) ? (this._createNewOscillator(e.AM),
                        this._oscillator.type = t.substr(2)) : "fat" === t.substr(0, 3) ? (this._createNewOscillator(e.Fat), this._oscillator.type = t.substr(3)) : "pwm" === t ? this._createNewOscillator(e.PWM) : "pulse" === t ? this._createNewOscillator(e.Pulse) : (this._createNewOscillator(e.Osc), this._oscillator.type = t)
                }
            }), Object.defineProperty(t.OmniOscillator.prototype, "partials", { get: function() { return this._oscillator.partials }, set: function(t) { this._oscillator.partials = t } }), t.OmniOscillator.prototype.set = function(e, i) { return "type" === e ? this.type = i : t.isObject(e) && e.hasOwnProperty("type") && (this.type = e.type), t.prototype.set.apply(this, arguments), this }, t.OmniOscillator.prototype._createNewOscillator = function(e) { var i, n, s;
                e !== this._sourceType && (this._sourceType = e, i = t[e], n = this.now(), null !== this._oscillator && (s = this._oscillator, s.stop(n), this.context.setTimeout(function() { s.dispose(), s = null }, this.blockTime)), this._oscillator = new i, this.frequency.connect(this._oscillator.frequency), this.detune.connect(this._oscillator.detune), this._oscillator.connect(this.output), this.state === t.State.Started && this._oscillator.start(n)) }, Object.defineProperty(t.OmniOscillator.prototype, "phase", { get: function() { return this._oscillator.phase }, set: function(t) { this._oscillator.phase = t } }), Object.defineProperty(t.OmniOscillator.prototype, "width", { get: function() { if (this._sourceType === e.Pulse) return this._oscillator.width } }), Object.defineProperty(t.OmniOscillator.prototype, "count", { get: function() { if (this._sourceType === e.Fat) return this._oscillator.count }, set: function(t) { this._sourceType === e.Fat && (this._oscillator.count = t) } }), Object.defineProperty(t.OmniOscillator.prototype, "spread", { get: function() { if (this._sourceType === e.Fat) return this._oscillator.spread }, set: function(t) { this._sourceType === e.Fat && (this._oscillator.spread = t) } }), Object.defineProperty(t.OmniOscillator.prototype, "modulationType", { get: function() { if (this._sourceType === e.FM || this._sourceType === e.AM) return this._oscillator.modulationType }, set: function(t) { this._sourceType !== e.FM && this._sourceType !== e.AM || (this._oscillator.modulationType = t) } }), Object.defineProperty(t.OmniOscillator.prototype, "modulationIndex", { get: function() { if (this._sourceType === e.FM) return this._oscillator.modulationIndex } }), Object.defineProperty(t.OmniOscillator.prototype, "harmonicity", { get: function() { if (this._sourceType === e.FM || this._sourceType === e.AM) return this._oscillator.harmonicity } }), Object.defineProperty(t.OmniOscillator.prototype, "modulationFrequency", { get: function() { if (this._sourceType === e.PWM) return this._oscillator.modulationFrequency } }), t.OmniOscillator.prototype.dispose = function() { return t.Source.prototype.dispose.call(this), this._writable(["frequency", "detune"]), this.detune.dispose(), this.detune = null, this.frequency.dispose(), this.frequency = null, this._oscillator.dispose(), this._oscillator = null, this._sourceType = null, this }, t.OmniOscillator
        }), t(function(t) { return t.Instrument = function(e) { e = t.defaultArg(e, t.Instrument.defaults), t.AudioNode.call(this), this._volume = this.output = new t.Volume(e.volume), this.volume = this._volume.volume, this._readOnly("volume") }, t.extend(t.Instrument, t.AudioNode), t.Instrument.defaults = { volume: 0 }, t.Instrument.prototype.triggerAttack = t.noOp, t.Instrument.prototype.triggerRelease = t.noOp, t.Instrument.prototype.triggerAttackRelease = function(t, e, i, n) { return i = this.toSeconds(i), e = this.toSeconds(e), this.triggerAttack(t, i, n), this.triggerRelease(i + e), this }, t.Instrument.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._volume.dispose(), this._volume = null, this._writable(["volume"]), this.volume = null, this }, t.Instrument }), t(function(t) { return t.Monophonic = function(e) { e = t.defaultArg(e, t.Monophonic.defaults), t.Instrument.call(this, e), this.portamento = e.portamento }, t.extend(t.Monophonic, t.Instrument), t.Monophonic.defaults = { portamento: 0 }, t.Monophonic.prototype.triggerAttack = function(t, e, i) { return e = this.toSeconds(e), this._triggerEnvelopeAttack(e, i), this.setNote(t, e), this }, t.Monophonic.prototype.triggerRelease = function(t) { return t = this.toSeconds(t), this._triggerEnvelopeRelease(t), this }, t.Monophonic.prototype._triggerEnvelopeAttack = function() {}, t.Monophonic.prototype._triggerEnvelopeRelease = function() {}, t.Monophonic.prototype.setNote = function(t, e) { var i, n; return e = this.toSeconds(e), this.portamento > 0 ? (i = this.frequency.value, this.frequency.setValueAtTime(i, e), n = this.toSeconds(this.portamento), this.frequency.exponentialRampToValueAtTime(t, e + n)) : this.frequency.setValueAtTime(t, e), this }, t.Monophonic }), t(function(t) { return t.Synth = function(e) { e = t.defaultArg(e, t.Synth.defaults), t.Monophonic.call(this, e), this.oscillator = new t.OmniOscillator(e.oscillator), this.frequency = this.oscillator.frequency, this.detune = this.oscillator.detune, this.envelope = new t.AmplitudeEnvelope(e.envelope), this.oscillator.chain(this.envelope, this.output), this.oscillator.start(), this._readOnly(["oscillator", "frequency", "detune", "envelope"]) }, t.extend(t.Synth, t.Monophonic), t.Synth.defaults = { oscillator: { type: "triangle" }, envelope: { attack: .005, decay: .1, sustain: .3, release: 1 } }, t.Synth.prototype._triggerEnvelopeAttack = function(t, e) { return this.envelope.triggerAttack(t, e), this }, t.Synth.prototype._triggerEnvelopeRelease = function(t) { return this.envelope.triggerRelease(t), this }, t.Synth.prototype.dispose = function() { return t.Monophonic.prototype.dispose.call(this), this._writable(["oscillator", "frequency", "detune", "envelope"]), this.oscillator.dispose(), this.oscillator = null, this.envelope.dispose(), this.envelope = null, this.frequency = null, this.detune = null, this }, t.Synth }), t(function(t) { return t.AMSynth = function(e) { e = t.defaultArg(e, t.AMSynth.defaults), t.Monophonic.call(this, e), this._carrier = new t.Synth, this._carrier.volume.value = -10, this.oscillator = this._carrier.oscillator, this.envelope = this._carrier.envelope.set(e.envelope), this._modulator = new t.Synth, this._modulator.volume.value = -10, this.modulation = this._modulator.oscillator.set(e.modulation), this.modulationEnvelope = this._modulator.envelope.set(e.modulationEnvelope), this.frequency = new t.Signal(440, t.Type.Frequency), this.detune = new t.Signal(e.detune, t.Type.Cents), this.harmonicity = new t.Multiply(e.harmonicity), this.harmonicity.units = t.Type.Positive, this._modulationScale = new t.AudioToGain, this._modulationNode = new t.Gain, this.frequency.connect(this._carrier.frequency), this.frequency.chain(this.harmonicity, this._modulator.frequency), this.detune.fan(this._carrier.detune, this._modulator.detune), this._modulator.chain(this._modulationScale, this._modulationNode.gain), this._carrier.chain(this._modulationNode, this.output), this._readOnly(["frequency", "harmonicity", "oscillator", "envelope", "modulation", "modulationEnvelope", "detune"]) }, t.extend(t.AMSynth, t.Monophonic), t.AMSynth.defaults = { harmonicity: 3, detune: 0, oscillator: { type: "sine" }, envelope: { attack: .01, decay: .01, sustain: 1, release: .5 }, modulation: { type: "square" }, modulationEnvelope: { attack: .5, decay: 0, sustain: 1, release: .5 } }, t.AMSynth.prototype._triggerEnvelopeAttack = function(t, e) { return t = this.toSeconds(t), this.envelope.triggerAttack(t, e), this.modulationEnvelope.triggerAttack(t, e), this }, t.AMSynth.prototype._triggerEnvelopeRelease = function(t) { return this.envelope.triggerRelease(t), this.modulationEnvelope.triggerRelease(t), this }, t.AMSynth.prototype.dispose = function() { return t.Monophonic.prototype.dispose.call(this), this._writable(["frequency", "harmonicity", "oscillator", "envelope", "modulation", "modulationEnvelope", "detune"]), this._carrier.dispose(), this._carrier = null, this._modulator.dispose(), this._modulator = null, this.frequency.dispose(), this.frequency = null, this.detune.dispose(), this.detune = null, this.harmonicity.dispose(), this.harmonicity = null, this._modulationScale.dispose(), this._modulationScale = null, this._modulationNode.dispose(), this._modulationNode = null, this.oscillator = null, this.envelope = null, this.modulationEnvelope = null, this.modulation = null, this }, t.AMSynth }), t(function(t) { return t.MonoSynth = function(e) { e = t.defaultArg(e, t.MonoSynth.defaults), t.Monophonic.call(this, e), this.oscillator = new t.OmniOscillator(e.oscillator), this.frequency = this.oscillator.frequency, this.detune = this.oscillator.detune, this.filter = new t.Filter(e.filter), this.filterEnvelope = new t.FrequencyEnvelope(e.filterEnvelope), this.envelope = new t.AmplitudeEnvelope(e.envelope), this.oscillator.chain(this.filter, this.envelope, this.output), this.oscillator.start(), this.filterEnvelope.connect(this.filter.frequency), this._readOnly(["oscillator", "frequency", "detune", "filter", "filterEnvelope", "envelope"]) }, t.extend(t.MonoSynth, t.Monophonic), t.MonoSynth.defaults = { frequency: "C4", detune: 0, oscillator: { type: "square" }, filter: { Q: 6, type: "lowpass", rolloff: -24 }, envelope: { attack: .005, decay: .1, sustain: .9, release: 1 }, filterEnvelope: { attack: .06, decay: .2, sustain: .5, release: 2, baseFrequency: 200, octaves: 7, exponent: 2 } }, t.MonoSynth.prototype._triggerEnvelopeAttack = function(t, e) { return this.envelope.triggerAttack(t, e), this.filterEnvelope.triggerAttack(t), this }, t.MonoSynth.prototype._triggerEnvelopeRelease = function(t) { return this.envelope.triggerRelease(t), this.filterEnvelope.triggerRelease(t), this }, t.MonoSynth.prototype.dispose = function() { return t.Monophonic.prototype.dispose.call(this), this._writable(["oscillator", "frequency", "detune", "filter", "filterEnvelope", "envelope"]), this.oscillator.dispose(), this.oscillator = null, this.envelope.dispose(), this.envelope = null, this.filterEnvelope.dispose(), this.filterEnvelope = null, this.filter.dispose(), this.filter = null, this.frequency = null, this.detune = null, this }, t.MonoSynth }), t(function(t) { return t.DuoSynth = function(e) { e = t.defaultArg(e, t.DuoSynth.defaults), t.Monophonic.call(this, e), this.voice0 = new t.MonoSynth(e.voice0), this.voice0.volume.value = -10, this.voice1 = new t.MonoSynth(e.voice1), this.voice1.volume.value = -10, this._vibrato = new t.LFO(e.vibratoRate, -50, 50), this._vibrato.start(), this.vibratoRate = this._vibrato.frequency, this._vibratoGain = new t.Gain(e.vibratoAmount, t.Type.Positive), this.vibratoAmount = this._vibratoGain.gain, this.frequency = new t.Signal(440, t.Type.Frequency), this.harmonicity = new t.Multiply(e.harmonicity), this.harmonicity.units = t.Type.Positive, this.frequency.connect(this.voice0.frequency), this.frequency.chain(this.harmonicity, this.voice1.frequency), this._vibrato.connect(this._vibratoGain), this._vibratoGain.fan(this.voice0.detune, this.voice1.detune), this.voice0.connect(this.output), this.voice1.connect(this.output), this._readOnly(["voice0", "voice1", "frequency", "vibratoAmount", "vibratoRate"]) }, t.extend(t.DuoSynth, t.Monophonic), t.DuoSynth.defaults = { vibratoAmount: .5, vibratoRate: 5, harmonicity: 1.5, voice0: { volume: -10, portamento: 0, oscillator: { type: "sine" }, filterEnvelope: { attack: .01, decay: 0, sustain: 1, release: .5 }, envelope: { attack: .01, decay: 0, sustain: 1, release: .5 } }, voice1: { volume: -10, portamento: 0, oscillator: { type: "sine" }, filterEnvelope: { attack: .01, decay: 0, sustain: 1, release: .5 }, envelope: { attack: .01, decay: 0, sustain: 1, release: .5 } } }, t.DuoSynth.prototype._triggerEnvelopeAttack = function(t, e) { return t = this.toSeconds(t), this.voice0.envelope.triggerAttack(t, e), this.voice1.envelope.triggerAttack(t, e), this.voice0.filterEnvelope.triggerAttack(t), this.voice1.filterEnvelope.triggerAttack(t), this }, t.DuoSynth.prototype._triggerEnvelopeRelease = function(t) { return this.voice0.triggerRelease(t), this.voice1.triggerRelease(t), this }, t.DuoSynth.prototype.dispose = function() { return t.Monophonic.prototype.dispose.call(this), this._writable(["voice0", "voice1", "frequency", "vibratoAmount", "vibratoRate"]), this.voice0.dispose(), this.voice0 = null, this.voice1.dispose(), this.voice1 = null, this.frequency.dispose(), this.frequency = null, this._vibratoGain.dispose(), this._vibratoGain = null, this._vibrato = null, this.harmonicity.dispose(), this.harmonicity = null, this.vibratoAmount.dispose(), this.vibratoAmount = null, this.vibratoRate = null, this }, t.DuoSynth }), t(function(t) { return t.FMSynth = function(e) { e = t.defaultArg(e, t.FMSynth.defaults), t.Monophonic.call(this, e), this._carrier = new t.Synth(e.carrier), this._carrier.volume.value = -10, this.oscillator = this._carrier.oscillator, this.envelope = this._carrier.envelope.set(e.envelope), this._modulator = new t.Synth(e.modulator), this._modulator.volume.value = -10, this.modulation = this._modulator.oscillator.set(e.modulation), this.modulationEnvelope = this._modulator.envelope.set(e.modulationEnvelope), this.frequency = new t.Signal(440, t.Type.Frequency), this.detune = new t.Signal(e.detune, t.Type.Cents), this.harmonicity = new t.Multiply(e.harmonicity), this.harmonicity.units = t.Type.Positive, this.modulationIndex = new t.Multiply(e.modulationIndex), this.modulationIndex.units = t.Type.Positive, this._modulationNode = new t.Gain(0), this.frequency.connect(this._carrier.frequency), this.frequency.chain(this.harmonicity, this._modulator.frequency), this.frequency.chain(this.modulationIndex, this._modulationNode), this.detune.fan(this._carrier.detune, this._modulator.detune), this._modulator.connect(this._modulationNode.gain), this._modulationNode.connect(this._carrier.frequency), this._carrier.connect(this.output), this._readOnly(["frequency", "harmonicity", "modulationIndex", "oscillator", "envelope", "modulation", "modulationEnvelope", "detune"]) }, t.extend(t.FMSynth, t.Monophonic), t.FMSynth.defaults = { harmonicity: 3, modulationIndex: 10, detune: 0, oscillator: { type: "sine" }, envelope: { attack: .01, decay: .01, sustain: 1, release: .5 }, modulation: { type: "square" }, modulationEnvelope: { attack: .5, decay: 0, sustain: 1, release: .5 } }, t.FMSynth.prototype._triggerEnvelopeAttack = function(t, e) { return t = this.toSeconds(t), this.envelope.triggerAttack(t, e), this.modulationEnvelope.triggerAttack(t), this }, t.FMSynth.prototype._triggerEnvelopeRelease = function(t) { return t = this.toSeconds(t), this.envelope.triggerRelease(t), this.modulationEnvelope.triggerRelease(t), this }, t.FMSynth.prototype.dispose = function() { return t.Monophonic.prototype.dispose.call(this), this._writable(["frequency", "harmonicity", "modulationIndex", "oscillator", "envelope", "modulation", "modulationEnvelope", "detune"]), this._carrier.dispose(), this._carrier = null, this._modulator.dispose(), this._modulator = null, this.frequency.dispose(), this.frequency = null, this.detune.dispose(), this.detune = null, this.modulationIndex.dispose(), this.modulationIndex = null, this.harmonicity.dispose(), this.harmonicity = null, this._modulationNode.dispose(), this._modulationNode = null, this.oscillator = null, this.envelope = null, this.modulationEnvelope = null, this.modulation = null, this }, t.FMSynth }), t(function(t) { return t.MembraneSynth = function(e) { e = t.defaultArg(e, t.MembraneSynth.defaults), t.Instrument.call(this, e), this.oscillator = new t.OmniOscillator(e.oscillator).start(), this.envelope = new t.AmplitudeEnvelope(e.envelope), this.octaves = e.octaves, this.pitchDecay = e.pitchDecay, this.oscillator.chain(this.envelope, this.output), this._readOnly(["oscillator", "envelope"]) }, t.extend(t.MembraneSynth, t.Instrument), t.MembraneSynth.defaults = { pitchDecay: .05, octaves: 10, oscillator: { type: "sine" }, envelope: { attack: .001, decay: .4, sustain: .01, release: 1.4, attackCurve: "exponential" } }, t.MembraneSynth.prototype.triggerAttack = function(t, e, i) { e = this.toSeconds(e), t = this.toFrequency(t); var n = t * this.octaves; return this.oscillator.frequency.setValueAtTime(n, e), this.oscillator.frequency.exponentialRampToValueAtTime(t, e + this.toSeconds(this.pitchDecay)), this.envelope.triggerAttack(e, i), this }, t.MembraneSynth.prototype.triggerRelease = function(t) { return this.envelope.triggerRelease(t), this }, t.MembraneSynth.prototype.dispose = function() { return t.Instrument.prototype.dispose.call(this), this._writable(["oscillator", "envelope"]), this.oscillator.dispose(), this.oscillator = null, this.envelope.dispose(), this.envelope = null, this }, t.MembraneSynth }), t(function(t) { var e = [1, 1.483, 1.932, 2.546, 2.63, 3.897]; return t.MetalSynth = function(i) { var n, s, o; for (i = t.defaultArg(i, t.MetalSynth.defaults), t.Instrument.call(this, i), this.frequency = new t.Signal(i.frequency, t.Type.Frequency), this._oscillators = [], this._freqMultipliers = [], this._amplitue = new t.Gain(0).connect(this.output), this._highpass = new t.Filter({ type: "highpass", Q: -3.0102999566398125 }).connect(this._amplitue), this._octaves = i.octaves, this._filterFreqScaler = new t.Scale(i.resonance, 7e3), this.envelope = new t.Envelope({ attack: i.envelope.attack, attackCurve: "linear", decay: i.envelope.decay, sustain: 0, release: i.envelope.release }).chain(this._filterFreqScaler, this._highpass.frequency), this.envelope.connect(this._amplitue.gain), n = 0; n < e.length; n++) s = new t.FMOscillator({ type: "square", modulationType: "square", harmonicity: i.harmonicity, modulationIndex: i.modulationIndex }), s.connect(this._highpass).start(), this._oscillators[n] = s, o = new t.Multiply(e[n]), this._freqMultipliers[n] = o, this.frequency.chain(o, s.frequency);
                this.octaves = i.octaves }, t.extend(t.MetalSynth, t.Instrument), t.MetalSynth.defaults = { frequency: 200, envelope: { attack: .001, decay: 1.4, release: .2 }, harmonicity: 5.1, modulationIndex: 32, resonance: 4e3, octaves: 1.5 }, t.MetalSynth.prototype.triggerAttack = function(e, i) { return e = this.toSeconds(e), i = t.defaultArg(i, 1), this.envelope.triggerAttack(e, i), this }, t.MetalSynth.prototype.triggerRelease = function(t) { return t = this.toSeconds(t), this.envelope.triggerRelease(t), this }, t.MetalSynth.prototype.triggerAttackRelease = function(t, e, i) { return e = this.toSeconds(e), t = this.toSeconds(t), this.triggerAttack(e, i), this.triggerRelease(e + t), this }, Object.defineProperty(t.MetalSynth.prototype, "modulationIndex", { get: function() { return this._oscillators[0].modulationIndex.value }, set: function(t) { for (var e = 0; e < this._oscillators.length; e++) this._oscillators[e].modulationIndex.value = t } }), Object.defineProperty(t.MetalSynth.prototype, "harmonicity", { get: function() { return this._oscillators[0].harmonicity.value }, set: function(t) { for (var e = 0; e < this._oscillators.length; e++) this._oscillators[e].harmonicity.value = t } }), Object.defineProperty(t.MetalSynth.prototype, "resonance", { get: function() { return this._filterFreqScaler.min }, set: function(t) { this._filterFreqScaler.min = t, this.octaves = this._octaves } }), Object.defineProperty(t.MetalSynth.prototype, "octaves", { get: function() { return this._octaves }, set: function(t) { this._octaves = t, this._filterFreqScaler.max = this._filterFreqScaler.min * Math.pow(2, t) } }), t.MetalSynth.prototype.dispose = function() { t.Instrument.prototype.dispose.call(this); for (var e = 0; e < this._oscillators.length; e++) this._oscillators[e].dispose(), this._freqMultipliers[e].dispose();
                this._oscillators = null, this._freqMultipliers = null, this.frequency.dispose(), this.frequency = null, this._filterFreqScaler.dispose(), this._filterFreqScaler = null, this._amplitue.dispose(), this._amplitue = null, this.envelope.dispose(), this.envelope = null, this._highpass.dispose(), this._highpass = null }, t.MetalSynth }), t(function(t) { return t.BufferSource = function() { var e = t.defaults(arguments, ["buffer", "onload"], t.BufferSource);
                t.AudioNode.call(this), this.onended = e.onended, this._startTime = -1, this._stopTime = -1, this._gainNode = this.output = new t.Gain, this._source = this.context.createBufferSource(), this._source.connect(this._gainNode), this._buffer = new t.Buffer(e.buffer, e.onload), this.playbackRate = new t.Param(this._source.playbackRate, t.Type.Positive), this.fadeIn = e.fadeIn, this.fadeOut = e.fadeOut, this.curve = e.curve, this._gain = 1, this._onendedTimeout = -1, this.loop = e.loop, this.loopStart = e.loopStart, this.loopEnd = e.loopEnd, this.playbackRate.value = e.playbackRate }, t.extend(t.BufferSource, t.AudioNode), t.BufferSource.defaults = { onended: t.noOp, onload: t.noOp, loop: !1, loopStart: 0, loopEnd: 0, fadeIn: 0, fadeOut: 0, curve: "linear", playbackRate: 1 }, Object.defineProperty(t.BufferSource.prototype, "state", { get: function() { var e = this.now(); return -1 !== this._startTime && e >= this._startTime && e < this._stopTime ? t.State.Started : t.State.Stopped } }), t.BufferSource.prototype.start = function(e, i, n, s, o) { var r, a, l, h; if (-1 !== this._startTime) throw new Error("Tone.BufferSource can only be started once."); if (!this.buffer.loaded) throw new Error("Tone.BufferSource: buffer is either not set or not loaded."); return e = this.toSeconds(e), i = this.loop ? t.defaultArg(i, this.loopStart) : t.defaultArg(i, 0), i = this.toSeconds(i), s = t.defaultArg(s, 1), this._gain = s, o = this.toSeconds(t.defaultArg(o, this.fadeIn)), this.fadeIn = o, o > 0 ? (this._gainNode.gain.setValueAtTime(0, e), "linear" === this.curve ? this._gainNode.gain.linearRampToValueAtTime(this._gain, e + o) : this._gainNode.gain.exponentialAppraochValueAtTime(this._gain, e, o)) : this._gainNode.gain.setValueAtTime(s, e), this._startTime = e, r = this.toSeconds(t.defaultArg(n, this.buffer.duration - i % this.buffer.duration)), r = Math.max(r, 0), (!this.loop || this.loop && !t.isUndef(n)) && (this.loop || (r = Math.min(r, this.buffer.duration - i % this.buffer.duration)), this.stop(e + r, this.fadeOut)), this.loop && (a = this.loopEnd || this.buffer.duration, l = this.loopStart, h = a - l, i > a && (i = (i - l) % h + l)), this._source.buffer = this.buffer.get(), this._source.loopEnd = this.loopEnd || this.buffer.duration, t.isPast(e), this._source.start(e, i), this }, t.BufferSource.prototype.stop = function(e, i) { var n, s; if (!this.buffer.loaded) throw new Error("Tone.BufferSource: buffer is either not set or not loaded."); if (e = this.toSeconds(e), -1 === this._stopTime || this._stopTime > e) { if (e <= this._startTime) return this._gainNode.gain.cancelScheduledValues(e), this._gainNode.gain.value = 0, this;
                    e = Math.max(this._startTime + this.fadeIn + this.sampleTime, e), this._gainNode.gain.cancelScheduledValues(e), this._stopTime = e, i = this.toSeconds(t.defaultArg(i, this.fadeOut)), n = e - this._startTime - this.fadeIn - this.sampleTime, this.loop || (n = Math.min(n, this.buffer.duration)), i = Math.min(n, i), s = e - i, i > this.sampleTime ? (this._gainNode.gain.setValueAtTime(this._gain, s), "linear" === this.curve ? this._gainNode.gain.linearRampToValueAtTime(0, e) : this._gainNode.gain.exponentialAppraochValueAtTime(0, s, i)) : this._gainNode.gain.setValueAtTime(0, e), t.context.clearTimeout(this._onendedTimeout), this._onendedTimeout = t.context.setTimeout(this._onended.bind(this), this._stopTime - this.now()) } return this }, t.BufferSource.prototype._onended = function() { var t = "exponential" === this.curve ? 2 * this.fadeOut : 0;
                this._source.stop(this._stopTime + t), this.onended(this) }, Object.defineProperty(t.BufferSource.prototype, "loopStart", { get: function() { return this._source.loopStart }, set: function(t) { this._source.loopStart = this.toSeconds(t) } }), Object.defineProperty(t.BufferSource.prototype, "loopEnd", { get: function() { return this._source.loopEnd }, set: function(t) { this._source.loopEnd = this.toSeconds(t) } }), Object.defineProperty(t.BufferSource.prototype, "buffer", { get: function() { return this._buffer }, set: function(t) { this._buffer.set(t) } }), Object.defineProperty(t.BufferSource.prototype, "loop", { get: function() { return this._source.loop }, set: function(t) { this._source.loop = t } }), t.BufferSource.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this.onended = null, this._source.disconnect(), this._source = null, this._gainNode.dispose(), this._gainNode = null, this._buffer.dispose(), this._buffer = null, this._startTime = -1, this.playbackRate = null, t.context.clearTimeout(this._onendedTimeout), this }, t.BufferSource }), t(function(t) {
            function e() { for (var e in s) o[e] = (new t.Buffer).fromArray(s[e]) } var i, n, s, o; return t.Noise = function() { var e = t.defaults(arguments, ["type"], t.Noise);
                t.Source.call(this, e), this._source = null, this._type = e.type, this._playbackRate = e.playbackRate }, t.extend(t.Noise, t.Source), t.Noise.defaults = { type: "white", playbackRate: 1 }, Object.defineProperty(t.Noise.prototype, "type", { get: function() { return this._type }, set: function(e) { if (this._type !== e) { if (!(e in o)) throw new TypeError("Tone.Noise: invalid type: " + e); if (this._type = e, this.state === t.State.Started) { var i = this.now();
                            this._stop(i), this._start(i) } } } }), Object.defineProperty(t.Noise.prototype, "playbackRate", { get: function() { return this._playbackRate }, set: function(t) { this._playbackRate = t, this._source && (this._source.playbackRate.value = t) } }), t.Noise.prototype._start = function(e) { var i = o[this._type];
                this._source = new t.BufferSource(i).connect(this.output), this._source.loop = !0, this._source.playbackRate.value = this._playbackRate, this._source.start(this.toSeconds(e), Math.random() * (i.duration - .001)) }, t.Noise.prototype._stop = function(t) { this._source && (this._source.stop(this.toSeconds(t)), this._source = null) }, t.Noise.prototype.dispose = function() { return t.Source.prototype.dispose.call(this), null !== this._source && (this._source.disconnect(), this._source = null), this._buffer = null, this }, i = 220500, n = 2, s = { pink: function() { var t, e, s, o, r, a, l, h, u, p, c, d = []; for (t = 0; t < n; t++)
                        for (e = new Float32Array(i), d[t] = e, s = o = r = a = l = h = u = 0, p = 0; p < i; p++) c = 2 * Math.random() - 1, s = .99886 * s + .0555179 * c, o = .99332 * o + .0750759 * c, r = .969 * r + .153852 * c, a = .8665 * a + .3104856 * c, l = .55 * l + .5329522 * c, h = -.7616 * h - .016898 * c, e[p] = s + o + r + a + l + h + u + .5362 * c, e[p] *= .11, u = .115926 * c; return d }(), brown: function() { var t, e, s, o, r, a = []; for (t = 0; t < n; t++)
                        for (e = new Float32Array(i), a[t] = e, s = 0, o = 0; o < i; o++) r = 2 * Math.random() - 1, e[o] = (s + .02 * r) / 1.02, s = e[o], e[o] *= 3.5; return a }(), white: function() { var t, e, s, o = []; for (t = 0; t < n; t++)
                        for (e = new Float32Array(i), o[t] = e, s = 0; s < i; s++) e[s] = 2 * Math.random() - 1; return o }() }, o = {}, t.getContext(e), t.Context.on("init", e), t.Noise }), t(function(t) { return t.NoiseSynth = function(e) { e = t.defaultArg(e, t.NoiseSynth.defaults), t.Instrument.call(this, e), this.noise = new t.Noise, this.envelope = new t.AmplitudeEnvelope(e.envelope), this.noise.chain(this.envelope, this.output), this.noise.start(), this._readOnly(["noise", "envelope"]) }, t.extend(t.NoiseSynth, t.Instrument), t.NoiseSynth.defaults = { noise: { type: "white" }, envelope: { attack: .005, decay: .1, sustain: 0 } }, t.NoiseSynth.prototype.triggerAttack = function(t, e) { return this.envelope.triggerAttack(t, e), this }, t.NoiseSynth.prototype.triggerRelease = function(t) { return this.envelope.triggerRelease(t), this }, t.NoiseSynth.prototype.triggerAttackRelease = function(t, e, i) { return e = this.toSeconds(e), t = this.toSeconds(t), this.triggerAttack(e, i), this.triggerRelease(e + t), this }, t.NoiseSynth.prototype.dispose = function() { return t.Instrument.prototype.dispose.call(this), this._writable(["noise", "envelope"]), this.noise.dispose(), this.noise = null, this.envelope.dispose(), this.envelope = null, this }, t.NoiseSynth }), t(function(t) { return t.PluckSynth = function(e) { e = t.defaultArg(e, t.PluckSynth.defaults), t.Instrument.call(this, e), this._noise = new t.Noise("pink"), this.attackNoise = e.attackNoise, this._lfcf = new t.LowpassCombFilter({ resonance: e.resonance, dampening: e.dampening }), this.resonance = this._lfcf.resonance, this.dampening = this._lfcf.dampening, this._noise.connect(this._lfcf), this._lfcf.connect(this.output), this._readOnly(["resonance", "dampening"]) }, t.extend(t.PluckSynth, t.Instrument), t.PluckSynth.defaults = { attackNoise: 1, dampening: 4e3, resonance: .9 }, t.PluckSynth.prototype.triggerAttack = function(t, e) { t = this.toFrequency(t), e = this.toSeconds(e); var i = 1 / t; return this._lfcf.delayTime.setValueAtTime(i, e), this._noise.start(e), this._noise.stop(e + i * this.attackNoise), this }, t.PluckSynth.prototype.dispose = function() { return t.Instrument.prototype.dispose.call(this), this._noise.dispose(), this._lfcf.dispose(), this._noise = null, this._lfcf = null, this._writable(["resonance", "dampening"]), this.dampening = null, this.resonance = null, this }, t.PluckSynth }), t(function(t) { return t.PolySynth = function() { var e, i, n = t.defaults(arguments, ["polyphony", "voice"], t.PolySynth); for (t.Instrument.call(this, n), n = t.defaultArg(n, t.Instrument.defaults), n.polyphony = Math.min(t.PolySynth.MAX_POLYPHONY, n.polyphony), this.voices = new Array(n.polyphony), this._triggers = new Array(n.polyphony), this.detune = new t.Signal(n.detune, t.Type.Cents), this._readOnly("detune"), e = 0; e < n.polyphony; e++) i = new n.voice(arguments[2], arguments[3]), this.voices[e] = i, i.connect(this.output), i.hasOwnProperty("detune") && this.detune.connect(i.detune), this._triggers[e] = { release: -1, note: null, voice: i } }, t.extend(t.PolySynth, t.Instrument), t.PolySynth.defaults = { polyphony: 4, volume: 0, detune: 0, voice: t.Synth }, t.PolySynth.prototype.triggerAttack = function(t, e, i) { var n, s, o, r; for (Array.isArray(t) || (t = [t]), e = this.toSeconds(e), n = 0; n < t.length; n++) { for (s = t[n], o = this._triggers[0], r = 1; r < this._triggers.length; r++) this._triggers[r].release < o.release && (o = this._triggers[r]);
                    o.release = 1 / 0, o.note = JSON.stringify(s), o.voice.triggerAttack(s, e, i) } return this }, t.PolySynth.prototype.triggerAttackRelease = function(e, i, n, s) { var o, r; if (n = this.toSeconds(n), this.triggerAttack(e, n, s), t.isArray(i) && t.isArray(e))
                    for (o = 0; o < e.length; o++) r = i[Math.min(o, i.length - 1)], this.triggerRelease(e[o], n + this.toSeconds(r));
                else this.triggerRelease(e, n + this.toSeconds(i)); return this }, t.PolySynth.prototype.triggerRelease = function(t, e) { var i, n, s, o; for (Array.isArray(t) || (t = [t]), e = this.toSeconds(e), i = 0; i < t.length; i++)
                    for (n = JSON.stringify(t[i]), s = 0; s < this._triggers.length; s++) o = this._triggers[s], o.note === n && o.release > e && (o.voice.triggerRelease(e), o.release = e); return this }, t.PolySynth.prototype.set = function(t, e, i) { for (var n = 0; n < this.voices.length; n++) this.voices[n].set(t, e, i); return this }, t.PolySynth.prototype.get = function(t) { return this.voices[0].get(t) }, t.PolySynth.prototype.releaseAll = function(t) { var e, i; for (t = this.toSeconds(t), e = 0; e < this._triggers.length; e++) i = this._triggers[e], i.release > t && (i.release = t, i.voice.triggerRelease(t)); return this }, t.PolySynth.prototype.dispose = function() { t.Instrument.prototype.dispose.call(this); for (var e = 0; e < this.voices.length; e++) this.voices[e].dispose(), this.voices[e] = null; return this._writable("detune"), this.detune.dispose(), this.detune = null, this.voices = null, this._triggers = null, this }, t.PolySynth.MAX_POLYPHONY = 20, t.PolySynth }), t(function(t) { return t.Sampler = function(e) { var i, n, s, o, r = Array.prototype.slice.call(arguments);
                r.shift(), i = t.defaults(r, ["onload", "baseUrl"], t.Sampler), t.Instrument.call(this, i), n = {}; for (s in e)
                    if (t.isNote(s)) o = t.Frequency(s).toMidi(), n[o] = e[s];
                    else { if (isNaN(parseFloat(s))) throw new Error("Tone.Sampler: url keys must be the note's pitch");
                        n[s] = e[s] } this._buffers = new t.Buffers(n, i.onload, i.baseUrl), this._activeSources = {}, this.attack = i.attack, this.release = i.release }, t.extend(t.Sampler, t.Instrument), t.Sampler.defaults = { attack: 0, release: .1, onload: t.noOp, baseUrl: "" }, t.Sampler.prototype._findClosest = function(t) { for (var e = 24, i = 0; i < e;) { if (this._buffers.has(t + i)) return -i; if (this._buffers.has(t - i)) return i;
                    i++ } return null }, t.Sampler.prototype.triggerAttack = function(e, i, n) { var s, o, r, a = t.Frequency(e).toMidi(),
                    l = this._findClosest(a); return null !== l && (s = a - l, o = this._buffers.get(s), r = new t.BufferSource({ buffer: o, playbackRate: t.intervalToFrequencyRatio(l), fadeIn: this.attack, fadeOut: this.release, curve: "exponential" }).connect(this.output), r.start(i, 0, o.duration, n), t.isArray(this._activeSources[a]) || (this._activeSources[a] = []), this._activeSources[a].push({ note: a, source: r })), this }, t.Sampler.prototype.triggerRelease = function(e, i) { var n, s = t.Frequency(e).toMidi();
                this._activeSources[s] && this._activeSources[s].length && (n = this._activeSources[s].shift().source, i = this.toSeconds(i), n.stop(i + this.release, this.release)) }, t.Sampler.prototype.triggerAttackRelease = function(t, e, i, n) { return i = this.toSeconds(i), e = this.toSeconds(e), this.triggerAttack(t, i, n), this.triggerRelease(t, i + e), this }, t.Sampler.prototype.add = function(e, i, n) { if (t.isNote(e)) { var s = t.Frequency(e).toMidi();
                    this._buffers.add(s, i, n) } else { if (isNaN(parseFloat(e))) throw new Error("Tone.Sampler: note must be the note's pitch. Instead got " + e);
                    this._buffers.add(e, i, n) } }, Object.defineProperty(t.Sampler.prototype, "loaded", { get: function() { return this._buffers.loaded } }), t.Sampler.prototype.dispose = function() { t.Instrument.prototype.dispose.call(this), this._buffers.dispose(), this._buffers = null; for (var e in this._activeSources) this._activeSources[e].forEach(function(t) { t.source.dispose() }); return this._activeSources = null, this }, t.Sampler }), t(function(t) { t.supported && (OscillatorNode.prototype.setPeriodicWave || (OscillatorNode.prototype.setPeriodicWave = OscillatorNode.prototype.setWaveTable), AudioContext.prototype.createPeriodicWave || (AudioContext.prototype.createPeriodicWave = AudioContext.prototype.createWaveTable)) }), t(function(t) {
            function e(t, e, i) { var n = new t; return i._eval(e[0]).connect(n, 0, 0), i._eval(e[1]).connect(n, 0, 1), n }

            function i(t, e, i) { var n = new t; return i._eval(e[0]).connect(n, 0, 0), n }

            function n(t) { return t ? parseFloat(t) : void 0 }

            function s(t) { return t && t.args ? parseFloat(t.args) : void 0 }
            return t.Expr = function() {
                var e, i, n, s, o;
                for (t.SignalBase.call(this), e = this._replacements(Array.prototype.slice.call(arguments)), i = this._parseInputs(e),
                    this._nodes = [], this.input = new Array(i), n = 0; n < i; n++) this.input[n] = this.context.createGain();
                s = this._parseTree(e);
                try { o = this._eval(s) } catch (t) { throw this._disposeNodes(), new Error("Tone.Expr: Could evaluate expression: " + e) } this.output = o
            }, t.extend(t.Expr, t.SignalBase), t.Expr._Expressions = { value: { signal: { regexp: /^\d+\.\d+|^\d+/, method: function(e) { return new t.Signal(n(e)) } }, input: { regexp: /^\$\d/, method: function(t, e) { return e.input[n(t.substr(1))] } } }, glue: { "(": { regexp: /^\(/ }, ")": { regexp: /^\)/ }, ",": { regexp: /^,/ } }, func: { abs: { regexp: /^abs/, method: i.bind(this, t.Abs) }, mod: { regexp: /^mod/, method: function(e, i) { var n = s(e[1]),
                                o = new t.Modulo(n); return i._eval(e[0]).connect(o), o } }, pow: { regexp: /^pow/, method: function(e, i) { var n = s(e[1]),
                                o = new t.Pow(n); return i._eval(e[0]).connect(o), o } }, a2g: { regexp: /^a2g/, method: function(e, i) { var n = new t.AudioToGain; return i._eval(e[0]).connect(n), n } } }, binary: { "+": { regexp: /^\+/, precedence: 1, method: e.bind(this, t.Add) }, "-": { regexp: /^-/, precedence: 1, method: function(n, s) { return 1 === n.length ? i(t.Negate, n, s) : e(t.Subtract, n, s) } }, "*": { regexp: /^\*/, precedence: 0, method: e.bind(this, t.Multiply) } }, unary: { "-": { regexp: /^-/, method: i.bind(this, t.Negate) }, "!": { regexp: /^!/, method: i.bind(this, t.NOT) } } }, t.Expr.prototype._parseInputs = function(t) { var e, i, n = t.match(/\$\d/g),
                    s = 0; if (null !== n)
                    for (e = 0; e < n.length; e++) i = parseInt(n[e].substr(1)) + 1, s = Math.max(s, i); return s }, t.Expr.prototype._replacements = function(t) { var e, i = t.shift(); for (e = 0; e < t.length; e++) i = i.replace(/%/i, t[e]); return i }, t.Expr.prototype._tokenize = function(e) { for (var i, n = -1, s = []; e.length > 0;) e = e.trim(), i = function(e) { var i, n, s, o, r, a; for (i in t.Expr._Expressions) { n = t.Expr._Expressions[i]; for (s in n)
                            if (o = n[s], r = o.regexp, null !== (a = e.match(r))) return { type: i, value: a[0], method: o.method } } throw new SyntaxError("Tone.Expr: Unexpected token " + e) }(e), s.push(i), e = e.substr(i.value.length); return { next: function() { return s[++n] }, peek: function() { return s[n + 1] } } }, t.Expr.prototype._parseTree = function(e) {
                function i(t, e) { return !u(t) && "glue" === t.type && t.value === e }

                function n(e, i, n) { var s, o, r = !1,
                        a = t.Expr._Expressions[i]; if (!u(e))
                        for (s in a)
                            if (o = a[s], o.regexp.test(e.value)) { if (u(n)) return !0; if (o.precedence === n) return !0 } return r }

                function s(t) { var e, i; for (u(t) && (t = 5), e = t < 0 ? o() : s(t - 1), i = h.peek(); n(i, "binary", t);) i = h.next(), e = { operator: i.value, method: i.method, args: [e, s(t - 1)] }, i = h.peek(); return e }

                function o() { var t, e; return t = h.peek(), n(t, "unary") ? (t = h.next(), e = o(), { operator: t.value, method: t.method, args: [e] }) : r() }

                function r() { var t, e; if (t = h.peek(), u(t)) throw new SyntaxError("Tone.Expr: Unexpected termination of expression"); if ("func" === t.type) return t = h.next(), a(t); if ("value" === t.type) return t = h.next(), { method: t.method, args: t.value }; if (i(t, "(")) { if (h.next(), e = s(), t = h.next(), !i(t, ")")) throw new SyntaxError("Expected )"); return e } throw new SyntaxError("Tone.Expr: Parse error, cannot process token " + t.value) }

                function a(t) { var e, n = []; if (e = h.next(), !i(e, "(")) throw new SyntaxError('Tone.Expr: Expected ( in a function call "' + t.value + '"'); if (e = h.peek(), i(e, ")") || (n = l()), e = h.next(), !i(e, ")")) throw new SyntaxError('Tone.Expr: Expected ) in a function call "' + t.value + '"'); return { method: t.method, args: n, name: name } }

                function l() { for (var t, e, n = [];;) { if (e = s(), u(e)) break; if (n.push(e), t = h.peek(), !i(t, ",")) break;
                        h.next() } return n } var h = this._tokenize(e),
                    u = t.isUndef.bind(this); return s() }, t.Expr.prototype._eval = function(e) { if (!t.isUndef(e)) { var i = e.method(e.args, this); return this._nodes.push(i), i } }, t.Expr.prototype._disposeNodes = function() { var e, i; for (e = 0; e < this._nodes.length; e++) i = this._nodes[e], t.isFunction(i.dispose) ? i.dispose() : t.isFunction(i.disconnect) && i.disconnect(), i = null, this._nodes[e] = null;
                this._nodes = null }, t.Expr.prototype.dispose = function() { t.SignalBase.prototype.dispose.call(this), this._disposeNodes() }, t.Expr
        }), t(function(t) { return t.GainToAudio = function() { t.SignalBase.call(this), this._norm = this.input = this.output = new t.WaveShaper(function(t) { return 2 * Math.abs(t) - 1 }) }, t.extend(t.GainToAudio, t.SignalBase), t.GainToAudio.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._norm.dispose(), this._norm = null, this }, t.GainToAudio }), t(function(t) { return t.Normalize = function(e, i) { t.SignalBase.call(this), this._inputMin = t.defaultArg(e, 0), this._inputMax = t.defaultArg(i, 1), this._sub = this.input = new t.Add(0), this._div = this.output = new t.Multiply(1), this._sub.connect(this._div), this._setRange() }, t.extend(t.Normalize, t.SignalBase), Object.defineProperty(t.Normalize.prototype, "min", { get: function() { return this._inputMin }, set: function(t) { this._inputMin = t, this._setRange() } }), Object.defineProperty(t.Normalize.prototype, "max", { get: function() { return this._inputMax }, set: function(t) { this._inputMax = t, this._setRange() } }), t.Normalize.prototype._setRange = function() { this._sub.value = -this._inputMin, this._div.value = 1 / (this._inputMax - this._inputMin) }, t.Normalize.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._sub.dispose(), this._sub = null, this._div.dispose(), this._div = null, this }, t.Normalize }), t(function(t) { return t.TransportTimelineSignal = function() { t.TimelineSignal.apply(this, arguments), this.output = this._outputSig = new t.Signal(this._initial), this._lastVal = this.value, this._synced = t.Transport.scheduleRepeat(this._onTick.bind(this), "1i"), this._bindAnchorValue = this._anchorValue.bind(this), t.Transport.on("start stop pause", this._bindAnchorValue), this._events.memory = 1 / 0 }, t.extend(t.TransportTimelineSignal, t.TimelineSignal), t.TransportTimelineSignal.prototype._onTick = function(e) { var i = this.getValueAtTime(t.Transport.seconds);
                this._lastVal !== i && (this._lastVal = i, this._outputSig.linearRampToValueAtTime(i, e)) }, t.TransportTimelineSignal.prototype._anchorValue = function(e) { var i = this.getValueAtTime(t.Transport.ticks); return this._lastVal = i, this._outputSig.cancelScheduledValues(e), this._outputSig.setValueAtTime(i, e), this }, t.TransportTimelineSignal.prototype.getValueAtTime = function(e) { return e = this.toTicks(e), t.TimelineSignal.prototype.getValueAtTime.call(this, e) }, t.TransportTimelineSignal.prototype.setValueAtTime = function(e, i) { return i = this.toTicks(i), t.TimelineSignal.prototype.setValueAtTime.call(this, e, i), this }, t.TransportTimelineSignal.prototype.linearRampToValueAtTime = function(e, i) { return i = this.toTicks(i), t.TimelineSignal.prototype.linearRampToValueAtTime.call(this, e, i), this }, t.TransportTimelineSignal.prototype.exponentialRampToValueAtTime = function(e, i) { return i = this.toTicks(i), t.TimelineSignal.prototype.exponentialRampToValueAtTime.call(this, e, i), this }, t.TransportTimelineSignal.prototype.setTargetAtTime = function(e, i, n) { return i = this.toTicks(i), t.TimelineSignal.prototype.setTargetAtTime.call(this, e, i, n), this }, t.TransportTimelineSignal.prototype.cancelScheduledValues = function(e) { return e = this.toTicks(e), t.TimelineSignal.prototype.cancelScheduledValues.call(this, e), this }, t.TransportTimelineSignal.prototype.setValueCurveAtTime = function(e, i, n, s) { return i = this.toTicks(i), n = this.toTicks(n), t.TimelineSignal.prototype.setValueCurveAtTime.call(this, e, i, n, s), this }, t.TransportTimelineSignal.prototype.dispose = function() { t.Transport.clear(this._synced), t.Transport.off("start stop pause", this._syncedCallback), this._events.cancel(0), t.TimelineSignal.prototype.dispose.call(this), this._outputSig.dispose(), this._outputSig = null }, t.TransportTimelineSignal }), t(function(t) { return t.GrainPlayer = function() { var e = t.defaults(arguments, ["url", "onload"], t.GrainPlayer);
                t.Source.call(this, e), this.buffer = new t.Buffer(e.url, e.onload), this._clock = new t.Clock(this._tick.bind(this), e.grainSize), this._loopStart = 0, this._loopEnd = 0, this._activeSources = [], this._playbackRate = e.playbackRate, this._grainSize = e.grainSize, this._overlap = e.overlap, this.detune = e.detune, this.overlap = e.overlap, this.loop = e.loop, this.playbackRate = e.playbackRate, this.grainSize = e.grainSize, this.loopStart = e.loopStart, this.loopEnd = e.loopEnd, this.reverse = e.reverse, this._clock.on("stop", this._onstop.bind(this)) }, t.extend(t.GrainPlayer, t.Source), t.GrainPlayer.defaults = { onload: t.noOp, overlap: .1, grainSize: .2, playbackRate: 1, detune: 0, loop: !1, loopStart: 0, loopEnd: 0, reverse: !1 }, t.GrainPlayer.prototype._start = function(e, i, n) { i = t.defaultArg(i, 0), i = this.toSeconds(i), e = this.toSeconds(e), this._offset = i, this._clock.start(e), n && this.stop(e + this.toSeconds(n)) }, t.GrainPlayer.prototype._stop = function(t) { this._clock.stop(t) }, t.GrainPlayer.prototype._onstop = function(t) { this._activeSources.forEach(function(e) { e.stop(t, 0) }) }, t.GrainPlayer.prototype._tick = function(e) { var i = this._offset < this._overlap ? 0 : this._overlap,
                    n = new t.BufferSource({ buffer: this.buffer, fadeIn: i, fadeOut: this._overlap, loop: this.loop, loopStart: this._loopStart, loopEnd: this._loopEnd, playbackRate: t.intervalToFrequencyRatio(this.detune / 100) }).connect(this.output);
                n.start(e, this._offset), this._offset += this.grainSize, n.stop(e + this.grainSize), this._activeSources.push(n), n.onended = function() { var t = this._activeSources.indexOf(n); - 1 !== t && this._activeSources.splice(t, 1) }.bind(this) }, t.GrainPlayer.prototype.seek = function(t, e) { return this._offset = this.toSeconds(t), this._tick(this.toSeconds(e)), this }, Object.defineProperty(t.GrainPlayer.prototype, "playbackRate", { get: function() { return this._playbackRate }, set: function(t) { this._playbackRate = t, this.grainSize = this._grainSize } }), Object.defineProperty(t.GrainPlayer.prototype, "loopStart", { get: function() { return this._loopStart }, set: function(t) { this._loopStart = this.toSeconds(t) } }), Object.defineProperty(t.GrainPlayer.prototype, "loopEnd", { get: function() { return this._loopEnd }, set: function(t) { this._loopEnd = this.toSeconds(t) } }), Object.defineProperty(t.GrainPlayer.prototype, "reverse", { get: function() { return this.buffer.reverse }, set: function(t) { this.buffer.reverse = t } }), Object.defineProperty(t.GrainPlayer.prototype, "grainSize", { get: function() { return this._grainSize }, set: function(t) { this._grainSize = this.toSeconds(t), this._clock.frequency.value = this._playbackRate / this._grainSize } }), Object.defineProperty(t.GrainPlayer.prototype, "overlap", { get: function() { return this._overlap }, set: function(t) { this._overlap = this.toSeconds(t) } }), t.GrainPlayer.prototype.dispose = function() { return t.Source.prototype.dispose.call(this), this.buffer.dispose(), this.buffer = null, this._clock.dispose(), this._clock = null, this._activeSources.forEach(function(t) { t.dispose() }), this._activeSources = null, this }, t.GrainPlayer }), t(function(t) { return t.Player = function(e) { var i;
                e instanceof t.Buffer ? (e = e.get(), i = t.Player.defaults) : i = t.defaults(arguments, ["url", "onload"], t.Player), t.Source.call(this, i), this.autostart = i.autostart, this._buffer = new t.Buffer({ url: i.url, onload: this._onload.bind(this, i.onload), reverse: i.reverse }), e instanceof AudioBuffer && this._buffer.set(e), this._loop = i.loop, this._loopStart = i.loopStart, this._loopEnd = i.loopEnd, this._playbackRate = i.playbackRate, this.retrigger = i.retrigger, this.fadeIn = i.fadeIn, this.fadeOut = i.fadeOut }, t.extend(t.Player, t.Source), t.Player.defaults = { onload: t.noOp, playbackRate: 1, loop: !1, autostart: !1, loopStart: 0, loopEnd: 0, retrigger: !1, reverse: !1, fadeIn: 0, fadeOut: 0 }, t.Player.prototype.load = function(t, e) { return this._buffer.load(t, this._onload.bind(this, e)) }, t.Player.prototype._onload = function(e) { e = t.defaultArg(e, t.noOp), e(this), this.autostart && this.start() }, t.Player.prototype._start = function(e, i, n) { var s, o; return i = this._loop ? t.defaultArg(i, this._loopStart) : t.defaultArg(i, 0), i = this.toSeconds(i), n = t.defaultArg(n, Math.max(this._buffer.duration - i, 0)), n = this.toSeconds(n), e = this.toSeconds(e), s = new t.BufferSource({ buffer: this._buffer, loop: this._loop, loopStart: this._loopStart, loopEnd: this._loopEnd, playbackRate: this._playbackRate, fadeIn: this.fadeIn, fadeOut: this.fadeOut }).connect(this.output), this._loop || this._synced || this._state.setStateAtTime(t.State.Stopped, e + n), o = this._state.get(e), o.source = s, this._loop ? s.start(e, i) : s.start(e, i, n), this }, t.Player.prototype._stop = function(t) { var e, i; return t = this.toSeconds(t), e = this._state.get(t), i = e ? e.time : 0, i = this.retrigger ? 0 : i, this._state.forEachFrom(i, function(e) { e.source && e.source.stop(t) }), this }, t.Player.prototype.seek = function(e, i) { return i = this.toSeconds(i), this._state.getValueAtTime(i) === t.State.Started && (e = this.toSeconds(e), this._stop(i), this._start(i, e)), this }, t.Player.prototype.setLoopPoints = function(t, e) { return this.loopStart = t, this.loopEnd = e, this }, Object.defineProperty(t.Player.prototype, "loopStart", { get: function() { return this._loopStart }, set: function(e) { this._loopStart = e; var i = this._state.get(t.now());
                    i && i.source && (i.source.loopStart = this.toSeconds(e)) } }), Object.defineProperty(t.Player.prototype, "loopEnd", { get: function() { return this._loopEnd }, set: function(e) { this._loopEnd = e; var i = this._state.get(t.now());
                    i && i.source && (i.source.loopEnd = this.toSeconds(e)) } }), Object.defineProperty(t.Player.prototype, "buffer", { get: function() { return this._buffer }, set: function(t) { this._buffer.set(t) } }), Object.defineProperty(t.Player.prototype, "loop", { get: function() { return this._loop }, set: function(e) { this._loop = e; var i = this._state.get(t.now());
                    i && i.source && (i.source.loop = e) } }), Object.defineProperty(t.Player.prototype, "playbackRate", { get: function() { return this._playbackRate }, set: function(e) { this._playbackRate = e; var i = this._state.get(t.now());
                    i && i.source && (i.source.playbackRate.value = e) } }), Object.defineProperty(t.Player.prototype, "reverse", { get: function() { return this._buffer.reverse }, set: function(t) { this._buffer.reverse = t } }), Object.defineProperty(t.Player.prototype, "loaded", { get: function() { return this._buffer.loaded } }), t.Player.prototype.dispose = function() { return this._state.forEach(function(t) { t.source && (t.source.disconnect(), t.source = null) }), t.Source.prototype.dispose.call(this), this._buffer.dispose(), this._buffer = null, this }, t.Player }), t(function(t) { return t.Players = function(e) { var i, n, s = Array.prototype.slice.call(arguments);
                s.shift(), i = t.defaults(s, ["onload"], t.Players), t.call(this), this._volume = this.output = new t.Volume(i.volume), this.volume = this._volume.volume, this._readOnly("volume"), this._volume.output.output.channelCount = 2, this._volume.output.output.channelCountMode = "explicit", this.mute = i.mute, this._players = {}, this._loadingCount = 0, this._fadeIn = i.fadeIn, this._fadeOut = i.fadeOut; for (n in e) this._loadingCount++, this.add(n, e[n], this._bufferLoaded.bind(this, i.onload)) }, t.extend(t.Players, t.AudioNode), t.Players.defaults = { volume: 0, mute: !1, onload: t.noOp, fadeIn: 0, fadeOut: 0 }, t.Players.prototype._bufferLoaded = function(t) { 0 === --this._loadingCount && t && t(this) }, Object.defineProperty(t.Players.prototype, "mute", { get: function() { return this._volume.mute }, set: function(t) { this._volume.mute = t } }), Object.defineProperty(t.Players.prototype, "fadeIn", { get: function() { return this._fadeIn }, set: function(t) { this._fadeIn = t, this._forEach(function(e) { e.fadeIn = t }) } }), Object.defineProperty(t.Players.prototype, "fadeOut", { get: function() { return this._fadeOut }, set: function(t) { this._fadeOut = t, this._forEach(function(e) { e.fadeOut = t }) } }), Object.defineProperty(t.Players.prototype, "state", { get: function() { var e = !1; return this._forEach(function(i) { e = e || i.state === t.State.Started }), e ? t.State.Started : t.State.Stopped } }), t.Players.prototype.has = function(t) { return this._players.hasOwnProperty(t) }, t.Players.prototype.get = function(t) { if (this.has(t)) return this._players[t]; throw new Error("Tone.Players: no player named " + t) }, t.Players.prototype._forEach = function(t) { for (var e in this._players) t(this._players[e], e); return this }, Object.defineProperty(t.Players.prototype, "loaded", { get: function() { var t = !0; return this._forEach(function(e) { t = t && e.loaded }), t } }), t.Players.prototype.add = function(e, i, n) { return this._players[e] = new t.Player(i, n).connect(this.output), this._players[e].fadeIn = this._fadeIn, this._players[e].fadeOut = this._fadeOut, this }, t.Players.prototype.stopAll = function(t) { this._forEach(function(e) { e.stop(t) }) }, t.Players.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._volume.dispose(), this._volume = null, this._writable("volume"), this.volume = null, this.output = null, this._forEach(function(t) { t.dispose() }), this._players = null, this }, t.Players }), t(function(t) { return t.UserMedia = function() { var e = t.defaults(arguments, ["volume"], t.UserMedia);
                t.AudioNode.call(this), this._mediaStream = null, this._stream = null, this._device = null, this._volume = this.output = new t.Volume(e.volume), this.volume = this._volume.volume, this._readOnly("volume"), this.mute = e.mute }, t.extend(t.UserMedia, t.AudioNode), t.UserMedia.defaults = { volume: 0, mute: !1 }, t.UserMedia.prototype.open = function(e) { return t.UserMedia.enumerateDevices().then(function(i) { var n, s; if (t.isNumber(e)) n = i[e];
                    else if (!(n = i.find(function(t) { return t.label === e || t.deviceId === e })) && i.length > 0) n = i[0];
                    else if (!n) throw new Error("Tone.UserMedia: no matching device: " + e); return this._device = n, s = { audio: { deviceId: n.deviceId, echoCancellation: !1, sampleRate: this.context.sampleRate } }, navigator.mediaDevices.getUserMedia(s).then(function(t) { return this._stream || (this._stream = t, this._mediaStream = this.context.createMediaStreamSource(t), this._mediaStream.connect(this.output)), this }.bind(this)) }.bind(this)) }, t.UserMedia.prototype.close = function() { return this._stream && (this._stream.getAudioTracks().forEach(function(t) { t.stop() }), this._stream = null, this._mediaStream.disconnect(), this._mediaStream = null), this._device = null, this }, t.UserMedia.enumerateDevices = function() { return navigator.mediaDevices.enumerateDevices().then(function(t) { return t.filter(function(t) { return "audioinput" === t.kind }) }) }, Object.defineProperty(t.UserMedia.prototype, "state", { get: function() { return this._stream && this._stream.active ? t.State.Started : t.State.Stopped } }), Object.defineProperty(t.UserMedia.prototype, "deviceId", { get: function() { if (this._device) return this._device.deviceId } }), Object.defineProperty(t.UserMedia.prototype, "groupId", { get: function() { if (this._device) return this._device.groupId } }), Object.defineProperty(t.UserMedia.prototype, "label", { get: function() { if (this._device) return this._device.label } }), Object.defineProperty(t.UserMedia.prototype, "mute", { get: function() { return this._volume.mute }, set: function(t) { this._volume.mute = t } }), t.UserMedia.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this.close(), this._writable("volume"), this._volume.dispose(), this._volume = null, this.volume = null, this }, Object.defineProperty(t.UserMedia, "supported", { get: function() { return !t.isUndef(navigator.mediaDevices) && t.isFunction(navigator.mediaDevices.getUserMedia) } }), t.UserMedia }), e
    });
    ! function(t, e) { "function" == typeof define && define.amd ? define(function() { return e() }) : "object" == typeof module ? module.exports = e() : t.Tone = e() }(this, function() {
        "use strict";

        function t(t) { t(e) }
        var e;
        /**
         *  Tone.js
         *  @author Yotam Mann
         *  @license http://opensource.org/licenses/MIT MIT License
         *  @copyright 2014-2017 Yotam Mann
         */
        return function(t) { e = t() }(function() { var t = function() {}; return t.prototype.toString = function() { var e, i, n; for (e in t)
                    if (i = e[0].match(/^[A-Z]$/), n = t[e] === this.constructor, t.isFunction(t[e]) && i && n) return e; return "Tone" }, t.prototype.dispose = function() { return this }, t.prototype.set = function(e, i, n) { var s, o, r, a, l, h, u;
                t.isObject(e) ? n = i : t.isString(e) && (s = {}, s[e] = i, e = s);
                t: for (o in e) { if (i = e[o], r = this, -1 !== o.indexOf(".")) { for (a = o.split("."), l = 0; l < a.length - 1; l++)
                            if ((r = r[a[l]]) instanceof t) { a.splice(0, l + 1), h = a.join("."), r.set(h, i); continue t } o = a[a.length - 1] } u = r[o], t.isUndef(u) || (t.Signal && u instanceof t.Signal || t.Param && u instanceof t.Param ? u.value !== i && (t.isUndef(n) ? u.value = i : u.rampTo(i, n)) : u instanceof AudioParam ? u.value !== i && (u.value = i) : u instanceof t ? u.set(i) : u !== i && (r[o] = i)) }
                return this }, t.prototype.get = function(e) { var i, n, s, o, r, a, l, h, u; for (t.isUndef(e) ? e = this._collectDefaults(this.constructor) : t.isString(e) && (e = [e]), i = {}, n = 0; n < e.length; n++) { if (s = e[n], o = this, r = i, -1 !== s.indexOf(".")) { for (a = s.split("."), l = 0; l < a.length - 1; l++) h = a[l], r[h] = r[h] || {}, r = r[h], o = o[h];
                        s = a[a.length - 1] } u = o[s], t.isObject(e[s]) ? r[s] = u.get() : t.Signal && u instanceof t.Signal ? r[s] = u.value : t.Param && u instanceof t.Param ? r[s] = u.value : u instanceof AudioParam ? r[s] = u.value : u instanceof t ? r[s] = u.get() : t.isFunction(u) || t.isUndef(u) || (r[s] = u) } return i }, t.prototype._collectDefaults = function(e) { var i, n, s = []; if (t.isUndef(e.defaults) || (s = Object.keys(e.defaults)), !t.isUndef(e._super))
                    for (i = this._collectDefaults(e._super), n = 0; n < i.length; n++) - 1 === s.indexOf(i[n]) && s.push(i[n]); return s }, t.defaults = function(e, i, n) { var s, o = {}; if (1 === e.length && t.isObject(e[0])) o = e[0];
                else
                    for (s = 0; s < i.length; s++) o[i[s]] = e[s]; return t.isUndef(n.defaults) ? t.isObject(n) ? t.defaultArg(o, n) : o : t.defaultArg(o, n.defaults) }, t.defaultArg = function(e, i) { var n, s, o; if (t.isObject(e) && t.isObject(i)) { n = {}; for (s in e) n[s] = t.defaultArg(i[s], e[s]); for (o in i) n[o] = t.defaultArg(e[o], i[o]); return n } return t.isUndef(e) ? i : e }, t.connectSeries = function() { var e, i, n = arguments[0]; for (e = 1; e < arguments.length; e++) i = arguments[e], n.connect(i), n = i; return t }, t.isUndef = function(t) { return void 0 === t }, t.isFunction = function(t) { return "function" == typeof t }, t.isNumber = function(t) { return "number" == typeof t }, t.isObject = function(t) { return "[object Object]" === Object.prototype.toString.call(t) && t.constructor === Object }, t.isBoolean = function(t) { return "boolean" == typeof t }, t.isArray = function(t) { return Array.isArray(t) }, t.isString = function(t) { return "string" == typeof t }, t.isNote = function(e) { return t.isString(e) && /^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(e) }, t.noOp = function() {}, t.prototype._readOnly = function(t) { if (Array.isArray(t))
                    for (var e = 0; e < t.length; e++) this._readOnly(t[e]);
                else Object.defineProperty(this, t, { writable: !1, enumerable: !0 }) }, t.prototype._writable = function(t) { if (Array.isArray(t))
                    for (var e = 0; e < t.length; e++) this._writable(t[e]);
                else Object.defineProperty(this, t, { writable: !0 }) }, t.State = { Started: "started", Stopped: "stopped", Paused: "paused" }, t.equalPowerScale = function(t) { var e = .5 * Math.PI; return Math.sin(t * e) }, t.dbToGain = function(t) { return Math.pow(2, t / 6) }, t.gainToDb = function(t) { return Math.log(t) / Math.LN10 * 20 }, t.intervalToFrequencyRatio = function(t) { return Math.pow(2, t / 12) }, t.prototype.now = function() { return t.context.now() }, t.now = function() { return t.context.now() }, t.isPast = function(e) { e < t.context.currentTime && console.warn("Time '" + e + "' is in the past. Scheduled time must be ≥ AudioContext.currentTime") }, t.extend = function(e, i) {
                function n() {} t.isUndef(i) && (i = t), n.prototype = i.prototype, e.prototype = new n, e.prototype.constructor = e, e._super = i }, Object.defineProperty(t, "context", { get: function() { return window.TONE_AUDIO_CONTEXT }, set: function(e) { window.TONE_AUDIO_CONTEXT = t.Context && e instanceof t.Context ? e : new t.Context(e), t.Context.emit("init", window.TONE_AUDIO_CONTEXT) } }), Object.defineProperty(t.prototype, "context", { get: function() { return t.context } }), t.setContext = function(e) { t.context = e }, Object.defineProperty(t.prototype, "blockTime", { get: function() { return 128 / this.context.sampleRate } }), Object.defineProperty(t.prototype, "sampleTime", { get: function() { return 1 / this.context.sampleRate } }), Object.defineProperty(t, "supported", { get: function() { var t = window.hasOwnProperty("AudioContext") || window.hasOwnProperty("webkitAudioContext"),
                        e = window.hasOwnProperty("Promise"),
                        i = window.hasOwnProperty("Worker"); return t && e && i } }), Object.defineProperty(t, "initialized", { get: function() { return !t.isUndef(window.TONE_AUDIO_CONTEXT) } }), t.getContext = function(e) { if (t.initialized) e(t.context);
                else { var i = function() { e(t.context), t.Context.off("init", i) };
                    t.Context.on("init", i) } return t }, t.version = "r12-dev", t }), t(function(t) { return t.Emitter = function() { t.call(this), this._events = {} }, t.extend(t.Emitter), t.Emitter.prototype.on = function(t, e) { var i, n, s = t.split(/\W+/); for (i = 0; i < s.length; i++) n = s[i], this._events.hasOwnProperty(n) || (this._events[n] = []), this._events[n].push(e); return this }, t.Emitter.prototype.off = function(e, i) { var n, s, o, r = e.split(/\W+/); for (n = 0; n < r.length; n++)
                    if (e = r[n], this._events.hasOwnProperty(e))
                        if (t.isUndef(i)) this._events[e] = [];
                        else
                            for (s = this._events[e], o = 0; o < s.length; o++) s[o] === i && s.splice(o, 1); return this }, t.Emitter.prototype.emit = function(t) { var e, i, n, s; if (this._events && (e = Array.apply(null, arguments).slice(1), this._events.hasOwnProperty(t)))
                    for (i = this._events[t], n = 0, s = i.length; n < s; n++) i[n].apply(this, e); return this }, t.Emitter.mixin = function(e) { var i, n, s, o = ["on", "off", "emit"]; for (e._events = {}, i = 0; i < o.length; i++) n = o[i], s = t.Emitter.prototype[n], e[n] = s; return t.Emitter }, t.Emitter.prototype.dispose = function() { return t.prototype.dispose.call(this), this._events = null, this }, t.Emitter }), t(function(t) { return t.Timeline = function() { var e = t.defaults(arguments, ["memory"], t.Timeline);
                t.call(this), this._timeline = [], this._toRemove = [], this._toAdd = [], this._iterating = !1, this.memory = e.memory }, t.extend(t.Timeline), t.Timeline.defaults = { memory: 1 / 0 }, Object.defineProperty(t.Timeline.prototype, "length", { get: function() { return this._timeline.length } }), t.Timeline.prototype.add = function(e) { var i, n; if (t.isUndef(e.time)) throw new Error("Tone.Timeline: events must have a time attribute"); return this._iterating ? this._toAdd.push(e) : (i = this._search(e.time), this._timeline.splice(i + 1, 0, e), this.length > this.memory && (n = this.length - this.memory, this._timeline.splice(0, n))), this }, t.Timeline.prototype.remove = function(t) { if (this._iterating) this._toRemove.push(t);
                else { var e = this._timeline.indexOf(t); - 1 !== e && this._timeline.splice(e, 1) } return this }, t.Timeline.prototype.get = function(e, i) { i = t.defaultArg(i, "time"); var n = this._search(e, i); return -1 !== n ? this._timeline[n] : null }, t.Timeline.prototype.peek = function() { return this._timeline[0] }, t.Timeline.prototype.shift = function() { return this._timeline.shift() }, t.Timeline.prototype.getAfter = function(e, i) { i = t.defaultArg(i, "time"); var n = this._search(e, i); return n + 1 < this._timeline.length ? this._timeline[n + 1] : null }, t.Timeline.prototype.getBefore = function(e, i) { var n, s; return i = t.defaultArg(i, "time"), (n = this._timeline.length) > 0 && this._timeline[n - 1][i] < e ? this._timeline[n - 1] : (s = this._search(e, i), s - 1 >= 0 ? this._timeline[s - 1] : null) }, t.Timeline.prototype.cancel = function(t) { var e, i; if (this._timeline.length > 1)
                    if ((e = this._search(t)) >= 0)
                        if (this._timeline[e].time === t) { for (i = e; i >= 0 && this._timeline[i].time === t; i--) e = i;
                            this._timeline = this._timeline.slice(0, e) } else this._timeline = this._timeline.slice(0, e + 1);
                else this._timeline = [];
                else 1 === this._timeline.length && this._timeline[0].time >= t && (this._timeline = []); return this }, t.Timeline.prototype.cancelBefore = function(t) { var e = this._search(t); return e >= 0 && (this._timeline = this._timeline.slice(e + 1)), this }, t.Timeline.prototype.previousEvent = function(t) { var e = this._timeline.indexOf(t); return e > 0 ? this._timeline[e - 1] : null }, t.Timeline.prototype._search = function(e, i) { var n, s, o, r, a, l, h, u; if (0 === this._timeline.length) return -1; if (i = t.defaultArg(i, "time"), n = 0, s = this._timeline.length, o = s, s > 0 && this._timeline[s - 1][i] <= e) return s - 1; for (; n < o;) { if (r = Math.floor(n + (o - n) / 2), a = this._timeline[r], l = this._timeline[r + 1], a[i] === e) { for (h = r; h < this._timeline.length; h++) u = this._timeline[h], u[i] === e && (r = h); return r } if (a[i] < e && l[i] > e) return r;
                    a[i] > e ? o = r : n = r + 1 } return -1 }, t.Timeline.prototype._iterate = function(e, i, n) { this._iterating = !0, i = t.defaultArg(i, 0), n = t.defaultArg(n, this._timeline.length - 1); for (var s = i; s <= n; s++) e.call(this, this._timeline[s]);
                this._iterating = !1, this._toRemove.forEach(function(t) { this.remove(t) }.bind(this)), this._toRemove = [], this._toAdd.forEach(function(t) { this.add(t) }.bind(this)), this._toAdd = [] }, t.Timeline.prototype.forEach = function(t) { return this._iterate(t), this }, t.Timeline.prototype.forEachBefore = function(t, e) { var i = this._search(t); return -1 !== i && this._iterate(e, 0, i), this }, t.Timeline.prototype.forEachAfter = function(t, e) { var i = this._search(t); return this._iterate(e, i + 1), this }, t.Timeline.prototype.forEachFrom = function(t, e) { for (var i = this._search(t); i >= 0 && this._timeline[i].time >= t;) i--; return this._iterate(e, i + 1), this }, t.Timeline.prototype.forEachAtTime = function(t, e) { var i = this._search(t); return -1 !== i && this._iterate(function(i) { i.time === t && e.call(this, i) }, 0, i), this }, t.Timeline.prototype.dispose = function() { return t.prototype.dispose.call(this), this._timeline = null, this._toRemove = null, this._toAdd = null, this }, t.Timeline }), t(function(t) { t.supported && (!window.hasOwnProperty("AudioContext") && window.hasOwnProperty("webkitAudioContext") && (window.AudioContext = window.webkitAudioContext), AudioContext.prototype.close || (AudioContext.prototype.close = function() { return t.isFunction(this.suspend) ? this.suspend() : Promise.resolve() }), AudioContext.prototype.resume || (AudioContext.prototype.resume = function() { return Promise.resolve() }), !AudioContext.prototype.createGain && AudioContext.prototype.createGainNode && (AudioContext.prototype.createGain = AudioContext.prototype.createGainNode), !AudioContext.prototype.createDelay && AudioContext.prototype.createDelayNode && (AudioContext.prototype.createDelay = AudioContext.prototype.createDelayNode)) }), t(function(t) { t.Context = function() { var i, n; if (t.Emitter.call(this), i = t.defaults(arguments, ["context"], t.Context), !i.context && (i.context = new window.AudioContext, !i.context)) throw new Error("could not create AudioContext. Possibly too many AudioContexts running already.");
                this._context = i.context; for (n in this._context) this._defineProperty(this._context, n);
                this._latencyHint = i.latencyHint, this._constants = {}, this.lookAhead = i.lookAhead, this._computedUpdateInterval = 0, this._ticker = new e(this.emit.bind(this, "tick"), i.clockSource, i.updateInterval), this._timeouts = new t.Timeline, this._timeoutIds = 0, this.on("tick", this._timeoutLoop.bind(this)) }, t.extend(t.Context, t.Emitter), t.Emitter.mixin(t.Context), t.Context.defaults = { clockSource: "worker", latencyHint: "interactive", lookAhead: .1, updateInterval: .03 }, t.Context.prototype._defineProperty = function(e, i) { t.isUndef(this[i]) && Object.defineProperty(this, i, { get: function() { return "function" == typeof e[i] ? e[i].bind(e) : e[i] }, set: function(t) { e[i] = t } }) }, t.Context.prototype.now = function() { return this._context.currentTime + this.lookAhead }, t.Context.prototype.ready = function() { return new Promise(function(t) { "running" === this._context.state ? t() : this._context.resume().then(function() { t() }) }.bind(this)) }, t.Context.prototype.close = function() { return this._context.close().then(function() { t.Context.emit("close", this) }.bind(this)) }, t.Context.prototype.getConstant = function(t) { var e, i, n, s; if (this._constants[t]) return this._constants[t]; for (e = this._context.createBuffer(1, 128, this._context.sampleRate), i = e.getChannelData(0), n = 0; n < i.length; n++) i[n] = t; return s = this._context.createBufferSource(), s.channelCount = 1, s.channelCountMode = "explicit", s.buffer = e, s.loop = !0, s.start(0), this._constants[t] = s, s }, t.Context.prototype._timeoutLoop = function() { for (var t = this.now(); this._timeouts && this._timeouts.length && this._timeouts.peek().time <= t;) this._timeouts.shift().callback() }, t.Context.prototype.setTimeout = function(t, e) { this._timeoutIds++; var i = this.now(); return this._timeouts.add({ callback: t, time: i + e, id: this._timeoutIds }), this._timeoutIds }, t.Context.prototype.clearTimeout = function(t) { return this._timeouts.forEach(function(e) { e.id === t && this.remove(e) }), this }, Object.defineProperty(t.Context.prototype, "updateInterval", { get: function() { return this._ticker.updateInterval }, set: function(t) { this._ticker.updateInterval = t } }), Object.defineProperty(t.Context.prototype, "clockSource", { get: function() { return this._ticker.type }, set: function(t) { this._ticker.type = t } }), Object.defineProperty(t.Context.prototype, "latencyHint", { get: function() { return this._latencyHint }, set: function(e) { var i = e; if (this._latencyHint = e, t.isString(e)) switch (e) {
                        case "interactive":
                            i = .1, this._context.latencyHint = e; break;
                        case "playback":
                            i = .8, this._context.latencyHint = e; break;
                        case "balanced":
                            i = .25, this._context.latencyHint = e; break;
                        case "fastest":
                            this._context.latencyHint = "interactive", i = .01 } this.lookAhead = i, this.updateInterval = i / 3 } }), t.Context.prototype.dispose = function() { return this.close().then(function() { t.Emitter.prototype.dispose.call(this), this._ticker.dispose(), this._ticker = null, this._timeouts.dispose(), this._timeouts = null; for (var e in this._constants) this._constants[e].disconnect();
                    this._constants = null }.bind(this)) }; var e = function(e, i, n) { this._type = i, this._updateInterval = n, this._callback = t.defaultArg(e, t.noOp), this._createClock() }; return e.Type = { Worker: "worker", Timeout: "timeout", Offline: "offline" }, e.prototype._createWorker = function() { var t, e, i;
                window.URL = window.URL || window.webkitURL, t = new Blob(["var timeoutTime = " + (1e3 * this._updateInterval).toFixed(1) + ";self.onmessage = function(msg){\ttimeoutTime = parseInt(msg.data);};function tick(){\tsetTimeout(tick, timeoutTime);\tself.postMessage('tick');}tick();"]), e = URL.createObjectURL(t), i = new Worker(e), i.onmessage = this._callback.bind(this), this._worker = i }, e.prototype._createTimeout = function() { this._timeout = setTimeout(function() { this._createTimeout(), this._callback() }.bind(this), 1e3 * this._updateInterval) }, e.prototype._createClock = function() { if (this._type === e.Type.Worker) try { this._createWorker() } catch (t) { this._type = e.Type.Timeout, this._createClock() } else this._type === e.Type.Timeout && this._createTimeout() }, Object.defineProperty(e.prototype, "updateInterval", { get: function() { return this._updateInterval }, set: function(t) { this._updateInterval = Math.max(t, 128 / 44100), this._type === e.Type.Worker && this._worker.postMessage(Math.max(1e3 * t, 1)) } }), Object.defineProperty(e.prototype, "type", { get: function() { return this._type }, set: function(t) { this._disposeClock(), this._type = t, this._createClock() } }), e.prototype._disposeClock = function() { this._timeout && (clearTimeout(this._timeout), this._timeout = null), this._worker && (this._worker.terminate(), this._worker.onmessage = null, this._worker = null) }, e.prototype.dispose = function() { this._disposeClock(), this._callback = null }, t.getContext(function() {
                function e(e, i, s) { if (e.input) s = t.defaultArg(s, 0), t.isArray(e.input) ? this.connect(e.input[s]) : this.connect(e.input, i, s);
                    else try { e instanceof AudioNode ? n.call(this, e, i, s) : n.call(this, e, i) } catch (t) { throw new Error("error connecting to node: " + e + "\n" + t) } }

                function i(e, i, n) { if (e && e.input && t.isArray(e.input)) n = t.defaultArg(n, 0), this.disconnect(e.input[n], i, 0);
                    else if (e && e.input) this.disconnect(e.input, i, n);
                    else try { s.apply(this, arguments) } catch (t) { throw new Error("error disconnecting node: " + e + "\n" + t) } } var n = AudioNode.prototype.connect,
                    s = AudioNode.prototype.disconnect;
                AudioNode.prototype.connect !== e && (AudioNode.prototype.connect = e, AudioNode.prototype.disconnect = i) }), t.supported && !t.initialized ? (t.context = new t.Context, window.TONE_SILENCE_VERSION_LOGGING || console.log("%c * Tone.js " + t.version + " * ", "background: #000; color: #fff")) : t.supported || console.warn("This browser does not support Tone.js"), t.Context }), t(function(t) { return t.AudioNode = function() { t.call(this); var e = t.defaults(arguments, ["context"], { context: t.context });
                this._context = e.context }, t.extend(t.AudioNode), Object.defineProperty(t.AudioNode.prototype, "context", { get: function() { return this._context } }), t.AudioNode.prototype.createInsOuts = function(t, e) { 1 === t ? this.input = this.context.createGain() : t > 1 && (this.input = new Array(t)), 1 === e ? this.output = this.context.createGain() : e > 1 && (this.output = new Array(e)) }, Object.defineProperty(t.AudioNode.prototype, "numberOfInputs", { get: function() { return this.input ? t.isArray(this.input) ? this.input.length : 1 : 0 } }), Object.defineProperty(t.AudioNode.prototype, "numberOfOutputs", { get: function() { return this.output ? t.isArray(this.output) ? this.output.length : 1 : 0 } }), t.AudioNode.prototype.connect = function(e, i, n) { return t.isArray(this.output) ? (i = t.defaultArg(i, 0), this.output[i].connect(e, 0, n)) : this.output.connect(e, i, n), this }, t.AudioNode.prototype.disconnect = function(e, i, n) { t.isArray(this.output) ? t.isNumber(e) ? this.output[e].disconnect() : (i = t.defaultArg(i, 0), this.output[i].disconnect(e, 0, n)) : this.output.disconnect.apply(this.output, arguments) }, t.AudioNode.prototype.chain = function() { var t, e, i = this; for (t = 0; t < arguments.length; t++) e = arguments[t], i.connect(e), i = e; return this }, t.AudioNode.prototype.fan = function() { for (var t = 0; t < arguments.length; t++) this.connect(arguments[t]); return this }, window.AudioNode && (AudioNode.prototype.chain = t.AudioNode.prototype.chain, AudioNode.prototype.fan = t.AudioNode.prototype.fan), t.AudioNode.prototype.dispose = function() { return t.isUndef(this.input) || (this.input instanceof AudioNode && this.input.disconnect(), this.input = null), t.isUndef(this.output) || (this.output instanceof AudioNode && this.output.disconnect(), this.output = null), this._context = null, this }, t.AudioNode }), t(function(t) { return t.SignalBase = function() { t.AudioNode.call(this) }, t.extend(t.SignalBase, t.AudioNode), t.SignalBase.prototype.connect = function(e, i, n) { return t.Signal && t.Signal === e.constructor || t.Param && t.Param === e.constructor || t.TimelineSignal && t.TimelineSignal === e.constructor ? (e._param.cancelScheduledValues(0), e._param.value = 0, e.overridden = !0) : e instanceof AudioParam && (e.cancelScheduledValues(0), e.value = 0), t.AudioNode.prototype.connect.call(this, e, i, n), this }, t.SignalBase }), t(function(t) { return t.WaveShaper = function(e, i) { t.SignalBase.call(this), this._shaper = this.input = this.output = this.context.createWaveShaper(), this._curve = null, Array.isArray(e) ? this.curve = e : isFinite(e) || t.isUndef(e) ? this._curve = new Float32Array(t.defaultArg(e, 1024)) : t.isFunction(e) && (this._curve = new Float32Array(t.defaultArg(i, 1024)), this.setMap(e)) }, t.extend(t.WaveShaper, t.SignalBase), t.WaveShaper.prototype.setMap = function(t) { var e, i, n; for (e = 0, i = this._curve.length; e < i; e++) n = e / (i - 1) * 2 - 1, this._curve[e] = t(n, e); return this._shaper.curve = this._curve, this }, Object.defineProperty(t.WaveShaper.prototype, "curve", { get: function() { return this._shaper.curve }, set: function(t) { this._curve = new Float32Array(t), this._shaper.curve = this._curve } }), Object.defineProperty(t.WaveShaper.prototype, "oversample", { get: function() { return this._shaper.oversample }, set: function(t) { if (-1 === ["none", "2x", "4x"].indexOf(t)) throw new RangeError("Tone.WaveShaper: oversampling must be either 'none', '2x', or '4x'");
                    this._shaper.oversample = t } }), t.WaveShaper.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._shaper.disconnect(), this._shaper = null, this._curve = null, this }, t.WaveShaper }), t(function(t) { return t.TimeBase = function(e, i) { if (!(this instanceof t.TimeBase)) return new t.TimeBase(e, i); if (this._expr = this._noOp, e instanceof t.TimeBase) this.copy(e);
                else if (!t.isUndef(i) || t.isNumber(e)) { i = t.defaultArg(i, this._defaultUnits); var n = this._primaryExpressions[i].method;
                    this._expr = n.bind(this, e) } else t.isString(e) ? this.set(e) : t.isUndef(e) && (this._expr = this._defaultExpr()) }, t.extend(t.TimeBase), t.TimeBase.prototype.set = function(t) { return this._expr = this._parseExprString(t), this }, t.TimeBase.prototype.clone = function() { var t = new this.constructor; return t.copy(this), t }, t.TimeBase.prototype.copy = function(t) { var e = t._expr(); return this.set(e) }, t.TimeBase.prototype._primaryExpressions = { n: { regexp: /^(\d+)n/i, method: function(t) { return t = parseInt(t), 1 === t ? this._beatsToUnits(this._timeSignature()) : this._beatsToUnits(4 / t) } }, t: { regexp: /^(\d+)t/i, method: function(t) { return t = parseInt(t), this._beatsToUnits(8 / (3 * parseInt(t))) } }, m: { regexp: /^(\d+)m/i, method: function(t) { return this._beatsToUnits(parseInt(t) * this._timeSignature()) } }, i: { regexp: /^(\d+)i/i, method: function(t) { return this._ticksToUnits(parseInt(t)) } }, hz: { regexp: /^(\d+(?:\.\d+)?)hz/i, method: function(t) { return this._frequencyToUnits(parseFloat(t)) } }, tr: { regexp: /^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/, method: function(t, e, i) { var n = 0; return t && "0" !== t && (n += this._beatsToUnits(this._timeSignature() * parseFloat(t))), e && "0" !== e && (n += this._beatsToUnits(parseFloat(e))), i && "0" !== i && (n += this._beatsToUnits(parseFloat(i) / 4)), n } }, s: { regexp: /^(\d+(?:\.\d+)?s)/, method: function(t) { return this._secondsToUnits(parseFloat(t)) } }, samples: { regexp: /^(\d+)samples/, method: function(t) { return parseInt(t) / this.context.sampleRate } }, default: { regexp: /^(\d+(?:\.\d+)?)/, method: function(t) { return this._primaryExpressions[this._defaultUnits].method.call(this, t) } } }, t.TimeBase.prototype._binaryExpressions = { "+": { regexp: /^\+/, precedence: 2, method: function(t, e) { return t() + e() } }, "-": { regexp: /^-/, precedence: 2, method: function(t, e) { return t() - e() } }, "*": { regexp: /^\*/, precedence: 1, method: function(t, e) { return t() * e() } }, "/": { regexp: /^\//, precedence: 1, method: function(t, e) { return t() / e() } } }, t.TimeBase.prototype._unaryExpressions = { neg: { regexp: /^-/, method: function(t) { return -t() } } }, t.TimeBase.prototype._syntaxGlue = { "(": { regexp: /^\(/ }, ")": { regexp: /^\)/ } }, t.TimeBase.prototype._tokenize = function(t) { for (var e, i = -1, n = []; t.length > 0;) t = t.trim(), e = function(t, e) { var i, n, s, o, r, a, l = ["_binaryExpressions", "_unaryExpressions", "_primaryExpressions", "_syntaxGlue"]; for (i = 0; i < l.length; i++) { n = e[l[i]]; for (s in n)
                            if (o = n[s], r = o.regexp, null !== (a = t.match(r))) return { method: o.method, precedence: o.precedence, regexp: o.regexp, value: a[0] } } throw new SyntaxError("Tone.TimeBase: Unexpected token " + t) }(t, this), n.push(e), t = t.substr(e.value.length); return { next: function() { return n[++i] }, peek: function() { return n[i + 1] } } }, t.TimeBase.prototype._matchGroup = function(e, i, n) { var s, o, r = !1; if (!t.isUndef(e))
                    for (s in i)
                        if (o = i[s], o.regexp.test(e.value)) { if (t.isUndef(n)) return o; if (o.precedence === n) return o } return r }, t.TimeBase.prototype._parseBinary = function(e, i) { var n, s; for (t.isUndef(i) && (i = 2), n = i < 0 ? this._parseUnary(e) : this._parseBinary(e, i - 1), s = e.peek(); s && this._matchGroup(s, this._binaryExpressions, i);) s = e.next(), n = s.method.bind(this, n, this._parseBinary(e, i - 1)), s = e.peek(); return n }, t.TimeBase.prototype._parseUnary = function(t) { var e, i = t.peek(),
                    n = this._matchGroup(i, this._unaryExpressions); return n ? (i = t.next(), e = this._parseUnary(t), n.method.bind(this, e)) : this._parsePrimary(t) }, t.TimeBase.prototype._parsePrimary = function(e) { var i, n, s = e.peek(); if (t.isUndef(s)) throw new SyntaxError("Tone.TimeBase: Unexpected end of expression"); if (this._matchGroup(s, this._primaryExpressions)) return s = e.next(), n = s.value.match(s.regexp), s.method.bind(this, n[1], n[2], n[3]); if (s && "(" === s.value) { if (e.next(), i = this._parseBinary(e), !(s = e.next()) || ")" !== s.value) throw new SyntaxError("Expected )"); return i } throw new SyntaxError("Tone.TimeBase: Cannot process token " + s.value) }, t.TimeBase.prototype._parseExprString = function(e) { var i; return t.isString(e) || (e = e.toString()), i = this._tokenize(e), this._parseBinary(i) }, t.TimeBase.prototype._noOp = function() { return 0 }, t.TimeBase.prototype._defaultExpr = function() { return this._noOp }, t.TimeBase.prototype._defaultUnits = "s", t.TimeBase.prototype._frequencyToUnits = function(t) { return 1 / t }, t.TimeBase.prototype._beatsToUnits = function(e) { return 60 / t.Transport.bpm.value * e }, t.TimeBase.prototype._secondsToUnits = function(t) { return t }, t.TimeBase.prototype._ticksToUnits = function(e) { return e * (this._beatsToUnits(1) / t.Transport.PPQ) }, t.TimeBase.prototype._timeSignature = function() { return t.Transport.timeSignature }, t.TimeBase.prototype._pushExpr = function(e, i, n) { return e instanceof t.TimeBase || (e = new this.constructor(e, n)), this._expr = this._binaryExpressions[i].method.bind(this, this._expr, e._expr), this }, t.TimeBase.prototype.add = function(t, e) { return this._pushExpr(t, "+", e) }, t.TimeBase.prototype.sub = function(t, e) { return this._pushExpr(t, "-", e) }, t.TimeBase.prototype.mult = function(t, e) { return this._pushExpr(t, "*", e) }, t.TimeBase.prototype.div = function(t, e) { return this._pushExpr(t, "/", e) }, t.TimeBase.prototype.valueOf = function() { return this._expr() }, t.TimeBase.prototype.dispose = function() { this._expr = null }, t.TimeBase }), t(function(t) { return t.Time = function(e, i) { if (!(this instanceof t.Time)) return new t.Time(e, i);
                this._plusNow = !1, t.TimeBase.call(this, e, i) }, t.extend(t.Time, t.TimeBase), t.Time.prototype._unaryExpressions = Object.create(t.TimeBase.prototype._unaryExpressions), t.Time.prototype._unaryExpressions.quantize = { regexp: /^@/, method: function(e) { return t.Transport.nextSubdivision(e()) } }, t.Time.prototype._unaryExpressions.now = { regexp: /^\+/, method: function(t) { return this._plusNow = !0, t() } }, t.Time.prototype.quantize = function(e, i) { return i = t.defaultArg(i, 1), this._expr = function(t, e, i) { var n, s, o; return t = t(), e = e.toSeconds(), n = Math.round(t / e), s = n * e, o = s - t, t + o * i }.bind(this, this._expr, new this.constructor(e), i), this }, t.Time.prototype.addNow = function() { return this._plusNow = !0, this }, t.Time.prototype._defaultExpr = function() { return this._plusNow = !0, this._noOp }, t.Time.prototype.copy = function(e) { return t.TimeBase.prototype.copy.call(this, e), this._plusNow = e._plusNow, this }, t.Time.prototype.toNotation = function() { var t = this.toSeconds(),
                    e = ["1m", "2n", "4n", "8n", "16n", "32n", "64n", "128n"],
                    i = this._toNotationHelper(t, e),
                    n = ["1m", "2n", "2t", "4n", "4t", "8n", "8t", "16n", "16t", "32n", "32t", "64n", "64t", "128n"],
                    s = this._toNotationHelper(t, n); return s.split("+").length < i.split("+").length ? s : i }, t.Time.prototype._toNotationHelper = function(t, e) { var i, n, s, o, r = this._notationToUnits(e[e.length - 1]),
                    a = ""; for (i = 0; i < e.length; i++)
                    if (n = this._notationToUnits(e[i]), s = t / n, o = 1e-6, 1 - s % 1 < o && (s += o), (s = Math.floor(s)) > 0) { if (a += 1 === s ? e[i] : s.toString() + "*" + e[i], (t -= s * n) < r) break;
                        a += " + " } return "" === a && (a = "0"), a }, t.Time.prototype._notationToUnits = function(t) { var e, i, n, s = this._primaryExpressions,
                    o = [s.n, s.t, s.m]; for (e = 0; e < o.length; e++)
                    if (i = o[e], n = t.match(i.regexp)) return i.method.call(this, n[1]) }, t.Time.prototype.toBarsBeatsSixteenths = function() { var t, e = this._beatsToUnits(1),
                    i = this.toSeconds() / e,
                    n = Math.floor(i / this._timeSignature()),
                    s = i % 1 * 4; return i = Math.floor(i) % this._timeSignature(), s = s.toString(), s.length > 3 && (s = parseFloat(parseFloat(s).toFixed(3))), t = [n, i, s], t.join(":") }, t.Time.prototype.toTicks = function() { var e = this._beatsToUnits(1),
                    i = this.valueOf() / e; return Math.round(i * t.Transport.PPQ) }, t.Time.prototype.toSamples = function() { return this.toSeconds() * this.context.sampleRate }, t.Time.prototype.toFrequency = function() { return 1 / this.toSeconds() }, t.Time.prototype.toSeconds = function() { return this.valueOf() }, t.Time.prototype.toMilliseconds = function() { return 1e3 * this.toSeconds() }, t.Time.prototype.valueOf = function() { return this._expr() + (this._plusNow ? this.now() : 0) }, t.Time }), t(function(t) { var e, i; return t.Frequency = function(e, i) { if (!(this instanceof t.Frequency)) return new t.Frequency(e, i);
                t.TimeBase.call(this, e, i) }, t.extend(t.Frequency, t.TimeBase), t.Frequency.prototype._primaryExpressions = Object.create(t.TimeBase.prototype._primaryExpressions), t.Frequency.prototype._primaryExpressions.midi = { regexp: /^(\d+(?:\.\d+)?midi)/, method: function(t) { return this.midiToFrequency(t) } }, t.Frequency.prototype._primaryExpressions.note = { regexp: /^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i, method: function(t, i) { var n = e[t.toLowerCase()],
                        s = n + 12 * (parseInt(i) + 1); return this.midiToFrequency(s) } }, t.Frequency.prototype._primaryExpressions.tr = { regexp: /^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/, method: function(t, e, i) { var n = 1; return t && "0" !== t && (n *= this._beatsToUnits(this._timeSignature() * parseFloat(t))), e && "0" !== e && (n *= this._beatsToUnits(parseFloat(e))), i && "0" !== i && (n *= this._beatsToUnits(parseFloat(i) / 4)), n } }, t.Frequency.prototype.transpose = function(e) { return this._expr = function(e, i) { return e() * t.intervalToFrequencyRatio(i) }.bind(this, this._expr, e), this }, t.Frequency.prototype.harmonize = function(e) { return this._expr = function(e, i) { var n, s = e(),
                        o = []; for (n = 0; n < i.length; n++) o[n] = s * t.intervalToFrequencyRatio(i[n]); return o }.bind(this, this._expr, e), this }, t.Frequency.prototype.toMidi = function() { return this.frequencyToMidi(this.valueOf()) }, t.Frequency.prototype.toNote = function() { var e = this.valueOf(),
                    n = Math.log(e / t.Frequency.A4) / Math.LN2,
                    s = Math.round(12 * n) + 57,
                    o = Math.floor(s / 12); return o < 0 && (s += -12 * o), i[s % 12] + o.toString() }, t.Frequency.prototype.toSeconds = function() { return 1 / this.valueOf() }, t.Frequency.prototype.toFrequency = function() { return this.valueOf() }, t.Frequency.prototype.toTicks = function() { var e = this._beatsToUnits(1),
                    i = this.valueOf() / e; return Math.floor(i * t.Transport.PPQ) }, t.Frequency.prototype._frequencyToUnits = function(t) { return t }, t.Frequency.prototype._ticksToUnits = function(e) { return 1 / (60 * e / (t.Transport.bpm.value * t.Transport.PPQ)) }, t.Frequency.prototype._beatsToUnits = function(e) { return 1 / t.TimeBase.prototype._beatsToUnits.call(this, e) }, t.Frequency.prototype._secondsToUnits = function(t) { return 1 / t }, t.Frequency.prototype._defaultUnits = "hz", e = { cbb: -2, cb: -1, c: 0, "c#": 1, cx: 2, dbb: 0, db: 1, d: 2, "d#": 3, dx: 4, ebb: 2, eb: 3, e: 4, "e#": 5, ex: 6, fbb: 3, fb: 4, f: 5, "f#": 6, fx: 7, gbb: 5, gb: 6, g: 7, "g#": 8, gx: 9, abb: 7, ab: 8, a: 9, "a#": 10, ax: 11, bbb: 9, bb: 10, b: 11, "b#": 12, bx: 13 }, i = ["C", "C#", "D", "D#", "E", "F", "F#", "G", "G#", "A", "A#", "B"], t.Frequency.A4 = 440, t.Frequency.prototype.midiToFrequency = function(e) { return t.Frequency.A4 * Math.pow(2, (e - 69) / 12) }, t.Frequency.prototype.frequencyToMidi = function(e) { return 69 + Math.round(12 * Math.log(e / t.Frequency.A4) / Math.LN2) }, t.Frequency }), t(function(t) { return t.TransportTime = function(e, i) { if (!(this instanceof t.TransportTime)) return new t.TransportTime(e, i);
                t.Time.call(this, e, i) }, t.extend(t.TransportTime, t.Time), t.TransportTime.prototype._unaryExpressions = Object.create(t.Time.prototype._unaryExpressions), t.TransportTime.prototype._unaryExpressions.quantize = { regexp: /^@/, method: function(e) { var i = this._secondsToTicks(e()),
                        n = Math.ceil(t.Transport.ticks / i); return this._ticksToUnits(n * i) } }, t.TransportTime.prototype._secondsToTicks = function(e) { var i = this._beatsToUnits(1),
                    n = e / i; return Math.round(n * t.Transport.PPQ) }, t.TransportTime.prototype.valueOf = function() { return this._secondsToTicks(this._expr()) + (this._plusNow ? t.Transport.ticks : 0) }, t.TransportTime.prototype.toTicks = function() { return this.valueOf() }, t.TransportTime.prototype.toSeconds = function() { return this._expr() + (this._plusNow ? t.Transport.seconds : 0) }, t.TransportTime.prototype.toFrequency = function() { return 1 / this.toSeconds() }, t.TransportTime }), t(function(t) { return t.Type = { Default: "number", Time: "time", Frequency: "frequency", TransportTime: "transportTime", Ticks: "ticks", NormalRange: "normalRange", AudioRange: "audioRange", Decibels: "db", Interval: "interval", BPM: "bpm", Positive: "positive", Gain: "gain", Cents: "cents", Degrees: "degrees", MIDI: "midi", BarsBeatsSixteenths: "barsBeatsSixteenths", Samples: "samples", Hertz: "hertz", Note: "note", Milliseconds: "milliseconds", Seconds: "seconds", Notation: "notation" }, t.prototype.toSeconds = function(e) { return t.isNumber(e) ? e : t.isUndef(e) ? this.now() : t.isString(e) ? new t.Time(e).toSeconds() : e instanceof t.TimeBase ? e.toSeconds() : void 0 }, t.prototype.toFrequency = function(e) { return t.isNumber(e) ? e : t.isString(e) || t.isUndef(e) ? new t.Frequency(e).valueOf() : e instanceof t.TimeBase ? e.toFrequency() : void 0 }, t.prototype.toTicks = function(e) { return t.isNumber(e) || t.isString(e) ? new t.TransportTime(e).toTicks() : t.isUndef(e) ? t.Transport.ticks : e instanceof t.TimeBase ? e.toTicks() : void 0 }, t }), t(function(t) {
            function e(e) { e._events || (e._events = new t.Timeline(1e3)) }
            var i = function(t, e, i, n, s) { return i + (e - i) * Math.exp(-(s - t) / n) },
                n = function(t, e, i, n, s) { return e + (s - t) / (i - t) * (n - e) },
                s = function(t, e, i, n, s) { return e * Math.pow(n / e, (s - t) / (i - t)) },
                o = { Linear: "linearRampToValueAtTime", Exponential: "exponentialRampToValueAtTime", Target: "setTargetAtTime", SetValue: "setValueAtTime" };
            t.supported && (Object.defineProperty(AudioParam.prototype, "value", {
                get: function() {
                    var e = t.context.currentTime;
                    return this.getValueAtTime(e)
                },
                set: function(e) { this._initialValue = e; var i = t.context.currentTime;
                    this.setValueAtTime(e, i) }
            }), AudioParam.prototype.hasOwnProperty("defaultValue") || Object.defineProperty(AudioParam.prototype, "defaultValue", { get: function() { return 1 } }), AudioParam.prototype.hasOwnProperty("minValue") || Object.defineProperty(AudioParam.prototype, "minValue", { get: function() { return -3.4028235e38 } }), AudioParam.prototype.hasOwnProperty("maxValue") || Object.defineProperty(AudioParam.prototype, "maxValue", { get: function() { return 3.4028235e38 } }), ["setValueAtTime", "linearRampToValueAtTime", "exponentialRampToValueAtTime"].forEach(function(t) { var i = "_native_" + t;
                AudioParam.prototype[i] || (AudioParam.prototype[i] = AudioParam.prototype[t], AudioParam.prototype[t] = function(n, s) { if (e(this), t === o.Exponential) { var r = this._events.get(s); if (r && this.getValueAtTime(r.time) <= 0) throw new Error("exponentialRampToValueAtTime must ramp from a value > 0") } return this._events.add({ type: t, time: s, value: n }), AudioParam.prototype[i].call(this, n, s) }) }), AudioParam.prototype._native_setTargetAtTime || (AudioParam.prototype._native_setTargetAtTime = AudioParam.prototype.setTargetAtTime, AudioParam.prototype.setTargetAtTime = function(t, i, n) { return e(this), this._events.add({ type: o.Target, value: t, time: i, constant: n }), this._native_setTargetAtTime(t, i, n) }), AudioParam.prototype._native_setValueCurveAtTime || (AudioParam.prototype._native_setValueCurveAtTime = AudioParam.prototype.setValueCurveAtTime, AudioParam.prototype.setValueCurveAtTime = function(t, i, n) { var s, r; for (e(this), this._events.add({ type: o.SetValue, value: t[0], time: i }), s = n / (t.length - 1), r = 1; r < t.length; r++) this._events.add({ type: o.Linear, value: t[r], time: i + r * s }); return this._native_setValueCurveAtTime(t, i, n) }), AudioParam.prototype._native_cancelScheduledValues || (AudioParam.prototype._native_cancelScheduledValues = AudioParam.prototype.cancelScheduledValues, AudioParam.prototype.cancelScheduledValues = function(t) { return e(this), this._events.cancel(t), this._native_cancelScheduledValues(t) }), AudioParam.prototype._native_cancelAndHoldAtTime || (AudioParam.prototype._native_cancelAndHoldAtTime = AudioParam.prototype.cancelAndHoldAtTime, AudioParam.prototype.cancelAndHoldAtTime = function(t) { var i, n, s; return e(this), i = this.getValueAtTime(t), n = this._events.get(t), s = this._events.getAfter(t), n && n.time === t ? s ? this._events.cancel(s.time) : this._events.cancel(t + 1e-6) : s && (this._events.cancel(s.time), this._native_cancelAndHoldAtTime || this._native_cancelScheduledValues(t), s.type === o.Linear ? this._native_cancelAndHoldAtTime ? this._events.add({ type: o.Linear, value: i, time: t }) : this.linearRampToValueAtTime(i, t) : s.type === o.Exponential && (this._native_cancelAndHoldAtTime ? this._events.add({ type: o.Exponential, value: i, time: t }) : this.exponentialRampToValueAtTime(i, t))), this._events.add({ type: o.SetValue, value: i, time: t }), this._native_cancelAndHoldAtTime ? this._native_cancelAndHoldAtTime(t) : this._native_setValueAtTime(i, t) }), AudioParam.prototype.getValueAtTime = function(r) { var a, l, h, u, p; return e(this), a = this._events.getAfter(r), l = this._events.get(r), h = t.defaultArg(this._initialValue, this.defaultValue), null === l ? h : l.type === o.Target ? (u = this._events.getBefore(l.time), p = null === u ? h : u.value, i(l.time, p, l.value, l.constant, r)) : null === a ? l.value : a.type === o.Linear ? n(l.time, l.value, a.time, a.value, r) : a.type === o.Exponential ? s(l.time, l.value, a.time, a.value, r) : l.value })
        }), t(function(t) { return t.Param = function() { var e = t.defaults(arguments, ["param", "units", "convert"], t.Param);
                t.AudioNode.call(this), this._param = this.input = e.param, this.units = e.units, this.convert = e.convert, this.overridden = !1, t.isUndef(e.value) || (this.value = e.value) }, t.extend(t.Param, t.AudioNode), t.Param.defaults = { units: t.Type.Default, convert: !0, param: void 0 }, Object.defineProperty(t.Param.prototype, "value", { get: function() { return this._toUnits(this._param.value) }, set: function(t) { var e = this._fromUnits(t);
                    this._param.cancelScheduledValues(0), this._param.value = e } }), t.Param.prototype._fromUnits = function(e) { if (!this.convert && !t.isUndef(this.convert)) return e; switch (this.units) {
                    case t.Type.Time:
                        return this.toSeconds(e);
                    case t.Type.Frequency:
                        return this.toFrequency(e);
                    case t.Type.Decibels:
                        return t.dbToGain(e);
                    case t.Type.NormalRange:
                        return Math.min(Math.max(e, 0), 1);
                    case t.Type.AudioRange:
                        return Math.min(Math.max(e, -1), 1);
                    case t.Type.Positive:
                        return Math.max(e, 0);
                    default:
                        return e } }, t.Param.prototype._toUnits = function(e) { if (!this.convert && !t.isUndef(this.convert)) return e; switch (this.units) {
                    case t.Type.Decibels:
                        return t.gainToDb(e);
                    default:
                        return e } }, t.Param.prototype._minOutput = 1e-5, t.Param.prototype.setValueAtTime = function(e, i) { return i = this.toSeconds(i), t.isPast(i), this._param.setValueAtTime(this._fromUnits(e), i), this }, t.Param.prototype.getValueAtTime = function(t) { return t = this.toSeconds(t), this._fromUnits(this._param.getValueAtTime(t)) }, t.Param.prototype.setRampPoint = function(t) { t = this.toSeconds(t); var e = this.getValueAtTime(t); return this.cancelAndHoldAtTime(t), 0 === e && (e = this._minOutput), this._param.setValueAtTime(e, t), this }, t.Param.prototype.linearRampToValueAtTime = function(e, i) { return e = this._fromUnits(e), i = this.toSeconds(i), t.isPast(i), this._param.linearRampToValueAtTime(e, i), this }, t.Param.prototype.exponentialRampToValueAtTime = function(e, i) { return e = this._fromUnits(e), e = Math.max(this._minOutput, e), i = this.toSeconds(i), t.isPast(i), this._param.exponentialRampToValueAtTime(e, i), this }, t.Param.prototype.exponentialRampTo = function(t, e, i) { return i = this.toSeconds(i), this.setRampPoint(i), this.exponentialRampToValueAtTime(t, i + this.toSeconds(e)), this }, t.Param.prototype.linearRampTo = function(t, e, i) { return i = this.toSeconds(i), this.setRampPoint(i), this.linearRampToValueAtTime(t, i + this.toSeconds(e)), this }, t.Param.prototype.targetRampTo = function(t, e, i) { return i = this.toSeconds(i), this.setRampPoint(i), this.exponentialAppraochValueAtTime(t, i, e), this }, t.Param.prototype.exponentialAppraochValueAtTime = function(e, i, n) { var s = Math.log(this.toSeconds(n) + 1) / Math.log(200); return i = this.toSeconds(i), t.isPast(i), this.setTargetAtTime(e, i, s) }, t.Param.prototype.setTargetAtTime = function(t, e, i) { if (t = this._fromUnits(t), i <= 0) throw new Error("timeConstant must be greater than 0"); return this._param.setTargetAtTime(t, this.toSeconds(e), i), this }, t.Param.prototype.setValueCurveAtTime = function(e, i, n, s) { var o, r; for (s = t.defaultArg(s, 1), n = this.toSeconds(n), i = this.toSeconds(i), this.setValueAtTime(e[0] * s, i), o = n / (e.length - 1), r = 1; r < e.length; r++) this._param.linearRampToValueAtTime(this._fromUnits(e[r] * s), i + r * o); return this }, t.Param.prototype.cancelScheduledValues = function(t) { return this._param.cancelScheduledValues(this.toSeconds(t)), this }, t.Param.prototype.cancelAndHoldAtTime = function(t) { return this._param.cancelAndHoldAtTime(this.toSeconds(t)), this }, t.Param.prototype.rampTo = function(e, i, n) { return i = t.defaultArg(i, .1), this.units === t.Type.Frequency || this.units === t.Type.BPM || this.units === t.Type.Decibels ? this.exponentialRampTo(e, i, n) : this.linearRampTo(e, i, n), this }, t.Param.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._param = null, this }, t.Param }), t(function(t) { return t.Gain = function() { var e = t.defaults(arguments, ["gain", "units"], t.Gain);
                t.AudioNode.call(this), this.input = this.output = this._gainNode = this.context.createGain(), this.gain = new t.Param({ param: this._gainNode.gain, units: e.units, value: e.gain, convert: e.convert }), this._readOnly("gain") }, t.extend(t.Gain, t.AudioNode), t.Gain.defaults = { gain: 1, convert: !0 }, t.Gain.prototype.dispose = function() { t.AudioNode.prototype.dispose.call(this), this._gainNode.disconnect(), this._gainNode = null, this._writable("gain"), this.gain.dispose(), this.gain = null }, t.Gain }), t(function(t) { if (t.supported && !window.ConstantSourceNode) { var e = function(t) { var e, i, n, s; for (this.context = t, e = t.createBuffer(1, 128, t.sampleRate), i = e.getChannelData(0), n = 0; n < i.length; n++) i[n] = 1;
                    this._bufferSource = t.createBufferSource(), this._bufferSource.channelCount = 1, this._bufferSource.channelCountMode = "explicit", this._bufferSource.buffer = e, this._bufferSource.loop = !0, s = this._output = t.createGain(), this.offset = s.gain, this._bufferSource.connect(s) };
                e.prototype.start = function(t) { return this._bufferSource.start(t), this }, e.prototype.stop = function(t) { return this._bufferSource.stop(t), this }, e.prototype.connect = function() { return this._output.connect.apply(this._output, arguments), this }, e.prototype.disconnect = function() { return this._output.disconnect.apply(this._output, arguments), this }, AudioContext.prototype.createConstantSource = function() { return new e(this) }, t.Context.prototype.createConstantSource = function() { return new e(this) } } }), t(function(t) { return t.Signal = function() { var e = t.defaults(arguments, ["value", "units"], t.Signal),
                    i = t.context.createConstantSource();
                i.start(0), e.param = i.offset, t.Param.call(this, e), this.output = i, this.input = this._param = this.output.offset }, t.extend(t.Signal, t.Param), t.Signal.defaults = { value: 0, units: t.Type.Default, convert: !0 }, t.Signal.prototype.connect = t.SignalBase.prototype.connect, t.Signal.prototype.dispose = function() { return t.Param.prototype.dispose.call(this), this }, t.Signal }), t(function(t) { return t.TimelineSignal = function() { var e = t.defaults(arguments, ["value", "units"], t.Signal);
                t.Signal.call(this, e), this._events = new t.Timeline(100), this._initial = this._fromUnits(this._param.value), this.value = e.value, delete this.input }, t.extend(t.TimelineSignal, t.Signal), t.TimelineSignal.Type = { Linear: "linear", Exponential: "exponential", Target: "target", Set: "set" }, Object.defineProperty(t.TimelineSignal.prototype, "value", { get: function() { var t = this.now(),
                        e = this.getValueAtTime(t); return this._toUnits(e) }, set: function(t) { if (this._events) { var e = this._fromUnits(t);
                        this._initial = e, this.cancelScheduledValues(), this._param.value = e } } }), t.TimelineSignal.prototype.setValueAtTime = function(e, i) { return e = this._fromUnits(e), i = this.toSeconds(i), this._events.add({ type: t.TimelineSignal.Type.Set, value: e, time: i }), this._param.setValueAtTime(e, i), this }, t.TimelineSignal.prototype.linearRampToValueAtTime = function(e, i) { return e = this._fromUnits(e), i = this.toSeconds(i), this._events.add({ type: t.TimelineSignal.Type.Linear, value: e, time: i }), this._param.linearRampToValueAtTime(e, i), this }, t.TimelineSignal.prototype.exponentialRampToValueAtTime = function(e, i) { var n, s; return i = this.toSeconds(i), n = this._searchBefore(i), n && 0 === n.value && this.setValueAtTime(this._minOutput, n.time), e = this._fromUnits(e), s = Math.max(e, this._minOutput), this._events.add({ type: t.TimelineSignal.Type.Exponential, value: s, time: i }), e < this._minOutput ? (this._param.exponentialRampToValueAtTime(this._minOutput, i - this.sampleTime), this.setValueAtTime(0, i)) : this._param.exponentialRampToValueAtTime(e, i), this }, t.TimelineSignal.prototype.setTargetAtTime = function(e, i, n) { return e = this._fromUnits(e), e = Math.max(this._minOutput, e), n = Math.max(this._minOutput, n), i = this.toSeconds(i), this._events.add({ type: t.TimelineSignal.Type.Target, value: e, time: i, constant: n }), this._param.setTargetAtTime(e, i, n), this }, t.TimelineSignal.prototype.setValueCurveAtTime = function(e, i, n, s) { var o, r; for (s = t.defaultArg(s, 1), n = this.toSeconds(n), i = this.toSeconds(i), o = n / (e.length - 1), this.setValueAtTime(e[0] * s, i), r = 1; r < e.length; r++) this.linearRampToValueAtTime(e[r] * s, i + r * o); return this }, t.TimelineSignal.prototype.cancelScheduledValues = function(t) { return t = this.toSeconds(t), this._events.cancel(t), this._param.cancelScheduledValues(t), this }, t.TimelineSignal.prototype.cancelAndHoldAtTime = function(t) { return this.setRampPoint(this.toSeconds(t)), this }, t.TimelineSignal.prototype.setRampPoint = function(e) { var i, n, s; return e = this.toSeconds(e), i = this._toUnits(this.getValueAtTime(e)), n = this._searchBefore(e), n && n.time === e ? this.cancelScheduledValues(e + this.sampleTime) : (s = this._searchAfter(e)) && (this.cancelScheduledValues(e), s.type === t.TimelineSignal.Type.Linear ? this.linearRampToValueAtTime(i, e) : s.type === t.TimelineSignal.Type.Exponential && this.exponentialRampToValueAtTime(i, e)), this.setValueAtTime(i, e), this }, t.TimelineSignal.prototype.linearRampToValueBetween = function(t, e, i) { return this.setRampPoint(e), this.linearRampToValueAtTime(t, i), this }, t.TimelineSignal.prototype.exponentialRampToValueBetween = function(t, e, i) { return this.setRampPoint(e), this.exponentialRampToValueAtTime(t, i), this }, t.TimelineSignal.prototype._searchBefore = function(t) { return this._events.get(t) }, t.TimelineSignal.prototype._searchAfter = function(t) { return this._events.getAfter(t) }, t.TimelineSignal.prototype.getValueAtTime = function(e) { var i, n, s, o, r; return e = this.toSeconds(e), i = this._searchAfter(e), n = this._searchBefore(e), s = this._initial, null === n ? s = this._initial : n.type === t.TimelineSignal.Type.Target ? (o = this._events.getBefore(n.time), r = null === o ? this._initial : o.value, s = this._exponentialApproach(n.time, r, n.value, n.constant, e)) : s = null === i ? n.value : i.type === t.TimelineSignal.Type.Linear ? this._linearInterpolate(n.time, n.value, i.time, i.value, e) : i.type === t.TimelineSignal.Type.Exponential ? this._exponentialInterpolate(n.time, n.value, i.time, i.value, e) : n.value, s }, t.TimelineSignal.prototype.connect = t.SignalBase.prototype.connect, t.TimelineSignal.prototype._exponentialApproach = function(t, e, i, n, s) { return i + (e - i) * Math.exp(-(s - t) / n) }, t.TimelineSignal.prototype._linearInterpolate = function(t, e, i, n, s) { return e + (s - t) / (i - t) * (n - e) }, t.TimelineSignal.prototype._exponentialInterpolate = function(t, e, i, n, s) { return (e = Math.max(this._minOutput, e)) * Math.pow(n / e, (s - t) / (i - t)) }, t.TimelineSignal.prototype.dispose = function() { t.Signal.prototype.dispose.call(this), this._events.dispose(), this._events = null }, t.TimelineSignal }), t(function(t) { return t.Pow = function(e) { t.SignalBase.call(this), this._exp = t.defaultArg(e, 1), this._expScaler = this.input = this.output = new t.WaveShaper(this._expFunc(this._exp), 8192) }, t.extend(t.Pow, t.SignalBase), Object.defineProperty(t.Pow.prototype, "value", { get: function() { return this._exp }, set: function(t) { this._exp = t, this._expScaler.setMap(this._expFunc(this._exp)) } }), t.Pow.prototype._expFunc = function(t) { return function(e) { return Math.pow(Math.abs(e), t) } }, t.Pow.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._expScaler.dispose(), this._expScaler = null, this }, t.Pow }), t(function(t) { return t.Envelope = function() { var e = t.defaults(arguments, ["attack", "decay", "sustain", "release"], t.Envelope);
                    t.AudioNode.call(this), this.attack = e.attack, this.decay = e.decay, this.sustain = e.sustain, this.release = e.release, this._attackCurve = "linear", this._releaseCurve = "exponential", this._sig = this.output = new t.Signal(0), this.attackCurve = e.attackCurve, this.releaseCurve = e.releaseCurve }, t.extend(t.Envelope, t.AudioNode), t.Envelope.defaults = { attack: .01, decay: .1, sustain: .5, release: 1, attackCurve: "linear", releaseCurve: "exponential" }, Object.defineProperty(t.Envelope.prototype, "value", { get: function() { return this.getValueAtTime(this.now()) } }), Object.defineProperty(t.Envelope.prototype, "attackCurve", { get: function() { if (t.isString(this._attackCurve)) return this._attackCurve; if (t.isArray(this._attackCurve)) { for (var e in t.Envelope.Type)
                                if (t.Envelope.Type[e].In === this._attackCurve) return e; return this._attackCurve } }, set: function(e) { if (t.Envelope.Type.hasOwnProperty(e)) { var i = t.Envelope.Type[e];
                            t.isObject(i) ? this._attackCurve = i.In : this._attackCurve = i } else { if (!t.isArray(e)) throw new Error("Tone.Envelope: invalid curve: " + e);
                            this._attackCurve = e } } }), Object.defineProperty(t.Envelope.prototype, "releaseCurve", { get: function() { if (t.isString(this._releaseCurve)) return this._releaseCurve; if (t.isArray(this._releaseCurve)) { for (var e in t.Envelope.Type)
                                if (t.Envelope.Type[e].Out === this._releaseCurve) return e; return this._releaseCurve } }, set: function(e) { if (t.Envelope.Type.hasOwnProperty(e)) { var i = t.Envelope.Type[e];
                            t.isObject(i) ? this._releaseCurve = i.Out : this._releaseCurve = i } else { if (!t.isArray(e)) throw new Error("Tone.Envelope: invalid curve: " + e);
                            this._releaseCurve = e } } }), t.Envelope.prototype.triggerAttack = function(e, i) { var n, s, o, r, a, l, h, u, p; return e = this.toSeconds(e), n = this.toSeconds(this.attack), s = n, o = this.toSeconds(this.decay), i = t.defaultArg(i, 1), r = this.getValueAtTime(e), r > 0 && (a = 1 / s, l = 1 - r, s = l / a), "linear" === this._attackCurve ? this._sig.linearRampTo(i, s, e) : "exponential" === this._attackCurve ? this._sig.targetRampTo(i, s, e) : s > 0 && (this._sig.cancelAndHoldAtTime(e), h = this._attackCurve, s < n && (u = 1 - s / n, p = Math.floor(u * this._attackCurve.length), h = this._attackCurve.slice(p), h[0] = r), this._sig.setValueCurveAtTime(h, e, s, i)), o && this._sig.targetRampTo(i * this.sustain, o, s + e), this }, t.Envelope.prototype.triggerRelease = function(e) { var i, n, s; return e = this.toSeconds(e), i = this.getValueAtTime(e), i > 0 && (n = this.toSeconds(this.release), "linear" === this._releaseCurve ? this._sig.linearRampTo(0, n, e) : "exponential" === this._releaseCurve ? this._sig.targetRampTo(0, n, e) : (s = this._releaseCurve, t.isArray(s) && (this._sig.cancelAndHoldAtTime(e), this._sig.setValueCurveAtTime(s, e, n, i)))), this }, t.Envelope.prototype.getValueAtTime = function(t) { return this._sig.getValueAtTime(t) }, t.Envelope.prototype.triggerAttackRelease = function(t, e, i) { return e = this.toSeconds(e), this.triggerAttack(e, i), this.triggerRelease(e + this.toSeconds(t)), this }, t.Envelope.prototype.cancel = function(t) { return this._sig.cancelScheduledValues(t), this }, t.Envelope.prototype.connect = t.Signal.prototype.connect,
                function() {
                    function e(t) { var e, i = new Array(t.length); for (e = 0; e < t.length; e++) i[e] = 1 - t[e]; return i } var i, n, s, o, r, a, l, h, u, p, c, d = 128,
                        f = []; for (i = 0; i < d; i++) f[i] = Math.sin(i / (d - 1) * (Math.PI / 2)); for (s = [], o = 6.4, i = 0; i < d - 1; i++) n = i / (d - 1), r = Math.sin(n * (2 * Math.PI) * o - Math.PI / 2) + 1, s[i] = r / 10 + .83 * n; for (s[d - 1] = 1, a = [], l = 5, i = 0; i < d; i++) a[i] = Math.ceil(i / (d - 1) * l) / l; for (h = [], i = 0; i < d; i++) n = i / (d - 1), h[i] = .5 * (1 - Math.cos(Math.PI * n)); for (u = [], i = 0; i < d; i++) n = i / (d - 1), p = 4 * Math.pow(n, 3) + .2, c = Math.cos(p * Math.PI * 2 * n), u[i] = Math.abs(c * (1 - n));
                    t.Envelope.Type = { linear: "linear", exponential: "exponential", bounce: { In: e(u), Out: u }, cosine: { In: f, Out: function(t) { return t.slice(0).reverse() }(f) }, step: { In: a, Out: e(a) }, ripple: { In: s, Out: e(s) }, sine: { In: h, Out: e(h) } } }(), t.Envelope.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._sig.dispose(), this._sig = null, this._attackCurve = null, this._releaseCurve = null, this }, t.Envelope }), t(function(t) { return t.AmplitudeEnvelope = function() { t.Envelope.apply(this, arguments), this.input = this.output = new t.Gain, this._sig.connect(this.output.gain) }, t.extend(t.AmplitudeEnvelope, t.Envelope), t.AmplitudeEnvelope.prototype.dispose = function() { return t.Envelope.prototype.dispose.call(this), this }, t.AmplitudeEnvelope }), t(function(t) { t.supported && (AnalyserNode.prototype.getFloatTimeDomainData || (AnalyserNode.prototype.getFloatTimeDomainData = function(t) { var e, i = new Uint8Array(t.length); for (this.getByteTimeDomainData(i), e = 0; e < i.length; e++) t[e] = (i[e] - 128) / 128 })) }), t(function(t) { return t.Analyser = function() { var e = t.defaults(arguments, ["type", "size"], t.Analyser);
                t.AudioNode.call(this), this._analyser = this.input = this.output = this.context.createAnalyser(), this._type = e.type, this._buffer = null, this.size = e.size, this.type = e.type }, t.extend(t.Analyser, t.AudioNode), t.Analyser.defaults = { size: 1024, type: "fft", smoothing: .8 }, t.Analyser.Type = { Waveform: "waveform", FFT: "fft" }, t.Analyser.prototype.getValue = function() { return this._type === t.Analyser.Type.FFT ? this._analyser.getFloatFrequencyData(this._buffer) : this._type === t.Analyser.Type.Waveform && this._analyser.getFloatTimeDomainData(this._buffer), this._buffer }, Object.defineProperty(t.Analyser.prototype, "size", { get: function() { return this._analyser.frequencyBinCount }, set: function(t) { this._analyser.fftSize = 2 * t, this._buffer = new Float32Array(t) } }), Object.defineProperty(t.Analyser.prototype, "type", { get: function() { return this._type }, set: function(e) { if (e !== t.Analyser.Type.Waveform && e !== t.Analyser.Type.FFT) throw new TypeError("Tone.Analyser: invalid type: " + e);
                    this._type = e } }), Object.defineProperty(t.Analyser.prototype, "smoothing", { get: function() { return this._analyser.smoothingTimeConstant }, set: function(t) { this._analyser.smoothingTimeConstant = t } }), t.Analyser.prototype.dispose = function() { t.AudioNode.prototype.dispose.call(this), this._analyser.disconnect(), this._analyser = null, this._buffer = null }, t.Analyser }), t(function(t) { return t.Compressor = function() { var e = t.defaults(arguments, ["threshold", "ratio"], t.Compressor);
                t.AudioNode.call(this), this._compressor = this.input = this.output = this.context.createDynamicsCompressor(), this.threshold = new t.Param({ param: this._compressor.threshold, units: t.Type.Decibels, convert: !1 }), this.attack = new t.Param(this._compressor.attack, t.Type.Time), this.release = new t.Param(this._compressor.release, t.Type.Time), this.knee = new t.Param({ param: this._compressor.knee, units: t.Type.Decibels, convert: !1 }), this.ratio = new t.Param({ param: this._compressor.ratio, convert: !1 }), this._readOnly(["knee", "release", "attack", "ratio", "threshold"]), this.set(e) }, t.extend(t.Compressor, t.AudioNode), t.Compressor.defaults = { ratio: 12, threshold: -24, release: .25, attack: .003, knee: 30 }, t.Compressor.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._writable(["knee", "release", "attack", "ratio", "threshold"]), this._compressor.disconnect(), this._compressor = null, this.attack.dispose(), this.attack = null, this.release.dispose(), this.release = null, this.threshold.dispose(), this.threshold = null, this.ratio.dispose(), this.ratio = null, this.knee.dispose(), this.knee = null, this }, t.Compressor }), t(function(t) { return t.Add = function(e) { t.Signal.call(this), this.createInsOuts(2, 0), this._sum = this.input[0] = this.input[1] = this.output = new t.Gain, this._param = this.input[1] = new t.Signal(e), this._param.connect(this._sum) }, t.extend(t.Add, t.Signal), t.Add.prototype.dispose = function() { return t.Signal.prototype.dispose.call(this), this._sum.dispose(), this._sum = null, this }, t.Add }), t(function(t) { return t.Multiply = function(e) { t.Signal.call(this), this.createInsOuts(2, 0), this._mult = this.input[0] = this.output = new t.Gain, this._param = this.input[1] = this.output.gain, this._param.value = t.defaultArg(e, 0) }, t.extend(t.Multiply, t.Signal), t.Multiply.prototype.dispose = function() { return t.Signal.prototype.dispose.call(this), this._mult.dispose(), this._mult = null, this._param = null, this }, t.Multiply }), t(function(t) { return t.Negate = function() { t.SignalBase.call(this), this._multiply = this.input = this.output = new t.Multiply(-1) }, t.extend(t.Negate, t.SignalBase), t.Negate.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._multiply.dispose(), this._multiply = null, this }, t.Negate }), t(function(t) { return t.Subtract = function(e) { t.Signal.call(this), this.createInsOuts(2, 0), this._sum = this.input[0] = this.output = new t.Gain, this._neg = new t.Negate, this._param = this.input[1] = new t.Signal(e), this._param.chain(this._neg, this._sum) }, t.extend(t.Subtract, t.Signal), t.Subtract.prototype.dispose = function() { return t.Signal.prototype.dispose.call(this), this._neg.dispose(), this._neg = null, this._sum.disconnect(), this._sum = null, this }, t.Subtract }), t(function(t) { return t.EqualPowerGain = function() { t.SignalBase.call(this), this._eqPower = this.input = this.output = new t.WaveShaper(function(e) { return Math.abs(e) < .001 ? 0 : t.equalPowerScale(e) }.bind(this), 4096) }, t.extend(t.EqualPowerGain, t.SignalBase), t.EqualPowerGain.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._eqPower.dispose(), this._eqPower = null, this }, t.EqualPowerGain }), t(function(t) { return t.CrossFade = function(e) { t.AudioNode.call(this), this.createInsOuts(2, 1), this.a = this.input[0] = new t.Gain, this.b = this.input[1] = new t.Gain, this.fade = new t.Signal(t.defaultArg(e, .5), t.Type.NormalRange), this._equalPowerA = new t.EqualPowerGain, this._equalPowerB = new t.EqualPowerGain, this._one = this.context.getConstant(1), this._invert = new t.Subtract, this.a.connect(this.output), this.b.connect(this.output), this.fade.chain(this._equalPowerB, this.b.gain), this._one.connect(this._invert, 0, 0), this.fade.connect(this._invert, 0, 1), this._invert.chain(this._equalPowerA, this.a.gain), this._readOnly("fade") }, t.extend(t.CrossFade, t.AudioNode), t.CrossFade.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._writable("fade"), this._equalPowerA.dispose(), this._equalPowerA = null, this._equalPowerB.dispose(), this._equalPowerB = null, this.fade.dispose(), this.fade = null, this._invert.dispose(), this._invert = null, this._one = null, this.a.dispose(), this.a = null, this.b.dispose(), this.b = null, this }, t.CrossFade }), t(function(t) { return t.Filter = function() { var e = t.defaults(arguments, ["frequency", "type", "rolloff"], t.Filter);
                t.AudioNode.call(this), this.createInsOuts(1, 1), this._filters = [], this.frequency = new t.Signal(e.frequency, t.Type.Frequency), this.detune = new t.Signal(0, t.Type.Cents), this.gain = new t.Signal({ value: e.gain, convert: !1 }), this.Q = new t.Signal(e.Q), this._type = e.type, this._rolloff = e.rolloff, this.rolloff = e.rolloff, this._readOnly(["detune", "frequency", "gain", "Q"]) }, t.extend(t.Filter, t.AudioNode), t.Filter.defaults = { type: "lowpass", frequency: 350, rolloff: -12, Q: 1, gain: 0 }, Object.defineProperty(t.Filter.prototype, "type", { get: function() { return this._type }, set: function(t) { var e; if (-1 === ["lowpass", "highpass", "bandpass", "lowshelf", "highshelf", "notch", "allpass", "peaking"].indexOf(t)) throw new TypeError("Tone.Filter: invalid type " + t); for (this._type = t, e = 0; e < this._filters.length; e++) this._filters[e].type = t } }), Object.defineProperty(t.Filter.prototype, "rolloff", { get: function() { return this._rolloff }, set: function(e) { var i, n, s, o, r, a; if (e = parseInt(e, 10), i = [-12, -24, -48, -96], -1 === (n = i.indexOf(e))) throw new RangeError("Tone.Filter: rolloff can only be -12, -24, -48 or -96"); for (n += 1, this._rolloff = e, this.input.disconnect(), s = 0; s < this._filters.length; s++) this._filters[s].disconnect(), this._filters[s] = null; for (this._filters = new Array(n), o = 0; o < n; o++) r = this.context.createBiquadFilter(), r.type = this._type, this.frequency.connect(r.frequency), this.detune.connect(r.detune), this.Q.connect(r.Q), this.gain.connect(r.gain), this._filters[o] = r;
                    a = [this.input].concat(this._filters).concat([this.output]), t.connectSeries.apply(t, a) } }), t.Filter.prototype.dispose = function() { t.AudioNode.prototype.dispose.call(this); for (var e = 0; e < this._filters.length; e++) this._filters[e].disconnect(), this._filters[e] = null; return this._filters = null, this._writable(["detune", "frequency", "gain", "Q"]), this.frequency.dispose(), this.Q.dispose(), this.frequency = null, this.Q = null, this.detune.dispose(), this.detune = null, this.gain.dispose(), this.gain = null, this }, t.Filter }), t(function(t) { return t.MultibandSplit = function() { var e = t.defaults(arguments, ["lowFrequency", "highFrequency"], t.MultibandSplit);
                t.AudioNode.call(this), this.input = new t.Gain, this.output = new Array(3), this.low = this.output[0] = new t.Filter(0, "lowpass"), this._lowMidFilter = new t.Filter(0, "highpass"), this.mid = this.output[1] = new t.Filter(0, "lowpass"), this.high = this.output[2] = new t.Filter(0, "highpass"), this.lowFrequency = new t.Signal(e.lowFrequency, t.Type.Frequency), this.highFrequency = new t.Signal(e.highFrequency, t.Type.Frequency), this.Q = new t.Signal(e.Q), this.input.fan(this.low, this.high), this.input.chain(this._lowMidFilter, this.mid), this.lowFrequency.connect(this.low.frequency), this.lowFrequency.connect(this._lowMidFilter.frequency), this.highFrequency.connect(this.mid.frequency), this.highFrequency.connect(this.high.frequency), this.Q.connect(this.low.Q), this.Q.connect(this._lowMidFilter.Q), this.Q.connect(this.mid.Q), this.Q.connect(this.high.Q), this._readOnly(["high", "mid", "low", "highFrequency", "lowFrequency"]) }, t.extend(t.MultibandSplit, t.AudioNode), t.MultibandSplit.defaults = { lowFrequency: 400, highFrequency: 2500, Q: 1 }, t.MultibandSplit.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._writable(["high", "mid", "low", "highFrequency", "lowFrequency"]), this.low.dispose(), this.low = null, this._lowMidFilter.dispose(), this._lowMidFilter = null, this.mid.dispose(), this.mid = null, this.high.dispose(), this.high = null, this.lowFrequency.dispose(), this.lowFrequency = null, this.highFrequency.dispose(), this.highFrequency = null, this.Q.dispose(), this.Q = null, this }, t.MultibandSplit }), t(function(t) { return t.EQ3 = function() { var e = t.defaults(arguments, ["low", "mid", "high"], t.EQ3);
                t.AudioNode.call(this), this.output = new t.Gain, this._multibandSplit = this.input = new t.MultibandSplit({ lowFrequency: e.lowFrequency, highFrequency: e.highFrequency }), this._lowGain = new t.Gain(e.low, t.Type.Decibels), this._midGain = new t.Gain(e.mid, t.Type.Decibels), this._highGain = new t.Gain(e.high, t.Type.Decibels), this.low = this._lowGain.gain, this.mid = this._midGain.gain, this.high = this._highGain.gain, this.Q = this._multibandSplit.Q, this.lowFrequency = this._multibandSplit.lowFrequency, this.highFrequency = this._multibandSplit.highFrequency, this._multibandSplit.low.chain(this._lowGain, this.output), this._multibandSplit.mid.chain(this._midGain, this.output), this._multibandSplit.high.chain(this._highGain, this.output), this._readOnly(["low", "mid", "high", "lowFrequency", "highFrequency"]) }, t.extend(t.EQ3, t.AudioNode), t.EQ3.defaults = { low: 0, mid: 0, high: 0, lowFrequency: 400, highFrequency: 2500 }, t.EQ3.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._writable(["low", "mid", "high", "lowFrequency", "highFrequency"]), this._multibandSplit.dispose(), this._multibandSplit = null, this.lowFrequency = null, this.highFrequency = null, this._lowGain.dispose(), this._lowGain = null, this._midGain.dispose(), this._midGain = null, this._highGain.dispose(), this._highGain = null, this.low = null, this.mid = null, this.high = null, this.Q = null, this }, t.EQ3 }), t(function(t) { return t.Scale = function(e, i) { t.SignalBase.call(this), this._outputMin = t.defaultArg(e, 0), this._outputMax = t.defaultArg(i, 1), this._scale = this.input = new t.Multiply(1), this._add = this.output = new t.Add(0), this._scale.connect(this._add), this._setRange() }, t.extend(t.Scale, t.SignalBase), Object.defineProperty(t.Scale.prototype, "min", { get: function() { return this._outputMin }, set: function(t) { this._outputMin = t, this._setRange() } }), Object.defineProperty(t.Scale.prototype, "max", { get: function() { return this._outputMax }, set: function(t) { this._outputMax = t, this._setRange() } }), t.Scale.prototype._setRange = function() { this._add.value = this._outputMin, this._scale.value = this._outputMax - this._outputMin }, t.Scale.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._add.dispose(), this._add = null, this._scale.dispose(), this._scale = null, this }, t.Scale }), t(function(t) { return t.ScaleExp = function(e, i, n) { t.SignalBase.call(this), this._scale = this.output = new t.Scale(e, i), this._exp = this.input = new t.Pow(t.defaultArg(n, 2)), this._exp.connect(this._scale) }, t.extend(t.ScaleExp, t.SignalBase), Object.defineProperty(t.ScaleExp.prototype, "exponent", { get: function() { return this._exp.value }, set: function(t) { this._exp.value = t } }), Object.defineProperty(t.ScaleExp.prototype, "min", { get: function() { return this._scale.min }, set: function(t) { this._scale.min = t } }), Object.defineProperty(t.ScaleExp.prototype, "max", { get: function() { return this._scale.max }, set: function(t) { this._scale.max = t } }), t.ScaleExp.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._scale.dispose(), this._scale = null, this._exp.dispose(), this._exp = null, this }, t.ScaleExp }), t(function(t) { return t.Delay = function() { var e = t.defaults(arguments, ["delayTime", "maxDelay"], t.Delay);
                t.AudioNode.call(this), this._delayNode = this.input = this.output = this.context.createDelay(this.toSeconds(e.maxDelay)), this.delayTime = new t.Param({ param: this._delayNode.delayTime, units: t.Type.Time, value: e.delayTime }), this._readOnly("delayTime") }, t.extend(t.Delay, t.AudioNode), t.Delay.defaults = { maxDelay: 1, delayTime: 0 }, t.Delay.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._delayNode.disconnect(), this._delayNode = null, this._writable("delayTime"), this.delayTime = null, this }, t.Delay }), t(function(t) {
            return t.FeedbackCombFilter = function() { var e = t.defaults(arguments, ["delayTime", "resonance"], t.FeedbackCombFilter);
                t.AudioNode.call(this), this._delay = this.input = this.output = new t.Delay(e.delayTime), this.delayTime = this._delay.delayTime, this._feedback = new t.Gain(e.resonance, t.Type.NormalRange), this.resonance = this._feedback.gain, this._delay.chain(this._feedback, this._delay), this._readOnly(["resonance", "delayTime"]) }, t.extend(t.FeedbackCombFilter, t.AudioNode), t.FeedbackCombFilter.defaults = { delayTime: .1, resonance: .5 }, t.FeedbackCombFilter.prototype.dispose = function() {
                return t.AudioNode.prototype.dispose.call(this), this._writable(["resonance", "delayTime"]), this._delay.dispose(), this._delay = null, this.delayTime = null, this._feedback.dispose(), this._feedback = null, this.resonance = null, this
            }, t.FeedbackCombFilter
        }), t(function(t) { return t.FFT = function() { var e = t.defaults(arguments, ["size"], t.FFT);
                e.type = t.Analyser.Type.FFT, t.AudioNode.call(this), this._analyser = this.input = this.output = new t.Analyser(e) }, t.extend(t.FFT, t.AudioNode), t.FFT.defaults = { size: 1024 }, t.FFT.prototype.getValue = function() { return this._analyser.getValue() }, Object.defineProperty(t.FFT.prototype, "size", { get: function() { return this._analyser.size }, set: function(t) { this._analyser.size = t } }), t.FFT.prototype.dispose = function() { t.AudioNode.prototype.dispose.call(this), this._analyser.dispose(), this._analyser = null }, t.FFT }), t(function(t) { return t.Abs = function() { t.SignalBase.call(this), this._abs = this.input = this.output = new t.WaveShaper(function(t) { return Math.abs(t) < .001 ? 0 : Math.abs(t) }, 1024) }, t.extend(t.Abs, t.SignalBase), t.Abs.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._abs.dispose(), this._abs = null, this }, t.Abs }), t(function(t) { return t.Follower = function() { var e = t.defaults(arguments, ["attack", "release"], t.Follower);
                t.AudioNode.call(this), this.createInsOuts(1, 1), this._abs = new t.Abs, this._filter = this.context.createBiquadFilter(), this._filter.type = "lowpass", this._filter.frequency.value = 0, this._filter.Q.value = -100, this._frequencyValues = new t.WaveShaper, this._sub = new t.Subtract, this._delay = new t.Delay(this.blockTime), this._mult = new t.Multiply(1e4), this._attack = e.attack, this._release = e.release, this.input.chain(this._abs, this._filter, this.output), this._abs.connect(this._sub, 0, 1), this._filter.chain(this._delay, this._sub), this._sub.chain(this._mult, this._frequencyValues, this._filter.frequency), this._setAttackRelease(this._attack, this._release) }, t.extend(t.Follower, t.AudioNode), t.Follower.defaults = { attack: .05, release: .5 }, t.Follower.prototype._setAttackRelease = function(e, i) { var n = this.blockTime;
                e = t.Time(e).toFrequency(), i = t.Time(i).toFrequency(), e = Math.max(e, n), i = Math.max(i, n), this._frequencyValues.setMap(function(t) { return t <= 0 ? e : i }) }, Object.defineProperty(t.Follower.prototype, "attack", { get: function() { return this._attack }, set: function(t) { this._attack = t, this._setAttackRelease(this._attack, this._release) } }), Object.defineProperty(t.Follower.prototype, "release", { get: function() { return this._release }, set: function(t) { this._release = t, this._setAttackRelease(this._attack, this._release) } }), t.Follower.prototype.connect = t.Signal.prototype.connect, t.Follower.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._filter.disconnect(), this._filter = null, this._frequencyValues.disconnect(), this._frequencyValues = null, this._delay.dispose(), this._delay = null, this._sub.disconnect(), this._sub = null, this._abs.dispose(), this._abs = null, this._mult.dispose(), this._mult = null, this._curve = null, this }, t.Follower }), t(function(t) { return t.ScaledEnvelope = function() { var e = t.defaults(arguments, ["attack", "decay", "sustain", "release"], t.Envelope);
                t.Envelope.call(this, e), e = t.defaultArg(e, t.ScaledEnvelope.defaults), this._exp = this.output = new t.Pow(e.exponent), this._scale = this.output = new t.Scale(e.min, e.max), this._sig.chain(this._exp, this._scale) }, t.extend(t.ScaledEnvelope, t.Envelope), t.ScaledEnvelope.defaults = { min: 0, max: 1, exponent: 1 }, Object.defineProperty(t.ScaledEnvelope.prototype, "min", { get: function() { return this._scale.min }, set: function(t) { this._scale.min = t } }), Object.defineProperty(t.ScaledEnvelope.prototype, "max", { get: function() { return this._scale.max }, set: function(t) { this._scale.max = t } }), Object.defineProperty(t.ScaledEnvelope.prototype, "exponent", { get: function() { return this._exp.value }, set: function(t) { this._exp.value = t } }), t.ScaledEnvelope.prototype.dispose = function() { return t.Envelope.prototype.dispose.call(this), this._scale.dispose(), this._scale = null, this._exp.dispose(), this._exp = null, this }, t.ScaledEnvelope }), t(function(t) { return t.FrequencyEnvelope = function() { var e = t.defaults(arguments, ["attack", "decay", "sustain", "release"], t.Envelope);
                t.ScaledEnvelope.call(this, e), e = t.defaultArg(e, t.FrequencyEnvelope.defaults), this._octaves = e.octaves, this.baseFrequency = e.baseFrequency, this.octaves = e.octaves }, t.extend(t.FrequencyEnvelope, t.Envelope), t.FrequencyEnvelope.defaults = { baseFrequency: 200, octaves: 4, exponent: 2 }, Object.defineProperty(t.FrequencyEnvelope.prototype, "baseFrequency", { get: function() { return this._scale.min }, set: function(t) { this._scale.min = this.toFrequency(t), this.octaves = this._octaves } }), Object.defineProperty(t.FrequencyEnvelope.prototype, "octaves", { get: function() { return this._octaves }, set: function(t) { this._octaves = t, this._scale.max = this.baseFrequency * Math.pow(2, t) } }), Object.defineProperty(t.FrequencyEnvelope.prototype, "exponent", { get: function() { return this._exp.value }, set: function(t) { this._exp.value = t } }), t.FrequencyEnvelope.prototype.dispose = function() { return t.ScaledEnvelope.prototype.dispose.call(this), this }, t.FrequencyEnvelope }), t(function(t) { return t.GreaterThanZero = function() { t.SignalBase.call(this), this._thresh = this.output = new t.WaveShaper(function(t) { return t <= 0 ? 0 : 1 }, 127), this._scale = this.input = new t.Multiply(1e4), this._scale.connect(this._thresh) }, t.extend(t.GreaterThanZero, t.SignalBase), t.GreaterThanZero.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._scale.dispose(), this._scale = null, this._thresh.dispose(), this._thresh = null, this }, t.GreaterThanZero }), t(function(t) { return t.GreaterThan = function(e) { t.Signal.call(this), this.createInsOuts(2, 0), this._param = this.input[0] = new t.Subtract(e), this.input[1] = this._param.input[1], this._gtz = this.output = new t.GreaterThanZero, this._param.connect(this._gtz) }, t.extend(t.GreaterThan, t.Signal), t.GreaterThan.prototype.dispose = function() { return t.Signal.prototype.dispose.call(this), this._gtz.dispose(), this._gtz = null, this }, t.GreaterThan }), t(function(t) { return t.Gate = function() { var e = t.defaults(arguments, ["threshold", "attack", "release"], t.Gate);
                t.AudioNode.call(this), this.createInsOuts(1, 1), this._follower = new t.Follower(e.attack, e.release), this._gt = new t.GreaterThan(t.dbToGain(e.threshold)), this.input.connect(this.output), this.input.chain(this._gt, this._follower, this.output.gain) }, t.extend(t.Gate, t.AudioNode), t.Gate.defaults = { attack: .1, release: .1, threshold: -40 }, Object.defineProperty(t.Gate.prototype, "threshold", { get: function() { return t.gainToDb(this._gt.value) }, set: function(e) { this._gt.value = t.dbToGain(e) } }), Object.defineProperty(t.Gate.prototype, "attack", { get: function() { return this._follower.attack }, set: function(t) { this._follower.attack = t } }), Object.defineProperty(t.Gate.prototype, "release", { get: function() { return this._follower.release }, set: function(t) { this._follower.release = t } }), t.Gate.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._follower.dispose(), this._gt.dispose(), this._follower = null, this._gt = null, this }, t.Gate }), t(function(t) {
            function e(t) { return function(e, i) { var n, s, o; return i = this.toSeconds(i), t.apply(this, arguments), n = this._events.get(i), s = this._events.previousEvent(n), o = this._getTickUntilEvent(s, i - this.sampleTime), n.ticks = Math.max(o, 0), this } } return t.TickSignal = function(e) { e = t.defaultArg(e, 1), t.TimelineSignal.call(this, { units: t.Type.Ticks, value: e }), this._events.memory = 1 / 0 }, t.extend(t.TickSignal, t.TimelineSignal), t.TickSignal.prototype.setValueAtTime = e(t.TimelineSignal.prototype.setValueAtTime), t.TickSignal.prototype.linearRampToValueAtTime = e(t.TimelineSignal.prototype.linearRampToValueAtTime), t.TickSignal.prototype.setTargetAtTime = function(t, e, i) { var n, s, o, r, a; for (e = this.toSeconds(e), this.setRampPoint(e), t = this._fromUnits(t), n = this._events.get(e), s = 5, o = 0; o <= s; o++) r = i * o + e, a = this._exponentialApproach(n.time, n.value, t, i, r), this.linearRampToValueAtTime(this._toUnits(a), r); return this }, t.TickSignal.prototype.exponentialRampToValueAtTime = function(t, e) { var i, n, s, o, r, a; for (e = this.toSeconds(e), t = this._fromUnits(t), i = this._events.get(e), null === i && (i = { value: this._initial, time: 0 }), n = 5, s = (e - i.time) / n, o = 0; o <= n; o++) r = s * o + i.time, a = this._exponentialInterpolate(i.time, i.value, e, t, r), this.linearRampToValueAtTime(this._toUnits(a), r); return this }, t.TickSignal.prototype._getTickUntilEvent = function(t, e) { var i, n; return null === t && (t = { ticks: 0, time: 0 }), i = this.getValueAtTime(t.time), n = this.getValueAtTime(e), .5 * (e - t.time) * (i + n) + t.ticks }, t.TickSignal.prototype.getTickAtTime = function(t) { t = this.toSeconds(t); var e = this._events.get(t); return this._getTickUntilEvent(e, t) }, t.TickSignal.prototype.getDurationOfTicks = function(t, e) { e = this.toSeconds(e); var i = this.getTickAtTime(e); return this.getTimeOfTick(i + t) - e }, t.TickSignal.prototype.getTimeOfTick = function(e) { var i, n, s, o, r, a, l = this._events.get(e, "ticks"),
                    h = this._events.getAfter(e, "ticks"); return l && l.ticks === e ? l.time : l && h && h.type === t.TimelineSignal.Type.Linear && l.value !== h.value ? (i = this.getValueAtTime(l.time), n = this.getValueAtTime(h.time), s = (n - i) / (h.time - l.time), o = Math.sqrt(Math.pow(i, 2) - 2 * s * (l.ticks - e)), r = (-i + o) / s, a = (-i - o) / s, (r > 0 ? r : a) + l.time) : l ? 0 === l.value ? 1 / 0 : l.time + (e - l.ticks) / l.value : e / this._initial }, t.TickSignal }), t(function(t) { return t.TimelineState = function(e) { t.Timeline.call(this), this._initial = e }, t.extend(t.TimelineState, t.Timeline), t.TimelineState.prototype.getValueAtTime = function(t) { var e = this.get(t); return null !== e ? e.state : this._initial }, t.TimelineState.prototype.setStateAtTime = function(t, e) { return this.add({ state: t, time: e }), this }, t.TimelineState }), t(function(t) { return t.Clock = function() { var e = t.defaults(arguments, ["callback", "frequency"], t.Clock);
                t.Emitter.call(this), this.callback = e.callback, this._nextTick = 0, this._lastState = t.State.Stopped, this.frequency = new t.TickSignal(e.frequency, t.Type.Frequency), this._readOnly("frequency"), this.ticks = 0, this._state = new t.TimelineState(t.State.Stopped), this._boundLoop = this._loop.bind(this), this.context.on("tick", this._boundLoop) }, t.extend(t.Clock, t.Emitter), t.Clock.defaults = { callback: t.noOp, frequency: 1 }, Object.defineProperty(t.Clock.prototype, "state", { get: function() { return this._state.getValueAtTime(this.now()) } }), t.Clock.prototype.start = function(e, i) { return e = this.toSeconds(e), this._state.getValueAtTime(e) !== t.State.Started && (this._state.setStateAtTime(t.State.Started, e), this._state.get(e).offset = i), this }, t.Clock.prototype.stop = function(e) { return e = this.toSeconds(e), this._state.cancel(e), this._state.setStateAtTime(t.State.Stopped, e), this }, t.Clock.prototype.pause = function(e) { return e = this.toSeconds(e), this._state.getValueAtTime(e) === t.State.Started && this._state.setStateAtTime(t.State.Paused, e), this }, t.Clock.prototype._loop = function() { var e, i = this.now() + this.context.updateInterval,
                    n = this._state.get(i); if (n) { if (n.state !== this._lastState) switch (this._lastState = n.state, n.state) {
                        case t.State.Started:
                            t.isUndef(n.offset) || (this.ticks = n.offset), this._nextTick = n.time, this.emit("start", n.time, this.ticks); break;
                        case t.State.Stopped:
                            this.ticks = 0, this.emit("stop", n.time); break;
                        case t.State.Paused:
                            this.emit("pause", n.time) }
                    for (; i > this._nextTick && this._state;)
                        if (e = this._nextTick, this.frequency && (this._nextTick += this.frequency.getDurationOfTicks(1, this._nextTick), n.state === t.State.Started)) try { this.callback(e), this.ticks++ } catch (t) { throw this.ticks++, t } } }, t.Clock.prototype.getStateAtTime = function(t) { return t = this.toSeconds(t), this._state.getValueAtTime(t) }, t.Clock.prototype.dispose = function() { t.Emitter.prototype.dispose.call(this), this.context.off("tick", this._boundLoop), this._writable("frequency"), this.frequency.dispose(), this.frequency = null, this._boundLoop = null, this._nextTick = 1 / 0, this.callback = null, this._state.dispose(), this._state = null }, t.Clock }), t(function(t) { t.IntervalTimeline = function() { t.call(this), this._root = null, this._length = 0 }, t.extend(t.IntervalTimeline), t.IntervalTimeline.prototype.add = function(i) { if (t.isUndef(i.time) || t.isUndef(i.duration)) throw new Error("Tone.IntervalTimeline: events must have time and duration parameters"); var n = new e(i.time, i.time + i.duration, i); for (null === this._root ? this._root = n : this._root.insert(n), this._length++; null !== n;) n.updateHeight(), n.updateMax(), this._rebalance(n), n = n.parent; return this }, t.IntervalTimeline.prototype.remove = function(t) { var e, i, n; if (null !== this._root)
                    for (e = [], this._root.search(t.time, e), i = 0; i < e.length; i++)
                        if (n = e[i], n.event === t) { this._removeNode(n), this._length--; break } return this }, Object.defineProperty(t.IntervalTimeline.prototype, "length", { get: function() { return this._length } }), t.IntervalTimeline.prototype.cancel = function(t) { return this.forEachAfter(t, function(t) { this.remove(t) }.bind(this)), this }, t.IntervalTimeline.prototype._setRoot = function(t) { this._root = t, null !== this._root && (this._root.parent = null) }, t.IntervalTimeline.prototype._replaceNodeInParent = function(t, e) { null !== t.parent ? (t.isLeftChild() ? t.parent.left = e : t.parent.right = e, this._rebalance(t.parent)) : this._setRoot(e) }, t.IntervalTimeline.prototype._removeNode = function(t) { var e, i; if (null === t.left && null === t.right) this._replaceNodeInParent(t, null);
                else if (null === t.right) this._replaceNodeInParent(t, t.left);
                else if (null === t.left) this._replaceNodeInParent(t, t.right);
                else { if (t.getBalance() > 0)
                        if (null === t.left.right) e = t.left, e.right = t.right, i = e;
                        else { for (e = t.left.right; null !== e.right;) e = e.right;
                            e.parent.right = e.left, i = e.parent, e.left = t.left, e.right = t.right } else if (null === t.right.left) e = t.right, e.left = t.left, i = e;
                    else { for (e = t.right.left; null !== e.left;) e = e.left;
                        e.parent = e.parent, e.parent.left = e.right, i = e.parent, e.left = t.left, e.right = t.right } null !== t.parent ? t.isLeftChild() ? t.parent.left = e : t.parent.right = e : this._setRoot(e), this._rebalance(i) } t.dispose() }, t.IntervalTimeline.prototype._rotateLeft = function(t) { var e = t.parent,
                    i = t.isLeftChild(),
                    n = t.right;
                t.right = n.left, n.left = t, null !== e ? i ? e.left = n : e.right = n : this._setRoot(n) }, t.IntervalTimeline.prototype._rotateRight = function(t) { var e = t.parent,
                    i = t.isLeftChild(),
                    n = t.left;
                t.left = n.right, n.right = t, null !== e ? i ? e.left = n : e.right = n : this._setRoot(n) }, t.IntervalTimeline.prototype._rebalance = function(t) { var e = t.getBalance();
                e > 1 ? t.left.getBalance() < 0 ? this._rotateLeft(t.left) : this._rotateRight(t) : e < -1 && (t.right.getBalance() > 0 ? this._rotateRight(t.right) : this._rotateLeft(t)) }, t.IntervalTimeline.prototype.get = function(t) { var e, i, n; if (null !== this._root && (e = [], this._root.search(t, e), e.length > 0)) { for (i = e[0], n = 1; n < e.length; n++) e[n].low > i.low && (i = e[n]); return i.event } return null }, t.IntervalTimeline.prototype.forEach = function(t) { var e, i, n; if (null !== this._root)
                    for (e = [], this._root.traverse(function(t) { e.push(t) }), i = 0; i < e.length; i++)(n = e[i].event) && t(n); return this }, t.IntervalTimeline.prototype.forEachAtTime = function(t, e) { var i, n, s; if (null !== this._root)
                    for (i = [], this._root.search(t, i), n = i.length - 1; n >= 0; n--)(s = i[n].event) && e(s); return this }, t.IntervalTimeline.prototype.forEachAfter = function(t, e) { var i, n, s; if (null !== this._root)
                    for (i = [], this._root.searchAfter(t, i), n = i.length - 1; n >= 0; n--) s = i[n].event, e(s); return this }, t.IntervalTimeline.prototype.dispose = function() { var t, e = []; for (null !== this._root && this._root.traverse(function(t) { e.push(t) }), t = 0; t < e.length; t++) e[t].dispose(); return e = null, this._root = null, this }; var e = function(t, e, i) { this.event = i, this.low = t, this.high = e, this.max = this.high, this._left = null, this._right = null, this.parent = null, this.height = 0 }; return e.prototype.insert = function(t) { t.low <= this.low ? null === this.left ? this.left = t : this.left.insert(t) : null === this.right ? this.right = t : this.right.insert(t) }, e.prototype.search = function(t, e) { t > this.max || (null !== this.left && this.left.search(t, e), this.low <= t && this.high > t && e.push(this), this.low > t || null !== this.right && this.right.search(t, e)) }, e.prototype.searchAfter = function(t, e) { this.low >= t && (e.push(this), null !== this.left && this.left.searchAfter(t, e)), null !== this.right && this.right.searchAfter(t, e) }, e.prototype.traverse = function(t) { t(this), null !== this.left && this.left.traverse(t), null !== this.right && this.right.traverse(t) }, e.prototype.updateHeight = function() { null !== this.left && null !== this.right ? this.height = Math.max(this.left.height, this.right.height) + 1 : null !== this.right ? this.height = this.right.height + 1 : null !== this.left ? this.height = this.left.height + 1 : this.height = 0 }, e.prototype.updateMax = function() { this.max = this.high, null !== this.left && (this.max = Math.max(this.max, this.left.max)), null !== this.right && (this.max = Math.max(this.max, this.right.max)) }, e.prototype.getBalance = function() { var t = 0; return null !== this.left && null !== this.right ? t = this.left.height - this.right.height : null !== this.left ? t = this.left.height + 1 : null !== this.right && (t = -(this.right.height + 1)), t }, e.prototype.isLeftChild = function() { return null !== this.parent && this.parent.left === this }, Object.defineProperty(e.prototype, "left", { get: function() { return this._left }, set: function(t) { this._left = t, null !== t && (t.parent = this), this.updateHeight(), this.updateMax() } }), Object.defineProperty(e.prototype, "right", { get: function() { return this._right }, set: function(t) { this._right = t, null !== t && (t.parent = this), this.updateHeight(), this.updateMax() } }), e.prototype.dispose = function() { this.parent = null, this._left = null, this._right = null, this.event = null }, t.IntervalTimeline }), t(function(t) { return t.TransportEvent = function(e, i) { i = t.defaultArg(i, t.TransportEvent.defaults), t.call(this), this.Transport = e, this.id = t.TransportEvent._eventId++, this.time = i.time, this.callback = i.callback, this._once = i.once }, t.extend(t.TransportEvent), t.TransportEvent.defaults = { once: !1, callback: t.noOp }, t.TransportEvent._eventId = 0, t.TransportEvent.prototype.invoke = function(t) { this.callback && (this.callback(t), this._once && this.Transport && this.Transport.clear(this.id)) }, t.TransportEvent.prototype.dispose = function() { return t.prototype.dispose.call(this), this.Transport = null, this.callback = null, this }, t.TransportEvent }), t(function(t) { return t.TransportRepeatEvent = function(e, i) { t.TransportEvent.call(this, e, i), i = t.defaultArg(i, t.TransportRepeatEvent.defaults), this.duration = i.duration, this._interval = i.interval, this._currentId = -1, this._nextId = -1, this._nextTick = this.time, this._boundRestart = this._restart.bind(this), this.Transport.on("start loopStart", this._boundRestart), this._restart() }, t.extend(t.TransportRepeatEvent, t.TransportEvent), t.TransportRepeatEvent.defaults = { duration: 1 / 0, interval: 1 }, t.TransportRepeatEvent.prototype.invoke = function(e) { this._createEvents(), t.TransportEvent.prototype.invoke.call(this, e) }, t.TransportRepeatEvent.prototype._createEvents = function() { var e = this.Transport.ticks;
                e >= this.time && e >= this._nextTick && this._nextTick + this._interval < this.time + this.duration && (this._nextTick += this._interval, this._currentId = this._nextId, this._nextId = this.Transport.scheduleOnce(this.invoke.bind(this), t.TransportTime(this._nextTick, "i"))) }, t.TransportRepeatEvent.prototype._restart = function() { this.Transport.clear(this._currentId), this.Transport.clear(this._nextId); var e = this.Transport.ticks;
                this._nextTick = this.time, e > this.time && (this._nextTick = this.time + Math.ceil((e - this.time) / this._interval) * this._interval), this._currentId = this.Transport.scheduleOnce(this.invoke.bind(this), t.TransportTime(this._nextTick, "i")), this._nextTick += this._interval, this._nextId = this.Transport.scheduleOnce(this.invoke.bind(this), t.TransportTime(this._nextTick, "i")) }, t.TransportRepeatEvent.prototype.dispose = function() { return this.Transport.clear(this._currentId), this.Transport.clear(this._nextId), this.Transport.off("start loopStart", this._boundRestart), this._boundCreateEvents = null, t.TransportEvent.prototype.dispose.call(this), this }, t.TransportRepeatEvent }), t(function(t) { t.Transport = function() { t.Emitter.call(this), t.getContext(function() { this.loop = !1, this._loopStart = 0, this._loopEnd = 0, this._ppq = e.defaults.PPQ, this._clock = new t.Clock({ callback: this._processTick.bind(this), frequency: 0 }), this._bindClockEvents(), this.bpm = this._clock.frequency, this.bpm._toUnits = this._toUnits.bind(this), this.bpm._fromUnits = this._fromUnits.bind(this), this.bpm.units = t.Type.BPM, this.bpm.value = e.defaults.bpm, this._readOnly("bpm"), this._timeSignature = e.defaults.timeSignature, this._scheduledEvents = {}, this._timeline = new t.Timeline, this._repeatedEvents = new t.IntervalTimeline, this._syncedSignals = [], this._swingTicks = e.defaults.PPQ / 2, this._swingAmount = 0 }.bind(this)) }, t.extend(t.Transport, t.Emitter), t.Transport.defaults = { bpm: 120, swing: 0, swingSubdivision: "8n", timeSignature: 4, loopStart: 0, loopEnd: "4m", PPQ: 192 }, t.Transport.prototype._processTick = function(e) { var i, n, s = this._clock.ticks;
                this._swingAmount > 0 && s % this._ppq != 0 && s % (2 * this._swingTicks) != 0 && (i = s % (2 * this._swingTicks) / (2 * this._swingTicks), n = Math.sin(i * Math.PI) * this._swingAmount, e += t.Time(2 * this._swingTicks / 3, "i") * n), this.loop && s >= this._loopEnd && (this.emit("loopEnd", e), this._clock.ticks = this._loopStart, s = this._loopStart, this.emit("loopStart", e, this.seconds), this.emit("loop", e)), this._timeline.forEachAtTime(s, function(t) { t.invoke(e) }) }, t.Transport.prototype.schedule = function(e, i) { var n = new t.TransportEvent(this, { time: this.toTicks(i), callback: e }); return this._addEvent(n, this._timeline) }, t.Transport.prototype.scheduleRepeat = function(e, i, n, s) { var o = new t.TransportRepeatEvent(this, { callback: e, interval: this.toTicks(i), time: this.toTicks(n), duration: this.toTicks(t.defaultArg(s, 1 / 0)) }); return this._addEvent(o, this._repeatedEvents) }, t.Transport.prototype.scheduleOnce = function(e, i) { var n = new t.TransportEvent(this, { time: this.toTicks(i), callback: e, once: !0 }); return this._addEvent(n, this._timeline) }, t.Transport.prototype.clear = function(t) { if (this._scheduledEvents.hasOwnProperty(t)) { var e = this._scheduledEvents[t.toString()];
                    e.timeline.remove(e.event), e.event.dispose(), delete this._scheduledEvents[t.toString()] } return this }, t.Transport.prototype._addEvent = function(t, e) { return this._scheduledEvents[t.id.toString()] = { event: t, timeline: e }, e.add(t), t.id }, t.Transport.prototype.cancel = function(e) { return e = t.defaultArg(e, 0), e = this.toTicks(e), this._timeline.cancel(e), this._repeatedEvents.cancel(e), this }, t.Transport.prototype._bindClockEvents = function() { this._clock.on("start", function(e, i) { i = t.Time(this._clock.ticks, "i").toSeconds(), this.emit("start", e, i) }.bind(this)), this._clock.on("stop", function(t) { this.emit("stop", t) }.bind(this)), this._clock.on("pause", function(t) { this.emit("pause", t) }.bind(this)) }, Object.defineProperty(t.Transport.prototype, "state", { get: function() { return this._clock.getStateAtTime(this.now()) } }), t.Transport.prototype.start = function(e, i) { return t.isUndef(i) || (i = this.toTicks(i)), this._clock.start(e, i), this }, t.Transport.prototype.stop = function(t) { return this._clock.stop(t), this }, t.Transport.prototype.pause = function(t) { return this._clock.pause(t), this }, t.Transport.prototype.toggle = function(e) { return e = this.toSeconds(e), this._clock.getStateAtTime(e) !== t.State.Started ? this.start(e) : this.stop(e), this }, Object.defineProperty(t.Transport.prototype, "timeSignature", { get: function() { return this._timeSignature }, set: function(e) { t.isArray(e) && (e = e[0] / e[1] * 4), this._timeSignature = e } }), Object.defineProperty(t.Transport.prototype, "loopStart", { get: function() { return t.TransportTime(this._loopStart, "i").toSeconds() }, set: function(t) { this._loopStart = this.toTicks(t) } }), Object.defineProperty(t.Transport.prototype, "loopEnd", { get: function() { return t.TransportTime(this._loopEnd, "i").toSeconds() }, set: function(t) { this._loopEnd = this.toTicks(t) } }), t.Transport.prototype.setLoopPoints = function(t, e) { return this.loopStart = t, this.loopEnd = e, this }, Object.defineProperty(t.Transport.prototype, "swing", { get: function() { return this._swingAmount }, set: function(t) { this._swingAmount = t } }), Object.defineProperty(t.Transport.prototype, "swingSubdivision", { get: function() { return t.Time(this._swingTicks, "i").toNotation() }, set: function(t) { this._swingTicks = this.toTicks(t) } }), Object.defineProperty(t.Transport.prototype, "position", { get: function() { return t.TransportTime(this.ticks, "i").toBarsBeatsSixteenths() }, set: function(t) { var e = this.toTicks(t);
                    this.ticks = e } }), Object.defineProperty(t.Transport.prototype, "seconds", { get: function() { return t.TransportTime(this.ticks, "i").toSeconds() }, set: function(t) { var e = this.toTicks(t);
                    this.ticks = e } }), Object.defineProperty(t.Transport.prototype, "progress", { get: function() { return this.loop ? (this.ticks - this._loopStart) / (this._loopEnd - this._loopStart) : 0 } }), Object.defineProperty(t.Transport.prototype, "ticks", { get: function() { return this._clock.ticks }, set: function(e) { if (this._clock.ticks !== e) { var i = this.now();
                        this.state === t.State.Started ? (this.emit("stop", i), this._clock.ticks = e, this.emit("start", i, this.seconds)) : this._clock.ticks = e } } }), Object.defineProperty(t.Transport.prototype, "PPQ", { get: function() { return this._ppq }, set: function(t) { var e = this.bpm.value;
                    this._ppq = t, this.bpm.value = e } }), t.Transport.prototype._fromUnits = function(t) { return 1 / (60 / t / this.PPQ) }, t.Transport.prototype._toUnits = function(t) { return t / this.PPQ * 60 }, t.Transport.prototype.nextSubdivision = function(e) { var i, n, s; return e = this.toSeconds(e), this.state !== t.State.Started ? 0 : (i = this._clock._nextTick, n = t.Time(this.ticks, "i"), s = e - n % e, 0 === s && (s = e), i + s) }, t.Transport.prototype.syncSignal = function(e, i) { i || (i = 0 !== e._param.value ? e._param.value / this.bpm._param.value : 0); var n = new t.Gain(i); return this.bpm.chain(n, e._param), this._syncedSignals.push({ ratio: n, signal: e, initial: e._param.value }), e._param.value = 0, this }, t.Transport.prototype.unsyncSignal = function(t) { var e, i; for (e = this._syncedSignals.length - 1; e >= 0; e--) i = this._syncedSignals[e], i.signal === t && (i.ratio.dispose(), i.signal._param.value = i.initial, this._syncedSignals.splice(e, 1)); return this }, t.Transport.prototype.dispose = function() { return t.Emitter.prototype.dispose.call(this), this._clock.dispose(), this._clock = null, this._writable("bpm"), this.bpm = null, this._timeline.dispose(), this._timeline = null, this._repeatedEvents.dispose(), this._repeatedEvents = null, this }; var e = t.Transport; return t.Transport = new e, t.Context.on("init", function(i) { i.Transport instanceof e ? t.Transport = i.Transport : t.Transport = new e, i.Transport = t.Transport }), t.Context.on("close", function(t) { t.Transport instanceof e && t.Transport.dispose() }), t.Transport }), t(function(t) { return t.Volume = function() { var e = t.defaults(arguments, ["volume"], t.Volume);
                t.AudioNode.call(this), this.output = this.input = new t.Gain(e.volume, t.Type.Decibels), this._unmutedVolume = e.volume, this.volume = this.output.gain, this._readOnly("volume"), this.mute = e.mute }, t.extend(t.Volume, t.AudioNode), t.Volume.defaults = { volume: 0, mute: !1 }, Object.defineProperty(t.Volume.prototype, "mute", { get: function() { return this.volume.value === -1 / 0 }, set: function(t) {!this.mute && t ? (this._unmutedVolume = this.volume.value, this.volume.value = -1 / 0) : this.mute && !t && (this.volume.value = this._unmutedVolume) } }), t.Volume.prototype.dispose = function() { return this.input.dispose(), t.AudioNode.prototype.dispose.call(this), this._writable("volume"), this.volume.dispose(), this.volume = null, this }, t.Volume }), t(function(t) { t.Master = function() { t.AudioNode.call(this), t.getContext(function() { this.createInsOuts(1, 0), this._volume = this.output = new t.Volume, this.volume = this._volume.volume, this._readOnly("volume"), this.input.chain(this.output, this.context.destination) }.bind(this)) }, t.extend(t.Master, t.AudioNode), t.Master.defaults = { volume: 0, mute: !1 }, Object.defineProperty(t.Master.prototype, "mute", { get: function() { return this._volume.mute }, set: function(t) { this._volume.mute = t } }), t.Master.prototype.chain = function() { this.input.disconnect(), this.input.chain.apply(this.input, arguments), arguments[arguments.length - 1].connect(this.output) }, t.Master.prototype.dispose = function() { t.AudioNode.prototype.dispose.call(this), this._writable("volume"), this._volume.dispose(), this._volume = null, this.volume = null }, t.AudioNode.prototype.toMaster = function() { return this.connect(t.Master), this }, window.AudioNode && (AudioNode.prototype.toMaster = function() { return this.connect(t.Master), this }); var e = t.Master; return t.Master = new e, t.Context.on("init", function(i) { i.Master instanceof e ? t.Master = i.Master : t.Master = new e, i.Master = t.Master }), t.Context.on("close", function(t) { t.Master instanceof e && t.Master.dispose() }), t.Master }), t(function(t) { return t.Source = function(e) { e = t.defaultArg(e, t.Source.defaults), t.AudioNode.call(this), this._volume = this.output = new t.Volume(e.volume), this.volume = this._volume.volume, this._readOnly("volume"), this._state = new t.TimelineState(t.State.Stopped), this._state.memory = 100, this._synced = !1, this._scheduled = [], this._volume.output.output.channelCount = 2, this._volume.output.output.channelCountMode = "explicit", this.mute = e.mute }, t.extend(t.Source, t.AudioNode), t.Source.defaults = { volume: 0, mute: !1 }, Object.defineProperty(t.Source.prototype, "state", { get: function() { return this._synced ? t.Transport.state === t.State.Started ? this._state.getValueAtTime(t.Transport.seconds) : t.State.Stopped : this._state.getValueAtTime(this.now()) } }), Object.defineProperty(t.Source.prototype, "mute", { get: function() { return this._volume.mute }, set: function(t) { this._volume.mute = t } }), t.Source.prototype._start = t.noOp, t.Source.prototype._stop = t.noOp, t.Source.prototype.start = function(e, i, n) { var s, o; return e = t.isUndef(e) && this._synced ? t.Transport.seconds : this.toSeconds(e), this.retrigger || this._state.getValueAtTime(e) !== t.State.Started || this.stop(e), this._state.setStateAtTime(t.State.Started, e), this._synced ? (s = this._state.get(e), s.offset = t.defaultArg(i, 0), s.duration = n, o = t.Transport.schedule(function(t) { this._start(t, i, n) }.bind(this), e), this._scheduled.push(o)) : this._start.apply(this, arguments), this }, t.Source.prototype.stop = function(e) { if (e = t.isUndef(e) && this._synced ? t.Transport.seconds : this.toSeconds(e), this._synced) { var i = t.Transport.schedule(this._stop.bind(this), e);
                    this._scheduled.push(i) } else this._stop.apply(this, arguments); return this._state.cancel(e), this._state.setStateAtTime(t.State.Stopped, e), this }, t.Source.prototype.sync = function() { return this._synced = !0, this._syncedStart = function(e, i) { var n, s, o;
                    i > 0 && (n = this._state.get(i)) && n.state === t.State.Started && n.time !== i && (s = i - this.toSeconds(n.time), n.duration && (o = this.toSeconds(n.duration) - s), this._start(e, this.toSeconds(n.offset) + s, o)) }.bind(this), this._syncedStop = function(e) { this._state.getValueAtTime(t.Transport.seconds) === t.State.Started && this._stop(e) }.bind(this), t.Transport.on("start loopStart", this._syncedStart), t.Transport.on("stop pause loopEnd", this._syncedStop), this }, t.Source.prototype.unsync = function() { var e, i; for (this._synced && (t.Transport.off("stop pause loopEnd", this._syncedStop), t.Transport.off("start loopStart", this._syncedStart)), this._synced = !1, e = 0; e < this._scheduled.length; e++) i = this._scheduled[e], t.Transport.clear(i); return this._scheduled = [], this._state.cancel(0), this }, t.Source.prototype.dispose = function() { t.AudioNode.prototype.dispose.call(this), this.unsync(), this._scheduled = null, this._writable("volume"), this._volume.dispose(), this._volume = null, this.volume = null, this._state.dispose(), this._state = null }, t.Source }), t(function(t) {
            return t.Oscillator = function() { var e = t.defaults(arguments, ["frequency", "type"], t.Oscillator);
                t.Source.call(this, e), this._oscillator = null, this.frequency = new t.Signal(e.frequency, t.Type.Frequency), this.detune = new t.Signal(e.detune, t.Type.Cents), this._wave = null, this._partials = t.defaultArg(e.partials, [1]), this._phase = e.phase, this._type = null, this.type = e.type, this.phase = this._phase, this._readOnly(["frequency", "detune"]) }, t.extend(t.Oscillator, t.Source), t.Oscillator.defaults = { type: "sine", frequency: 440, detune: 0, phase: 0, partials: [] }, t.Oscillator.Type = { Sine: "sine", Triangle: "triangle", Sawtooth: "sawtooth", Square: "square", Custom: "custom" }, t.Oscillator.prototype._start = function(e) { this._oscillator = this.context.createOscillator(), this._oscillator.setPeriodicWave(this._wave), this._oscillator.connect(this.output), this.frequency.connect(this._oscillator.frequency), this.detune.connect(this._oscillator.detune), e = this.toSeconds(e), t.isPast(e), this._oscillator.start(e) }, t.Oscillator.prototype._stop = function(e) { return this._oscillator && (e = this.toSeconds(e), t.isPast(e), this._oscillator.stop(e), this._oscillator = null), this }, t.Oscillator.prototype.syncFrequency = function() { return t.Transport.syncSignal(this.frequency), this }, t.Oscillator.prototype.unsyncFrequency = function() { return t.Transport.unsyncSignal(this.frequency), this }, Object.defineProperty(t.Oscillator.prototype, "type", {
                get: function() {
                    return this._type
                },
                set: function(t) { var e = this._getRealImaginary(t, this._phase),
                        i = this.context.createPeriodicWave(e[0], e[1]);
                    this._wave = i, null !== this._oscillator && this._oscillator.setPeriodicWave(this._wave), this._type = t }
            }), t.Oscillator.prototype._getRealImaginary = function(e, i) { var n, s, o, r, a = 4096,
                    l = a / 2,
                    h = new Float32Array(l),
                    u = new Float32Array(l),
                    p = 1; for (e === t.Oscillator.Type.Custom ? (p = this._partials.length + 1, l = p) : (n = /^(sine|triangle|square|sawtooth)(\d+)$/.exec(e)) && (p = parseInt(n[2]) + 1, e = n[1], p = Math.max(p, 2), l = p), s = 1; s < l; ++s) { switch (o = 2 / (s * Math.PI), e) {
                        case t.Oscillator.Type.Sine:
                            r = s <= p ? 1 : 0; break;
                        case t.Oscillator.Type.Square:
                            r = 1 & s ? 2 * o : 0; break;
                        case t.Oscillator.Type.Sawtooth:
                            r = o * (1 & s ? 1 : -1); break;
                        case t.Oscillator.Type.Triangle:
                            r = 1 & s ? o * o * 2 * (s - 1 >> 1 & 1 ? -1 : 1) : 0; break;
                        case t.Oscillator.Type.Custom:
                            r = this._partials[s - 1]; break;
                        default:
                            throw new TypeError("Tone.Oscillator: invalid type: " + e) } 0 !== r ? (h[s] = -r * Math.sin(i * s), u[s] = r * Math.cos(i * s)) : (h[s] = 0, u[s] = 0) } return [h, u] }, t.Oscillator.prototype._inverseFFT = function(t, e, i) { var n, s = 0,
                    o = t.length; for (n = 0; n < o; n++) s += t[n] * Math.cos(n * i) + e[n] * Math.sin(n * i); return s }, t.Oscillator.prototype._getInitialValue = function() { var t, e = this._getRealImaginary(this._type, 0),
                    i = e[0],
                    n = e[1],
                    s = 0,
                    o = 2 * Math.PI; for (t = 0; t < 8; t++) s = Math.max(this._inverseFFT(i, n, t / 8 * o), s); return -this._inverseFFT(i, n, this._phase) / s }, Object.defineProperty(t.Oscillator.prototype, "partials", { get: function() { return this._type !== t.Oscillator.Type.Custom ? [] : this._partials }, set: function(e) { this._partials = e, this.type = t.Oscillator.Type.Custom } }), Object.defineProperty(t.Oscillator.prototype, "phase", { get: function() { return this._phase * (180 / Math.PI) }, set: function(t) { this._phase = t * Math.PI / 180, this.type = this._type } }), t.Oscillator.prototype.dispose = function() { return t.Source.prototype.dispose.call(this), null !== this._oscillator && (this._oscillator.disconnect(), this._oscillator = null), this._wave = null, this._writable(["frequency", "detune"]), this.frequency.dispose(), this.frequency = null, this.detune.dispose(), this.detune = null, this._partials = null, this }, t.Oscillator
        }), t(function(t) { return t.AudioToGain = function() { t.SignalBase.call(this), this._norm = this.input = this.output = new t.WaveShaper(function(t) { return (t + 1) / 2 }) }, t.extend(t.AudioToGain, t.SignalBase), t.AudioToGain.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._norm.dispose(), this._norm = null, this }, t.AudioToGain }), t(function(t) { return t.Zero = function() { t.SignalBase.call(this), this._gain = this.input = this.output = new t.Gain, this.context.getConstant(0).connect(this._gain) }, t.extend(t.Zero, t.SignalBase), t.Zero.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._gain.dispose(), this._gain = null, this }, t.Zero }), t(function(t) { return t.LFO = function() { var e = t.defaults(arguments, ["frequency", "min", "max"], t.LFO);
                t.AudioNode.call(this), this._oscillator = new t.Oscillator({ frequency: e.frequency, type: e.type }), this.frequency = this._oscillator.frequency, this.amplitude = this._oscillator.volume, this.amplitude.units = t.Type.NormalRange, this.amplitude.value = e.amplitude, this._stoppedSignal = new t.Signal(0, t.Type.AudioRange), this._zeros = new t.Zero, this._stoppedValue = 0, this._a2g = new t.AudioToGain, this._scaler = this.output = new t.Scale(e.min, e.max), this._units = t.Type.Default, this.units = e.units, this._oscillator.chain(this._a2g, this._scaler), this._zeros.connect(this._a2g), this._stoppedSignal.connect(this._a2g), this._readOnly(["amplitude", "frequency"]), this.phase = e.phase }, t.extend(t.LFO, t.AudioNode), t.LFO.defaults = { type: "sine", min: 0, max: 1, phase: 0, frequency: "4n", amplitude: 1, units: t.Type.Default }, t.LFO.prototype.start = function(t) { return t = this.toSeconds(t), this._stoppedSignal.setValueAtTime(0, t), this._oscillator.start(t), this }, t.LFO.prototype.stop = function(t) { return t = this.toSeconds(t), this._stoppedSignal.setValueAtTime(this._stoppedValue, t), this._oscillator.stop(t), this }, t.LFO.prototype.sync = function() { return this._oscillator.sync(), this._oscillator.syncFrequency(), this }, t.LFO.prototype.unsync = function() { return this._oscillator.unsync(), this._oscillator.unsyncFrequency(), this }, Object.defineProperty(t.LFO.prototype, "min", { get: function() { return this._toUnits(this._scaler.min) }, set: function(t) { t = this._fromUnits(t), this._scaler.min = t } }), Object.defineProperty(t.LFO.prototype, "max", { get: function() { return this._toUnits(this._scaler.max) }, set: function(t) { t = this._fromUnits(t), this._scaler.max = t } }), Object.defineProperty(t.LFO.prototype, "type", { get: function() { return this._oscillator.type }, set: function(t) { this._oscillator.type = t, this._stoppedValue = this._oscillator._getInitialValue(), this._stoppedSignal.value = this._stoppedValue } }), Object.defineProperty(t.LFO.prototype, "phase", { get: function() { return this._oscillator.phase }, set: function(t) { this._oscillator.phase = t, this._stoppedValue = this._oscillator._getInitialValue(), this._stoppedSignal.value = this._stoppedValue } }), Object.defineProperty(t.LFO.prototype, "units", { get: function() { return this._units }, set: function(t) { var e = this.min,
                        i = this.max;
                    this._units = t, this.min = e, this.max = i } }), Object.defineProperty(t.LFO.prototype, "mute", { get: function() { return this._oscillator.mute }, set: function(t) { this._oscillator.mute = t } }), Object.defineProperty(t.LFO.prototype, "state", { get: function() { return this._oscillator.state } }), t.LFO.prototype.connect = function(e) { return e.constructor !== t.Signal && e.constructor !== t.Param && e.constructor !== t.TimelineSignal || (this.convert = e.convert, this.units = e.units), t.Signal.prototype.connect.apply(this, arguments), this }, t.LFO.prototype._fromUnits = t.Param.prototype._fromUnits, t.LFO.prototype._toUnits = t.Param.prototype._toUnits, t.LFO.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._writable(["amplitude", "frequency"]), this._oscillator.dispose(), this._oscillator = null, this._stoppedSignal.dispose(), this._stoppedSignal = null, this._zeros.dispose(), this._zeros = null, this._scaler.dispose(), this._scaler = null, this._a2g.dispose(), this._a2g = null, this.frequency = null, this.amplitude = null, this }, t.LFO }), t(function(t) { return t.Limiter = function() { var e = t.defaults(arguments, ["threshold"], t.Limiter);
                t.AudioNode.call(this), this._compressor = this.input = this.output = new t.Compressor({ attack: .001, decay: .001, threshold: e.threshold }), this.threshold = this._compressor.threshold, this._readOnly("threshold") }, t.extend(t.Limiter, t.AudioNode), t.Limiter.defaults = { threshold: -12 }, t.Limiter.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._compressor.dispose(), this._compressor = null, this._writable("threshold"), this.threshold = null, this }, t.Limiter }), t(function(t) { return t.LowpassCombFilter = function() { var e = t.defaults(arguments, ["delayTime", "resonance", "dampening"], t.LowpassCombFilter);
                t.AudioNode.call(this), this.createInsOuts(1, 1), this._delay = this.input = new t.Delay(e.delayTime), this.delayTime = this._delay.delayTime, this._lowpass = this.output = this.context.createBiquadFilter(), this._lowpass.Q.value = -3.0102999566398125, this._lowpass.type = "lowpass", this.dampening = new t.Param({ param: this._lowpass.frequency, units: t.Type.Frequency, value: e.dampening }), this._feedback = new t.Gain(e.resonance, t.Type.NormalRange), this.resonance = this._feedback.gain, this._delay.chain(this._lowpass, this._feedback, this._delay), this._readOnly(["dampening", "resonance", "delayTime"]) }, t.extend(t.LowpassCombFilter, t.AudioNode), t.LowpassCombFilter.defaults = { delayTime: .1, resonance: .5, dampening: 3e3 }, t.LowpassCombFilter.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._writable(["dampening", "resonance", "delayTime"]), this.dampening.dispose(), this.dampening = null, this.resonance.dispose(), this.resonance = null, this._delay.dispose(), this._delay = null, this.delayTime = null, this._lowpass.disconnect(), this._lowpass = null, this._feedback.disconnect(), this._feedback = null, this }, t.LowpassCombFilter }), t(function(t) { return t.Merge = function() { t.AudioNode.call(this), this.createInsOuts(2, 0), this.left = this.input[0] = new t.Gain, this.right = this.input[1] = new t.Gain, this._merger = this.output = this.context.createChannelMerger(2), this.left.connect(this._merger, 0, 0), this.right.connect(this._merger, 0, 1), this.left.channelCount = 1, this.right.channelCount = 1, this.left.channelCountMode = "explicit", this.right.channelCountMode = "explicit" }, t.extend(t.Merge, t.AudioNode), t.Merge.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this.left.dispose(), this.left = null, this.right.dispose(), this.right = null, this._merger.disconnect(), this._merger = null, this }, t.Merge }), t(function(t) { return t.Meter = function() { var e = t.defaults(arguments, ["smoothing"], t.Meter);
                t.AudioNode.call(this), this.input = this.output = this._analyser = new t.Analyser("waveform", 1024), this.smoothing = e.smoothing }, t.extend(t.Meter, t.AudioNode), t.Meter.defaults = { smoothing: .8 }, t.Meter.prototype.getLevel = function() { var t, e; return this._analyser.type = "fft", t = this._analyser.getValue(), e = 28, Math.max.apply(this, t) + e }, t.Meter.prototype.getValue = function() { return this._analyser.type = "waveform", this._analyser.getValue()[0] }, Object.defineProperty(t.Meter.prototype, "smoothing", { get: function() { return this._analyser.smoothing }, set: function(t) { this._analyser.smoothing = t } }), t.Meter.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._analyser.dispose(), this._analyser = null, this }, t.Meter }), t(function(t) { return t.Split = function() { t.AudioNode.call(this), this.createInsOuts(0, 2), this._splitter = this.input = this.context.createChannelSplitter(2), this._splitter.channelCount = 2, this._splitter.channelCountMode = "explicit", this.left = this.output[0] = new t.Gain, this.right = this.output[1] = new t.Gain, this._splitter.connect(this.left, 0, 0), this._splitter.connect(this.right, 1, 0) }, t.extend(t.Split, t.AudioNode), t.Split.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._splitter.disconnect(), this.left.dispose(), this.left = null, this.right.dispose(), this.right = null, this._splitter = null, this }, t.Split }), t(function(t) { return t.MidSideSplit = function() { t.AudioNode.call(this), this.createInsOuts(0, 2), this._split = this.input = new t.Split, this._midAdd = new t.Add, this.mid = this.output[0] = new t.Multiply(Math.SQRT1_2), this._sideSubtract = new t.Subtract, this.side = this.output[1] = new t.Multiply(Math.SQRT1_2), this._split.connect(this._midAdd, 0, 0), this._split.connect(this._midAdd, 1, 1), this._split.connect(this._sideSubtract, 0, 0), this._split.connect(this._sideSubtract, 1, 1), this._midAdd.connect(this.mid), this._sideSubtract.connect(this.side) }, t.extend(t.MidSideSplit, t.AudioNode), t.MidSideSplit.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this.mid.dispose(), this.mid = null, this.side.dispose(), this.side = null, this._midAdd.dispose(), this._midAdd = null, this._sideSubtract.dispose(), this._sideSubtract = null, this._split.dispose(), this._split = null, this }, t.MidSideSplit }), t(function(t) { return t.MidSideMerge = function() { t.AudioNode.call(this), this.createInsOuts(2, 0), this.mid = this.input[0] = new t.Gain, this._left = new t.Add, this._timesTwoLeft = new t.Multiply(Math.SQRT1_2), this.side = this.input[1] = new t.Gain, this._right = new t.Subtract, this._timesTwoRight = new t.Multiply(Math.SQRT1_2), this._merge = this.output = new t.Merge, this.mid.connect(this._left, 0, 0), this.side.connect(this._left, 0, 1), this.mid.connect(this._right, 0, 0), this.side.connect(this._right, 0, 1), this._left.connect(this._timesTwoLeft), this._right.connect(this._timesTwoRight), this._timesTwoLeft.connect(this._merge, 0, 0), this._timesTwoRight.connect(this._merge, 0, 1) }, t.extend(t.MidSideMerge, t.AudioNode), t.MidSideMerge.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this.mid.dispose(), this.mid = null, this.side.dispose(), this.side = null, this._left.dispose(), this._left = null, this._timesTwoLeft.dispose(), this._timesTwoLeft = null, this._right.dispose(), this._right = null, this._timesTwoRight.dispose(), this._timesTwoRight = null, this._merge.dispose(), this._merge = null, this }, t.MidSideMerge }), t(function(t) { return t.MidSideCompressor = function(e) { t.AudioNode.call(this), e = t.defaultArg(e, t.MidSideCompressor.defaults), this._midSideSplit = this.input = new t.MidSideSplit, this._midSideMerge = this.output = new t.MidSideMerge, this.mid = new t.Compressor(e.mid), this.side = new t.Compressor(e.side), this._midSideSplit.mid.chain(this.mid, this._midSideMerge.mid), this._midSideSplit.side.chain(this.side, this._midSideMerge.side), this._readOnly(["mid", "side"]) }, t.extend(t.MidSideCompressor, t.AudioNode), t.MidSideCompressor.defaults = { mid: { ratio: 3, threshold: -24, release: .03, attack: .02, knee: 16 }, side: { ratio: 6, threshold: -30, release: .25, attack: .03, knee: 10 } }, t.MidSideCompressor.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._writable(["mid", "side"]), this.mid.dispose(), this.mid = null, this.side.dispose(), this.side = null, this._midSideSplit.dispose(), this._midSideSplit = null, this._midSideMerge.dispose(), this._midSideMerge = null, this }, t.MidSideCompressor }), t(function(t) { return t.Mono = function() { t.AudioNode.call(this), this.createInsOuts(1, 0), this._merge = this.output = new t.Merge, this.input.connect(this._merge, 0, 0), this.input.connect(this._merge, 0, 1), this.input.gain.value = t.dbToGain(-10) }, t.extend(t.Mono), t.Mono.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._merge.dispose(), this._merge = null, this }, t.Mono }), t(function(t) { return t.MultibandCompressor = function(e) { t.AudioNode.call(this), e = t.defaultArg(arguments, t.MultibandCompressor.defaults), this._splitter = this.input = new t.MultibandSplit({ lowFrequency: e.lowFrequency, highFrequency: e.highFrequency }), this.lowFrequency = this._splitter.lowFrequency, this.highFrequency = this._splitter.highFrequency, this.output = new t.Gain, this.low = new t.Compressor(e.low), this.mid = new t.Compressor(e.mid), this.high = new t.Compressor(e.high), this._splitter.low.chain(this.low, this.output), this._splitter.mid.chain(this.mid, this.output), this._splitter.high.chain(this.high, this.output), this._readOnly(["high", "mid", "low", "highFrequency", "lowFrequency"]) }, t.extend(t.MultibandCompressor, t.AudioNode), t.MultibandCompressor.defaults = { low: t.Compressor.defaults, mid: t.Compressor.defaults, high: t.Compressor.defaults, lowFrequency: 250, highFrequency: 2e3 }, t.MultibandCompressor.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._splitter.dispose(), this._writable(["high", "mid", "low", "highFrequency", "lowFrequency"]), this.low.dispose(), this.mid.dispose(), this.high.dispose(), this._splitter = null, this.low = null, this.mid = null, this.high = null, this.lowFrequency = null, this.highFrequency = null, this }, t.MultibandCompressor }), t(function(t) { if (t.supported && !window.StereoPannerNode) { var e = function(e) { var i, n, s, o, r, a, l;
                    this.context = e, this.pan = new t.Signal(0, t.Type.AudioRange), i = new t.WaveShaper(function(e) { return t.equalPowerScale((e + 1) / 2) }, 4096), n = new t.WaveShaper(function(e) { return t.equalPowerScale(1 - (e + 1) / 2) }, 4096), s = new t.Gain, o = new t.Gain, r = this.input = new t.Split, a = new t.Zero, a.fan(i, n), l = this.output = new t.Merge, r.left.chain(s, l.left), r.right.chain(o, l.right), this.pan.chain(n, s.gain), this.pan.chain(i, o.gain) };
                e.prototype.disconnect = function() { this.output.disconnect.apply(this.output, arguments) }, e.prototype.connect = function() { this.output.connect.apply(this.output, arguments) }, AudioContext.prototype.createStereoPanner = function() { return new e(this) }, t.Context.prototype.createStereoPanner = function() { return new e(this) } } }), t(function(t) { return t.Panner = function(e) { t.AudioNode.call(this), this._panner = this.input = this.output = this.context.createStereoPanner(), this.pan = this._panner.pan, this.pan.value = t.defaultArg(e, 0), this._readOnly("pan") }, t.extend(t.Panner, t.AudioNode), t.Panner.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._writable("pan"), this._panner.disconnect(), this._panner = null, this.pan = null, this }, t.Panner }), t(function(t) { return t.Panner3D = function() { var e = t.defaults(arguments, ["positionX", "positionY", "positionZ"], t.Panner3D);
                t.AudioNode.call(this), this._panner = this.input = this.output = this.context.createPanner(), this._panner.panningModel = e.panningModel, this._panner.maxDistance = e.maxDistance, this._panner.distanceModel = e.distanceModel, this._panner.coneOuterGain = e.coneOuterGain, this._panner.coneOuterAngle = e.coneOuterAngle, this._panner.coneInnerAngle = e.coneInnerAngle, this._panner.refDistance = e.refDistance, this._panner.rolloffFactor = e.rolloffFactor, this._orientation = [e.orientationX, e.orientationY, e.orientationZ], this._position = [e.positionX, e.positionY, e.positionZ], this.orientationX = e.orientationX, this.orientationY = e.orientationY, this.orientationZ = e.orientationZ, this.positionX = e.positionX, this.positionY = e.positionY, this.positionZ = e.positionZ }, t.extend(t.Panner3D, t.AudioNode), t.Panner3D.defaults = { positionX: 0, positionY: 0, positionZ: 0, orientationX: 0, orientationY: 0, orientationZ: 0, panningModel: "equalpower", maxDistance: 1e4, distanceModel: "inverse", coneOuterGain: 0, coneOuterAngle: 360, coneInnerAngle: 360, refDistance: 1, rolloffFactor: 1 }, t.Panner3D.prototype._rampTimeConstant = .01, t.Panner3D.prototype.setPosition = function(t, e, i) { if (this._panner.positionX) { var n = this.now();
                    this._panner.positionX.setTargetAtTime(t, n, this._rampTimeConstant), this._panner.positionY.setTargetAtTime(e, n, this._rampTimeConstant), this._panner.positionZ.setTargetAtTime(i, n, this._rampTimeConstant) } else this._panner.setPosition(t, e, i); return this._position = Array.prototype.slice.call(arguments), this }, t.Panner3D.prototype.setOrientation = function(t, e, i) { if (this._panner.orientationX) { var n = this.now();
                    this._panner.orientationX.setTargetAtTime(t, n, this._rampTimeConstant), this._panner.orientationY.setTargetAtTime(e, n, this._rampTimeConstant), this._panner.orientationZ.setTargetAtTime(i, n, this._rampTimeConstant) } else this._panner.setOrientation(t, e, i); return this._orientation = Array.prototype.slice.call(arguments), this }, Object.defineProperty(t.Panner3D.prototype, "positionX", { set: function(t) { this._position[0] = t, this.setPosition.apply(this, this._position) }, get: function() { return this._position[0] } }), Object.defineProperty(t.Panner3D.prototype, "positionY", { set: function(t) { this._position[1] = t, this.setPosition.apply(this, this._position) }, get: function() { return this._position[1] } }), Object.defineProperty(t.Panner3D.prototype, "positionZ", { set: function(t) { this._position[2] = t, this.setPosition.apply(this, this._position) }, get: function() { return this._position[2] } }), Object.defineProperty(t.Panner3D.prototype, "orientationX", { set: function(t) { this._orientation[0] = t, this.setOrientation.apply(this, this._orientation) }, get: function() { return this._orientation[0] } }), Object.defineProperty(t.Panner3D.prototype, "orientationY", { set: function(t) { this._orientation[1] = t, this.setOrientation.apply(this, this._orientation) }, get: function() { return this._orientation[1] } }), Object.defineProperty(t.Panner3D.prototype, "orientationZ", { set: function(t) { this._orientation[2] = t, this.setOrientation.apply(this, this._orientation) }, get: function() { return this._orientation[2] } }), t.Panner3D._aliasProperty = function(e) { Object.defineProperty(t.Panner3D.prototype, e, { set: function(t) { this._panner[e] = t }, get: function() { return this._panner[e] } }) }, t.Panner3D._aliasProperty("panningModel"), t.Panner3D._aliasProperty("refDistance"), t.Panner3D._aliasProperty("rolloffFactor"), t.Panner3D._aliasProperty("distanceModel"), t.Panner3D._aliasProperty("coneInnerAngle"), t.Panner3D._aliasProperty("coneOuterAngle"), t.Panner3D._aliasProperty("coneOuterGain"), t.Panner3D._aliasProperty("maxDistance"), t.Panner3D.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._panner.disconnect(), this._panner = null, this._orientation = null, this._position = null, this }, t.Panner3D }), t(function(t) { return t.PanVol = function() { var e = t.defaults(arguments, ["pan", "volume"], t.PanVol);
                t.AudioNode.call(this), this._panner = this.input = new t.Panner(e.pan), this.pan = this._panner.pan, this._volume = this.output = new t.Volume(e.volume), this.volume = this._volume.volume, this._panner.connect(this._volume), this.mute = e.mute, this._readOnly(["pan", "volume"]) }, t.extend(t.PanVol, t.AudioNode), t.PanVol.defaults = { pan: 0, volume: 0, mute: !1 }, Object.defineProperty(t.PanVol.prototype, "mute", { get: function() { return this._volume.mute }, set: function(t) { this._volume.mute = t } }), t.PanVol.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._writable(["pan", "volume"]), this._panner.dispose(), this._panner = null, this.pan = null, this._volume.dispose(), this._volume = null, this.volume = null, this }, t.PanVol }), t(function(t) { return t.Solo = function() { var e = t.defaults(arguments, ["solo"], t.Solo);
                t.AudioNode.call(this), this.input = this.output = new t.Gain, this._soloBind = this._soloed.bind(this), this.context.on("solo", this._soloBind), this.solo = e.solo }, t.extend(t.Solo, t.AudioNode), t.Solo.defaults = { solo: !1 }, Object.defineProperty(t.Solo.prototype, "solo", { get: function() { return this._isSoloed() }, set: function(t) { t ? this._addSolo() : this._removeSolo(), this.context.emit("solo", this) } }), Object.defineProperty(t.Solo.prototype, "muted", { get: function() { return 0 === this.input.gain.value } }), t.Solo.prototype._addSolo = function() { t.isArray(this.context._currentSolo) || (this.context._currentSolo = []), this._isSoloed() || this.context._currentSolo.push(this) }, t.Solo.prototype._removeSolo = function() { if (this._isSoloed()) { var t = this.context._currentSolo.indexOf(this);
                    this.context._currentSolo.splice(t, 1) } }, t.Solo.prototype._isSoloed = function() { return !!t.isArray(this.context._currentSolo) && (0 !== this.context._currentSolo.length && -1 !== this.context._currentSolo.indexOf(this)) }, t.Solo.prototype._noSolos = function() { return !t.isArray(this.context._currentSolo) || 0 === this.context._currentSolo.length }, t.Solo.prototype._soloed = function() { this._isSoloed() ? this.input.gain.value = 1 : this._noSolos() ? this.input.gain.value = 1 : this.input.gain.value = 0 }, t.Solo.prototype.dispose = function() { return this.context.off("solo", this._soloBind), this._removeSolo(), this._soloBind = null, t.AudioNode.prototype.dispose.call(this), this }, t.Solo }), t(function(t) { return t.Waveform = function() { var e = t.defaults(arguments, ["size"], t.Waveform);
                e.type = t.Analyser.Type.Waveform, t.AudioNode.call(this), this._analyser = this.input = this.output = new t.Analyser(e) }, t.extend(t.Waveform, t.AudioNode), t.Waveform.defaults = { size: 1024 }, t.Waveform.prototype.getValue = function() { return this._analyser.getValue() }, Object.defineProperty(t.Waveform.prototype, "size", { get: function() { return this._analyser.size }, set: function(t) { this._analyser.size = t } }), t.Waveform.prototype.dispose = function() { t.AudioNode.prototype.dispose.call(this), this._analyser.dispose(), this._analyser = null }, t.Waveform }), t(function(t) { return t.CtrlInterpolate = function() { var e = t.defaults(arguments, ["values", "index"], t.CtrlInterpolate);
                t.call(this), this.values = e.values, this.index = e.index }, t.extend(t.CtrlInterpolate), t.CtrlInterpolate.defaults = { index: 0, values: [] }, Object.defineProperty(t.CtrlInterpolate.prototype, "value", { get: function() { var t, e, i, n = this.index; return n = Math.min(n, this.values.length - 1), t = Math.floor(n), e = this.values[t], i = this.values[Math.ceil(n)], this._interpolate(n - t, e, i) } }), t.CtrlInterpolate.prototype._interpolate = function(e, i, n) { var s, o, r, a; if (t.isArray(i)) { for (s = [], o = 0; o < i.length; o++) s[o] = this._interpolate(e, i[o], n[o]); return s } if (t.isObject(i)) { r = {}; for (a in i) r[a] = this._interpolate(e, i[a], n[a]); return r } return i = this._toNumber(i), n = this._toNumber(n), (1 - e) * i + e * n }, t.CtrlInterpolate.prototype._toNumber = function(e) { return t.isNumber(e) ? e : this.toSeconds(e) }, t.CtrlInterpolate.prototype.dispose = function() { this.values = null }, t.CtrlInterpolate }), t(function(t) { return t.CtrlMarkov = function(e, i) { t.call(this), this.values = t.defaultArg(e, {}), this.value = t.defaultArg(i, Object.keys(this.values)[0]) }, t.extend(t.CtrlMarkov), t.CtrlMarkov.prototype.next = function() { var e, i, n, s, o, r, a; if (this.values.hasOwnProperty(this.value))
                    if (e = this.values[this.value], t.isArray(e))
                        for (i = this._getProbDistribution(e), n = Math.random(), s = 0, o = 0; o < i.length; o++) r = i[o], n > s && n < s + r && (a = e[o], t.isObject(a) ? this.value = a.value : this.value = a), s += r;
                    else this.value = e; return this.value }, t.CtrlMarkov.prototype._getProbDistribution = function(e) { var i, n, s, o = [],
                    r = 0,
                    a = !1; for (i = 0; i < e.length; i++) n = e[i], t.isObject(n) ? (a = !0, o[i] = n.probability) : o[i] = 1 / e.length, r += o[i]; if (a)
                    for (s = 0; s < o.length; s++) o[s] = o[s] / r; return o }, t.CtrlMarkov.prototype.dispose = function() { this.values = null }, t.CtrlMarkov }), t(function(t) { return t.CtrlPattern = function() { var e = t.defaults(arguments, ["values", "type"], t.CtrlPattern);
                t.call(this), this.values = e.values, this.index = 0, this._type = null, this._shuffled = null, this._direction = null, this.type = e.type }, t.extend(t.CtrlPattern), t.CtrlPattern.Type = { Up: "up", Down: "down", UpDown: "upDown", DownUp: "downUp", AlternateUp: "alternateUp", AlternateDown: "alternateDown", Random: "random", RandomWalk: "randomWalk", RandomOnce: "randomOnce" }, t.CtrlPattern.defaults = { type: t.CtrlPattern.Type.Up, values: [] }, Object.defineProperty(t.CtrlPattern.prototype, "value", { get: function() { if (0 !== this.values.length) { if (1 === this.values.length) return this.values[0];
                        this.index = Math.min(this.index, this.values.length - 1); var e = this.values[this.index]; return this.type === t.CtrlPattern.Type.RandomOnce && (this.values.length !== this._shuffled.length && this._shuffleValues(), e = this.values[this._shuffled[this.index]]), e } } }), Object.defineProperty(t.CtrlPattern.prototype, "type", { get: function() { return this._type }, set: function(e) { this._type = e, this._shuffled = null, this._type === t.CtrlPattern.Type.Up || this._type === t.CtrlPattern.Type.UpDown || this._type === t.CtrlPattern.Type.RandomOnce || this._type === t.CtrlPattern.Type.AlternateUp ? this.index = 0 : this._type !== t.CtrlPattern.Type.Down && this._type !== t.CtrlPattern.Type.DownUp && this._type !== t.CtrlPattern.Type.AlternateDown || (this.index = this.values.length - 1), this._type === t.CtrlPattern.Type.UpDown || this._type === t.CtrlPattern.Type.AlternateUp ? this._direction = t.CtrlPattern.Type.Up : this._type !== t.CtrlPattern.Type.DownUp && this._type !== t.CtrlPattern.Type.AlternateDown || (this._direction = t.CtrlPattern.Type.Down), this._type === t.CtrlPattern.Type.RandomOnce ? this._shuffleValues() : this._type === t.CtrlPattern.Random && (this.index = Math.floor(Math.random() * this.values.length)) } }), t.CtrlPattern.prototype.next = function() { var e = this.type; return e === t.CtrlPattern.Type.Up ? ++this.index >= this.values.length && (this.index = 0) : e === t.CtrlPattern.Type.Down ? --this.index < 0 && (this.index = this.values.length - 1) : e === t.CtrlPattern.Type.UpDown || e === t.CtrlPattern.Type.DownUp ? (this._direction === t.CtrlPattern.Type.Up ? this.index++ : this.index--, this.index < 0 ? (this.index = 1, this._direction = t.CtrlPattern.Type.Up) : this.index >= this.values.length && (this.index = this.values.length - 2, this._direction = t.CtrlPattern.Type.Down)) : e === t.CtrlPattern.Type.Random ? this.index = Math.floor(Math.random() * this.values.length) : e === t.CtrlPattern.Type.RandomWalk ? Math.random() < .5 ? (this.index--, this.index = Math.max(this.index, 0)) : (this.index++, this.index = Math.min(this.index, this.values.length - 1)) : e === t.CtrlPattern.Type.RandomOnce ? ++this.index >= this.values.length && (this.index = 0, this._shuffleValues()) : e === t.CtrlPattern.Type.AlternateUp ? (this._direction === t.CtrlPattern.Type.Up ? (this.index += 2, this._direction = t.CtrlPattern.Type.Down) : (this.index -= 1, this._direction = t.CtrlPattern.Type.Up), this.index >= this.values.length && (this.index = 0, this._direction = t.CtrlPattern.Type.Up)) : e === t.CtrlPattern.Type.AlternateDown && (this._direction === t.CtrlPattern.Type.Up ? (this.index += 1, this._direction = t.CtrlPattern.Type.Down) : (this.index -= 2, this._direction = t.CtrlPattern.Type.Up), this.index < 0 && (this.index = this.values.length - 1, this._direction = t.CtrlPattern.Type.Down)), this.value }, t.CtrlPattern.prototype._shuffleValues = function() { var t, e, i = []; for (this._shuffled = [], t = 0; t < this.values.length; t++) i[t] = t; for (; i.length > 0;) e = i.splice(Math.floor(i.length * Math.random()), 1), this._shuffled.push(e[0]) }, t.CtrlPattern.prototype.dispose = function() { this._shuffled = null, this.values = null }, t.CtrlPattern }), t(function(t) { return t.CtrlRandom = function() { var e = t.defaults(arguments, ["min", "max"], t.CtrlRandom);
                t.call(this), this.min = e.min, this.max = e.max, this.integer = e.integer }, t.extend(t.CtrlRandom), t.CtrlRandom.defaults = { min: 0, max: 1, integer: !1 }, Object.defineProperty(t.CtrlRandom.prototype, "value", { get: function() { var t = this.toSeconds(this.min),
                        e = this.toSeconds(this.max),
                        i = Math.random(),
                        n = i * t + (1 - i) * e; return this.integer && (n = Math.floor(n)), n } }), t.CtrlRandom }), t(function(t) { t.supported && (AudioBuffer.prototype.copyToChannel || (AudioBuffer.prototype.copyToChannel = function(t, e, i) { var n, s = this.getChannelData(e); for (i = i || 0, n = 0; n < s.length; n++) s[n + i] = t[n] }, AudioBuffer.prototype.copyFromChannel = function(t, e, i) { var n, s = this.getChannelData(e); for (i = i || 0, n = 0; n < t.length; n++) t[n] = s[n + i] })) }), t(function(t) {
            return t.Buffer = function() { var e = t.defaults(arguments, ["url", "onload", "onerror"], t.Buffer);
                t.call(this), this._buffer = null, this._reversed = e.reverse, this._xhr = null, e.url instanceof AudioBuffer || e.url instanceof t.Buffer ? (this.set(e.url), e.onload && e.onload(this)) : t.isString(e.url) && this.load(e.url, e.onload, e.onerror) }, t.extend(t.Buffer), t.Buffer.defaults = { url: void 0, reverse: !1 }, t.Buffer.prototype.set = function(e) { return e instanceof t.Buffer ? this._buffer = e.get() : this._buffer = e, this }, t.Buffer.prototype.get = function() { return this._buffer }, t.Buffer.prototype.load = function(e, i, n) { return new Promise(function(s, o) { this._xhr = t.Buffer.load(e, function(t) { this._xhr = null, this.set(t), s(this), i && i(this) }.bind(this), function(t) { this._xhr = null, o(t), n && n(t) }.bind(this)) }.bind(this)) }, t.Buffer.prototype.dispose = function() { return t.prototype.dispose.call(this), this._buffer = null, this._xhr && (t.Buffer._removeFromDownloadQueue(this._xhr), this._xhr.abort(), this._xhr = null), this }, Object.defineProperty(t.Buffer.prototype, "loaded", { get: function() { return this.length > 0 } }), Object.defineProperty(t.Buffer.prototype, "duration", { get: function() { return this._buffer ? this._buffer.duration : 0 } }), Object.defineProperty(t.Buffer.prototype, "length", { get: function() { return this._buffer ? this._buffer.length : 0 } }), Object.defineProperty(t.Buffer.prototype, "numberOfChannels", { get: function() { return this._buffer ? this._buffer.numberOfChannels : 0 } }), t.Buffer.prototype.fromArray = function(t) { var e, i = t[0].length > 0,
                    n = i ? t.length : 1,
                    s = i ? t[0].length : t.length,
                    o = this.context.createBuffer(n, s, this.context.sampleRate); for (i || 1 !== n || (t = [t]), e = 0; e < n; e++) o.copyToChannel(t[e], e); return this._buffer = o, this }, t.Buffer.prototype.toMono = function(e) { var i, n, s, o, r; if (t.isNumber(e)) this.fromArray(this.toArray(e));
                else { for (i = new Float32Array(this.length), n = this.numberOfChannels, s = 0; s < n; s++)
                        for (o = this.toArray(s), r = 0; r < o.length; r++) i[r] += o[r];
                    i = i.map(function(t) { return t / n }), this.fromArray(i) } return this }, t.Buffer.prototype.toArray = function(e) { var i, n; if (t.isNumber(e)) return this.getChannelData(e); if (1 === this.numberOfChannels) return this.toArray(0); for (i = [], n = 0; n < this.numberOfChannels; n++) i[n] = this.getChannelData(n); return i }, t.Buffer.prototype.getChannelData = function(t) { return this._buffer.getChannelData(t) }, t.Buffer.prototype.slice = function(e, i) { var n, s, o, r; for (i = t.defaultArg(i, this.duration), n = Math.floor(this.context.sampleRate * this.toSeconds(e)), s = Math.floor(this.context.sampleRate * this.toSeconds(i)), o = [], r = 0; r < this.numberOfChannels; r++) o[r] = this.toArray(r).slice(n, s); return (new t.Buffer).fromArray(o) }, t.Buffer.prototype._reverse = function() { if (this.loaded)
                    for (var t = 0; t < this.numberOfChannels; t++) Array.prototype.reverse.call(this.getChannelData(t)); return this }, Object.defineProperty(t.Buffer.prototype, "reverse", { get: function() { return this._reversed }, set: function(t) { this._reversed !== t && (this._reversed = t, this._reverse()) } }), t.Emitter.mixin(t.Buffer), t.Buffer._downloadQueue = [], t.Buffer.baseUrl = "", t.Buffer.fromArray = function(e) { return (new t.Buffer).fromArray(e) }, t.Buffer._removeFromDownloadQueue = function(e) { var i = t.Buffer._downloadQueue.indexOf(e); - 1 !== i && t.Buffer._downloadQueue.splice(i, 1) }, t.Buffer.load = function(e, i, n) {
                function s(e) { if (t.Buffer._removeFromDownloadQueue(u), t.Buffer.emit("error", e), !n) throw e;
                    n(e) }

                function o() { var e, i = 0; for (e = 0; e < t.Buffer._downloadQueue.length; e++) i += t.Buffer._downloadQueue[e].progress;
                    t.Buffer.emit("progress", i / t.Buffer._downloadQueue.length) }
                var r, a, l, h, u;
                if (i = t.defaultArg(i, t.noOp), r = e.match(/\[(.+\|?)+\]$/)) { for (a = r[1].split("|"), l = a[0], h = 0; h < a.length; h++)
                        if (t.Buffer.supportsType(a[h])) { l = a[h]; break } e = e.replace(r[0], l) }
                return u = new XMLHttpRequest, u.open("GET", t.Buffer.baseUrl + e, !0), u.responseType = "arraybuffer", u.progress = 0, t.Buffer._downloadQueue.push(u), u.addEventListener("load", function() { 200 === u.status ? t.context.decodeAudioData(u.response, function(e) { u.progress = 1, o(), i(e), t.Buffer._removeFromDownloadQueue(u), 0 === t.Buffer._downloadQueue.length && t.Buffer.emit("load") }, function() { t.Buffer._removeFromDownloadQueue(u), s("Tone.Buffer: could not decode audio data: " + e) }) : s("Tone.Buffer: could not locate file: " + e) }), u.addEventListener("error", s), u.addEventListener("progress", function(t) { t.lengthComputable && (u.progress = t.loaded / t.total * .95, o()) }), u.send(), u
            }, t.Buffer.cancelDownloads = function() { return t.Buffer._downloadQueue.slice().forEach(function(e) { t.Buffer._removeFromDownloadQueue(e), e.abort() }), t.Buffer }, t.Buffer.supportsType = function(t) { var e = t.split("."); return e = e[e.length - 1], "" !== document.createElement("audio").canPlayType("audio/" + e) }, t.loaded = function() {
                function e() { t.Buffer.off("load", i), t.Buffer.off("error", n) } var i, n; return new Promise(function(e, s) { i = function() { e() }, n = function() { s() }, t.Buffer.on("load", i), t.Buffer.on("error", n) }).then(e).catch(function(t) { throw e(), new Error(t) }) }, t.Buffer
        }), t(function(t) { return t.Buffers = function(e) { var i, n, s = Array.prototype.slice.call(arguments);
                s.shift(), i = t.defaults(s, ["onload", "baseUrl"], t.Buffers), t.call(this), this._buffers = {}, this.baseUrl = i.baseUrl, this._loadingCount = 0; for (n in e) this._loadingCount++, this.add(n, e[n], this._bufferLoaded.bind(this, i.onload)) }, t.extend(t.Buffers), t.Buffers.defaults = { onload: t.noOp, baseUrl: "" }, t.Buffers.prototype.has = function(t) { return this._buffers.hasOwnProperty(t) }, t.Buffers.prototype.get = function(t) { if (this.has(t)) return this._buffers[t]; throw new Error("Tone.Buffers: no buffer named " + t) }, t.Buffers.prototype._bufferLoaded = function(t) { 0 === --this._loadingCount && t && t(this) }, Object.defineProperty(t.Buffers.prototype, "loaded", { get: function() { var t, e, i = !0; for (t in this._buffers) e = this.get(t), i = i && e.loaded; return i } }), t.Buffers.prototype.add = function(e, i, n) { return n = t.defaultArg(n, t.noOp), i instanceof t.Buffer ? (this._buffers[e] = i, n(this)) : i instanceof AudioBuffer ? (this._buffers[e] = new t.Buffer(i), n(this)) : t.isString(i) && (this._buffers[e] = new t.Buffer(this.baseUrl + i, n)), this }, t.Buffers.prototype.dispose = function() { t.prototype.dispose.call(this); for (var e in this._buffers) this._buffers[e].dispose(); return this._buffers = null, this }, t.Buffers }), t(function(t) { var e = {}; return t.prototype.send = function(i, n) { e.hasOwnProperty(i) || (e[i] = this.context.createGain()), n = t.defaultArg(n, 0); var s = new t.Gain(n, t.Type.Decibels); return this.output.chain(s, e[i]), s }, t.prototype.receive = function(t, i) { return e.hasOwnProperty(t) || (e[t] = this.context.createGain()), e[t].connect(this, 0, i), this }, t.Context.on("init", function(t) { t.Buses ? e = t.Buses : (e = {}, t.Buses = e) }), t }), t(function(t) { return t.Draw = function() { t.call(this), this._events = new t.Timeline, this.expiration = .25, this.anticipation = .008, this._boundDrawLoop = this._drawLoop.bind(this) }, t.extend(t.Draw), t.Draw.prototype.schedule = function(t, e) { return this._events.add({ callback: t, time: this.toSeconds(e) }), 1 === this._events.length && requestAnimationFrame(this._boundDrawLoop), this }, t.Draw.prototype.cancel = function(t) { return this._events.cancel(this.toSeconds(t)), this }, t.Draw.prototype._drawLoop = function() { for (var e, i = t.now(); this._events.length && this._events.peek().time - this.anticipation <= i;) e = this._events.shift(), i - e.time <= this.expiration && e.callback();
                this._events.length > 0 && requestAnimationFrame(this._boundDrawLoop) }, t.Draw = new t.Draw, t.Draw }), t(function(t) { t.Listener = function() { t.call(this), this._orientation = [0, 0, 0, 0, 0, 0], this._position = [0, 0, 0], t.getContext(function() { this.set(e.defaults) }.bind(this)) }, t.extend(t.Listener), t.Listener.defaults = { positionX: 0, positionY: 0, positionZ: 0, forwardX: 0, forwardY: 0, forwardZ: 1, upX: 0, upY: 1, upZ: 0 }, t.Listener.prototype._rampTimeConstant = .01, t.Listener.prototype.setPosition = function(t, e, i) { if (this.context.listener.positionX) { var n = this.now();
                    this.context.listener.positionX.setTargetAtTime(t, n, this._rampTimeConstant), this.context.listener.positionY.setTargetAtTime(e, n, this._rampTimeConstant), this.context.listener.positionZ.setTargetAtTime(i, n, this._rampTimeConstant) } else this.context.listener.setPosition(t, e, i); return this._position = Array.prototype.slice.call(arguments), this }, t.Listener.prototype.setOrientation = function(t, e, i, n, s, o) { if (this.context.listener.forwardX) { var r = this.now();
                    this.context.listener.forwardX.setTargetAtTime(t, r, this._rampTimeConstant), this.context.listener.forwardY.setTargetAtTime(e, r, this._rampTimeConstant), this.context.listener.forwardZ.setTargetAtTime(i, r, this._rampTimeConstant), this.context.listener.upX.setTargetAtTime(n, r, this._rampTimeConstant), this.context.listener.upY.setTargetAtTime(s, r, this._rampTimeConstant), this.context.listener.upZ.setTargetAtTime(o, r, this._rampTimeConstant) } else this.context.listener.setOrientation(t, e, i, n, s, o); return this._orientation = Array.prototype.slice.call(arguments), this }, Object.defineProperty(t.Listener.prototype, "positionX", { set: function(t) { this._position[0] = t, this.setPosition.apply(this, this._position) }, get: function() { return this._position[0] } }), Object.defineProperty(t.Listener.prototype, "positionY", { set: function(t) { this._position[1] = t, this.setPosition.apply(this, this._position) }, get: function() { return this._position[1] } }), Object.defineProperty(t.Listener.prototype, "positionZ", { set: function(t) { this._position[2] = t, this.setPosition.apply(this, this._position) }, get: function() { return this._position[2] } }), Object.defineProperty(t.Listener.prototype, "forwardX", { set: function(t) { this._orientation[0] = t, this.setOrientation.apply(this, this._orientation) }, get: function() { return this._orientation[0] } }), Object.defineProperty(t.Listener.prototype, "forwardY", { set: function(t) { this._orientation[1] = t, this.setOrientation.apply(this, this._orientation) }, get: function() { return this._orientation[1] } }), Object.defineProperty(t.Listener.prototype, "forwardZ", { set: function(t) { this._orientation[2] = t, this.setOrientation.apply(this, this._orientation) }, get: function() { return this._orientation[2] } }), Object.defineProperty(t.Listener.prototype, "upX", { set: function(t) { this._orientation[3] = t, this.setOrientation.apply(this, this._orientation) }, get: function() { return this._orientation[3] } }), Object.defineProperty(t.Listener.prototype, "upY", { set: function(t) { this._orientation[4] = t, this.setOrientation.apply(this, this._orientation) }, get: function() { return this._orientation[4] } }), Object.defineProperty(t.Listener.prototype, "upZ", { set: function(t) { this._orientation[5] = t, this.setOrientation.apply(this, this._orientation) }, get: function() { return this._orientation[5] } }), t.Listener.prototype.dispose = function() { return this._orientation = null, this._position = null, this }; var e = t.Listener; return t.Listener = new e, t.Context.on("init", function(i) { i.Listener instanceof e ? t.Listener = i.Listener : t.Listener = new e, i.Listener = t.Listener }), t.Listener }), t(function(t) { var e;
            t.supported && (!window.hasOwnProperty("OfflineAudioContext") && window.hasOwnProperty("webkitOfflineAudioContext") && (window.OfflineAudioContext = window.webkitOfflineAudioContext), e = new OfflineAudioContext(1, 1, 44100), e.startRendering() instanceof Promise || (OfflineAudioContext.prototype._native_startRendering = OfflineAudioContext.prototype.startRendering, OfflineAudioContext.prototype.startRendering = function() { return new Promise(function(t) { this.oncomplete = function(e) { t(e.renderedBuffer) }, this._native_startRendering() }.bind(this)) })) }), t(function(t) { return t.OfflineContext = function(e, i, n) { var s = new OfflineAudioContext(e, i * n, n);
                t.Context.call(this, { context: s, clockSource: "offline", lookAhead: 0, updateInterval: 128 / n }), this._duration = i, this._currentTime = 0 }, t.extend(t.OfflineContext, t.Context), t.OfflineContext.prototype.now = function() { return this._currentTime }, t.OfflineContext.prototype.render = function() { for (; this._duration - this._currentTime >= 0;) this.emit("tick"), this._currentTime += this.blockTime; return this._context.startRendering() }, t.OfflineContext.prototype.close = function() { return this._context = null, Promise.resolve() }, t.OfflineContext }), t(function(t) { return t.Offline = function(e, i) { var n, s = t.context.sampleRate,
                    o = t.context,
                    r = new t.OfflineContext(2, i, s); return t.context = r, e(t.Transport), n = r.render(), t.context = o, n.then(function(e) { return new t.Buffer(e) }) }, t.Offline }), t(function(t) { return t.Effect = function() { var e = t.defaults(arguments, ["wet"], t.Effect);
                t.AudioNode.call(this), this.createInsOuts(1, 1), this._dryWet = new t.CrossFade(e.wet), this.wet = this._dryWet.fade, this.effectSend = new t.Gain, this.effectReturn = new t.Gain, this.input.connect(this._dryWet.a), this.input.connect(this.effectSend), this.effectReturn.connect(this._dryWet.b), this._dryWet.connect(this.output), this._readOnly(["wet"]) }, t.extend(t.Effect, t.AudioNode), t.Effect.defaults = { wet: 1 }, t.Effect.prototype.connectEffect = function(t) { return this.effectSend.chain(t, this.effectReturn), this }, t.Effect.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._dryWet.dispose(), this._dryWet = null, this.effectSend.dispose(), this.effectSend = null, this.effectReturn.dispose(), this.effectReturn = null, this._writable(["wet"]), this.wet = null, this }, t.Effect }), t(function(t) { return t.AutoFilter = function() { var e = t.defaults(arguments, ["frequency", "baseFrequency", "octaves"], t.AutoFilter);
                t.Effect.call(this, e), this._lfo = new t.LFO({ frequency: e.frequency, amplitude: e.depth }), this.depth = this._lfo.amplitude, this.frequency = this._lfo.frequency, this.filter = new t.Filter(e.filter), this._octaves = 0, this.connectEffect(this.filter), this._lfo.connect(this.filter.frequency), this.type = e.type, this._readOnly(["frequency", "depth"]), this.octaves = e.octaves, this.baseFrequency = e.baseFrequency }, t.extend(t.AutoFilter, t.Effect), t.AutoFilter.defaults = { frequency: 1, type: "sine", depth: 1, baseFrequency: 200, octaves: 2.6, filter: { type: "lowpass", rolloff: -12, Q: 1 } }, t.AutoFilter.prototype.start = function(t) { return this._lfo.start(t), this }, t.AutoFilter.prototype.stop = function(t) { return this._lfo.stop(t), this }, t.AutoFilter.prototype.sync = function(t) { return this._lfo.sync(t), this }, t.AutoFilter.prototype.unsync = function() { return this._lfo.unsync(), this }, Object.defineProperty(t.AutoFilter.prototype, "type", { get: function() { return this._lfo.type }, set: function(t) { this._lfo.type = t } }), Object.defineProperty(t.AutoFilter.prototype, "baseFrequency", { get: function() { return this._lfo.min }, set: function(t) { this._lfo.min = this.toFrequency(t), this.octaves = this._octaves } }), Object.defineProperty(t.AutoFilter.prototype, "octaves", { get: function() { return this._octaves }, set: function(t) { this._octaves = t, this._lfo.max = this.baseFrequency * Math.pow(2, t) } }), t.AutoFilter.prototype.dispose = function() { return t.Effect.prototype.dispose.call(this), this._lfo.dispose(), this._lfo = null, this.filter.dispose(), this.filter = null, this._writable(["frequency", "depth"]), this.frequency = null, this.depth = null, this }, t.AutoFilter }), t(function(t) { return t.AutoPanner = function() { var e = t.defaults(arguments, ["frequency"], t.AutoPanner);
                t.Effect.call(this, e), this._lfo = new t.LFO({ frequency: e.frequency, amplitude: e.depth, min: -1, max: 1 }), this.depth = this._lfo.amplitude, this._panner = new t.Panner, this.frequency = this._lfo.frequency, this.connectEffect(this._panner), this._lfo.connect(this._panner.pan), this.type = e.type, this._readOnly(["depth", "frequency"]) }, t.extend(t.AutoPanner, t.Effect), t.AutoPanner.defaults = { frequency: 1, type: "sine", depth: 1 }, t.AutoPanner.prototype.start = function(t) { return this._lfo.start(t), this }, t.AutoPanner.prototype.stop = function(t) { return this._lfo.stop(t), this }, t.AutoPanner.prototype.sync = function(t) { return this._lfo.sync(t), this }, t.AutoPanner.prototype.unsync = function() { return this._lfo.unsync(), this }, Object.defineProperty(t.AutoPanner.prototype, "type", { get: function() { return this._lfo.type }, set: function(t) { this._lfo.type = t } }), t.AutoPanner.prototype.dispose = function() { return t.Effect.prototype.dispose.call(this), this._lfo.dispose(), this._lfo = null, this._panner.dispose(), this._panner = null, this._writable(["depth", "frequency"]), this.frequency = null, this.depth = null, this }, t.AutoPanner }), t(function(t) { return t.AutoWah = function() { var e = t.defaults(arguments, ["baseFrequency", "octaves", "sensitivity"], t.AutoWah);
                t.Effect.call(this, e), this.follower = new t.Follower(e.follower), this._sweepRange = new t.ScaleExp(0, 1, .5), this._baseFrequency = e.baseFrequency, this._octaves = e.octaves, this._inputBoost = new t.Gain, this._bandpass = new t.Filter({ rolloff: -48, frequency: 0, Q: e.Q }), this._peaking = new t.Filter(0, "peaking"), this._peaking.gain.value = e.gain, this.gain = this._peaking.gain, this.Q = this._bandpass.Q, this.effectSend.chain(this._inputBoost, this.follower, this._sweepRange), this._sweepRange.connect(this._bandpass.frequency), this._sweepRange.connect(this._peaking.frequency), this.effectSend.chain(this._bandpass, this._peaking, this.effectReturn), this._setSweepRange(), this.sensitivity = e.sensitivity, this._readOnly(["gain", "Q"]) }, t.extend(t.AutoWah, t.Effect), t.AutoWah.defaults = { baseFrequency: 100, octaves: 6, sensitivity: 0, Q: 2, gain: 2, follower: { attack: .3, release: .5 } }, Object.defineProperty(t.AutoWah.prototype, "octaves", { get: function() { return this._octaves }, set: function(t) { this._octaves = t, this._setSweepRange() } }), Object.defineProperty(t.AutoWah.prototype, "baseFrequency", { get: function() { return this._baseFrequency }, set: function(t) { this._baseFrequency = t, this._setSweepRange() } }), Object.defineProperty(t.AutoWah.prototype, "sensitivity", { get: function() { return t.gainToDb(1 / this._inputBoost.gain.value) }, set: function(e) { this._inputBoost.gain.value = 1 / t.dbToGain(e) } }), t.AutoWah.prototype._setSweepRange = function() { this._sweepRange.min = this._baseFrequency, this._sweepRange.max = Math.min(this._baseFrequency * Math.pow(2, this._octaves), this.context.sampleRate / 2) }, t.AutoWah.prototype.dispose = function() { return t.Effect.prototype.dispose.call(this), this.follower.dispose(), this.follower = null, this._sweepRange.dispose(), this._sweepRange = null, this._bandpass.dispose(), this._bandpass = null, this._peaking.dispose(), this._peaking = null, this._inputBoost.dispose(), this._inputBoost = null, this._writable(["gain", "Q"]), this.gain = null, this.Q = null, this }, t.AutoWah }), t(function(t) { return t.Modulo = function(e) { t.SignalBase.call(this), this.createInsOuts(1, 0), this._shaper = new t.WaveShaper(Math.pow(2, 16)), this._multiply = new t.Multiply, this._subtract = this.output = new t.Subtract, this._modSignal = new t.Signal(e), this.input.fan(this._shaper, this._subtract), this._modSignal.connect(this._multiply, 0, 0), this._shaper.connect(this._multiply, 0, 1), this._multiply.connect(this._subtract, 0, 1), this._setWaveShaper(e) }, t.extend(t.Modulo, t.SignalBase), t.Modulo.prototype._setWaveShaper = function(t) { this._shaper.setMap(function(e) { return Math.floor((e + 1e-4) / t) }) }, Object.defineProperty(t.Modulo.prototype, "value", { get: function() { return this._modSignal.value }, set: function(t) { this._modSignal.value = t, this._setWaveShaper(t) } }), t.Modulo.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._shaper.dispose(), this._shaper = null, this._multiply.dispose(), this._multiply = null, this._subtract.dispose(), this._subtract = null, this._modSignal.dispose(), this._modSignal = null, this }, t.Modulo }), t(function(t) { return t.BitCrusher = function() { var e, i = t.defaults(arguments, ["bits"], t.BitCrusher);
                t.Effect.call(this, i), e = 1 / Math.pow(2, i.bits - 1), this._subtract = new t.Subtract, this._modulo = new t.Modulo(e), this._bits = i.bits, this.effectSend.fan(this._subtract, this._modulo), this._modulo.connect(this._subtract, 0, 1), this._subtract.connect(this.effectReturn) }, t.extend(t.BitCrusher, t.Effect), t.BitCrusher.defaults = { bits: 4 }, Object.defineProperty(t.BitCrusher.prototype, "bits", { get: function() { return this._bits }, set: function(t) { this._bits = t; var e = 1 / Math.pow(2, t - 1);
                    this._modulo.value = e } }), t.BitCrusher.prototype.dispose = function() { return t.Effect.prototype.dispose.call(this), this._subtract.dispose(), this._subtract = null, this._modulo.dispose(), this._modulo = null, this }, t.BitCrusher }), t(function(t) { return t.Chebyshev = function() { var e = t.defaults(arguments, ["order"], t.Chebyshev);
                t.Effect.call(this, e), this._shaper = new t.WaveShaper(4096), this._order = e.order, this.connectEffect(this._shaper), this.order = e.order, this.oversample = e.oversample }, t.extend(t.Chebyshev, t.Effect), t.Chebyshev.defaults = { order: 1, oversample: "none" }, t.Chebyshev.prototype._getCoefficient = function(t, e, i) { return i.hasOwnProperty(e) ? i[e] : (i[e] = 0 === e ? 0 : 1 === e ? t : 2 * t * this._getCoefficient(t, e - 1, i) - this._getCoefficient(t, e - 2, i), i[e]) }, Object.defineProperty(t.Chebyshev.prototype, "order", { get: function() { return this._order }, set: function(t) { var e, i, n, s; for (this._order = t, e = new Array(4096), i = e.length, n = 0; n < i; ++n) s = 2 * n / i - 1, e[n] = 0 === s ? 0 : this._getCoefficient(s, t, {});
                    this._shaper.curve = e } }), Object.defineProperty(t.Chebyshev.prototype, "oversample", { get: function() { return this._shaper.oversample }, set: function(t) { this._shaper.oversample = t } }), t.Chebyshev.prototype.dispose = function() { return t.Effect.prototype.dispose.call(this), this._shaper.dispose(), this._shaper = null, this }, t.Chebyshev }), t(function(t) { return t.StereoEffect = function() { t.AudioNode.call(this); var e = t.defaults(arguments, ["wet"], t.Effect);
                this.createInsOuts(1, 1), this._dryWet = new t.CrossFade(e.wet), this.wet = this._dryWet.fade, this._split = new t.Split, this.effectSendL = this._split.left, this.effectSendR = this._split.right, this._merge = new t.Merge, this.effectReturnL = this._merge.left, this.effectReturnR = this._merge.right, this.input.connect(this._split), this.input.connect(this._dryWet, 0, 0), this._merge.connect(this._dryWet, 0, 1), this._dryWet.connect(this.output), this._readOnly(["wet"]) }, t.extend(t.StereoEffect, t.Effect), t.StereoEffect.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._dryWet.dispose(), this._dryWet = null, this._split.dispose(), this._split = null, this._merge.dispose(), this._merge = null, this.effectSendL = null, this.effectSendR = null, this.effectReturnL = null, this.effectReturnR = null, this._writable(["wet"]), this.wet = null, this }, t.StereoEffect }), t(function(t) { return t.Chorus = function() { var e = t.defaults(arguments, ["frequency", "delayTime", "depth"], t.Chorus);
                t.StereoEffect.call(this, e), this._depth = e.depth, this._delayTime = e.delayTime / 1e3, this._lfoL = new t.LFO({ frequency: e.frequency, min: 0, max: 1 }), this._lfoR = new t.LFO({ frequency: e.frequency, min: 0, max: 1, phase: 180 }), this._delayNodeL = new t.Delay, this._delayNodeR = new t.Delay, this.frequency = this._lfoL.frequency, this.effectSendL.chain(this._delayNodeL, this.effectReturnL), this.effectSendR.chain(this._delayNodeR, this.effectReturnR), this.effectSendL.connect(this.effectReturnL), this.effectSendR.connect(this.effectReturnR), this._lfoL.connect(this._delayNodeL.delayTime), this._lfoR.connect(this._delayNodeR.delayTime), this._lfoL.start(), this._lfoR.start(), this._lfoL.frequency.connect(this._lfoR.frequency), this.depth = this._depth, this.frequency.value = e.frequency, this.type = e.type, this._readOnly(["frequency"]), this.spread = e.spread }, t.extend(t.Chorus, t.StereoEffect), t.Chorus.defaults = { frequency: 1.5, delayTime: 3.5, depth: .7, type: "sine", spread: 180 }, Object.defineProperty(t.Chorus.prototype, "depth", { get: function() { return this._depth }, set: function(t) { this._depth = t; var e = this._delayTime * t;
                    this._lfoL.min = Math.max(this._delayTime - e, 0), this._lfoL.max = this._delayTime + e, this._lfoR.min = Math.max(this._delayTime - e, 0), this._lfoR.max = this._delayTime + e } }), Object.defineProperty(t.Chorus.prototype, "delayTime", { get: function() { return 1e3 * this._delayTime }, set: function(t) { this._delayTime = t / 1e3, this.depth = this._depth } }), Object.defineProperty(t.Chorus.prototype, "type", { get: function() { return this._lfoL.type }, set: function(t) { this._lfoL.type = t, this._lfoR.type = t } }), Object.defineProperty(t.Chorus.prototype, "spread", { get: function() { return this._lfoR.phase - this._lfoL.phase }, set: function(t) { this._lfoL.phase = 90 - t / 2, this._lfoR.phase = t / 2 + 90 } }), t.Chorus.prototype.dispose = function() { return t.StereoEffect.prototype.dispose.call(this), this._lfoL.dispose(), this._lfoL = null, this._lfoR.dispose(), this._lfoR = null, this._delayNodeL.dispose(), this._delayNodeL = null, this._delayNodeR.dispose(), this._delayNodeR = null, this._writable("frequency"), this.frequency = null, this }, t.Chorus }), t(function(t) { return t.Convolver = function() { var e = t.defaults(arguments, ["url", "onload"], t.Convolver);
                t.Effect.call(this, e), this._convolver = this.context.createConvolver(), this._buffer = new t.Buffer, t.isString(e.url) ? this._buffer.load(e.url, function(t) { this.buffer = t, e.onload() }.bind(this)) : e.url && (this.buffer = e.url, e.onload()), this.connectEffect(this._convolver) }, t.extend(t.Convolver, t.Effect), t.Convolver.defaults = { onload: t.noOp }, Object.defineProperty(t.Convolver.prototype, "buffer", { get: function() { return this._buffer.get() }, set: function(t) { this._buffer.set(t), this._convolver.buffer = this._buffer.get() } }), t.Convolver.prototype.load = function(t, e) { return this._buffer.load(t, function(t) { this.buffer = t, e && e() }.bind(this)) }, t.Convolver.prototype.dispose = function() { return t.Effect.prototype.dispose.call(this), this._convolver.disconnect(), this._convolver = null, this._buffer.dispose(), this._buffer = null, this }, t.Convolver }), t(function(t) { return t.Distortion = function() { var e = t.defaults(arguments, ["distortion"], t.Distortion);
                t.Effect.call(this, e), this._shaper = new t.WaveShaper(4096), this._distortion = e.distortion, this.connectEffect(this._shaper), this.distortion = e.distortion, this.oversample = e.oversample }, t.extend(t.Distortion, t.Effect), t.Distortion.defaults = { distortion: .4, oversample: "none" }, Object.defineProperty(t.Distortion.prototype, "distortion", { get: function() { return this._distortion }, set: function(t) { var e, i;
                    this._distortion = t, e = 100 * t, i = Math.PI / 180, this._shaper.setMap(function(t) { return Math.abs(t) < .001 ? 0 : (3 + e) * t * 20 * i / (Math.PI + e * Math.abs(t)) }) } }), Object.defineProperty(t.Distortion.prototype, "oversample", { get: function() { return this._shaper.oversample }, set: function(t) { this._shaper.oversample = t } }), t.Distortion.prototype.dispose = function() { return t.Effect.prototype.dispose.call(this), this._shaper.dispose(), this._shaper = null, this }, t.Distortion }), t(function(t) { return t.FeedbackEffect = function() { var e = t.defaults(arguments, ["feedback"], t.FeedbackEffect);
                t.Effect.call(this, e), this._feedbackGain = new t.Gain(e.feedback, t.Type.NormalRange), this.feedback = this._feedbackGain.gain, this.effectReturn.chain(this._feedbackGain, this.effectSend), this._readOnly(["feedback"]) }, t.extend(t.FeedbackEffect, t.Effect), t.FeedbackEffect.defaults = { feedback: .125 }, t.FeedbackEffect.prototype.dispose = function() { return t.Effect.prototype.dispose.call(this), this._writable(["feedback"]), this._feedbackGain.dispose(), this._feedbackGain = null, this.feedback = null, this }, t.FeedbackEffect }), t(function(t) { return t.FeedbackDelay = function() { var e = t.defaults(arguments, ["delayTime", "feedback"], t.FeedbackDelay);
                t.FeedbackEffect.call(this, e), this._delayNode = new t.Delay(e.delayTime), this.delayTime = this._delayNode.delayTime, this.connectEffect(this._delayNode), this._readOnly(["delayTime"]) }, t.extend(t.FeedbackDelay, t.FeedbackEffect), t.FeedbackDelay.defaults = { delayTime: .25 }, t.FeedbackDelay.prototype.dispose = function() { return t.FeedbackEffect.prototype.dispose.call(this), this._delayNode.dispose(), this._delayNode = null, this._writable(["delayTime"]), this.delayTime = null, this }, t.FeedbackDelay }), t(function(t) { var e = [1557 / 44100, 1617 / 44100, 1491 / 44100, 1422 / 44100, 1277 / 44100, 1356 / 44100, 1188 / 44100, 1116 / 44100],
                i = [225, 556, 441, 341]; return t.Freeverb = function() { var n, s, o, r, a, l, h = t.defaults(arguments, ["roomSize", "dampening"], t.Freeverb); for (t.StereoEffect.call(this, h), this.roomSize = new t.Signal(h.roomSize, t.Type.NormalRange), this.dampening = new t.Signal(h.dampening, t.Type.Frequency), this._combFilters = [], this._allpassFiltersL = [], this._allpassFiltersR = [], n = 0; n < i.length; n++) s = this.context.createBiquadFilter(), s.type = "allpass", s.frequency.value = i[n], this._allpassFiltersL.push(s); for (o = 0; o < i.length; o++) r = this.context.createBiquadFilter(), r.type = "allpass", r.frequency.value = i[o], this._allpassFiltersR.push(r); for (a = 0; a < e.length; a++) l = new t.LowpassCombFilter(e[a]), a < e.length / 2 ? this.effectSendL.chain(l, this._allpassFiltersL[0]) : this.effectSendR.chain(l, this._allpassFiltersR[0]), this.roomSize.connect(l.resonance), this.dampening.connect(l.dampening), this._combFilters.push(l);
                t.connectSeries.apply(t, this._allpassFiltersL), t.connectSeries.apply(t, this._allpassFiltersR), this._allpassFiltersL[this._allpassFiltersL.length - 1].connect(this.effectReturnL), this._allpassFiltersR[this._allpassFiltersR.length - 1].connect(this.effectReturnR), this._readOnly(["roomSize", "dampening"]) }, t.extend(t.Freeverb, t.StereoEffect), t.Freeverb.defaults = { roomSize: .7, dampening: 3e3 }, t.Freeverb.prototype.dispose = function() { var e, i, n; for (t.StereoEffect.prototype.dispose.call(this), e = 0; e < this._allpassFiltersL.length; e++) this._allpassFiltersL[e].disconnect(), this._allpassFiltersL[e] = null; for (this._allpassFiltersL = null, i = 0; i < this._allpassFiltersR.length; i++) this._allpassFiltersR[i].disconnect(), this._allpassFiltersR[i] = null; for (this._allpassFiltersR = null, n = 0; n < this._combFilters.length; n++) this._combFilters[n].dispose(), this._combFilters[n] = null; return this._combFilters = null, this._writable(["roomSize", "dampening"]), this.roomSize.dispose(), this.roomSize = null, this.dampening.dispose(), this.dampening = null, this }, t.Freeverb }), t(function(t) { var e = [.06748, .06404, .08212, .09004],
                i = [.773, .802, .753, .733],
                n = [347, 113, 37]; return t.JCReverb = function() { var s, o, r, a, l = t.defaults(arguments, ["roomSize"], t.JCReverb); for (t.StereoEffect.call(this, l), this.roomSize = new t.Signal(l.roomSize, t.Type.NormalRange), this._scaleRoomSize = new t.Scale(-.733, .197), this._allpassFilters = [], this._feedbackCombFilters = [], s = 0; s < n.length; s++) o = this.context.createBiquadFilter(), o.type = "allpass", o.frequency.value = n[s], this._allpassFilters.push(o); for (r = 0; r < e.length; r++) a = new t.FeedbackCombFilter(e[r], .1), this._scaleRoomSize.connect(a.resonance), a.resonance.value = i[r], this._allpassFilters[this._allpassFilters.length - 1].connect(a), r < e.length / 2 ? a.connect(this.effectReturnL) : a.connect(this.effectReturnR), this._feedbackCombFilters.push(a);
                this.roomSize.connect(this._scaleRoomSize), t.connectSeries.apply(t, this._allpassFilters), this.effectSendL.connect(this._allpassFilters[0]), this.effectSendR.connect(this._allpassFilters[0]), this._readOnly(["roomSize"]) }, t.extend(t.JCReverb, t.StereoEffect), t.JCReverb.defaults = { roomSize: .5 }, t.JCReverb.prototype.dispose = function() { var e, i; for (t.StereoEffect.prototype.dispose.call(this), e = 0; e < this._allpassFilters.length; e++) this._allpassFilters[e].disconnect(), this._allpassFilters[e] = null; for (this._allpassFilters = null, i = 0; i < this._feedbackCombFilters.length; i++) this._feedbackCombFilters[i].dispose(), this._feedbackCombFilters[i] = null; return this._feedbackCombFilters = null, this._writable(["roomSize"]), this.roomSize.dispose(), this.roomSize = null, this._scaleRoomSize.dispose(), this._scaleRoomSize = null, this }, t.JCReverb }), t(function(t) { return t.MidSideEffect = function() { t.Effect.apply(this, arguments), this._midSideSplit = new t.MidSideSplit, this._midSideMerge = new t.MidSideMerge, this.midSend = this._midSideSplit.mid, this.sideSend = this._midSideSplit.side, this.midReturn = this._midSideMerge.mid, this.sideReturn = this._midSideMerge.side, this.effectSend.connect(this._midSideSplit), this._midSideMerge.connect(this.effectReturn) }, t.extend(t.MidSideEffect, t.Effect), t.MidSideEffect.prototype.dispose = function() { return t.Effect.prototype.dispose.call(this), this._midSideSplit.dispose(), this._midSideSplit = null, this._midSideMerge.dispose(), this._midSideMerge = null, this.midSend = null, this.sideSend = null, this.midReturn = null, this.sideReturn = null, this }, t.MidSideEffect }), t(function(t) { return t.Phaser = function() { var e = t.defaults(arguments, ["frequency", "octaves", "baseFrequency"], t.Phaser);
                t.StereoEffect.call(this, e), this._lfoL = new t.LFO(e.frequency, 0, 1), this._lfoR = new t.LFO(e.frequency, 0, 1), this._lfoR.phase = 180, this._baseFrequency = e.baseFrequency, this._octaves = e.octaves, this.Q = new t.Signal(e.Q, t.Type.Positive), this._filtersL = this._makeFilters(e.stages, this._lfoL, this.Q), this._filtersR = this._makeFilters(e.stages, this._lfoR, this.Q), this.frequency = this._lfoL.frequency, this.frequency.value = e.frequency, this.effectSendL.connect(this._filtersL[0]), this.effectSendR.connect(this._filtersR[0]), this._filtersL[e.stages - 1].connect(this.effectReturnL), this._filtersR[e.stages - 1].connect(this.effectReturnR), this._lfoL.frequency.connect(this._lfoR.frequency), this.baseFrequency = e.baseFrequency, this.octaves = e.octaves, this._lfoL.start(), this._lfoR.start(), this._readOnly(["frequency", "Q"]) }, t.extend(t.Phaser, t.StereoEffect), t.Phaser.defaults = { frequency: .5, octaves: 3, stages: 10, Q: 10, baseFrequency: 350 }, t.Phaser.prototype._makeFilters = function(e, i, n) { var s, o, r = new Array(e); for (s = 0; s < e; s++) o = this.context.createBiquadFilter(), o.type = "allpass", n.connect(o.Q), i.connect(o.frequency), r[s] = o; return t.connectSeries.apply(t, r), r }, Object.defineProperty(t.Phaser.prototype, "octaves", { get: function() { return this._octaves }, set: function(t) { this._octaves = t; var e = this._baseFrequency * Math.pow(2, t);
                    this._lfoL.max = e, this._lfoR.max = e } }), Object.defineProperty(t.Phaser.prototype, "baseFrequency", { get: function() { return this._baseFrequency }, set: function(t) { this._baseFrequency = t, this._lfoL.min = t, this._lfoR.min = t, this.octaves = this._octaves } }), t.Phaser.prototype.dispose = function() { var e, i; for (t.StereoEffect.prototype.dispose.call(this), this._writable(["frequency", "Q"]), this.Q.dispose(), this.Q = null, this._lfoL.dispose(), this._lfoL = null, this._lfoR.dispose(), this._lfoR = null, e = 0; e < this._filtersL.length; e++) this._filtersL[e].disconnect(), this._filtersL[e] = null; for (this._filtersL = null, i = 0; i < this._filtersR.length; i++) this._filtersR[i].disconnect(), this._filtersR[i] = null; return this._filtersR = null, this.frequency = null, this }, t.Phaser }), t(function(t) { return t.StereoXFeedbackEffect = function() { var e = t.defaults(arguments, ["feedback"], t.FeedbackEffect);
                t.StereoEffect.call(this, e), this.feedback = new t.Signal(e.feedback, t.Type.NormalRange), this._feedbackLR = new t.Gain, this._feedbackRL = new t.Gain, this.effectReturnL.chain(this._feedbackLR, this.effectSendR), this.effectReturnR.chain(this._feedbackRL, this.effectSendL), this.feedback.fan(this._feedbackLR.gain, this._feedbackRL.gain), this._readOnly(["feedback"]) }, t.extend(t.StereoXFeedbackEffect, t.StereoEffect), t.StereoXFeedbackEffect.prototype.dispose = function() { return t.StereoEffect.prototype.dispose.call(this), this._writable(["feedback"]), this.feedback.dispose(), this.feedback = null, this._feedbackLR.dispose(), this._feedbackLR = null, this._feedbackRL.dispose(), this._feedbackRL = null, this }, t.StereoXFeedbackEffect }), t(function(t) { return t.PingPongDelay = function() { var e = t.defaults(arguments, ["delayTime", "feedback"], t.PingPongDelay);
                t.StereoXFeedbackEffect.call(this, e), this._leftDelay = new t.Delay(0, e.maxDelayTime), this._rightDelay = new t.Delay(0, e.maxDelayTime), this._rightPreDelay = new t.Delay(0, e.maxDelayTime), this.delayTime = new t.Signal(e.delayTime, t.Type.Time), this.effectSendL.chain(this._leftDelay, this.effectReturnL), this.effectSendR.chain(this._rightPreDelay, this._rightDelay, this.effectReturnR), this.delayTime.fan(this._leftDelay.delayTime, this._rightDelay.delayTime, this._rightPreDelay.delayTime), this._feedbackLR.disconnect(), this._feedbackLR.connect(this._rightDelay), this._readOnly(["delayTime"]) }, t.extend(t.PingPongDelay, t.StereoXFeedbackEffect), t.PingPongDelay.defaults = { delayTime: .25, maxDelayTime: 1 }, t.PingPongDelay.prototype.dispose = function() { return t.StereoXFeedbackEffect.prototype.dispose.call(this), this._leftDelay.dispose(), this._leftDelay = null, this._rightDelay.dispose(), this._rightDelay = null, this._rightPreDelay.dispose(), this._rightPreDelay = null, this._writable(["delayTime"]), this.delayTime.dispose(), this.delayTime = null, this }, t.PingPongDelay }), t(function(t) {
            return t.PitchShift = function() {
                var e, i = t.defaults(arguments, ["pitch"], t.PitchShift);
                t.FeedbackEffect.call(this, i), this._frequency = new t.Signal(0), this._delayA = new t.Delay(0, 1), this._lfoA = new t.LFO({
                    min: 0,
                    max: .1,
                    type: "sawtooth"
                }).connect(this._delayA.delayTime), this._delayB = new t.Delay(0, 1), this._lfoB = new t.LFO({ min: 0, max: .1, type: "sawtooth", phase: 180 }).connect(this._delayB.delayTime), this._crossFade = new t.CrossFade, this._crossFadeLFO = new t.LFO({ min: 0, max: 1, type: "triangle", phase: 90 }).connect(this._crossFade.fade), this._feedbackDelay = new t.Delay(i.delayTime), this.delayTime = this._feedbackDelay.delayTime, this._readOnly("delayTime"), this._pitch = i.pitch, this._windowSize = i.windowSize, this._delayA.connect(this._crossFade.a), this._delayB.connect(this._crossFade.b), this._frequency.fan(this._lfoA.frequency, this._lfoB.frequency, this._crossFadeLFO.frequency), this.effectSend.fan(this._delayA, this._delayB), this._crossFade.chain(this._feedbackDelay, this.effectReturn), e = this.now(), this._lfoA.start(e), this._lfoB.start(e), this._crossFadeLFO.start(e), this.windowSize = this._windowSize
            }, t.extend(t.PitchShift, t.FeedbackEffect), t.PitchShift.defaults = { pitch: 0, windowSize: .1, delayTime: 0, feedback: 0 }, Object.defineProperty(t.PitchShift.prototype, "pitch", { get: function() { return this._pitch }, set: function(e) { this._pitch = e; var i = 0;
                    e < 0 ? (this._lfoA.min = 0, this._lfoA.max = this._windowSize, this._lfoB.min = 0, this._lfoB.max = this._windowSize, i = t.intervalToFrequencyRatio(e - 1) + 1) : (this._lfoA.min = this._windowSize, this._lfoA.max = 0, this._lfoB.min = this._windowSize, this._lfoB.max = 0, i = t.intervalToFrequencyRatio(e) - 1), this._frequency.value = i * (1.2 / this._windowSize) } }), Object.defineProperty(t.PitchShift.prototype, "windowSize", { get: function() { return this._windowSize }, set: function(t) { this._windowSize = this.toSeconds(t), this.pitch = this._pitch } }), t.PitchShift.prototype.dispose = function() { return t.FeedbackEffect.prototype.dispose.call(this), this._frequency.dispose(), this._frequency = null, this._delayA.disconnect(), this._delayA = null, this._delayB.disconnect(), this._delayB = null, this._lfoA.dispose(), this._lfoA = null, this._lfoB.dispose(), this._lfoB = null, this._crossFade.dispose(), this._crossFade = null, this._crossFadeLFO.dispose(), this._crossFadeLFO = null, this._writable("delayTime"), this._feedbackDelay.dispose(), this._feedbackDelay = null, this.delayTime = null, this }, t.PitchShift
        }), t(function(t) { return t.StereoFeedbackEffect = function() { var e = t.defaults(arguments, ["feedback"], t.FeedbackEffect);
                t.StereoEffect.call(this, e), this.feedback = new t.Signal(e.feedback, t.Type.NormalRange), this._feedbackL = new t.Gain, this._feedbackR = new t.Gain, this.effectReturnL.chain(this._feedbackL, this.effectSendL), this.effectReturnR.chain(this._feedbackR, this.effectSendR), this.feedback.fan(this._feedbackL.gain, this._feedbackR.gain), this._readOnly(["feedback"]) }, t.extend(t.StereoFeedbackEffect, t.StereoEffect), t.StereoFeedbackEffect.prototype.dispose = function() { return t.StereoEffect.prototype.dispose.call(this), this._writable(["feedback"]), this.feedback.dispose(), this.feedback = null, this._feedbackL.dispose(), this._feedbackL = null, this._feedbackR.dispose(), this._feedbackR = null, this }, t.StereoFeedbackEffect }), t(function(t) { return t.StereoWidener = function() { var e = t.defaults(arguments, ["width"], t.StereoWidener);
                t.MidSideEffect.call(this, e), this.width = new t.Signal(e.width, t.Type.NormalRange), this._readOnly(["width"]), this._twoTimesWidthMid = new t.Multiply(2), this._twoTimesWidthSide = new t.Multiply(2), this._midMult = new t.Multiply, this._twoTimesWidthMid.connect(this._midMult, 0, 1), this.midSend.chain(this._midMult, this.midReturn), this._oneMinusWidth = new t.Subtract, this._oneMinusWidth.connect(this._twoTimesWidthMid), this.context.getConstant(1).connect(this._oneMinusWidth, 0, 0), this.width.connect(this._oneMinusWidth, 0, 1), this._sideMult = new t.Multiply, this.width.connect(this._twoTimesWidthSide), this._twoTimesWidthSide.connect(this._sideMult, 0, 1), this.sideSend.chain(this._sideMult, this.sideReturn) }, t.extend(t.StereoWidener, t.MidSideEffect), t.StereoWidener.defaults = { width: .5 }, t.StereoWidener.prototype.dispose = function() { return t.MidSideEffect.prototype.dispose.call(this), this._writable(["width"]), this.width.dispose(), this.width = null, this._midMult.dispose(), this._midMult = null, this._sideMult.dispose(), this._sideMult = null, this._twoTimesWidthMid.dispose(), this._twoTimesWidthMid = null, this._twoTimesWidthSide.dispose(), this._twoTimesWidthSide = null, this._oneMinusWidth.dispose(), this._oneMinusWidth = null, this }, t.StereoWidener }), t(function(t) { return t.Tremolo = function() { var e = t.defaults(arguments, ["frequency", "depth"], t.Tremolo);
                t.StereoEffect.call(this, e), this._lfoL = new t.LFO({ phase: e.spread, min: 1, max: 0 }), this._lfoR = new t.LFO({ phase: e.spread, min: 1, max: 0 }), this._amplitudeL = new t.Gain, this._amplitudeR = new t.Gain, this.frequency = new t.Signal(e.frequency, t.Type.Frequency), this.depth = new t.Signal(e.depth, t.Type.NormalRange), this._readOnly(["frequency", "depth"]), this.effectSendL.chain(this._amplitudeL, this.effectReturnL), this.effectSendR.chain(this._amplitudeR, this.effectReturnR), this._lfoL.connect(this._amplitudeL.gain), this._lfoR.connect(this._amplitudeR.gain), this.frequency.fan(this._lfoL.frequency, this._lfoR.frequency), this.depth.fan(this._lfoR.amplitude, this._lfoL.amplitude), this.type = e.type, this.spread = e.spread }, t.extend(t.Tremolo, t.StereoEffect), t.Tremolo.defaults = { frequency: 10, type: "sine", depth: .5, spread: 180 }, t.Tremolo.prototype.start = function(t) { return this._lfoL.start(t), this._lfoR.start(t), this }, t.Tremolo.prototype.stop = function(t) { return this._lfoL.stop(t), this._lfoR.stop(t), this }, t.Tremolo.prototype.sync = function(t) { return this._lfoL.sync(t), this._lfoR.sync(t), this }, t.Tremolo.prototype.unsync = function() { return this._lfoL.unsync(), this._lfoR.unsync(), this }, Object.defineProperty(t.Tremolo.prototype, "type", { get: function() { return this._lfoL.type }, set: function(t) { this._lfoL.type = t, this._lfoR.type = t } }), Object.defineProperty(t.Tremolo.prototype, "spread", { get: function() { return this._lfoR.phase - this._lfoL.phase }, set: function(t) { this._lfoL.phase = 90 - t / 2, this._lfoR.phase = t / 2 + 90 } }), t.Tremolo.prototype.dispose = function() { return t.StereoEffect.prototype.dispose.call(this), this._writable(["frequency", "depth"]), this._lfoL.dispose(), this._lfoL = null, this._lfoR.dispose(), this._lfoR = null, this._amplitudeL.dispose(), this._amplitudeL = null, this._amplitudeR.dispose(), this._amplitudeR = null, this.frequency = null, this.depth = null, this }, t.Tremolo }), t(function(t) { return t.Vibrato = function() { var e = t.defaults(arguments, ["frequency", "depth"], t.Vibrato);
                t.Effect.call(this, e), this._delayNode = new t.Delay(0, e.maxDelay), this._lfo = new t.LFO({ type: e.type, min: 0, max: e.maxDelay, frequency: e.frequency, phase: -90 }).start().connect(this._delayNode.delayTime), this.frequency = this._lfo.frequency, this.depth = this._lfo.amplitude, this.depth.value = e.depth, this._readOnly(["frequency", "depth"]), this.effectSend.chain(this._delayNode, this.effectReturn) }, t.extend(t.Vibrato, t.Effect), t.Vibrato.defaults = { maxDelay: .005, frequency: 5, depth: .1, type: "sine" }, Object.defineProperty(t.Vibrato.prototype, "type", { get: function() { return this._lfo.type }, set: function(t) { this._lfo.type = t } }), t.Vibrato.prototype.dispose = function() { t.Effect.prototype.dispose.call(this), this._delayNode.dispose(), this._delayNode = null, this._lfo.dispose(), this._lfo = null, this._writable(["frequency", "depth"]), this.frequency = null, this.depth = null }, t.Vibrato }), t(function(t) { return t.Event = function() { var e = t.defaults(arguments, ["callback", "value"], t.Event);
                t.call(this), this._loop = e.loop, this.callback = e.callback, this.value = e.value, this._loopStart = this.toTicks(e.loopStart), this._loopEnd = this.toTicks(e.loopEnd), this._state = new t.TimelineState(t.State.Stopped), this._playbackRate = 1, this._startOffset = 0, this._probability = e.probability, this._humanize = e.humanize, this.mute = e.mute, this.playbackRate = e.playbackRate }, t.extend(t.Event), t.Event.defaults = { callback: t.noOp, loop: !1, loopEnd: "1m", loopStart: 0, playbackRate: 1, value: null, probability: 1, mute: !1, humanize: !1 }, t.Event.prototype._rescheduleEvents = function(e) { return e = t.defaultArg(e, -1), this._state.forEachFrom(e, function(e) { var i, n, s, o;
                    e.state === t.State.Started && (t.isUndef(e.id) || t.Transport.clear(e.id), n = e.time + Math.round(this.startOffset / this._playbackRate), this._loop ? (i = 1 / 0, t.isNumber(this._loop) && (i = this._loop * this._getLoopDuration()), s = this._state.getAfter(n), null !== s && (i = Math.min(i, s.time - n)), i !== 1 / 0 && (this._state.setStateAtTime(t.State.Stopped, n + i + 1), i = t.Time(i, "i")), o = t.Time(this._getLoopDuration(), "i"), e.id = t.Transport.scheduleRepeat(this._tick.bind(this), o, t.TransportTime(n, "i"), i)) : e.id = t.Transport.schedule(this._tick.bind(this), n + "i")) }.bind(this)), this }, Object.defineProperty(t.Event.prototype, "state", { get: function() { return this._state.getValueAtTime(t.Transport.ticks) } }), Object.defineProperty(t.Event.prototype, "startOffset", { get: function() { return this._startOffset }, set: function(t) { this._startOffset = t } }), Object.defineProperty(t.Event.prototype, "probability", { get: function() { return this._probability }, set: function(t) { this._probability = t } }), Object.defineProperty(t.Event.prototype, "humanize", { get: function() { return this._humanize }, set: function(t) { this._humanize = t } }), t.Event.prototype.start = function(e) { return e = this.toTicks(e), this._state.getValueAtTime(e) === t.State.Stopped && (this._state.add({ state: t.State.Started, time: e, id: void 0 }), this._rescheduleEvents(e)), this }, t.Event.prototype.stop = function(e) { var i, n; return this.cancel(e), e = this.toTicks(e), this._state.getValueAtTime(e) === t.State.Started && (this._state.setStateAtTime(t.State.Stopped, e), i = this._state.getBefore(e), n = e, null !== i && (n = i.time), this._rescheduleEvents(n)), this }, t.Event.prototype.cancel = function(e) { return e = t.defaultArg(e, -1 / 0), e = this.toTicks(e), this._state.forEachFrom(e, function(e) { t.Transport.clear(e.id) }), this._state.cancel(e), this }, t.Event.prototype._tick = function(e) { if (!this.mute && this._state.getValueAtTime(t.Transport.ticks) === t.State.Started) { if (this.probability < 1 && Math.random() > this.probability) return; if (this.humanize) { var i = .02;
                        t.isBoolean(this.humanize) || (i = this.toSeconds(this.humanize)), e += (2 * Math.random() - 1) * i } this.callback(e, this.value) } }, t.Event.prototype._getLoopDuration = function() { return Math.round((this._loopEnd - this._loopStart) / this._playbackRate) }, Object.defineProperty(t.Event.prototype, "loop", { get: function() { return this._loop }, set: function(t) { this._loop = t, this._rescheduleEvents() } }), Object.defineProperty(t.Event.prototype, "playbackRate", { get: function() { return this._playbackRate }, set: function(t) { this._playbackRate = t, this._rescheduleEvents() } }), Object.defineProperty(t.Event.prototype, "loopEnd", { get: function() { return t.TransportTime(this._loopEnd, "i").toNotation() }, set: function(t) { this._loopEnd = this.toTicks(t), this._loop && this._rescheduleEvents() } }), Object.defineProperty(t.Event.prototype, "loopStart", { get: function() { return t.TransportTime(this._loopStart, "i").toNotation() }, set: function(t) { this._loopStart = this.toTicks(t), this._loop && this._rescheduleEvents() } }), Object.defineProperty(t.Event.prototype, "progress", { get: function() { var e, i, n; return this._loop ? (e = t.Transport.ticks, i = this._state.get(e), null !== i && i.state === t.State.Started ? (n = this._getLoopDuration(), (e - i.time) % n / n) : 0) : 0 } }), t.Event.prototype.dispose = function() { this.cancel(), this._state.dispose(), this._state = null, this.callback = null, this.value = null }, t.Event }), t(function(t) { return t.Loop = function() { var e = t.defaults(arguments, ["callback", "interval"], t.Loop);
                t.call(this), this._event = new t.Event({ callback: this._tick.bind(this), loop: !0, loopEnd: e.interval, playbackRate: e.playbackRate, probability: e.probability }), this.callback = e.callback, this.iterations = e.iterations }, t.extend(t.Loop), t.Loop.defaults = { interval: "4n", callback: t.noOp, playbackRate: 1, iterations: 1 / 0, probability: !0, mute: !1 }, t.Loop.prototype.start = function(t) { return this._event.start(t), this }, t.Loop.prototype.stop = function(t) { return this._event.stop(t), this }, t.Loop.prototype.cancel = function(t) { return this._event.cancel(t), this }, t.Loop.prototype._tick = function(t) { this.callback(t) }, Object.defineProperty(t.Loop.prototype, "state", { get: function() { return this._event.state } }), Object.defineProperty(t.Loop.prototype, "progress", { get: function() { return this._event.progress } }), Object.defineProperty(t.Loop.prototype, "interval", { get: function() { return this._event.loopEnd }, set: function(t) { this._event.loopEnd = t } }), Object.defineProperty(t.Loop.prototype, "playbackRate", { get: function() { return this._event.playbackRate }, set: function(t) { this._event.playbackRate = t } }), Object.defineProperty(t.Loop.prototype, "humanize", { get: function() { return this._event.humanize }, set: function(t) { this._event.humanize = t } }), Object.defineProperty(t.Loop.prototype, "probability", { get: function() { return this._event.probability }, set: function(t) { this._event.probability = t } }), Object.defineProperty(t.Loop.prototype, "mute", { get: function() { return this._event.mute }, set: function(t) { this._event.mute = t } }), Object.defineProperty(t.Loop.prototype, "iterations", { get: function() { return !0 === this._event.loop ? 1 / 0 : this._event.loop }, set: function(t) { this._event.loop = t === 1 / 0 || t } }), t.Loop.prototype.dispose = function() { this._event.dispose(), this._event = null, this.callback = null }, t.Loop }), t(function(t) { return t.Part = function() { var e, i = t.defaults(arguments, ["callback", "events"], t.Part); for (t.Event.call(this, i), this._events = [], e = 0; e < i.events.length; e++) Array.isArray(i.events[e]) ? this.add(i.events[e][0], i.events[e][1]) : this.add(i.events[e]) }, t.extend(t.Part, t.Event), t.Part.defaults = { callback: t.noOp, loop: !1, loopEnd: "1m", loopStart: 0, playbackRate: 1, probability: 1, humanize: !1, mute: !1, events: [] }, t.Part.prototype.start = function(e, i) { var n = this.toTicks(e); return this._state.getValueAtTime(n) !== t.State.Started && (i = this._loop ? t.defaultArg(i, this._loopStart) : t.defaultArg(i, 0), i = this.toTicks(i), this._state.add({ state: t.State.Started, time: n, offset: i }), this._forEach(function(t) { this._startNote(t, n, i) })), this }, t.Part.prototype._startNote = function(e, i, n) { i -= n, this._loop ? e.startOffset >= this._loopStart && e.startOffset < this._loopEnd ? (e.startOffset < n && (i += this._getLoopDuration()), e.start(t.TransportTime(i, "i"))) : e.startOffset < this._loopStart && e.startOffset >= n && (e.loop = !1, e.start(t.TransportTime(i, "i"))) : e.startOffset >= n && e.start(t.TransportTime(i, "i")) }, Object.defineProperty(t.Part.prototype, "startOffset", { get: function() { return this._startOffset }, set: function(t) { this._startOffset = t, this._forEach(function(t) { t.startOffset += this._startOffset }) } }), t.Part.prototype.stop = function(e) { var i = this.toTicks(e); return this._state.cancel(i), this._state.setStateAtTime(t.State.Stopped, i), this._forEach(function(t) { t.stop(e) }), this }, t.Part.prototype.at = function(e, i) { var n, s, o; for (e = t.TransportTime(e), n = t.Time(1, "i").toSeconds(), s = 0; s < this._events.length; s++)
                    if (o = this._events[s], Math.abs(e.toTicks() - o.startOffset) < n) return t.isUndef(i) || (o.value = i), o; return t.isUndef(i) ? null : (this.add(e, i), this._events[this._events.length - 1]) }, t.Part.prototype.add = function(e, i) { e.hasOwnProperty("time") && (i = e, e = i.time), e = this.toTicks(e); var n; return i instanceof t.Event ? (n = i, n.callback = this._tick.bind(this)) : n = new t.Event({ callback: this._tick.bind(this), value: i }), n.startOffset = e, n.set({ loopEnd: this.loopEnd, loopStart: this.loopStart, loop: this.loop, humanize: this.humanize, playbackRate: this.playbackRate, probability: this.probability }), this._events.push(n), this._restartEvent(n), this }, t.Part.prototype._restartEvent = function(e) { this._state.forEach(function(i) { i.state === t.State.Started ? this._startNote(e, i.time, i.offset) : e.stop(t.TransportTime(i.time, "i")) }.bind(this)) }, t.Part.prototype.remove = function(e, i) { var n, s; for (e.hasOwnProperty("time") && (i = e, e = i.time), e = this.toTicks(e), n = this._events.length - 1; n >= 0; n--) s = this._events[n], s instanceof t.Part ? s.remove(e, i) : s.startOffset === e && (t.isUndef(i) || !t.isUndef(i) && s.value === i) && (this._events.splice(n, 1), s.dispose()); return this }, t.Part.prototype.removeAll = function() { return this._forEach(function(t) { t.dispose() }), this._events = [], this }, t.Part.prototype.cancel = function(t) { return this._forEach(function(e) { e.cancel(t) }), this._state.cancel(this.toTicks(t)), this }, t.Part.prototype._forEach = function(e, i) { var n, s; if (this._events)
                    for (i = t.defaultArg(i, this), n = this._events.length - 1; n >= 0; n--) s = this._events[n], s instanceof t.Part ? s._forEach(e, i) : e.call(i, s); return this }, t.Part.prototype._setAll = function(t, e) { this._forEach(function(i) { i[t] = e }) }, t.Part.prototype._tick = function(t, e) { this.mute || this.callback(t, e) }, t.Part.prototype._testLoopBoundries = function(e) { e.startOffset < this._loopStart || e.startOffset >= this._loopEnd ? e.cancel(0) : e.state === t.State.Stopped && this._restartEvent(e) }, Object.defineProperty(t.Part.prototype, "probability", { get: function() { return this._probability }, set: function(t) { this._probability = t, this._setAll("probability", t) } }), Object.defineProperty(t.Part.prototype, "humanize", { get: function() { return this._humanize }, set: function(t) { this._humanize = t, this._setAll("humanize", t) } }), Object.defineProperty(t.Part.prototype, "loop", { get: function() { return this._loop }, set: function(t) { this._loop = t, this._forEach(function(e) { e._loopStart = this._loopStart, e._loopEnd = this._loopEnd, e.loop = t, this._testLoopBoundries(e) }) } }), Object.defineProperty(t.Part.prototype, "loopEnd", { get: function() { return t.TransportTime(this._loopEnd, "i").toNotation() }, set: function(t) { this._loopEnd = this.toTicks(t), this._loop && this._forEach(function(e) { e.loopEnd = t, this._testLoopBoundries(e) }) } }), Object.defineProperty(t.Part.prototype, "loopStart", { get: function() { return t.TransportTime(this._loopStart, "i").toNotation() }, set: function(t) { this._loopStart = this.toTicks(t), this._loop && this._forEach(function(t) { t.loopStart = this.loopStart, this._testLoopBoundries(t) }) } }), Object.defineProperty(t.Part.prototype, "playbackRate", { get: function() { return this._playbackRate }, set: function(t) { this._playbackRate = t, this._setAll("playbackRate", t) } }), Object.defineProperty(t.Part.prototype, "length", { get: function() { return this._events.length } }), t.Part.prototype.dispose = function() { return this.removeAll(), this._state.dispose(), this._state = null, this.callback = null, this._events = null, this }, t.Part }), t(function(t) { return t.Pattern = function() { var e = t.defaults(arguments, ["callback", "values", "pattern"], t.Pattern);
                t.Loop.call(this, e), this._pattern = new t.CtrlPattern({ values: e.values, type: e.pattern, index: e.index }) }, t.extend(t.Pattern, t.Loop), t.Pattern.defaults = { pattern: t.CtrlPattern.Type.Up, callback: t.noOp, values: [] }, t.Pattern.prototype._tick = function(t) { this.callback(t, this._pattern.value), this._pattern.next() }, Object.defineProperty(t.Pattern.prototype, "index", { get: function() { return this._pattern.index }, set: function(t) { this._pattern.index = t } }), Object.defineProperty(t.Pattern.prototype, "values", { get: function() { return this._pattern.values }, set: function(t) { this._pattern.values = t } }), Object.defineProperty(t.Pattern.prototype, "value", { get: function() { return this._pattern.value } }), Object.defineProperty(t.Pattern.prototype, "pattern", { get: function() { return this._pattern.type }, set: function(t) { this._pattern.type = t } }), t.Pattern.prototype.dispose = function() { t.Loop.prototype.dispose.call(this), this._pattern.dispose(), this._pattern = null }, t.Pattern }), t(function(t) { return t.Sequence = function() { var e, i = t.defaults(arguments, ["callback", "events", "subdivision"], t.Sequence),
                    n = i.events; if (delete i.events, t.Part.call(this, i), this._subdivision = this.toTicks(i.subdivision), t.isUndef(i.loopEnd) && !t.isUndef(n) && (this._loopEnd = n.length * this._subdivision), this._loop = !0, !t.isUndef(n))
                    for (e = 0; e < n.length; e++) this.add(e, n[e]) }, t.extend(t.Sequence, t.Part), t.Sequence.defaults = { subdivision: "4n" }, Object.defineProperty(t.Sequence.prototype, "subdivision", { get: function() { return t.Time(this._subdivision, "i").toNotation() } }), t.Sequence.prototype.at = function(e, i) { return t.isArray(i) && this.remove(e), t.Part.prototype.at.call(this, this._indexTime(e), i) }, t.Sequence.prototype.add = function(e, i) { if (null === i) return this; if (t.isArray(i)) { var n = Math.round(this._subdivision / i.length);
                    i = new t.Sequence(this._tick.bind(this), i, t.Time(n, "i")) } return t.Part.prototype.add.call(this, this._indexTime(e), i), this }, t.Sequence.prototype.remove = function(e, i) { return t.Part.prototype.remove.call(this, this._indexTime(e), i), this }, t.Sequence.prototype._indexTime = function(e) { return e instanceof t.TransportTime ? e : t.TransportTime(e * this._subdivision + this.startOffset, "i") }, t.Sequence.prototype.dispose = function() { return t.Part.prototype.dispose.call(this), this }, t.Sequence }), t(function(t) { return t.PulseOscillator = function() { var e = t.defaults(arguments, ["frequency", "width"], t.Oscillator);
                t.Source.call(this, e), this.width = new t.Signal(e.width, t.Type.NormalRange), this._widthGate = new t.Gain, this._sawtooth = new t.Oscillator({ frequency: e.frequency, detune: e.detune, type: "sawtooth", phase: e.phase }), this.frequency = this._sawtooth.frequency, this.detune = this._sawtooth.detune, this._thresh = new t.WaveShaper(function(t) { return t < 0 ? -1 : 1 }), this._sawtooth.chain(this._thresh, this.output), this.width.chain(this._widthGate, this._thresh), this._readOnly(["width", "frequency", "detune"]) }, t.extend(t.PulseOscillator, t.Source), t.PulseOscillator.defaults = { frequency: 440, detune: 0, phase: 0, width: .2 }, t.PulseOscillator.prototype._start = function(t) { t = this.toSeconds(t), this._sawtooth.start(t), this._widthGate.gain.setValueAtTime(1, t) }, t.PulseOscillator.prototype._stop = function(t) { t = this.toSeconds(t), this._sawtooth.stop(t), this._widthGate.gain.setValueAtTime(0, t) }, Object.defineProperty(t.PulseOscillator.prototype, "phase", { get: function() { return this._sawtooth.phase }, set: function(t) { this._sawtooth.phase = t } }), Object.defineProperty(t.PulseOscillator.prototype, "type", { get: function() { return "pulse" } }), Object.defineProperty(t.PulseOscillator.prototype, "partials", { get: function() { return [] } }), t.PulseOscillator.prototype.dispose = function() { return t.Source.prototype.dispose.call(this), this._sawtooth.dispose(), this._sawtooth = null, this._writable(["width", "frequency", "detune"]), this.width.dispose(), this.width = null, this._widthGate.dispose(), this._widthGate = null, this._thresh.dispose(), this._thresh = null, this.frequency = null, this.detune = null, this }, t.PulseOscillator }), t(function(t) { return t.PWMOscillator = function() { var e = t.defaults(arguments, ["frequency", "modulationFrequency"], t.PWMOscillator);
                t.Source.call(this, e), this._pulse = new t.PulseOscillator(e.modulationFrequency), this._pulse._sawtooth.type = "sine", this._modulator = new t.Oscillator({ frequency: e.frequency, detune: e.detune, phase: e.phase }), this._scale = new t.Multiply(2), this.frequency = this._modulator.frequency, this.detune = this._modulator.detune, this.modulationFrequency = this._pulse.frequency, this._modulator.chain(this._scale, this._pulse.width), this._pulse.connect(this.output), this._readOnly(["modulationFrequency", "frequency", "detune"]) }, t.extend(t.PWMOscillator, t.Source), t.PWMOscillator.defaults = { frequency: 440, detune: 0, phase: 0, modulationFrequency: .4 }, t.PWMOscillator.prototype._start = function(t) { t = this.toSeconds(t), this._modulator.start(t), this._pulse.start(t) }, t.PWMOscillator.prototype._stop = function(t) { t = this.toSeconds(t), this._modulator.stop(t), this._pulse.stop(t) }, Object.defineProperty(t.PWMOscillator.prototype, "type", { get: function() { return "pwm" } }), Object.defineProperty(t.PWMOscillator.prototype, "partials", { get: function() { return [] } }), Object.defineProperty(t.PWMOscillator.prototype, "phase", { get: function() { return this._modulator.phase }, set: function(t) { this._modulator.phase = t } }), t.PWMOscillator.prototype.dispose = function() { return t.Source.prototype.dispose.call(this), this._pulse.dispose(), this._pulse = null, this._scale.dispose(), this._scale = null, this._modulator.dispose(), this._modulator = null, this._writable(["modulationFrequency", "frequency", "detune"]), this.frequency = null, this.detune = null, this.modulationFrequency = null, this }, t.PWMOscillator }), t(function(t) { return t.FMOscillator = function() { var e = t.defaults(arguments, ["frequency", "type", "modulationType"], t.FMOscillator);
                t.Source.call(this, e), this._carrier = new t.Oscillator(e.frequency, e.type), this.frequency = new t.Signal(e.frequency, t.Type.Frequency), this.detune = this._carrier.detune, this.detune.value = e.detune, this.modulationIndex = new t.Multiply(e.modulationIndex), this.modulationIndex.units = t.Type.Positive, this._modulator = new t.Oscillator(e.frequency, e.modulationType), this.harmonicity = new t.Multiply(e.harmonicity), this.harmonicity.units = t.Type.Positive, this._modulationNode = new t.Gain(0), this.frequency.connect(this._carrier.frequency), this.frequency.chain(this.harmonicity, this._modulator.frequency), this.frequency.chain(this.modulationIndex, this._modulationNode), this._modulator.connect(this._modulationNode.gain), this._modulationNode.connect(this._carrier.frequency), this._carrier.connect(this.output), this.detune.connect(this._modulator.detune), this.phase = e.phase, this._readOnly(["modulationIndex", "frequency", "detune", "harmonicity"]) }, t.extend(t.FMOscillator, t.Source), t.FMOscillator.defaults = { frequency: 440, detune: 0, phase: 0, modulationIndex: 2, modulationType: "square", harmonicity: 1 }, t.FMOscillator.prototype._start = function(t) { t = this.toSeconds(t), this._modulator.start(t), this._carrier.start(t) }, t.FMOscillator.prototype._stop = function(t) { t = this.toSeconds(t), this._modulator.stop(t), this._carrier.stop(t) }, Object.defineProperty(t.FMOscillator.prototype, "type", { get: function() { return this._carrier.type }, set: function(t) { this._carrier.type = t } }), Object.defineProperty(t.FMOscillator.prototype, "modulationType", { get: function() { return this._modulator.type }, set: function(t) { this._modulator.type = t } }), Object.defineProperty(t.FMOscillator.prototype, "phase", { get: function() { return this._carrier.phase }, set: function(t) { this._carrier.phase = t, this._modulator.phase = t } }), Object.defineProperty(t.FMOscillator.prototype, "partials", { get: function() { return this._carrier.partials }, set: function(t) { this._carrier.partials = t } }), t.FMOscillator.prototype.dispose = function() { return t.Source.prototype.dispose.call(this), this._writable(["modulationIndex", "frequency", "detune", "harmonicity"]), this.frequency.dispose(), this.frequency = null, this.detune = null, this.harmonicity.dispose(), this.harmonicity = null, this._carrier.dispose(), this._carrier = null, this._modulator.dispose(), this._modulator = null, this._modulationNode.dispose(), this._modulationNode = null, this.modulationIndex.dispose(), this.modulationIndex = null, this }, t.FMOscillator }), t(function(t) { return t.AMOscillator = function() { var e = t.defaults(arguments, ["frequency", "type", "modulationType"], t.AMOscillator);
                t.Source.call(this, e), this._carrier = new t.Oscillator(e.frequency, e.type), this.frequency = this._carrier.frequency, this.detune = this._carrier.detune, this.detune.value = e.detune, this._modulator = new t.Oscillator(e.frequency, e.modulationType), this._modulationScale = new t.AudioToGain, this.harmonicity = new t.Multiply(e.harmonicity), this.harmonicity.units = t.Type.Positive, this._modulationNode = new t.Gain(0), this.frequency.chain(this.harmonicity, this._modulator.frequency), this.detune.connect(this._modulator.detune), this._modulator.chain(this._modulationScale, this._modulationNode.gain), this._carrier.chain(this._modulationNode, this.output), this.phase = e.phase, this._readOnly(["frequency", "detune", "harmonicity"]) }, t.extend(t.AMOscillator, t.Oscillator), t.AMOscillator.defaults = { frequency: 440, detune: 0, phase: 0, modulationType: "square", harmonicity: 1 }, t.AMOscillator.prototype._start = function(t) { t = this.toSeconds(t), this._modulator.start(t), this._carrier.start(t) }, t.AMOscillator.prototype._stop = function(t) { t = this.toSeconds(t), this._modulator.stop(t), this._carrier.stop(t) }, Object.defineProperty(t.AMOscillator.prototype, "type", { get: function() { return this._carrier.type }, set: function(t) { this._carrier.type = t } }), Object.defineProperty(t.AMOscillator.prototype, "modulationType", { get: function() { return this._modulator.type }, set: function(t) { this._modulator.type = t } }), Object.defineProperty(t.AMOscillator.prototype, "phase", { get: function() { return this._carrier.phase }, set: function(t) { this._carrier.phase = t, this._modulator.phase = t } }), Object.defineProperty(t.AMOscillator.prototype, "partials", { get: function() { return this._carrier.partials }, set: function(t) { this._carrier.partials = t } }), t.AMOscillator.prototype.dispose = function() { return t.Source.prototype.dispose.call(this), this._writable(["frequency", "detune", "harmonicity"]), this.frequency = null, this.detune = null, this.harmonicity.dispose(), this.harmonicity = null, this._carrier.dispose(), this._carrier = null, this._modulator.dispose(), this._modulator = null, this._modulationNode.dispose(), this._modulationNode = null, this._modulationScale.dispose(), this._modulationScale = null, this }, t.AMOscillator }), t(function(t) { return t.FatOscillator = function() { var e = t.defaults(arguments, ["frequency", "type", "spread"], t.FatOscillator);
                t.Source.call(this, e), this.frequency = new t.Signal(e.frequency, t.Type.Frequency), this.detune = new t.Signal(e.detune, t.Type.Cents), this._oscillators = [], this._spread = e.spread, this._type = e.type, this._phase = e.phase, this._partials = t.defaultArg(e.partials, []), this.count = e.count, this._readOnly(["frequency", "detune"]) }, t.extend(t.FatOscillator, t.Source), t.FatOscillator.defaults = { frequency: 440, detune: 0, phase: 0, spread: 20, count: 3, type: "sawtooth" }, t.FatOscillator.prototype._start = function(t) { t = this.toSeconds(t), this._forEach(function(e) { e.start(t) }) }, t.FatOscillator.prototype._stop = function(t) { t = this.toSeconds(t), this._forEach(function(e) { e.stop(t) }) }, t.FatOscillator.prototype._forEach = function(t) { for (var e = 0; e < this._oscillators.length; e++) t.call(this, this._oscillators[e], e) }, Object.defineProperty(t.FatOscillator.prototype, "type", { get: function() { return this._type }, set: function(t) { this._type = t, this._forEach(function(e) { e.type = t }) } }), Object.defineProperty(t.FatOscillator.prototype, "spread", { get: function() { return this._spread }, set: function(t) { var e, i;
                    this._spread = t, this._oscillators.length > 1 && (e = -t / 2, i = t / (this._oscillators.length - 1), this._forEach(function(t, n) { t.detune.value = e + i * n })) } }), Object.defineProperty(t.FatOscillator.prototype, "count", { get: function() { return this._oscillators.length }, set: function(e) { var i, n; if (e = Math.max(e, 1), this._oscillators.length !== e) { for (this._forEach(function(t) { t.dispose() }), this._oscillators = [], i = 0; i < e; i++) n = new t.Oscillator, this.type === t.Oscillator.Type.Custom ? n.partials = this._partials : n.type = this._type, n.phase = this._phase, n.volume.value = -6 - 1.1 * e, this.frequency.connect(n.frequency), this.detune.connect(n.detune), n.connect(this.output), this._oscillators[i] = n;
                        this.spread = this._spread, this.state === t.State.Started && this._forEach(function(t) { t.start() }) } } }), Object.defineProperty(t.FatOscillator.prototype, "phase", { get: function() { return this._phase }, set: function(t) { this._phase = t, this._forEach(function(e) { e.phase = t }) } }), Object.defineProperty(t.FatOscillator.prototype, "partials", { get: function() { return this._partials }, set: function(e) { this._partials = e, this._type = t.Oscillator.Type.Custom, this._forEach(function(t) { t.partials = e }) } }), t.FatOscillator.prototype.dispose = function() { return t.Source.prototype.dispose.call(this), this._writable(["frequency", "detune"]), this.frequency.dispose(), this.frequency = null, this.detune.dispose(), this.detune = null, this._forEach(function(t) { t.dispose() }), this._oscillators = null, this._partials = null, this }, t.FatOscillator }), t(function(t) {
            t.OmniOscillator = function() { var e = t.defaults(arguments, ["frequency", "type"], t.OmniOscillator);
                t.Source.call(this, e), this.frequency = new t.Signal(e.frequency, t.Type.Frequency), this.detune = new t.Signal(e.detune, t.Type.Cents), this._sourceType = void 0, this._oscillator = null, this.type = e.type, this._readOnly(["frequency", "detune"]), this.set(e) }, t.extend(t.OmniOscillator, t.Source), t.OmniOscillator.defaults = { frequency: 440, detune: 0, type: "sine", phase: 0 };
            var e = { Pulse: "PulseOscillator", PWM: "PWMOscillator", Osc: "Oscillator", FM: "FMOscillator", AM: "AMOscillator", Fat: "FatOscillator" };
            return t.OmniOscillator.prototype._start = function(t) { this._oscillator.start(t) }, t.OmniOscillator.prototype._stop = function(t) { this._oscillator.stop(t) }, Object.defineProperty(t.OmniOscillator.prototype, "type", {
                get: function() { var t = ""; return this._sourceType === e.FM ? t = "fm" : this._sourceType === e.AM ? t = "am" : this._sourceType === e.Fat && (t = "fat"), t + this._oscillator.type },
                set: function(t) {
                    "fm" === t.substr(0, 2) ? (this._createNewOscillator(e.FM), this._oscillator.type = t.substr(2)) : "am" === t.substr(0, 2) ? (this._createNewOscillator(e.AM),
                        this._oscillator.type = t.substr(2)) : "fat" === t.substr(0, 3) ? (this._createNewOscillator(e.Fat), this._oscillator.type = t.substr(3)) : "pwm" === t ? this._createNewOscillator(e.PWM) : "pulse" === t ? this._createNewOscillator(e.Pulse) : (this._createNewOscillator(e.Osc), this._oscillator.type = t)
                }
            }), Object.defineProperty(t.OmniOscillator.prototype, "partials", { get: function() { return this._oscillator.partials }, set: function(t) { this._oscillator.partials = t } }), t.OmniOscillator.prototype.set = function(e, i) { return "type" === e ? this.type = i : t.isObject(e) && e.hasOwnProperty("type") && (this.type = e.type), t.prototype.set.apply(this, arguments), this }, t.OmniOscillator.prototype._createNewOscillator = function(e) { var i, n, s;
                e !== this._sourceType && (this._sourceType = e, i = t[e], n = this.now(), null !== this._oscillator && (s = this._oscillator, s.stop(n), this.context.setTimeout(function() { s.dispose(), s = null }, this.blockTime)), this._oscillator = new i, this.frequency.connect(this._oscillator.frequency), this.detune.connect(this._oscillator.detune), this._oscillator.connect(this.output), this.state === t.State.Started && this._oscillator.start(n)) }, Object.defineProperty(t.OmniOscillator.prototype, "phase", { get: function() { return this._oscillator.phase }, set: function(t) { this._oscillator.phase = t } }), Object.defineProperty(t.OmniOscillator.prototype, "width", { get: function() { if (this._sourceType === e.Pulse) return this._oscillator.width } }), Object.defineProperty(t.OmniOscillator.prototype, "count", { get: function() { if (this._sourceType === e.Fat) return this._oscillator.count }, set: function(t) { this._sourceType === e.Fat && (this._oscillator.count = t) } }), Object.defineProperty(t.OmniOscillator.prototype, "spread", { get: function() { if (this._sourceType === e.Fat) return this._oscillator.spread }, set: function(t) { this._sourceType === e.Fat && (this._oscillator.spread = t) } }), Object.defineProperty(t.OmniOscillator.prototype, "modulationType", { get: function() { if (this._sourceType === e.FM || this._sourceType === e.AM) return this._oscillator.modulationType }, set: function(t) { this._sourceType !== e.FM && this._sourceType !== e.AM || (this._oscillator.modulationType = t) } }), Object.defineProperty(t.OmniOscillator.prototype, "modulationIndex", { get: function() { if (this._sourceType === e.FM) return this._oscillator.modulationIndex } }), Object.defineProperty(t.OmniOscillator.prototype, "harmonicity", { get: function() { if (this._sourceType === e.FM || this._sourceType === e.AM) return this._oscillator.harmonicity } }), Object.defineProperty(t.OmniOscillator.prototype, "modulationFrequency", { get: function() { if (this._sourceType === e.PWM) return this._oscillator.modulationFrequency } }), t.OmniOscillator.prototype.dispose = function() { return t.Source.prototype.dispose.call(this), this._writable(["frequency", "detune"]), this.detune.dispose(), this.detune = null, this.frequency.dispose(), this.frequency = null, this._oscillator.dispose(), this._oscillator = null, this._sourceType = null, this }, t.OmniOscillator
        }), t(function(t) { return t.Instrument = function(e) { e = t.defaultArg(e, t.Instrument.defaults), t.AudioNode.call(this), this._volume = this.output = new t.Volume(e.volume), this.volume = this._volume.volume, this._readOnly("volume") }, t.extend(t.Instrument, t.AudioNode), t.Instrument.defaults = { volume: 0 }, t.Instrument.prototype.triggerAttack = t.noOp, t.Instrument.prototype.triggerRelease = t.noOp, t.Instrument.prototype.triggerAttackRelease = function(t, e, i, n) { return i = this.toSeconds(i), e = this.toSeconds(e), this.triggerAttack(t, i, n), this.triggerRelease(i + e), this }, t.Instrument.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._volume.dispose(), this._volume = null, this._writable(["volume"]), this.volume = null, this }, t.Instrument }), t(function(t) { return t.Monophonic = function(e) { e = t.defaultArg(e, t.Monophonic.defaults), t.Instrument.call(this, e), this.portamento = e.portamento }, t.extend(t.Monophonic, t.Instrument), t.Monophonic.defaults = { portamento: 0 }, t.Monophonic.prototype.triggerAttack = function(t, e, i) { return e = this.toSeconds(e), this._triggerEnvelopeAttack(e, i), this.setNote(t, e), this }, t.Monophonic.prototype.triggerRelease = function(t) { return t = this.toSeconds(t), this._triggerEnvelopeRelease(t), this }, t.Monophonic.prototype._triggerEnvelopeAttack = function() {}, t.Monophonic.prototype._triggerEnvelopeRelease = function() {}, t.Monophonic.prototype.setNote = function(t, e) { var i, n; return e = this.toSeconds(e), this.portamento > 0 ? (i = this.frequency.value, this.frequency.setValueAtTime(i, e), n = this.toSeconds(this.portamento), this.frequency.exponentialRampToValueAtTime(t, e + n)) : this.frequency.setValueAtTime(t, e), this }, t.Monophonic }), t(function(t) { return t.Synth = function(e) { e = t.defaultArg(e, t.Synth.defaults), t.Monophonic.call(this, e), this.oscillator = new t.OmniOscillator(e.oscillator), this.frequency = this.oscillator.frequency, this.detune = this.oscillator.detune, this.envelope = new t.AmplitudeEnvelope(e.envelope), this.oscillator.chain(this.envelope, this.output), this.oscillator.start(), this._readOnly(["oscillator", "frequency", "detune", "envelope"]) }, t.extend(t.Synth, t.Monophonic), t.Synth.defaults = { oscillator: { type: "triangle" }, envelope: { attack: .005, decay: .1, sustain: .3, release: 1 } }, t.Synth.prototype._triggerEnvelopeAttack = function(t, e) { return this.envelope.triggerAttack(t, e), this }, t.Synth.prototype._triggerEnvelopeRelease = function(t) { return this.envelope.triggerRelease(t), this }, t.Synth.prototype.dispose = function() { return t.Monophonic.prototype.dispose.call(this), this._writable(["oscillator", "frequency", "detune", "envelope"]), this.oscillator.dispose(), this.oscillator = null, this.envelope.dispose(), this.envelope = null, this.frequency = null, this.detune = null, this }, t.Synth }), t(function(t) { return t.AMSynth = function(e) { e = t.defaultArg(e, t.AMSynth.defaults), t.Monophonic.call(this, e), this._carrier = new t.Synth, this._carrier.volume.value = -10, this.oscillator = this._carrier.oscillator, this.envelope = this._carrier.envelope.set(e.envelope), this._modulator = new t.Synth, this._modulator.volume.value = -10, this.modulation = this._modulator.oscillator.set(e.modulation), this.modulationEnvelope = this._modulator.envelope.set(e.modulationEnvelope), this.frequency = new t.Signal(440, t.Type.Frequency), this.detune = new t.Signal(e.detune, t.Type.Cents), this.harmonicity = new t.Multiply(e.harmonicity), this.harmonicity.units = t.Type.Positive, this._modulationScale = new t.AudioToGain, this._modulationNode = new t.Gain, this.frequency.connect(this._carrier.frequency), this.frequency.chain(this.harmonicity, this._modulator.frequency), this.detune.fan(this._carrier.detune, this._modulator.detune), this._modulator.chain(this._modulationScale, this._modulationNode.gain), this._carrier.chain(this._modulationNode, this.output), this._readOnly(["frequency", "harmonicity", "oscillator", "envelope", "modulation", "modulationEnvelope", "detune"]) }, t.extend(t.AMSynth, t.Monophonic), t.AMSynth.defaults = { harmonicity: 3, detune: 0, oscillator: { type: "sine" }, envelope: { attack: .01, decay: .01, sustain: 1, release: .5 }, modulation: { type: "square" }, modulationEnvelope: { attack: .5, decay: 0, sustain: 1, release: .5 } }, t.AMSynth.prototype._triggerEnvelopeAttack = function(t, e) { return t = this.toSeconds(t), this.envelope.triggerAttack(t, e), this.modulationEnvelope.triggerAttack(t, e), this }, t.AMSynth.prototype._triggerEnvelopeRelease = function(t) { return this.envelope.triggerRelease(t), this.modulationEnvelope.triggerRelease(t), this }, t.AMSynth.prototype.dispose = function() { return t.Monophonic.prototype.dispose.call(this), this._writable(["frequency", "harmonicity", "oscillator", "envelope", "modulation", "modulationEnvelope", "detune"]), this._carrier.dispose(), this._carrier = null, this._modulator.dispose(), this._modulator = null, this.frequency.dispose(), this.frequency = null, this.detune.dispose(), this.detune = null, this.harmonicity.dispose(), this.harmonicity = null, this._modulationScale.dispose(), this._modulationScale = null, this._modulationNode.dispose(), this._modulationNode = null, this.oscillator = null, this.envelope = null, this.modulationEnvelope = null, this.modulation = null, this }, t.AMSynth }), t(function(t) { return t.MonoSynth = function(e) { e = t.defaultArg(e, t.MonoSynth.defaults), t.Monophonic.call(this, e), this.oscillator = new t.OmniOscillator(e.oscillator), this.frequency = this.oscillator.frequency, this.detune = this.oscillator.detune, this.filter = new t.Filter(e.filter), this.filterEnvelope = new t.FrequencyEnvelope(e.filterEnvelope), this.envelope = new t.AmplitudeEnvelope(e.envelope), this.oscillator.chain(this.filter, this.envelope, this.output), this.oscillator.start(), this.filterEnvelope.connect(this.filter.frequency), this._readOnly(["oscillator", "frequency", "detune", "filter", "filterEnvelope", "envelope"]) }, t.extend(t.MonoSynth, t.Monophonic), t.MonoSynth.defaults = { frequency: "C4", detune: 0, oscillator: { type: "square" }, filter: { Q: 6, type: "lowpass", rolloff: -24 }, envelope: { attack: .005, decay: .1, sustain: .9, release: 1 }, filterEnvelope: { attack: .06, decay: .2, sustain: .5, release: 2, baseFrequency: 200, octaves: 7, exponent: 2 } }, t.MonoSynth.prototype._triggerEnvelopeAttack = function(t, e) { return this.envelope.triggerAttack(t, e), this.filterEnvelope.triggerAttack(t), this }, t.MonoSynth.prototype._triggerEnvelopeRelease = function(t) { return this.envelope.triggerRelease(t), this.filterEnvelope.triggerRelease(t), this }, t.MonoSynth.prototype.dispose = function() { return t.Monophonic.prototype.dispose.call(this), this._writable(["oscillator", "frequency", "detune", "filter", "filterEnvelope", "envelope"]), this.oscillator.dispose(), this.oscillator = null, this.envelope.dispose(), this.envelope = null, this.filterEnvelope.dispose(), this.filterEnvelope = null, this.filter.dispose(), this.filter = null, this.frequency = null, this.detune = null, this }, t.MonoSynth }), t(function(t) { return t.DuoSynth = function(e) { e = t.defaultArg(e, t.DuoSynth.defaults), t.Monophonic.call(this, e), this.voice0 = new t.MonoSynth(e.voice0), this.voice0.volume.value = -10, this.voice1 = new t.MonoSynth(e.voice1), this.voice1.volume.value = -10, this._vibrato = new t.LFO(e.vibratoRate, -50, 50), this._vibrato.start(), this.vibratoRate = this._vibrato.frequency, this._vibratoGain = new t.Gain(e.vibratoAmount, t.Type.Positive), this.vibratoAmount = this._vibratoGain.gain, this.frequency = new t.Signal(440, t.Type.Frequency), this.harmonicity = new t.Multiply(e.harmonicity), this.harmonicity.units = t.Type.Positive, this.frequency.connect(this.voice0.frequency), this.frequency.chain(this.harmonicity, this.voice1.frequency), this._vibrato.connect(this._vibratoGain), this._vibratoGain.fan(this.voice0.detune, this.voice1.detune), this.voice0.connect(this.output), this.voice1.connect(this.output), this._readOnly(["voice0", "voice1", "frequency", "vibratoAmount", "vibratoRate"]) }, t.extend(t.DuoSynth, t.Monophonic), t.DuoSynth.defaults = { vibratoAmount: .5, vibratoRate: 5, harmonicity: 1.5, voice0: { volume: -10, portamento: 0, oscillator: { type: "sine" }, filterEnvelope: { attack: .01, decay: 0, sustain: 1, release: .5 }, envelope: { attack: .01, decay: 0, sustain: 1, release: .5 } }, voice1: { volume: -10, portamento: 0, oscillator: { type: "sine" }, filterEnvelope: { attack: .01, decay: 0, sustain: 1, release: .5 }, envelope: { attack: .01, decay: 0, sustain: 1, release: .5 } } }, t.DuoSynth.prototype._triggerEnvelopeAttack = function(t, e) { return t = this.toSeconds(t), this.voice0.envelope.triggerAttack(t, e), this.voice1.envelope.triggerAttack(t, e), this.voice0.filterEnvelope.triggerAttack(t), this.voice1.filterEnvelope.triggerAttack(t), this }, t.DuoSynth.prototype._triggerEnvelopeRelease = function(t) { return this.voice0.triggerRelease(t), this.voice1.triggerRelease(t), this }, t.DuoSynth.prototype.dispose = function() { return t.Monophonic.prototype.dispose.call(this), this._writable(["voice0", "voice1", "frequency", "vibratoAmount", "vibratoRate"]), this.voice0.dispose(), this.voice0 = null, this.voice1.dispose(), this.voice1 = null, this.frequency.dispose(), this.frequency = null, this._vibratoGain.dispose(), this._vibratoGain = null, this._vibrato = null, this.harmonicity.dispose(), this.harmonicity = null, this.vibratoAmount.dispose(), this.vibratoAmount = null, this.vibratoRate = null, this }, t.DuoSynth }), t(function(t) { return t.FMSynth = function(e) { e = t.defaultArg(e, t.FMSynth.defaults), t.Monophonic.call(this, e), this._carrier = new t.Synth(e.carrier), this._carrier.volume.value = -10, this.oscillator = this._carrier.oscillator, this.envelope = this._carrier.envelope.set(e.envelope), this._modulator = new t.Synth(e.modulator), this._modulator.volume.value = -10, this.modulation = this._modulator.oscillator.set(e.modulation), this.modulationEnvelope = this._modulator.envelope.set(e.modulationEnvelope), this.frequency = new t.Signal(440, t.Type.Frequency), this.detune = new t.Signal(e.detune, t.Type.Cents), this.harmonicity = new t.Multiply(e.harmonicity), this.harmonicity.units = t.Type.Positive, this.modulationIndex = new t.Multiply(e.modulationIndex), this.modulationIndex.units = t.Type.Positive, this._modulationNode = new t.Gain(0), this.frequency.connect(this._carrier.frequency), this.frequency.chain(this.harmonicity, this._modulator.frequency), this.frequency.chain(this.modulationIndex, this._modulationNode), this.detune.fan(this._carrier.detune, this._modulator.detune), this._modulator.connect(this._modulationNode.gain), this._modulationNode.connect(this._carrier.frequency), this._carrier.connect(this.output), this._readOnly(["frequency", "harmonicity", "modulationIndex", "oscillator", "envelope", "modulation", "modulationEnvelope", "detune"]) }, t.extend(t.FMSynth, t.Monophonic), t.FMSynth.defaults = { harmonicity: 3, modulationIndex: 10, detune: 0, oscillator: { type: "sine" }, envelope: { attack: .01, decay: .01, sustain: 1, release: .5 }, modulation: { type: "square" }, modulationEnvelope: { attack: .5, decay: 0, sustain: 1, release: .5 } }, t.FMSynth.prototype._triggerEnvelopeAttack = function(t, e) { return t = this.toSeconds(t), this.envelope.triggerAttack(t, e), this.modulationEnvelope.triggerAttack(t), this }, t.FMSynth.prototype._triggerEnvelopeRelease = function(t) { return t = this.toSeconds(t), this.envelope.triggerRelease(t), this.modulationEnvelope.triggerRelease(t), this }, t.FMSynth.prototype.dispose = function() { return t.Monophonic.prototype.dispose.call(this), this._writable(["frequency", "harmonicity", "modulationIndex", "oscillator", "envelope", "modulation", "modulationEnvelope", "detune"]), this._carrier.dispose(), this._carrier = null, this._modulator.dispose(), this._modulator = null, this.frequency.dispose(), this.frequency = null, this.detune.dispose(), this.detune = null, this.modulationIndex.dispose(), this.modulationIndex = null, this.harmonicity.dispose(), this.harmonicity = null, this._modulationNode.dispose(), this._modulationNode = null, this.oscillator = null, this.envelope = null, this.modulationEnvelope = null, this.modulation = null, this }, t.FMSynth }), t(function(t) { return t.MembraneSynth = function(e) { e = t.defaultArg(e, t.MembraneSynth.defaults), t.Instrument.call(this, e), this.oscillator = new t.OmniOscillator(e.oscillator).start(), this.envelope = new t.AmplitudeEnvelope(e.envelope), this.octaves = e.octaves, this.pitchDecay = e.pitchDecay, this.oscillator.chain(this.envelope, this.output), this._readOnly(["oscillator", "envelope"]) }, t.extend(t.MembraneSynth, t.Instrument), t.MembraneSynth.defaults = { pitchDecay: .05, octaves: 10, oscillator: { type: "sine" }, envelope: { attack: .001, decay: .4, sustain: .01, release: 1.4, attackCurve: "exponential" } }, t.MembraneSynth.prototype.triggerAttack = function(t, e, i) { e = this.toSeconds(e), t = this.toFrequency(t); var n = t * this.octaves; return this.oscillator.frequency.setValueAtTime(n, e), this.oscillator.frequency.exponentialRampToValueAtTime(t, e + this.toSeconds(this.pitchDecay)), this.envelope.triggerAttack(e, i), this }, t.MembraneSynth.prototype.triggerRelease = function(t) { return this.envelope.triggerRelease(t), this }, t.MembraneSynth.prototype.dispose = function() { return t.Instrument.prototype.dispose.call(this), this._writable(["oscillator", "envelope"]), this.oscillator.dispose(), this.oscillator = null, this.envelope.dispose(), this.envelope = null, this }, t.MembraneSynth }), t(function(t) { var e = [1, 1.483, 1.932, 2.546, 2.63, 3.897]; return t.MetalSynth = function(i) { var n, s, o; for (i = t.defaultArg(i, t.MetalSynth.defaults), t.Instrument.call(this, i), this.frequency = new t.Signal(i.frequency, t.Type.Frequency), this._oscillators = [], this._freqMultipliers = [], this._amplitue = new t.Gain(0).connect(this.output), this._highpass = new t.Filter({ type: "highpass", Q: -3.0102999566398125 }).connect(this._amplitue), this._octaves = i.octaves, this._filterFreqScaler = new t.Scale(i.resonance, 7e3), this.envelope = new t.Envelope({ attack: i.envelope.attack, attackCurve: "linear", decay: i.envelope.decay, sustain: 0, release: i.envelope.release }).chain(this._filterFreqScaler, this._highpass.frequency), this.envelope.connect(this._amplitue.gain), n = 0; n < e.length; n++) s = new t.FMOscillator({ type: "square", modulationType: "square", harmonicity: i.harmonicity, modulationIndex: i.modulationIndex }), s.connect(this._highpass).start(), this._oscillators[n] = s, o = new t.Multiply(e[n]), this._freqMultipliers[n] = o, this.frequency.chain(o, s.frequency);
                this.octaves = i.octaves }, t.extend(t.MetalSynth, t.Instrument), t.MetalSynth.defaults = { frequency: 200, envelope: { attack: .001, decay: 1.4, release: .2 }, harmonicity: 5.1, modulationIndex: 32, resonance: 4e3, octaves: 1.5 }, t.MetalSynth.prototype.triggerAttack = function(e, i) { return e = this.toSeconds(e), i = t.defaultArg(i, 1), this.envelope.triggerAttack(e, i), this }, t.MetalSynth.prototype.triggerRelease = function(t) { return t = this.toSeconds(t), this.envelope.triggerRelease(t), this }, t.MetalSynth.prototype.triggerAttackRelease = function(t, e, i) { return e = this.toSeconds(e), t = this.toSeconds(t), this.triggerAttack(e, i), this.triggerRelease(e + t), this }, Object.defineProperty(t.MetalSynth.prototype, "modulationIndex", { get: function() { return this._oscillators[0].modulationIndex.value }, set: function(t) { for (var e = 0; e < this._oscillators.length; e++) this._oscillators[e].modulationIndex.value = t } }), Object.defineProperty(t.MetalSynth.prototype, "harmonicity", { get: function() { return this._oscillators[0].harmonicity.value }, set: function(t) { for (var e = 0; e < this._oscillators.length; e++) this._oscillators[e].harmonicity.value = t } }), Object.defineProperty(t.MetalSynth.prototype, "resonance", { get: function() { return this._filterFreqScaler.min }, set: function(t) { this._filterFreqScaler.min = t, this.octaves = this._octaves } }), Object.defineProperty(t.MetalSynth.prototype, "octaves", { get: function() { return this._octaves }, set: function(t) { this._octaves = t, this._filterFreqScaler.max = this._filterFreqScaler.min * Math.pow(2, t) } }), t.MetalSynth.prototype.dispose = function() { t.Instrument.prototype.dispose.call(this); for (var e = 0; e < this._oscillators.length; e++) this._oscillators[e].dispose(), this._freqMultipliers[e].dispose();
                this._oscillators = null, this._freqMultipliers = null, this.frequency.dispose(), this.frequency = null, this._filterFreqScaler.dispose(), this._filterFreqScaler = null, this._amplitue.dispose(), this._amplitue = null, this.envelope.dispose(), this.envelope = null, this._highpass.dispose(), this._highpass = null }, t.MetalSynth }), t(function(t) { return t.BufferSource = function() { var e = t.defaults(arguments, ["buffer", "onload"], t.BufferSource);
                t.AudioNode.call(this), this.onended = e.onended, this._startTime = -1, this._stopTime = -1, this._gainNode = this.output = new t.Gain, this._source = this.context.createBufferSource(), this._source.connect(this._gainNode), this._buffer = new t.Buffer(e.buffer, e.onload), this.playbackRate = new t.Param(this._source.playbackRate, t.Type.Positive), this.fadeIn = e.fadeIn, this.fadeOut = e.fadeOut, this.curve = e.curve, this._gain = 1, this._onendedTimeout = -1, this.loop = e.loop, this.loopStart = e.loopStart, this.loopEnd = e.loopEnd, this.playbackRate.value = e.playbackRate }, t.extend(t.BufferSource, t.AudioNode), t.BufferSource.defaults = { onended: t.noOp, onload: t.noOp, loop: !1, loopStart: 0, loopEnd: 0, fadeIn: 0, fadeOut: 0, curve: "linear", playbackRate: 1 }, Object.defineProperty(t.BufferSource.prototype, "state", { get: function() { var e = this.now(); return -1 !== this._startTime && e >= this._startTime && e < this._stopTime ? t.State.Started : t.State.Stopped } }), t.BufferSource.prototype.start = function(e, i, n, s, o) { var r, a, l, h; if (-1 !== this._startTime) throw new Error("Tone.BufferSource can only be started once."); if (!this.buffer.loaded) throw new Error("Tone.BufferSource: buffer is either not set or not loaded."); return e = this.toSeconds(e), i = this.loop ? t.defaultArg(i, this.loopStart) : t.defaultArg(i, 0), i = this.toSeconds(i), s = t.defaultArg(s, 1), this._gain = s, o = this.toSeconds(t.defaultArg(o, this.fadeIn)), this.fadeIn = o, o > 0 ? (this._gainNode.gain.setValueAtTime(0, e), "linear" === this.curve ? this._gainNode.gain.linearRampToValueAtTime(this._gain, e + o) : this._gainNode.gain.exponentialAppraochValueAtTime(this._gain, e, o)) : this._gainNode.gain.setValueAtTime(s, e), this._startTime = e, r = this.toSeconds(t.defaultArg(n, this.buffer.duration - i % this.buffer.duration)), r = Math.max(r, 0), (!this.loop || this.loop && !t.isUndef(n)) && (this.loop || (r = Math.min(r, this.buffer.duration - i % this.buffer.duration)), this.stop(e + r, this.fadeOut)), this.loop && (a = this.loopEnd || this.buffer.duration, l = this.loopStart, h = a - l, i > a && (i = (i - l) % h + l)), this._source.buffer = this.buffer.get(), this._source.loopEnd = this.loopEnd || this.buffer.duration, t.isPast(e), this._source.start(e, i), this }, t.BufferSource.prototype.stop = function(e, i) { var n, s; if (!this.buffer.loaded) throw new Error("Tone.BufferSource: buffer is either not set or not loaded."); if (e = this.toSeconds(e), -1 === this._stopTime || this._stopTime > e) { if (e <= this._startTime) return this._gainNode.gain.cancelScheduledValues(e), this._gainNode.gain.value = 0, this;
                    e = Math.max(this._startTime + this.fadeIn + this.sampleTime, e), this._gainNode.gain.cancelScheduledValues(e), this._stopTime = e, i = this.toSeconds(t.defaultArg(i, this.fadeOut)), n = e - this._startTime - this.fadeIn - this.sampleTime, this.loop || (n = Math.min(n, this.buffer.duration)), i = Math.min(n, i), s = e - i, i > this.sampleTime ? (this._gainNode.gain.setValueAtTime(this._gain, s), "linear" === this.curve ? this._gainNode.gain.linearRampToValueAtTime(0, e) : this._gainNode.gain.exponentialAppraochValueAtTime(0, s, i)) : this._gainNode.gain.setValueAtTime(0, e), t.context.clearTimeout(this._onendedTimeout), this._onendedTimeout = t.context.setTimeout(this._onended.bind(this), this._stopTime - this.now()) } return this }, t.BufferSource.prototype._onended = function() { var t = "exponential" === this.curve ? 2 * this.fadeOut : 0;
                this._source.stop(this._stopTime + t), this.onended(this) }, Object.defineProperty(t.BufferSource.prototype, "loopStart", { get: function() { return this._source.loopStart }, set: function(t) { this._source.loopStart = this.toSeconds(t) } }), Object.defineProperty(t.BufferSource.prototype, "loopEnd", { get: function() { return this._source.loopEnd }, set: function(t) { this._source.loopEnd = this.toSeconds(t) } }), Object.defineProperty(t.BufferSource.prototype, "buffer", { get: function() { return this._buffer }, set: function(t) { this._buffer.set(t) } }), Object.defineProperty(t.BufferSource.prototype, "loop", { get: function() { return this._source.loop }, set: function(t) { this._source.loop = t } }), t.BufferSource.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this.onended = null, this._source.disconnect(), this._source = null, this._gainNode.dispose(), this._gainNode = null, this._buffer.dispose(), this._buffer = null, this._startTime = -1, this.playbackRate = null, t.context.clearTimeout(this._onendedTimeout), this }, t.BufferSource }), t(function(t) {
            function e() { for (var e in s) o[e] = (new t.Buffer).fromArray(s[e]) } var i, n, s, o; return t.Noise = function() { var e = t.defaults(arguments, ["type"], t.Noise);
                t.Source.call(this, e), this._source = null, this._type = e.type, this._playbackRate = e.playbackRate }, t.extend(t.Noise, t.Source), t.Noise.defaults = { type: "white", playbackRate: 1 }, Object.defineProperty(t.Noise.prototype, "type", { get: function() { return this._type }, set: function(e) { if (this._type !== e) { if (!(e in o)) throw new TypeError("Tone.Noise: invalid type: " + e); if (this._type = e, this.state === t.State.Started) { var i = this.now();
                            this._stop(i), this._start(i) } } } }), Object.defineProperty(t.Noise.prototype, "playbackRate", { get: function() { return this._playbackRate }, set: function(t) { this._playbackRate = t, this._source && (this._source.playbackRate.value = t) } }), t.Noise.prototype._start = function(e) { var i = o[this._type];
                this._source = new t.BufferSource(i).connect(this.output), this._source.loop = !0, this._source.playbackRate.value = this._playbackRate, this._source.start(this.toSeconds(e), Math.random() * (i.duration - .001)) }, t.Noise.prototype._stop = function(t) { this._source && (this._source.stop(this.toSeconds(t)), this._source = null) }, t.Noise.prototype.dispose = function() { return t.Source.prototype.dispose.call(this), null !== this._source && (this._source.disconnect(), this._source = null), this._buffer = null, this }, i = 220500, n = 2, s = { pink: function() { var t, e, s, o, r, a, l, h, u, p, c, d = []; for (t = 0; t < n; t++)
                        for (e = new Float32Array(i), d[t] = e, s = o = r = a = l = h = u = 0, p = 0; p < i; p++) c = 2 * Math.random() - 1, s = .99886 * s + .0555179 * c, o = .99332 * o + .0750759 * c, r = .969 * r + .153852 * c, a = .8665 * a + .3104856 * c, l = .55 * l + .5329522 * c, h = -.7616 * h - .016898 * c, e[p] = s + o + r + a + l + h + u + .5362 * c, e[p] *= .11, u = .115926 * c; return d }(), brown: function() { var t, e, s, o, r, a = []; for (t = 0; t < n; t++)
                        for (e = new Float32Array(i), a[t] = e, s = 0, o = 0; o < i; o++) r = 2 * Math.random() - 1, e[o] = (s + .02 * r) / 1.02, s = e[o], e[o] *= 3.5; return a }(), white: function() { var t, e, s, o = []; for (t = 0; t < n; t++)
                        for (e = new Float32Array(i), o[t] = e, s = 0; s < i; s++) e[s] = 2 * Math.random() - 1; return o }() }, o = {}, t.getContext(e), t.Context.on("init", e), t.Noise }), t(function(t) { return t.NoiseSynth = function(e) { e = t.defaultArg(e, t.NoiseSynth.defaults), t.Instrument.call(this, e), this.noise = new t.Noise, this.envelope = new t.AmplitudeEnvelope(e.envelope), this.noise.chain(this.envelope, this.output), this.noise.start(), this._readOnly(["noise", "envelope"]) }, t.extend(t.NoiseSynth, t.Instrument), t.NoiseSynth.defaults = { noise: { type: "white" }, envelope: { attack: .005, decay: .1, sustain: 0 } }, t.NoiseSynth.prototype.triggerAttack = function(t, e) { return this.envelope.triggerAttack(t, e), this }, t.NoiseSynth.prototype.triggerRelease = function(t) { return this.envelope.triggerRelease(t), this }, t.NoiseSynth.prototype.triggerAttackRelease = function(t, e, i) { return e = this.toSeconds(e), t = this.toSeconds(t), this.triggerAttack(e, i), this.triggerRelease(e + t), this }, t.NoiseSynth.prototype.dispose = function() { return t.Instrument.prototype.dispose.call(this), this._writable(["noise", "envelope"]), this.noise.dispose(), this.noise = null, this.envelope.dispose(), this.envelope = null, this }, t.NoiseSynth }), t(function(t) { return t.PluckSynth = function(e) { e = t.defaultArg(e, t.PluckSynth.defaults), t.Instrument.call(this, e), this._noise = new t.Noise("pink"), this.attackNoise = e.attackNoise, this._lfcf = new t.LowpassCombFilter({ resonance: e.resonance, dampening: e.dampening }), this.resonance = this._lfcf.resonance, this.dampening = this._lfcf.dampening, this._noise.connect(this._lfcf), this._lfcf.connect(this.output), this._readOnly(["resonance", "dampening"]) }, t.extend(t.PluckSynth, t.Instrument), t.PluckSynth.defaults = { attackNoise: 1, dampening: 4e3, resonance: .9 }, t.PluckSynth.prototype.triggerAttack = function(t, e) { t = this.toFrequency(t), e = this.toSeconds(e); var i = 1 / t; return this._lfcf.delayTime.setValueAtTime(i, e), this._noise.start(e), this._noise.stop(e + i * this.attackNoise), this }, t.PluckSynth.prototype.dispose = function() { return t.Instrument.prototype.dispose.call(this), this._noise.dispose(), this._lfcf.dispose(), this._noise = null, this._lfcf = null, this._writable(["resonance", "dampening"]), this.dampening = null, this.resonance = null, this }, t.PluckSynth }), t(function(t) { return t.PolySynth = function() { var e, i, n = t.defaults(arguments, ["polyphony", "voice"], t.PolySynth); for (t.Instrument.call(this, n), n = t.defaultArg(n, t.Instrument.defaults), n.polyphony = Math.min(t.PolySynth.MAX_POLYPHONY, n.polyphony), this.voices = new Array(n.polyphony), this._triggers = new Array(n.polyphony), this.detune = new t.Signal(n.detune, t.Type.Cents), this._readOnly("detune"), e = 0; e < n.polyphony; e++) i = new n.voice(arguments[2], arguments[3]), this.voices[e] = i, i.connect(this.output), i.hasOwnProperty("detune") && this.detune.connect(i.detune), this._triggers[e] = { release: -1, note: null, voice: i } }, t.extend(t.PolySynth, t.Instrument), t.PolySynth.defaults = { polyphony: 4, volume: 0, detune: 0, voice: t.Synth }, t.PolySynth.prototype.triggerAttack = function(t, e, i) { var n, s, o, r; for (Array.isArray(t) || (t = [t]), e = this.toSeconds(e), n = 0; n < t.length; n++) { for (s = t[n], o = this._triggers[0], r = 1; r < this._triggers.length; r++) this._triggers[r].release < o.release && (o = this._triggers[r]);
                    o.release = 1 / 0, o.note = JSON.stringify(s), o.voice.triggerAttack(s, e, i) } return this }, t.PolySynth.prototype.triggerAttackRelease = function(e, i, n, s) { var o, r; if (n = this.toSeconds(n), this.triggerAttack(e, n, s), t.isArray(i) && t.isArray(e))
                    for (o = 0; o < e.length; o++) r = i[Math.min(o, i.length - 1)], this.triggerRelease(e[o], n + this.toSeconds(r));
                else this.triggerRelease(e, n + this.toSeconds(i)); return this }, t.PolySynth.prototype.triggerRelease = function(t, e) { var i, n, s, o; for (Array.isArray(t) || (t = [t]), e = this.toSeconds(e), i = 0; i < t.length; i++)
                    for (n = JSON.stringify(t[i]), s = 0; s < this._triggers.length; s++) o = this._triggers[s], o.note === n && o.release > e && (o.voice.triggerRelease(e), o.release = e); return this }, t.PolySynth.prototype.set = function(t, e, i) { for (var n = 0; n < this.voices.length; n++) this.voices[n].set(t, e, i); return this }, t.PolySynth.prototype.get = function(t) { return this.voices[0].get(t) }, t.PolySynth.prototype.releaseAll = function(t) { var e, i; for (t = this.toSeconds(t), e = 0; e < this._triggers.length; e++) i = this._triggers[e], i.release > t && (i.release = t, i.voice.triggerRelease(t)); return this }, t.PolySynth.prototype.dispose = function() { t.Instrument.prototype.dispose.call(this); for (var e = 0; e < this.voices.length; e++) this.voices[e].dispose(), this.voices[e] = null; return this._writable("detune"), this.detune.dispose(), this.detune = null, this.voices = null, this._triggers = null, this }, t.PolySynth.MAX_POLYPHONY = 20, t.PolySynth }), t(function(t) { return t.Sampler = function(e) { var i, n, s, o, r = Array.prototype.slice.call(arguments);
                r.shift(), i = t.defaults(r, ["onload", "baseUrl"], t.Sampler), t.Instrument.call(this, i), n = {}; for (s in e)
                    if (t.isNote(s)) o = t.Frequency(s).toMidi(), n[o] = e[s];
                    else { if (isNaN(parseFloat(s))) throw new Error("Tone.Sampler: url keys must be the note's pitch");
                        n[s] = e[s] } this._buffers = new t.Buffers(n, i.onload, i.baseUrl), this._activeSources = {}, this.attack = i.attack, this.release = i.release }, t.extend(t.Sampler, t.Instrument), t.Sampler.defaults = { attack: 0, release: .1, onload: t.noOp, baseUrl: "" }, t.Sampler.prototype._findClosest = function(t) { for (var e = 24, i = 0; i < e;) { if (this._buffers.has(t + i)) return -i; if (this._buffers.has(t - i)) return i;
                    i++ } return null }, t.Sampler.prototype.triggerAttack = function(e, i, n) { var s, o, r, a = t.Frequency(e).toMidi(),
                    l = this._findClosest(a); return null !== l && (s = a - l, o = this._buffers.get(s), r = new t.BufferSource({ buffer: o, playbackRate: t.intervalToFrequencyRatio(l), fadeIn: this.attack, fadeOut: this.release, curve: "exponential" }).connect(this.output), r.start(i, 0, o.duration, n), t.isArray(this._activeSources[a]) || (this._activeSources[a] = []), this._activeSources[a].push({ note: a, source: r })), this }, t.Sampler.prototype.triggerRelease = function(e, i) { var n, s = t.Frequency(e).toMidi();
                this._activeSources[s] && this._activeSources[s].length && (n = this._activeSources[s].shift().source, i = this.toSeconds(i), n.stop(i + this.release, this.release)) }, t.Sampler.prototype.triggerAttackRelease = function(t, e, i, n) { return i = this.toSeconds(i), e = this.toSeconds(e), this.triggerAttack(t, i, n), this.triggerRelease(t, i + e), this }, t.Sampler.prototype.add = function(e, i, n) { if (t.isNote(e)) { var s = t.Frequency(e).toMidi();
                    this._buffers.add(s, i, n) } else { if (isNaN(parseFloat(e))) throw new Error("Tone.Sampler: note must be the note's pitch. Instead got " + e);
                    this._buffers.add(e, i, n) } }, Object.defineProperty(t.Sampler.prototype, "loaded", { get: function() { return this._buffers.loaded } }), t.Sampler.prototype.dispose = function() { t.Instrument.prototype.dispose.call(this), this._buffers.dispose(), this._buffers = null; for (var e in this._activeSources) this._activeSources[e].forEach(function(t) { t.source.dispose() }); return this._activeSources = null, this }, t.Sampler }), t(function(t) { t.supported && (OscillatorNode.prototype.setPeriodicWave || (OscillatorNode.prototype.setPeriodicWave = OscillatorNode.prototype.setWaveTable), AudioContext.prototype.createPeriodicWave || (AudioContext.prototype.createPeriodicWave = AudioContext.prototype.createWaveTable)) }), t(function(t) {
            function e(t, e, i) { var n = new t; return i._eval(e[0]).connect(n, 0, 0), i._eval(e[1]).connect(n, 0, 1), n }

            function i(t, e, i) { var n = new t; return i._eval(e[0]).connect(n, 0, 0), n }

            function n(t) { return t ? parseFloat(t) : void 0 }

            function s(t) { return t && t.args ? parseFloat(t.args) : void 0 }
            return t.Expr = function() {
                var e, i, n, s, o;
                for (t.SignalBase.call(this), e = this._replacements(Array.prototype.slice.call(arguments)), i = this._parseInputs(e),
                    this._nodes = [], this.input = new Array(i), n = 0; n < i; n++) this.input[n] = this.context.createGain();
                s = this._parseTree(e);
                try { o = this._eval(s) } catch (t) { throw this._disposeNodes(), new Error("Tone.Expr: Could evaluate expression: " + e) } this.output = o
            }, t.extend(t.Expr, t.SignalBase), t.Expr._Expressions = { value: { signal: { regexp: /^\d+\.\d+|^\d+/, method: function(e) { return new t.Signal(n(e)) } }, input: { regexp: /^\$\d/, method: function(t, e) { return e.input[n(t.substr(1))] } } }, glue: { "(": { regexp: /^\(/ }, ")": { regexp: /^\)/ }, ",": { regexp: /^,/ } }, func: { abs: { regexp: /^abs/, method: i.bind(this, t.Abs) }, mod: { regexp: /^mod/, method: function(e, i) { var n = s(e[1]),
                                o = new t.Modulo(n); return i._eval(e[0]).connect(o), o } }, pow: { regexp: /^pow/, method: function(e, i) { var n = s(e[1]),
                                o = new t.Pow(n); return i._eval(e[0]).connect(o), o } }, a2g: { regexp: /^a2g/, method: function(e, i) { var n = new t.AudioToGain; return i._eval(e[0]).connect(n), n } } }, binary: { "+": { regexp: /^\+/, precedence: 1, method: e.bind(this, t.Add) }, "-": { regexp: /^-/, precedence: 1, method: function(n, s) { return 1 === n.length ? i(t.Negate, n, s) : e(t.Subtract, n, s) } }, "*": { regexp: /^\*/, precedence: 0, method: e.bind(this, t.Multiply) } }, unary: { "-": { regexp: /^-/, method: i.bind(this, t.Negate) }, "!": { regexp: /^!/, method: i.bind(this, t.NOT) } } }, t.Expr.prototype._parseInputs = function(t) { var e, i, n = t.match(/\$\d/g),
                    s = 0; if (null !== n)
                    for (e = 0; e < n.length; e++) i = parseInt(n[e].substr(1)) + 1, s = Math.max(s, i); return s }, t.Expr.prototype._replacements = function(t) { var e, i = t.shift(); for (e = 0; e < t.length; e++) i = i.replace(/%/i, t[e]); return i }, t.Expr.prototype._tokenize = function(e) { for (var i, n = -1, s = []; e.length > 0;) e = e.trim(), i = function(e) { var i, n, s, o, r, a; for (i in t.Expr._Expressions) { n = t.Expr._Expressions[i]; for (s in n)
                            if (o = n[s], r = o.regexp, null !== (a = e.match(r))) return { type: i, value: a[0], method: o.method } } throw new SyntaxError("Tone.Expr: Unexpected token " + e) }(e), s.push(i), e = e.substr(i.value.length); return { next: function() { return s[++n] }, peek: function() { return s[n + 1] } } }, t.Expr.prototype._parseTree = function(e) {
                function i(t, e) { return !u(t) && "glue" === t.type && t.value === e }

                function n(e, i, n) { var s, o, r = !1,
                        a = t.Expr._Expressions[i]; if (!u(e))
                        for (s in a)
                            if (o = a[s], o.regexp.test(e.value)) { if (u(n)) return !0; if (o.precedence === n) return !0 } return r }

                function s(t) { var e, i; for (u(t) && (t = 5), e = t < 0 ? o() : s(t - 1), i = h.peek(); n(i, "binary", t);) i = h.next(), e = { operator: i.value, method: i.method, args: [e, s(t - 1)] }, i = h.peek(); return e }

                function o() { var t, e; return t = h.peek(), n(t, "unary") ? (t = h.next(), e = o(), { operator: t.value, method: t.method, args: [e] }) : r() }

                function r() { var t, e; if (t = h.peek(), u(t)) throw new SyntaxError("Tone.Expr: Unexpected termination of expression"); if ("func" === t.type) return t = h.next(), a(t); if ("value" === t.type) return t = h.next(), { method: t.method, args: t.value }; if (i(t, "(")) { if (h.next(), e = s(), t = h.next(), !i(t, ")")) throw new SyntaxError("Expected )"); return e } throw new SyntaxError("Tone.Expr: Parse error, cannot process token " + t.value) }

                function a(t) { var e, n = []; if (e = h.next(), !i(e, "(")) throw new SyntaxError('Tone.Expr: Expected ( in a function call "' + t.value + '"'); if (e = h.peek(), i(e, ")") || (n = l()), e = h.next(), !i(e, ")")) throw new SyntaxError('Tone.Expr: Expected ) in a function call "' + t.value + '"'); return { method: t.method, args: n, name: name } }

                function l() { for (var t, e, n = [];;) { if (e = s(), u(e)) break; if (n.push(e), t = h.peek(), !i(t, ",")) break;
                        h.next() } return n } var h = this._tokenize(e),
                    u = t.isUndef.bind(this); return s() }, t.Expr.prototype._eval = function(e) { if (!t.isUndef(e)) { var i = e.method(e.args, this); return this._nodes.push(i), i } }, t.Expr.prototype._disposeNodes = function() { var e, i; for (e = 0; e < this._nodes.length; e++) i = this._nodes[e], t.isFunction(i.dispose) ? i.dispose() : t.isFunction(i.disconnect) && i.disconnect(), i = null, this._nodes[e] = null;
                this._nodes = null }, t.Expr.prototype.dispose = function() { t.SignalBase.prototype.dispose.call(this), this._disposeNodes() }, t.Expr
        }), t(function(t) { return t.GainToAudio = function() { t.SignalBase.call(this), this._norm = this.input = this.output = new t.WaveShaper(function(t) { return 2 * Math.abs(t) - 1 }) }, t.extend(t.GainToAudio, t.SignalBase), t.GainToAudio.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._norm.dispose(), this._norm = null, this }, t.GainToAudio }), t(function(t) { return t.Normalize = function(e, i) { t.SignalBase.call(this), this._inputMin = t.defaultArg(e, 0), this._inputMax = t.defaultArg(i, 1), this._sub = this.input = new t.Add(0), this._div = this.output = new t.Multiply(1), this._sub.connect(this._div), this._setRange() }, t.extend(t.Normalize, t.SignalBase), Object.defineProperty(t.Normalize.prototype, "min", { get: function() { return this._inputMin }, set: function(t) { this._inputMin = t, this._setRange() } }), Object.defineProperty(t.Normalize.prototype, "max", { get: function() { return this._inputMax }, set: function(t) { this._inputMax = t, this._setRange() } }), t.Normalize.prototype._setRange = function() { this._sub.value = -this._inputMin, this._div.value = 1 / (this._inputMax - this._inputMin) }, t.Normalize.prototype.dispose = function() { return t.SignalBase.prototype.dispose.call(this), this._sub.dispose(), this._sub = null, this._div.dispose(), this._div = null, this }, t.Normalize }), t(function(t) { return t.TransportTimelineSignal = function() { t.TimelineSignal.apply(this, arguments), this.output = this._outputSig = new t.Signal(this._initial), this._lastVal = this.value, this._synced = t.Transport.scheduleRepeat(this._onTick.bind(this), "1i"), this._bindAnchorValue = this._anchorValue.bind(this), t.Transport.on("start stop pause", this._bindAnchorValue), this._events.memory = 1 / 0 }, t.extend(t.TransportTimelineSignal, t.TimelineSignal), t.TransportTimelineSignal.prototype._onTick = function(e) { var i = this.getValueAtTime(t.Transport.seconds);
                this._lastVal !== i && (this._lastVal = i, this._outputSig.linearRampToValueAtTime(i, e)) }, t.TransportTimelineSignal.prototype._anchorValue = function(e) { var i = this.getValueAtTime(t.Transport.ticks); return this._lastVal = i, this._outputSig.cancelScheduledValues(e), this._outputSig.setValueAtTime(i, e), this }, t.TransportTimelineSignal.prototype.getValueAtTime = function(e) { return e = this.toTicks(e), t.TimelineSignal.prototype.getValueAtTime.call(this, e) }, t.TransportTimelineSignal.prototype.setValueAtTime = function(e, i) { return i = this.toTicks(i), t.TimelineSignal.prototype.setValueAtTime.call(this, e, i), this }, t.TransportTimelineSignal.prototype.linearRampToValueAtTime = function(e, i) { return i = this.toTicks(i), t.TimelineSignal.prototype.linearRampToValueAtTime.call(this, e, i), this }, t.TransportTimelineSignal.prototype.exponentialRampToValueAtTime = function(e, i) { return i = this.toTicks(i), t.TimelineSignal.prototype.exponentialRampToValueAtTime.call(this, e, i), this }, t.TransportTimelineSignal.prototype.setTargetAtTime = function(e, i, n) { return i = this.toTicks(i), t.TimelineSignal.prototype.setTargetAtTime.call(this, e, i, n), this }, t.TransportTimelineSignal.prototype.cancelScheduledValues = function(e) { return e = this.toTicks(e), t.TimelineSignal.prototype.cancelScheduledValues.call(this, e), this }, t.TransportTimelineSignal.prototype.setValueCurveAtTime = function(e, i, n, s) { return i = this.toTicks(i), n = this.toTicks(n), t.TimelineSignal.prototype.setValueCurveAtTime.call(this, e, i, n, s), this }, t.TransportTimelineSignal.prototype.dispose = function() { t.Transport.clear(this._synced), t.Transport.off("start stop pause", this._syncedCallback), this._events.cancel(0), t.TimelineSignal.prototype.dispose.call(this), this._outputSig.dispose(), this._outputSig = null }, t.TransportTimelineSignal }), t(function(t) { return t.GrainPlayer = function() { var e = t.defaults(arguments, ["url", "onload"], t.GrainPlayer);
                t.Source.call(this, e), this.buffer = new t.Buffer(e.url, e.onload), this._clock = new t.Clock(this._tick.bind(this), e.grainSize), this._loopStart = 0, this._loopEnd = 0, this._activeSources = [], this._playbackRate = e.playbackRate, this._grainSize = e.grainSize, this._overlap = e.overlap, this.detune = e.detune, this.overlap = e.overlap, this.loop = e.loop, this.playbackRate = e.playbackRate, this.grainSize = e.grainSize, this.loopStart = e.loopStart, this.loopEnd = e.loopEnd, this.reverse = e.reverse, this._clock.on("stop", this._onstop.bind(this)) }, t.extend(t.GrainPlayer, t.Source), t.GrainPlayer.defaults = { onload: t.noOp, overlap: .1, grainSize: .2, playbackRate: 1, detune: 0, loop: !1, loopStart: 0, loopEnd: 0, reverse: !1 }, t.GrainPlayer.prototype._start = function(e, i, n) { i = t.defaultArg(i, 0), i = this.toSeconds(i), e = this.toSeconds(e), this._offset = i, this._clock.start(e), n && this.stop(e + this.toSeconds(n)) }, t.GrainPlayer.prototype._stop = function(t) { this._clock.stop(t) }, t.GrainPlayer.prototype._onstop = function(t) { this._activeSources.forEach(function(e) { e.stop(t, 0) }) }, t.GrainPlayer.prototype._tick = function(e) { var i = this._offset < this._overlap ? 0 : this._overlap,
                    n = new t.BufferSource({ buffer: this.buffer, fadeIn: i, fadeOut: this._overlap, loop: this.loop, loopStart: this._loopStart, loopEnd: this._loopEnd, playbackRate: t.intervalToFrequencyRatio(this.detune / 100) }).connect(this.output);
                n.start(e, this._offset), this._offset += this.grainSize, n.stop(e + this.grainSize), this._activeSources.push(n), n.onended = function() { var t = this._activeSources.indexOf(n); - 1 !== t && this._activeSources.splice(t, 1) }.bind(this) }, t.GrainPlayer.prototype.seek = function(t, e) { return this._offset = this.toSeconds(t), this._tick(this.toSeconds(e)), this }, Object.defineProperty(t.GrainPlayer.prototype, "playbackRate", { get: function() { return this._playbackRate }, set: function(t) { this._playbackRate = t, this.grainSize = this._grainSize } }), Object.defineProperty(t.GrainPlayer.prototype, "loopStart", { get: function() { return this._loopStart }, set: function(t) { this._loopStart = this.toSeconds(t) } }), Object.defineProperty(t.GrainPlayer.prototype, "loopEnd", { get: function() { return this._loopEnd }, set: function(t) { this._loopEnd = this.toSeconds(t) } }), Object.defineProperty(t.GrainPlayer.prototype, "reverse", { get: function() { return this.buffer.reverse }, set: function(t) { this.buffer.reverse = t } }), Object.defineProperty(t.GrainPlayer.prototype, "grainSize", { get: function() { return this._grainSize }, set: function(t) { this._grainSize = this.toSeconds(t), this._clock.frequency.value = this._playbackRate / this._grainSize } }), Object.defineProperty(t.GrainPlayer.prototype, "overlap", { get: function() { return this._overlap }, set: function(t) { this._overlap = this.toSeconds(t) } }), t.GrainPlayer.prototype.dispose = function() { return t.Source.prototype.dispose.call(this), this.buffer.dispose(), this.buffer = null, this._clock.dispose(), this._clock = null, this._activeSources.forEach(function(t) { t.dispose() }), this._activeSources = null, this }, t.GrainPlayer }), t(function(t) { return t.Player = function(e) { var i;
                e instanceof t.Buffer ? (e = e.get(), i = t.Player.defaults) : i = t.defaults(arguments, ["url", "onload"], t.Player), t.Source.call(this, i), this.autostart = i.autostart, this._buffer = new t.Buffer({ url: i.url, onload: this._onload.bind(this, i.onload), reverse: i.reverse }), e instanceof AudioBuffer && this._buffer.set(e), this._loop = i.loop, this._loopStart = i.loopStart, this._loopEnd = i.loopEnd, this._playbackRate = i.playbackRate, this.retrigger = i.retrigger, this.fadeIn = i.fadeIn, this.fadeOut = i.fadeOut }, t.extend(t.Player, t.Source), t.Player.defaults = { onload: t.noOp, playbackRate: 1, loop: !1, autostart: !1, loopStart: 0, loopEnd: 0, retrigger: !1, reverse: !1, fadeIn: 0, fadeOut: 0 }, t.Player.prototype.load = function(t, e) { return this._buffer.load(t, this._onload.bind(this, e)) }, t.Player.prototype._onload = function(e) { e = t.defaultArg(e, t.noOp), e(this), this.autostart && this.start() }, t.Player.prototype._start = function(e, i, n) { var s, o; return i = this._loop ? t.defaultArg(i, this._loopStart) : t.defaultArg(i, 0), i = this.toSeconds(i), n = t.defaultArg(n, Math.max(this._buffer.duration - i, 0)), n = this.toSeconds(n), e = this.toSeconds(e), s = new t.BufferSource({ buffer: this._buffer, loop: this._loop, loopStart: this._loopStart, loopEnd: this._loopEnd, playbackRate: this._playbackRate, fadeIn: this.fadeIn, fadeOut: this.fadeOut }).connect(this.output), this._loop || this._synced || this._state.setStateAtTime(t.State.Stopped, e + n), o = this._state.get(e), o.source = s, this._loop ? s.start(e, i) : s.start(e, i, n), this }, t.Player.prototype._stop = function(t) { var e, i; return t = this.toSeconds(t), e = this._state.get(t), i = e ? e.time : 0, i = this.retrigger ? 0 : i, this._state.forEachFrom(i, function(e) { e.source && e.source.stop(t) }), this }, t.Player.prototype.seek = function(e, i) { return i = this.toSeconds(i), this._state.getValueAtTime(i) === t.State.Started && (e = this.toSeconds(e), this._stop(i), this._start(i, e)), this }, t.Player.prototype.setLoopPoints = function(t, e) { return this.loopStart = t, this.loopEnd = e, this }, Object.defineProperty(t.Player.prototype, "loopStart", { get: function() { return this._loopStart }, set: function(e) { this._loopStart = e; var i = this._state.get(t.now());
                    i && i.source && (i.source.loopStart = this.toSeconds(e)) } }), Object.defineProperty(t.Player.prototype, "loopEnd", { get: function() { return this._loopEnd }, set: function(e) { this._loopEnd = e; var i = this._state.get(t.now());
                    i && i.source && (i.source.loopEnd = this.toSeconds(e)) } }), Object.defineProperty(t.Player.prototype, "buffer", { get: function() { return this._buffer }, set: function(t) { this._buffer.set(t) } }), Object.defineProperty(t.Player.prototype, "loop", { get: function() { return this._loop }, set: function(e) { this._loop = e; var i = this._state.get(t.now());
                    i && i.source && (i.source.loop = e) } }), Object.defineProperty(t.Player.prototype, "playbackRate", { get: function() { return this._playbackRate }, set: function(e) { this._playbackRate = e; var i = this._state.get(t.now());
                    i && i.source && (i.source.playbackRate.value = e) } }), Object.defineProperty(t.Player.prototype, "reverse", { get: function() { return this._buffer.reverse }, set: function(t) { this._buffer.reverse = t } }), Object.defineProperty(t.Player.prototype, "loaded", { get: function() { return this._buffer.loaded } }), t.Player.prototype.dispose = function() { return this._state.forEach(function(t) { t.source && (t.source.disconnect(), t.source = null) }), t.Source.prototype.dispose.call(this), this._buffer.dispose(), this._buffer = null, this }, t.Player }), t(function(t) { return t.Players = function(e) { var i, n, s = Array.prototype.slice.call(arguments);
                s.shift(), i = t.defaults(s, ["onload"], t.Players), t.call(this), this._volume = this.output = new t.Volume(i.volume), this.volume = this._volume.volume, this._readOnly("volume"), this._volume.output.output.channelCount = 2, this._volume.output.output.channelCountMode = "explicit", this.mute = i.mute, this._players = {}, this._loadingCount = 0, this._fadeIn = i.fadeIn, this._fadeOut = i.fadeOut; for (n in e) this._loadingCount++, this.add(n, e[n], this._bufferLoaded.bind(this, i.onload)) }, t.extend(t.Players, t.AudioNode), t.Players.defaults = { volume: 0, mute: !1, onload: t.noOp, fadeIn: 0, fadeOut: 0 }, t.Players.prototype._bufferLoaded = function(t) { 0 === --this._loadingCount && t && t(this) }, Object.defineProperty(t.Players.prototype, "mute", { get: function() { return this._volume.mute }, set: function(t) { this._volume.mute = t } }), Object.defineProperty(t.Players.prototype, "fadeIn", { get: function() { return this._fadeIn }, set: function(t) { this._fadeIn = t, this._forEach(function(e) { e.fadeIn = t }) } }), Object.defineProperty(t.Players.prototype, "fadeOut", { get: function() { return this._fadeOut }, set: function(t) { this._fadeOut = t, this._forEach(function(e) { e.fadeOut = t }) } }), Object.defineProperty(t.Players.prototype, "state", { get: function() { var e = !1; return this._forEach(function(i) { e = e || i.state === t.State.Started }), e ? t.State.Started : t.State.Stopped } }), t.Players.prototype.has = function(t) { return this._players.hasOwnProperty(t) }, t.Players.prototype.get = function(t) { if (this.has(t)) return this._players[t]; throw new Error("Tone.Players: no player named " + t) }, t.Players.prototype._forEach = function(t) { for (var e in this._players) t(this._players[e], e); return this }, Object.defineProperty(t.Players.prototype, "loaded", { get: function() { var t = !0; return this._forEach(function(e) { t = t && e.loaded }), t } }), t.Players.prototype.add = function(e, i, n) { return this._players[e] = new t.Player(i, n).connect(this.output), this._players[e].fadeIn = this._fadeIn, this._players[e].fadeOut = this._fadeOut, this }, t.Players.prototype.stopAll = function(t) { this._forEach(function(e) { e.stop(t) }) }, t.Players.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this._volume.dispose(), this._volume = null, this._writable("volume"), this.volume = null, this.output = null, this._forEach(function(t) { t.dispose() }), this._players = null, this }, t.Players }), t(function(t) { return t.UserMedia = function() { var e = t.defaults(arguments, ["volume"], t.UserMedia);
                t.AudioNode.call(this), this._mediaStream = null, this._stream = null, this._device = null, this._volume = this.output = new t.Volume(e.volume), this.volume = this._volume.volume, this._readOnly("volume"), this.mute = e.mute }, t.extend(t.UserMedia, t.AudioNode), t.UserMedia.defaults = { volume: 0, mute: !1 }, t.UserMedia.prototype.open = function(e) { return t.UserMedia.enumerateDevices().then(function(i) { var n, s; if (t.isNumber(e)) n = i[e];
                    else if (!(n = i.find(function(t) { return t.label === e || t.deviceId === e })) && i.length > 0) n = i[0];
                    else if (!n) throw new Error("Tone.UserMedia: no matching device: " + e); return this._device = n, s = { audio: { deviceId: n.deviceId, echoCancellation: !1, sampleRate: this.context.sampleRate } }, navigator.mediaDevices.getUserMedia(s).then(function(t) { return this._stream || (this._stream = t, this._mediaStream = this.context.createMediaStreamSource(t), this._mediaStream.connect(this.output)), this }.bind(this)) }.bind(this)) }, t.UserMedia.prototype.close = function() { return this._stream && (this._stream.getAudioTracks().forEach(function(t) { t.stop() }), this._stream = null, this._mediaStream.disconnect(), this._mediaStream = null), this._device = null, this }, t.UserMedia.enumerateDevices = function() { return navigator.mediaDevices.enumerateDevices().then(function(t) { return t.filter(function(t) { return "audioinput" === t.kind }) }) }, Object.defineProperty(t.UserMedia.prototype, "state", { get: function() { return this._stream && this._stream.active ? t.State.Started : t.State.Stopped } }), Object.defineProperty(t.UserMedia.prototype, "deviceId", { get: function() { if (this._device) return this._device.deviceId } }), Object.defineProperty(t.UserMedia.prototype, "groupId", { get: function() { if (this._device) return this._device.groupId } }), Object.defineProperty(t.UserMedia.prototype, "label", { get: function() { if (this._device) return this._device.label } }), Object.defineProperty(t.UserMedia.prototype, "mute", { get: function() { return this._volume.mute }, set: function(t) { this._volume.mute = t } }), t.UserMedia.prototype.dispose = function() { return t.AudioNode.prototype.dispose.call(this), this.close(), this._writable("volume"), this._volume.dispose(), this._volume = null, this.volume = null, this }, Object.defineProperty(t.UserMedia, "supported", { get: function() { return !t.isUndef(navigator.mediaDevices) && t.isFunction(navigator.mediaDevices.getUserMedia) } }), t.UserMedia }), e
    });

    /*! nouislider - 10.1.0 - 2017-07-28 13:09:54 */

    ! function(a) { "function" == typeof define && define.amd ? define([], a) : "object" == typeof exports ? module.exports = a() : window.noUiSlider = a() }(function() { "use strict";

        function a(a) { return "object" == typeof a && "function" == typeof a.to && "function" == typeof a.from }

        function b(a) { a.parentElement.removeChild(a) }

        function c(a) { a.preventDefault() }

        function d(a) { return a.filter(function(a) { return !this[a] && (this[a] = !0) }, {}) }

        function e(a, b) { return Math.round(a / b) * b }

        function f(a, b) { var c = a.getBoundingClientRect(),
                d = a.ownerDocument,
                e = d.documentElement,
                f = o(d); return /webkit.*Chrome.*Mobile/i.test(navigator.userAgent) && (f.x = 0), b ? c.top + f.y - e.clientTop : c.left + f.x - e.clientLeft }

        function g(a) { return "number" == typeof a && !isNaN(a) && isFinite(a) }

        function h(a, b, c) { c > 0 && (l(a, b), setTimeout(function() { m(a, b) }, c)) }

        function i(a) { return Math.max(Math.min(a, 100), 0) }

        function j(a) { return Array.isArray(a) ? a : [a] }

        function k(a) { a = String(a); var b = a.split("."); return b.length > 1 ? b[1].length : 0 }

        function l(a, b) { a.classList ? a.classList.add(b) : a.className += " " + b }

        function m(a, b) { a.classList ? a.classList.remove(b) : a.className = a.className.replace(new RegExp("(^|\\b)" + b.split(" ").join("|") + "(\\b|$)", "gi"), " ") }

        function n(a, b) { return a.classList ? a.classList.contains(b) : new RegExp("\\b" + b + "\\b").test(a.className) }

        function o(a) { var b = void 0 !== window.pageXOffset,
                c = "CSS1Compat" === (a.compatMode || ""); return { x: b ? window.pageXOffset : c ? a.documentElement.scrollLeft : a.body.scrollLeft, y: b ? window.pageYOffset : c ? a.documentElement.scrollTop : a.body.scrollTop } }

        function p() { return window.navigator.pointerEnabled ? { start: "pointerdown", move: "pointermove", end: "pointerup" } : window.navigator.msPointerEnabled ? { start: "MSPointerDown", move: "MSPointerMove", end: "MSPointerUp" } : { start: "mousedown touchstart", move: "mousemove touchmove", end: "mouseup touchend" } }

        function q() { var a = !1; try { var b = Object.defineProperty({}, "passive", { get: function() { a = !0 } });
                window.addEventListener("test", null, b) } catch (a) {} return a }

        function r() { return window.CSS && CSS.supports && CSS.supports("touch-action", "none") }

        function s(a, b) { return 100 / (b - a) }

        function t(a, b) { return 100 * b / (a[1] - a[0]) }

        function u(a, b) { return t(a, a[0] < 0 ? b + Math.abs(a[0]) : b - a[0]) }

        function v(a, b) { return b * (a[1] - a[0]) / 100 + a[0] }

        function w(a, b) { for (var c = 1; a >= b[c];) c += 1; return c }

        function x(a, b, c) { if (c >= a.slice(-1)[0]) return 100; var d, e, f, g, h = w(c, a); return d = a[h - 1], e = a[h], f = b[h - 1], g = b[h], f + u([d, e], c) / s(f, g) }

        function y(a, b, c) { if (c >= 100) return a.slice(-1)[0]; var d, e, f, g, h = w(c, b); return d = a[h - 1], e = a[h], f = b[h - 1], g = b[h], v([d, e], (c - f) * s(f, g)) }

        function z(a, b, c, d) { if (100 === d) return d; var f, g, h = w(d, a); return c ? (f = a[h - 1], g = a[h], d - f > (g - f) / 2 ? g : f) : b[h - 1] ? a[h - 1] + e(d - a[h - 1], b[h - 1]) : d }

        function A(a, b, c) { var d; if ("number" == typeof b && (b = [b]), "[object Array]" !== Object.prototype.toString.call(b)) throw new Error("noUiSlider (" + _ + "): 'range' contains invalid value."); if (d = "min" === a ? 0 : "max" === a ? 100 : parseFloat(a), !g(d) || !g(b[0])) throw new Error("noUiSlider (" + _ + "): 'range' value isn't numeric.");
            c.xPct.push(d), c.xVal.push(b[0]), d ? c.xSteps.push(!isNaN(b[1]) && b[1]) : isNaN(b[1]) || (c.xSteps[0] = b[1]), c.xHighestCompleteStep.push(0) }

        function B(a, b, c) { if (!b) return !0;
            c.xSteps[a] = t([c.xVal[a], c.xVal[a + 1]], b) / s(c.xPct[a], c.xPct[a + 1]); var d = (c.xVal[a + 1] - c.xVal[a]) / c.xNumSteps[a],
                e = Math.ceil(Number(d.toFixed(3)) - 1),
                f = c.xVal[a] + c.xNumSteps[a] * e;
            c.xHighestCompleteStep[a] = f }

        function C(a, b, c) { this.xPct = [], this.xVal = [], this.xSteps = [c || !1], this.xNumSteps = [!1], this.xHighestCompleteStep = [], this.snap = b; var d, e = []; for (d in a) a.hasOwnProperty(d) && e.push([a[d], d]); for (e.length && "object" == typeof e[0][0] ? e.sort(function(a, b) { return a[0][0] - b[0][0] }) : e.sort(function(a, b) { return a[0] - b[0] }), d = 0; d < e.length; d++) A(e[d][1], e[d][0], this); for (this.xNumSteps = this.xSteps.slice(0), d = 0; d < this.xNumSteps.length; d++) B(d, this.xNumSteps[d], this) }

        function D(b) { if (a(b)) return !0; throw new Error("noUiSlider (" + _ + "): 'format' requires 'to' and 'from' methods.") }

        function E(a, b) { if (!g(b)) throw new Error("noUiSlider (" + _ + "): 'step' is not numeric.");
            a.singleStep = b }

        function F(a, b) { if ("object" != typeof b || Array.isArray(b)) throw new Error("noUiSlider (" + _ + "): 'range' is not an object."); if (void 0 === b.min || void 0 === b.max) throw new Error("noUiSlider (" + _ + "): Missing 'min' or 'max' in 'range'."); if (b.min === b.max) throw new Error("noUiSlider (" + _ + "): 'range' 'min' and 'max' cannot be equal.");
            a.spectrum = new C(b, a.snap, a.singleStep) }

        function G(a, b) { if (b = j(b), !Array.isArray(b) || !b.length) throw new Error("noUiSlider (" + _ + "): 'start' option is incorrect.");
            a.handles = b.length, a.start = b }

        function H(a, b) { if (a.snap = b, "boolean" != typeof b) throw new Error("noUiSlider (" + _ + "): 'snap' option must be a boolean.") }

        function I(a, b) { if (a.animate = b, "boolean" != typeof b) throw new Error("noUiSlider (" + _ + "): 'animate' option must be a boolean.") }

        function J(a, b) { if (a.animationDuration = b, "number" != typeof b) throw new Error("noUiSlider (" + _ + "): 'animationDuration' option must be a number.") }

        function K(a, b) { var c, d = [!1]; if ("lower" === b ? b = [!0, !1] : "upper" === b && (b = [!1, !0]), !0 === b || !1 === b) { for (c = 1; c < a.handles; c++) d.push(b);
                d.push(!1) } else { if (!Array.isArray(b) || !b.length || b.length !== a.handles + 1) throw new Error("noUiSlider (" + _ + "): 'connect' option doesn't match handle count.");
                d = b } a.connect = d }

        function L(a, b) { switch (b) {
                case "horizontal":
                    a.ort = 0; break;
                case "vertical":
                    a.ort = 1; break;
                default:
                    throw new Error("noUiSlider (" + _ + "): 'orientation' option is invalid.") } }

        function M(a, b) { if (!g(b)) throw new Error("noUiSlider (" + _ + "): 'margin' option must be numeric."); if (0 !== b && (a.margin = a.spectrum.getMargin(b), !a.margin)) throw new Error("noUiSlider (" + _ + "): 'margin' option is only supported on linear sliders.") }

        function N(a, b) { if (!g(b)) throw new Error("noUiSlider (" + _ + "): 'limit' option must be numeric."); if (a.limit = a.spectrum.getMargin(b), !a.limit || a.handles < 2) throw new Error("noUiSlider (" + _ + "): 'limit' option is only supported on linear sliders with 2 or more handles.") }

        function O(a, b) { if (!g(b)) throw new Error("noUiSlider (" + _ + "): 'padding' option must be numeric."); if (0 !== b) { if (a.padding = a.spectrum.getMargin(b), !a.padding) throw new Error("noUiSlider (" + _ + "): 'padding' option is only supported on linear sliders."); if (a.padding < 0) throw new Error("noUiSlider (" + _ + "): 'padding' option must be a positive number."); if (a.padding >= 50) throw new Error("noUiSlider (" + _ + "): 'padding' option must be less than half the range.") } }

        function P(a, b) { switch (b) {
                case "ltr":
                    a.dir = 0; break;
                case "rtl":
                    a.dir = 1; break;
                default:
                    throw new Error("noUiSlider (" + _ + "): 'direction' option was not recognized.") } }

        function Q(a, b) { if ("string" != typeof b) throw new Error("noUiSlider (" + _ + "): 'behaviour' must be a string containing options."); var c = b.indexOf("tap") >= 0,
                d = b.indexOf("drag") >= 0,
                e = b.indexOf("fixed") >= 0,
                f = b.indexOf("snap") >= 0,
                g = b.indexOf("hover") >= 0; if (e) { if (2 !== a.handles) throw new Error("noUiSlider (" + _ + "): 'fixed' behaviour must be used with 2 handles");
                M(a, a.start[1] - a.start[0]) } a.events = { tap: c || f, drag: d, fixed: e, snap: f, hover: g } }

        function R(a, b) { if (a.multitouch = b, "boolean" != typeof b) throw new Error("noUiSlider (" + _ + "): 'multitouch' option must be a boolean.") }

        function S(a, b) { if (!1 !== b)
                if (!0 === b) { a.tooltips = []; for (var c = 0; c < a.handles; c++) a.tooltips.push(!0) } else { if (a.tooltips = j(b), a.tooltips.length !== a.handles) throw new Error("noUiSlider (" + _ + "): must pass a formatter for all handles.");
                    a.tooltips.forEach(function(a) { if ("boolean" != typeof a && ("object" != typeof a || "function" != typeof a.to)) throw new Error("noUiSlider (" + _ + "): 'tooltips' must be passed a formatter or 'false'.") }) } }

        function T(a, b) { a.ariaFormat = b, D(b) }

        function U(a, b) { a.format = b, D(b) }

        function V(a, b) { if (void 0 !== b && "string" != typeof b && !1 !== b) throw new Error("noUiSlider (" + _ + "): 'cssPrefix' must be a string or `false`.");
            a.cssPrefix = b }

        function W(a, b) { if (void 0 !== b && "object" != typeof b) throw new Error("noUiSlider (" + _ + "): 'cssClasses' must be an object."); if ("string" == typeof a.cssPrefix) { a.cssClasses = {}; for (var c in b) b.hasOwnProperty(c) && (a.cssClasses[c] = a.cssPrefix + b[c]) } else a.cssClasses = b }

        function X(a, b) { if (!0 !== b && !1 !== b) throw new Error("noUiSlider (" + _ + "): 'useRequestAnimationFrame' option should be true (default) or false.");
            a.useRequestAnimationFrame = b }

        function Y(a) { var b = { margin: 0, limit: 0, padding: 0, animate: !0, animationDuration: 300, ariaFormat: aa, format: aa },
                c = { step: { r: !1, t: E }, start: { r: !0, t: G }, connect: { r: !0, t: K }, direction: { r: !0, t: P }, snap: { r: !1, t: H }, animate: { r: !1, t: I }, animationDuration: { r: !1, t: J }, range: { r: !0, t: F }, orientation: { r: !1, t: L }, margin: { r: !1, t: M }, limit: { r: !1, t: N }, padding: { r: !1, t: O }, behaviour: { r: !0, t: Q }, multitouch: { r: !0, t: R }, ariaFormat: { r: !1, t: T }, format: { r: !1, t: U }, tooltips: { r: !1, t: S }, cssPrefix: { r: !1, t: V }, cssClasses: { r: !1, t: W }, useRequestAnimationFrame: { r: !1, t: X } },
                d = { connect: !1, direction: "ltr", behaviour: "tap", multitouch: !1, orientation: "horizontal", cssPrefix: "noUi-", cssClasses: { target: "target", base: "base", origin: "origin", handle: "handle", handleLower: "handle-lower", handleUpper: "handle-upper", horizontal: "horizontal", vertical: "vertical", background: "background", connect: "connect", ltr: "ltr", rtl: "rtl", draggable: "draggable", drag: "state-drag", tap: "state-tap", active: "active", tooltip: "tooltip", pips: "pips", pipsHorizontal: "pips-horizontal", pipsVertical: "pips-vertical", marker: "marker", markerHorizontal: "marker-horizontal", markerVertical: "marker-vertical", markerNormal: "marker-normal", markerLarge: "marker-large", markerSub: "marker-sub", value: "value", valueHorizontal: "value-horizontal", valueVertical: "value-vertical", valueNormal: "value-normal", valueLarge: "value-large", valueSub: "value-sub" }, useRequestAnimationFrame: !0 };
            a.format && !a.ariaFormat && (a.ariaFormat = a.format), Object.keys(c).forEach(function(e) { if (void 0 === a[e] && void 0 === d[e]) { if (c[e].r) throw new Error("noUiSlider (" + _ + "): '" + e + "' is required."); return !0 } c[e].t(b, void 0 === a[e] ? d[e] : a[e]) }), b.pips = a.pips; var e = [
                ["left", "top"],
                ["right", "bottom"]
            ]; return b.style = e[b.dir][b.ort], b.styleOposite = e[b.dir ? 0 : 1][b.ort], b }

        function Z(a, e, g) {
            function k(a, b) { var c = wa.createElement("div"); return b && l(c, b), a.appendChild(c), c }

            function s(a, b) { var c = k(a, e.cssClasses.origin),
                    d = k(c, e.cssClasses.handle); return d.setAttribute("data-handle", b), d.setAttribute("tabindex", "0"), d.setAttribute("role", "slider"), d.setAttribute("aria-orientation", e.ort ? "vertical" : "horizontal"), 0 === b ? l(d, e.cssClasses.handleLower) : b === e.handles - 1 && l(d, e.cssClasses.handleUpper), c }

            function t(a, b) { return !!b && k(a, e.cssClasses.connect) }

            function u(a, b) { ia = [], ja = [], ja.push(t(b, a[0])); for (var c = 0; c < e.handles; c++) ia.push(s(b, c)), ra[c] = c, ja.push(t(b, a[c + 1])) }

            function v(a) { l(a, e.cssClasses.target), 0 === e.dir ? l(a, e.cssClasses.ltr) : l(a, e.cssClasses.rtl), 0 === e.ort ? l(a, e.cssClasses.horizontal) : l(a, e.cssClasses.vertical), ha = k(a, e.cssClasses.base) }

            function w(a, b) { return !!e.tooltips[b] && k(a.firstChild, e.cssClasses.tooltip) }

            function x() { var a = ia.map(w);
                ea("update", function(b, c, d) { if (a[c]) { var f = b[c];!0 !== e.tooltips[c] && (f = e.tooltips[c].to(d[c])), a[c].innerHTML = f } }) }

            function y() { ea("update", function(a, b, c, d, f) { ra.forEach(function(a) { var b = ia[a],
                            d = S(qa, a, 0, !0, !0, !0),
                            g = S(qa, a, 100, !0, !0, !0),
                            h = f[a],
                            i = e.ariaFormat.to(c[a]);
                        b.children[0].setAttribute("aria-valuemin", d.toFixed(1)), b.children[0].setAttribute("aria-valuemax", g.toFixed(1)), b.children[0].setAttribute("aria-valuenow", h.toFixed(1)), b.children[0].setAttribute("aria-valuetext", i) }) }) }

            function z(a, b, c) { if ("range" === a || "steps" === a) return ta.xVal; if ("count" === a) { if (!b) throw new Error("noUiSlider (" + _ + "): 'values' required for mode 'count'."); var d, e = 100 / (b - 1),
                        f = 0; for (b = [];
                        (d = f++ * e) <= 100;) b.push(d);
                    a = "positions" } return "positions" === a ? b.map(function(a) { return ta.fromStepping(c ? ta.getStep(a) : a) }) : "values" === a ? c ? b.map(function(a) { return ta.fromStepping(ta.getStep(ta.toStepping(a))) }) : b : void 0 }

            function A(a, b, c) {
                function e(a, b) { return (a + b).toFixed(7) / 1 } var f = {},
                    g = ta.xVal[0],
                    h = ta.xVal[ta.xVal.length - 1],
                    i = !1,
                    j = !1,
                    k = 0; return c = d(c.slice().sort(function(a, b) { return a - b })), c[0] !== g && (c.unshift(g), i = !0), c[c.length - 1] !== h && (c.push(h), j = !0), c.forEach(function(d, g) { var h, l, m, n, o, p, q, r, s, t, u = d,
                        v = c[g + 1]; if ("steps" === b && (h = ta.xNumSteps[g]), h || (h = v - u), !1 !== u && void 0 !== v)
                        for (h = Math.max(h, 1e-7), l = u; l <= v; l = e(l, h)) { for (n = ta.toStepping(l), o = n - k, r = o / a, s = Math.round(r), t = o / s, m = 1; m <= s; m += 1) p = k + m * t, f[p.toFixed(5)] = ["x", 0];
                            q = c.indexOf(l) > -1 ? 1 : "steps" === b ? 2 : 0, !g && i && (q = 0), l === v && j || (f[n.toFixed(5)] = [l, q]), k = n } }), f }

            function B(a, b, c) {
                function d(a, b) { var c = b === e.cssClasses.value,
                        d = c ? j : m,
                        f = c ? h : i; return b + " " + d[e.ort] + " " + f[a] }

                function f(a, f) { f[1] = f[1] && b ? b(f[0], f[1]) : f[1]; var h = k(g, !1);
                    h.className = d(f[1], e.cssClasses.marker), h.style[e.style] = a + "%", f[1] && (h = k(g, !1), h.className = d(f[1], e.cssClasses.value), h.style[e.style] = a + "%", h.innerText = c.to(f[0])) } var g = wa.createElement("div"),
                    h = [e.cssClasses.valueNormal, e.cssClasses.valueLarge, e.cssClasses.valueSub],
                    i = [e.cssClasses.markerNormal, e.cssClasses.markerLarge, e.cssClasses.markerSub],
                    j = [e.cssClasses.valueHorizontal, e.cssClasses.valueVertical],
                    m = [e.cssClasses.markerHorizontal, e.cssClasses.markerVertical]; return l(g, e.cssClasses.pips), l(g, 0 === e.ort ? e.cssClasses.pipsHorizontal : e.cssClasses.pipsVertical), Object.keys(a).forEach(function(b) { f(b, a[b]) }), g }

            function C() { la && (b(la), la = null) }

            function D(a) { C(); var b = a.mode,
                    c = a.density || 1,
                    d = a.filter || !1,
                    e = a.values || !1,
                    f = a.stepped || !1,
                    g = z(b, e, f),
                    h = A(c, b, g),
                    i = a.format || { to: Math.round }; return la = pa.appendChild(B(h, d, i)) }

            function E() { var a = ha.getBoundingClientRect(),
                    b = "offset" + ["Width", "Height"][e.ort]; return 0 === e.ort ? a.width || ha[b] : a.height || ha[b] }

            function F(a, b, c, d) { var f = function(f) { return !pa.hasAttribute("disabled") && (!n(pa, e.cssClasses.tap) && (!!(f = G(f, d.pageOffset, d.target || b)) && (!(a === ma.start && void 0 !== f.buttons && f.buttons > 1) && ((!d.hover || !f.buttons) && (oa || f.preventDefault(), f.calcPoint = f.points[e.ort], void c(f, d)))))) },
                    g = []; return a.split(" ").forEach(function(a) { b.addEventListener(a, f, !!oa && { passive: !0 }), g.push([a, f]) }), g }

            function G(a, b, c) { var d, f, g = 0 === a.type.indexOf("touch"),
                    h = 0 === a.type.indexOf("mouse"),
                    i = 0 === a.type.indexOf("pointer"); if (0 === a.type.indexOf("MSPointer") && (i = !0), g && e.multitouch) { var j = function(a) { return a.target === c || c.contains(a.target) }; if ("touchstart" === a.type) { var k = Array.prototype.filter.call(a.touches, j); if (k.length > 1) return !1;
                        d = k[0].pageX, f = k[0].pageY } else { var l = Array.prototype.find.call(a.changedTouches, j); if (!l) return !1;
                        d = l.pageX, f = l.pageY } } else if (g) { if (a.touches.length > 1) return !1;
                    d = a.changedTouches[0].pageX, f = a.changedTouches[0].pageY } return b = b || o(wa), (h || i) && (d = a.clientX + b.x, f = a.clientY + b.y), a.pageOffset = b, a.points = [d, f], a.cursor = h || i, a }

            function H(a) { var b = a - f(ha, e.ort),
                    c = 100 * b / E(); return e.dir ? 100 - c : c }

            function I(a) { var b = 100,
                    c = !1; return ia.forEach(function(d, e) { if (!d.hasAttribute("disabled")) { var f = Math.abs(qa[e] - a);
                        f < b && (c = e, b = f) } }), c }

            function J(a, b, c, d) { var e = c.slice(),
                    f = [!a, a],
                    g = [a, !a];
                d = d.slice(), a && d.reverse(), d.length > 1 ? d.forEach(function(a, c) { var d = S(e, a, e[a] + b, f[c], g[c], !1);!1 === d ? b = 0 : (b = d - e[a], e[a] = d) }) : f = g = [!0]; var h = !1;
                d.forEach(function(a, d) { h = W(a, c[a] + b, f[d], g[d]) || h }), h && d.forEach(function(a) { K("update", a), K("slide", a) }) }

            function K(a, b, c) { Object.keys(va).forEach(function(d) { var f = d.split(".")[0];
                    a === f && va[d].forEach(function(a) { a.call(ka, ua.map(e.format.to), b, ua.slice(), c || !1, qa.slice()) }) }) }

            function L(a, b) { "mouseout" === a.type && "HTML" === a.target.nodeName && null === a.relatedTarget && N(a, b) }

            function M(a, b) { if (-1 === navigator.appVersion.indexOf("MSIE 9") && 0 === a.buttons && 0 !== b.buttonsProperty) return N(a, b); var c = (e.dir ? -1 : 1) * (a.calcPoint - b.startCalcPoint);
                J(c > 0, 100 * c / b.baseSize, b.locations, b.handleNumbers) }

            function N(a, b) { b.handle && (m(b.handle, e.cssClasses.active), sa -= 1), b.listeners.forEach(function(a) { xa.removeEventListener(a[0], a[1]) }), 0 === sa && (m(pa, e.cssClasses.drag), V(), a.cursor && (ya.style.cursor = "", ya.removeEventListener("selectstart", c))), b.handleNumbers.forEach(function(a) { K("change", a), K("set", a), K("end", a) }) }

            function O(a, b) { var d; if (1 === b.handleNumbers.length) { var f = ia[b.handleNumbers[0]]; if (f.hasAttribute("disabled")) return !1;
                    d = f.children[0], sa += 1, l(d, e.cssClasses.active) } a.stopPropagation(); var g = [],
                    h = F(ma.move, xa, M, { target: a.target, handle: d, listeners: g, startCalcPoint: a.calcPoint, baseSize: E(), pageOffset: a.pageOffset, handleNumbers: b.handleNumbers, buttonsProperty: a.buttons, locations: qa.slice() }),
                    i = F(ma.end, xa, N, { target: a.target, handle: d, listeners: g, handleNumbers: b.handleNumbers }),
                    j = F("mouseout", xa, L, { target: a.target, handle: d, listeners: g, handleNumbers: b.handleNumbers });
                g.push.apply(g, h.concat(i, j)), a.cursor && (ya.style.cursor = getComputedStyle(a.target).cursor, ia.length > 1 && l(pa, e.cssClasses.drag), ya.addEventListener("selectstart", c, !1)), b.handleNumbers.forEach(function(a) { K("start", a) }) }

            function P(a) { a.stopPropagation(); var b = H(a.calcPoint),
                    c = I(b); if (!1 === c) return !1;
                e.events.snap || h(pa, e.cssClasses.tap, e.animationDuration), W(c, b, !0, !0), V(), K("slide", c, !0), K("update", c, !0), K("change", c, !0), K("set", c, !0), e.events.snap && O(a, { handleNumbers: [c] }) }

            function Q(a) { var b = H(a.calcPoint),
                    c = ta.getStep(b),
                    d = ta.fromStepping(c);
                Object.keys(va).forEach(function(a) { "hover" === a.split(".")[0] && va[a].forEach(function(a) { a.call(ka, d) }) }) }

            function R(a) { a.fixed || ia.forEach(function(a, b) { F(ma.start, a.children[0], O, { handleNumbers: [b] }) }), a.tap && F(ma.start, ha, P, {}), a.hover && F(ma.move, ha, Q, { hover: !0 }), a.drag && ja.forEach(function(b, c) { if (!1 !== b && 0 !== c && c !== ja.length - 1) { var d = ia[c - 1],
                            f = ia[c],
                            g = [b];
                        l(b, e.cssClasses.draggable), a.fixed && (g.push(d.children[0]), g.push(f.children[0])), g.forEach(function(a) { F(ma.start, a, O, { handles: [d, f], handleNumbers: [c - 1, c] }) }) } }) }

            function S(a, b, c, d, f, g) { return ia.length > 1 && (d && b > 0 && (c = Math.max(c, a[b - 1] + e.margin)), f && b < ia.length - 1 && (c = Math.min(c, a[b + 1] - e.margin))), ia.length > 1 && e.limit && (d && b > 0 && (c = Math.min(c, a[b - 1] + e.limit)), f && b < ia.length - 1 && (c = Math.max(c, a[b + 1] - e.limit))), e.padding && (0 === b && (c = Math.max(c, e.padding)), b === ia.length - 1 && (c = Math.min(c, 100 - e.padding))), c = ta.getStep(c), !((c = i(c)) === a[b] && !g) && c }

            function T(a) { return a + "%" }

            function U(a, b) { qa[a] = b, ua[a] = ta.fromStepping(b); var c = function() { ia[a].style[e.style] = T(b), X(a), X(a + 1) };
                window.requestAnimationFrame && e.useRequestAnimationFrame ? window.requestAnimationFrame(c) : c() }

            function V() { ra.forEach(function(a) { var b = qa[a] > 50 ? -1 : 1,
                        c = 3 + (ia.length + b * a);
                    ia[a].childNodes[0].style.zIndex = c }) }

            function W(a, b, c, d) { return !1 !== (b = S(qa, a, b, c, d, !1)) && (U(a, b), !0) }

            function X(a) { if (ja[a]) { var b = 0,
                        c = 100;
                    0 !== a && (b = qa[a - 1]), a !== ja.length - 1 && (c = qa[a]), ja[a].style[e.style] = T(b), ja[a].style[e.styleOposite] = T(100 - c) } }

            function Z(a, b) { null !== a && !1 !== a && ("number" == typeof a && (a = String(a)), !1 === (a = e.format.from(a)) || isNaN(a) || W(b, ta.toStepping(a), !1, !1)) }

            function $(a, b) { var c = j(a),
                    d = void 0 === qa[0];
                b = void 0 === b || !!b, c.forEach(Z), e.animate && !d && h(pa, e.cssClasses.tap, e.animationDuration), ra.forEach(function(a) { W(a, qa[a], !0, !1) }), V(), ra.forEach(function(a) { K("update", a), null !== c[a] && b && K("set", a) }) }

            function aa(a) { $(e.start, a) }

            function ba() { var a = ua.map(e.format.to); return 1 === a.length ? a[0] : a }

            function ca() { for (var a in e.cssClasses) e.cssClasses.hasOwnProperty(a) && m(pa, e.cssClasses[a]); for (; pa.firstChild;) pa.removeChild(pa.firstChild);
                delete pa.noUiSlider }

            function da() { return qa.map(function(a, b) { var c = ta.getNearbySteps(a),
                        d = ua[b],
                        e = c.thisStep.step,
                        f = null;!1 !== e && d + e > c.stepAfter.startValue && (e = c.stepAfter.startValue - d), f = d > c.thisStep.startValue ? c.thisStep.step : !1 !== c.stepBefore.step && d - c.stepBefore.highestStep, 100 === a ? e = null : 0 === a && (f = null); var g = ta.countStepDecimals(); return null !== e && !1 !== e && (e = Number(e.toFixed(g))), null !== f && !1 !== f && (f = Number(f.toFixed(g))), [f, e] }) }

            function ea(a, b) { va[a] = va[a] || [], va[a].push(b), "update" === a.split(".")[0] && ia.forEach(function(a, b) { K("update", b) }) }

            function fa(a) { var b = a && a.split(".")[0],
                    c = b && a.substring(b.length);
                Object.keys(va).forEach(function(a) { var d = a.split(".")[0],
                        e = a.substring(d.length);
                    b && b !== d || c && c !== e || delete va[a] }) }

            function ga(a, b) { var c = ba(),
                    d = ["margin", "limit", "padding", "range", "animate", "snap", "step", "format"];
                d.forEach(function(b) { void 0 !== a[b] && (g[b] = a[b]) }); var f = Y(g);
                d.forEach(function(b) { void 0 !== a[b] && (e[b] = f[b]) }), ta = f.spectrum, e.margin = f.margin, e.limit = f.limit, e.padding = f.padding, e.pips && D(e.pips), qa = [], $(a.start || c, b) } var ha, ia, ja, ka, la, ma = p(),
                na = r(),
                oa = na && q(),
                pa = a,
                qa = [],
                ra = [],
                sa = 0,
                ta = e.spectrum,
                ua = [],
                va = {},
                wa = a.ownerDocument,
                xa = wa.documentElement,
                ya = wa.body; if (pa.noUiSlider) throw new Error("noUiSlider (" + _ + "): Slider was already initialized."); return v(pa), u(e.connect, ha), ka = { destroy: ca, steps: da, on: ea, off: fa, get: ba, set: $, reset: aa, __moveHandles: function(a, b, c) { J(a, b, qa, c) }, options: g, updateOptions: ga, target: pa, removePips: C, pips: D }, R(e.events), $(e.start), e.pips && D(e.pips), e.tooltips && x(), y(), ka }

        function $(a, b) { if (!a || !a.nodeName) throw new Error("noUiSlider (" + _ + "): create requires a single element, got: " + a); var c = Y(b, a),
                d = Z(a, c, b); return a.noUiSlider = d, d } var _ = "10.1.0";
        C.prototype.getMargin = function(a) { var b = this.xNumSteps[0]; if (b && a / b % 1 != 0) throw new Error("noUiSlider (" + _ + "): 'limit', 'margin' and 'padding' must be divisible by step."); return 2 === this.xPct.length && t(this.xVal, a) }, C.prototype.toStepping = function(a) { return a = x(this.xVal, this.xPct, a) }, C.prototype.fromStepping = function(a) { return y(this.xVal, this.xPct, a) }, C.prototype.getStep = function(a) { return a = z(this.xPct, this.xSteps, this.snap, a) }, C.prototype.getNearbySteps = function(a) { var b = w(a, this.xPct); return { stepBefore: { startValue: this.xVal[b - 2], step: this.xNumSteps[b - 2], highestStep: this.xHighestCompleteStep[b - 2] }, thisStep: { startValue: this.xVal[b - 1], step: this.xNumSteps[b - 1], highestStep: this.xHighestCompleteStep[b - 1] }, stepAfter: { startValue: this.xVal[b - 0], step: this.xNumSteps[b - 0], highestStep: this.xHighestCompleteStep[b - 0] } } }, C.prototype.countStepDecimals = function() { var a = this.xNumSteps.map(k); return Math.max.apply(null, a) }, C.prototype.convert = function(a) { return this.getStep(this.toStepping(a)) }; var aa = { to: function(a) { return void 0 !== a && a.toFixed(2) }, from: Number }; return { version: _, create: $ } });

    // Generated by CoffeeScript 1.7.1
    (function() {
        var Color, DecomposedMatrix, DecomposedMatrix2D, InterpolableArray, InterpolableColor, InterpolableNumber, InterpolableObject, InterpolableString, Matrix, Matrix2D, Set, Vector, addTimeout, addUnitsToNumberInterpolables, animationTick, animations, animationsTimeouts, applyDefaults, applyFrame, applyProperties, baseSVG, cacheFn, cancelTimeout, clone, createInterpolable, defaultValueForKey, degProperties, dynamics, getCurrentProperties, interpolate, isDocumentVisible, isSVGElement, lastTime, leftDelayForTimeout, makeArrayFn, observeVisibilityChange, parseProperties, prefixFor, propertyWithPrefix, pxProperties, rAF, roundf, runLoopPaused, runLoopRunning, runLoopTick, setRealTimeout, slow, slowRatio, startAnimation, startRunLoop, svgProperties, timeBeforeVisibilityChange, timeoutLastId, timeouts, toDashed, transformProperties, transformValueForProperty, unitForProperty,
            __bind = function(fn, me) { return function() { return fn.apply(me, arguments); }; };

        isDocumentVisible = function() {
            return document.visibilityState === "visible" || (dynamics.tests != null);
        };

        observeVisibilityChange = (function() {
            var fns;
            fns = [];
            if (typeof document !== "undefined" && document !== null) {
                document.addEventListener("visibilitychange", function() {
                    var fn, _i, _len, _results;
                    _results = [];
                    for (_i = 0, _len = fns.length; _i < _len; _i++) {
                        fn = fns[_i];
                        _results.push(fn(isDocumentVisible()));
                    }
                    return _results;
                });
            }
            return function(fn) {
                return fns.push(fn);
            };
        })();

        clone = function(o) {
            var k, newO, v;
            newO = {};
            for (k in o) {
                v = o[k];
                newO[k] = v;
            }
            return newO;
        };

        cacheFn = function(func) {
            var data;
            data = {};
            return function() {
                var k, key, result, _i, _len;
                key = "";
                for (_i = 0, _len = arguments.length; _i < _len; _i++) {
                    k = arguments[_i];
                    key += k.toString() + ",";
                }
                result = data[key];
                if (!result) {
                    data[key] = result = func.apply(this, arguments);
                }
                return result;
            };
        };

        makeArrayFn = function(fn) {
            return function(el) {
                var args, i, res;
                if (el instanceof Array || el instanceof NodeList || el instanceof HTMLCollection) {
                    res = (function() {
                        var _i, _ref, _results;
                        _results = [];
                        for (i = _i = 0, _ref = el.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {
                            args = Array.prototype.slice.call(arguments, 1);
                            args.splice(0, 0, el[i]);
                            _results.push(fn.apply(this, args));
                        }
                        return _results;
                    }).apply(this, arguments);
                    return res;
                }
                return fn.apply(this, arguments);
            };
        };

        applyDefaults = function(options, defaults) {
            var k, v, _results;
            _results = [];
            for (k in defaults) {
                v = defaults[k];
                _results.push(options[k] != null ? options[k] : options[k] = v);
            }
            return _results;
        };

        applyFrame = function(el, properties) {
            var k, v, _results;
            if ((el.style != null)) {
                return applyProperties(el, properties);
            } else {
                _results = [];
                for (k in properties) {
                    v = properties[k];
                    _results.push(el[k] = v.format());
                }
                return _results;
            }
        };

        applyProperties = function(el, properties) {
            var isSVG, k, matrix, transforms, v;
            properties = parseProperties(properties);
            transforms = [];
            isSVG = isSVGElement(el);
            for (k in properties) {
                v = properties[k];
                if (transformProperties.contains(k)) {
                    transforms.push([k, v]);
                } else {
                    if (v.format != null) {
                        v = v.format();
                    }
                    if (typeof v === 'number') {
                        v = "" + v + (unitForProperty(k, v));
                    }
                    if ((el.hasAttribute != null) && el.hasAttribute(k)) {
                        el.setAttribute(k, v);
                    } else if (el.style != null) {
                        el.style[propertyWithPrefix(k)] = v;
                    }
                    if (k in el) {
                        el[k] = v;
                    }
                }
            }
            if (transforms.length > 0) {
                if (isSVG) {
                    matrix = new Matrix2D();
                    matrix.applyProperties(transforms);
                    return el.setAttribute("transform", matrix.decompose().format());
                } else {
                    v = (transforms.map(function(transform) {
                        return transformValueForProperty(transform[0], transform[1]);
                    })).join(" ");
                    return el.style[propertyWithPrefix("transform")] = v;
                }
            }
        };

        isSVGElement = function(el) {
            var _ref, _ref1;
            if ((typeof SVGElement !== "undefined" && SVGElement !== null) && (typeof SVGSVGElement !== "undefined" && SVGSVGElement !== null)) {
                return el instanceof SVGElement && !(el instanceof SVGSVGElement);
            } else {
                return (_ref = (_ref1 = dynamics.tests) != null ? typeof _ref1.isSVG === "function" ? _ref1.isSVG(el) : void 0 : void 0) != null ? _ref : false;
            }
        };

        roundf = function(v, decimal) {
            var d;
            d = Math.pow(10, decimal);
            return Math.round(v * d) / d;
        };

        Set = (function() {
            function Set(array) {
                var v, _i, _len;
                this.obj = {};
                for (_i = 0, _len = array.length; _i < _len; _i++) {
                    v = array[_i];
                    this.obj[v] = 1;
                }
            }

            Set.prototype.contains = function(v) {
                return this.obj[v] === 1;
            };

            return Set;

        })();

        toDashed = function(str) {
            return str.replace(/([A-Z])/g, function($1) {
                return "-" + $1.toLowerCase();
            });
        };

        pxProperties = new Set('marginTop,marginLeft,marginBottom,marginRight,paddingTop,paddingLeft,paddingBottom,paddingRight,top,left,bottom,right,translateX,translateY,translateZ,perspectiveX,perspectiveY,perspectiveZ,width,height,maxWidth,maxHeight,minWidth,minHeight,borderRadius'.split(','));

        degProperties = new Set('rotate,rotateX,rotateY,rotateZ,skew,skewX,skewY,skewZ'.split(','));

        transformProperties = new Set('translate,translateX,translateY,translateZ,scale,scaleX,scaleY,scaleZ,rotate,rotateX,rotateY,rotateZ,rotateC,rotateCX,rotateCY,skew,skewX,skewY,skewZ,perspective'.split(','));

        svgProperties = new Set('accent-height,ascent,azimuth,baseFrequency,baseline-shift,bias,cx,cy,d,diffuseConstant,divisor,dx,dy,elevation,filterRes,fx,fy,gradientTransform,height,k1,k2,k3,k4,kernelMatrix,kernelUnitLength,letter-spacing,limitingConeAngle,markerHeight,markerWidth,numOctaves,order,overline-position,overline-thickness,pathLength,points,pointsAtX,pointsAtY,pointsAtZ,r,radius,rx,ry,seed,specularConstant,specularExponent,stdDeviation,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,surfaceScale,target,targetX,targetY,transform,underline-position,underline-thickness,viewBox,width,x,x1,x2,y,y1,y2,z'.split(','));

        unitForProperty = function(k, v) {
            if (typeof v !== 'number') {
                return '';
            }
            if (pxProperties.contains(k)) {
                return 'px';
            } else if (degProperties.contains(k)) {
                return 'deg';
            }
            return '';
        };

        transformValueForProperty = function(k, v) {
            var match, unit;
            match = ("" + v).match(/^([0-9.-]*)([^0-9]*)$/);
            if (match != null) {
                v = match[1];
                unit = match[2];
            } else {
                v = parseFloat(v);
            }
            v = roundf(parseFloat(v), 10);
            if ((unit == null) || unit === "") {
                unit = unitForProperty(k, v);
            }
            return "" + k + "(" + v + unit + ")";
        };

        parseProperties = function(properties) {
            var axis, match, parsed, property, value, _i, _len, _ref;
            parsed = {};
            for (property in properties) {
                value = properties[property];
                if (transformProperties.contains(property)) {
                    match = property.match(/(translate|rotateC|rotate|skew|scale|perspective)(X|Y|Z|)/);
                    if (match && match[2].length > 0) {
                        parsed[property] = value;
                    } else {
                        _ref = ['X', 'Y', 'Z'];
                        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
                            axis = _ref[_i];
                            parsed[match[1] + axis] = value;
                        }
                    }
                } else {
                    parsed[property] = value;
                }
            }
            return parsed;
        };

        defaultValueForKey = function(key) {
            var v;
            v = key === 'opacity' ? 1 : 0;
            return "" + v + (unitForProperty(key, v));
        };

        getCurrentProperties = function(el, keys) {
            var isSVG, key, matrix, properties, style, v, _i, _j, _len, _len1, _ref;
            properties = {};
            isSVG = isSVGElement(el);
            if (el.style != null) {
                style = window.getComputedStyle(el, null);
                for (_i = 0, _len = keys.length; _i < _len; _i++) {
                    key = keys[_i];
                    if (transformProperties.contains(key)) {
                        if (properties['transform'] == null) {
                            if (isSVG) {
                                matrix = new Matrix2D((_ref = el.transform.baseVal.consolidate()) != null ? _ref.matrix : void 0);
                            } else {
                                matrix = Matrix.fromTransform(style[propertyWithPrefix('transform')]);
                            }
                            properties['transform'] = matrix.decompose();
                        }
                    } else {
                        if ((el.hasAttribute != null) && el.hasAttribute(key)) {
                            v = el.getAttribute(key);
                        } else if (key in el) {
                            v = el[key];
                        } else {
                            v = style[key];
                        }
                        if (((v == null) || key === 'd') && svgProperties.contains(key)) {
                            v = el.getAttribute(key);
                        }
                        if (v === "" || (v == null)) {
                            v = defaultValueForKey(key);
                        }
                        properties[key] = createInterpolable(v);
                    }
                }
            } else {
                for (_j = 0, _len1 = keys.length; _j < _len1; _j++) {
                    key = keys[_j];
                    properties[key] = createInterpolable(el[key]);
                }
            }
            addUnitsToNumberInterpolables(el, properties);
            return properties;
        };

        addUnitsToNumberInterpolables = function(el, properties) {
            var interpolable, k;
            for (k in properties) {
                interpolable = properties[k];
                if (interpolable instanceof InterpolableNumber && (el.style != null) && k in el.style) {
                    interpolable = new InterpolableString([interpolable, unitForProperty(k, 0)]);
                }
                properties[k] = interpolable;
            }
            return properties;
        };

        createInterpolable = function(value) {
            var interpolable, klass, klasses, _i, _len;
            klasses = [InterpolableArray, InterpolableObject, InterpolableNumber, InterpolableString];
            for (_i = 0, _len = klasses.length; _i < _len; _i++) {
                klass = klasses[_i];
                interpolable = klass.create(value);
                if (interpolable != null) {
                    return interpolable;
                }
            }
            return null;
        };

        InterpolableString = (function() {
            function InterpolableString(parts) {
                this.parts = parts;
                this.format = __bind(this.format, this);
                this.interpolate = __bind(this.interpolate, this);
            }

            InterpolableString.prototype.interpolate = function(endInterpolable, t) {
                var end, i, newParts, start, _i, _ref;
                start = this.parts;
                end = endInterpolable.parts;
                newParts = [];
                for (i = _i = 0, _ref = Math.min(start.length, end.length); 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {
                    if (start[i].interpolate != null) {
                        newParts.push(start[i].interpolate(end[i], t));
                    } else {
                        newParts.push(start[i]);
                    }
                }
                return new InterpolableString(newParts);
            };

            InterpolableString.prototype.format = function() {
                var parts;
                parts = this.parts.map(function(val) {
                    if (val.format != null) {
                        return val.format();
                    } else {
                        return val;
                    }
                });
                return parts.join('');
            };

            InterpolableString.create = function(value) {
                var index, match, matches, parts, re, type, types, _i, _j, _len, _len1;
                value = "" + value;
                matches = [];
                types = [{
                    re: /(#[a-f\d]{3,6})/ig,
                    klass: InterpolableColor,
                    parse: function(v) {
                        return v;
                    }
                }, {
                    re: /(rgba?\([0-9.]*, ?[0-9.]*, ?[0-9.]*(?:, ?[0-9.]*)?\))/ig,
                    klass: InterpolableColor,
                    parse: function(v) {
                        return v;
                    }
                }, {
                    re: /([-+]?[\d.]+)/ig,
                    klass: InterpolableNumber,
                    parse: parseFloat
                }];
                for (_i = 0, _len = types.length; _i < _len; _i++) {
                    type = types[_i];
                    re = type.re;
                    while (match = re.exec(value)) {
                        matches.push({
                            index: match.index,
                            length: match[1].length,
                            interpolable: type.klass.create(type.parse(match[1]))
                        });
                    }
                }
                matches = matches.sort(function(a, b) {
                    if (a.index > b.index) {
                        return 1;
                    } else {
                        return -1;
                    }
                });
                parts = [];
                index = 0;
                for (_j = 0, _len1 = matches.length; _j < _len1; _j++) {
                    match = matches[_j];
                    if (match.index < index) {
                        continue;
                    }
                    if (match.index > index) {
                        parts.push(value.substring(index, match.index));
                    }
                    parts.push(match.interpolable);
                    index = match.index + match.length;
                }
                if (index < value.length) {
                    parts.push(value.substring(index));
                }
                return new InterpolableString(parts);
            };

            return InterpolableString;

        })();

        InterpolableObject = (function() {
            function InterpolableObject(obj) {
                this.format = __bind(this.format, this);
                this.interpolate = __bind(this.interpolate, this);
                this.obj = obj;
            }

            InterpolableObject.prototype.interpolate = function(endInterpolable, t) {
                var end, k, newObj, start, v;
                start = this.obj;
                end = endInterpolable.obj;
                newObj = {};
                for (k in start) {
                    v = start[k];
                    if (v.interpolate != null) {
                        newObj[k] = v.interpolate(end[k], t);
                    } else {
                        newObj[k] = v;
                    }
                }
                return new InterpolableObject(newObj);
            };

            InterpolableObject.prototype.format = function() {
                return this.obj;
            };

            InterpolableObject.create = function(value) {
                var k, obj, v;
                if (value instanceof Object) {
                    obj = {};
                    for (k in value) {
                        v = value[k];
                        obj[k] = createInterpolable(v);
                    }
                    return new InterpolableObject(obj);
                }
                return null;
            };

            return InterpolableObject;

        })();

        InterpolableNumber = (function() {
            function InterpolableNumber(value) {
                this.format = __bind(this.format, this);
                this.interpolate = __bind(this.interpolate, this);
                this.value = parseFloat(value);
            }

            InterpolableNumber.prototype.interpolate = function(endInterpolable, t) {
                var end, start;
                start = this.value;
                end = endInterpolable.value;
                return new InterpolableNumber((end - start) * t + start);
            };

            InterpolableNumber.prototype.format = function() {
                return roundf(this.value, 5);
            };

            InterpolableNumber.create = function(value) {
                if (typeof value === 'number') {
                    return new InterpolableNumber(value);
                }
                return null;
            };

            return InterpolableNumber;

        })();

        InterpolableArray = (function() {
            function InterpolableArray(values) {
                this.values = values;
                this.format = __bind(this.format, this);
                this.interpolate = __bind(this.interpolate, this);
            }

            InterpolableArray.prototype.interpolate = function(endInterpolable, t) {
                var end, i, newValues, start, _i, _ref;
                start = this.values;
                end = endInterpolable.values;
                newValues = [];
                for (i = _i = 0, _ref = Math.min(start.length, end.length); 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {
                    if (start[i].interpolate != null) {
                        newValues.push(start[i].interpolate(end[i], t));
                    } else {
                        newValues.push(start[i]);
                    }
                }
                return new InterpolableArray(newValues);
            };

            InterpolableArray.prototype.format = function() {
                return this.values.map(function(val) {
                    if (val.format != null) {
                        return val.format();
                    } else {
                        return val;
                    }
                });
            };

            InterpolableArray.createFromArray = function(arr) {
                var values;
                values = arr.map(function(val) {
                    return createInterpolable(val) || val;
                });
                values = values.filter(function(val) {
                    return val != null;
                });
                return new InterpolableArray(values);
            };

            InterpolableArray.create = function(value) {
                if (value instanceof Array) {
                    return InterpolableArray.createFromArray(value);
                }
                return null;
            };

            return InterpolableArray;

        })();

        Color = (function() {
            function Color(rgb, format) {
                this.rgb = rgb != null ? rgb : {};
                this.format = format;
                this.toRgba = __bind(this.toRgba, this);
                this.toRgb = __bind(this.toRgb, this);
                this.toHex = __bind(this.toHex, this);
            }

            Color.fromHex = function(hex) {
                var hex3, result;
                hex3 = hex.match(/^#([a-f\d]{1})([a-f\d]{1})([a-f\d]{1})$/i);
                if (hex3 != null) {
                    hex = "#" + hex3[1] + hex3[1] + hex3[2] + hex3[2] + hex3[3] + hex3[3];
                }
                result = hex.match(/^#([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i);
                if (result != null) {
                    return new Color({
                        r: parseInt(result[1], 16),
                        g: parseInt(result[2], 16),
                        b: parseInt(result[3], 16),
                        a: 1
                    }, "hex");
                }
                return null;
            };

            Color.fromRgb = function(rgb) {
                var match, _ref;
                match = rgb.match(/^rgba?\(([0-9.]*), ?([0-9.]*), ?([0-9.]*)(?:, ?([0-9.]*))?\)$/);
                if (match != null) {
                    return new Color({
                        r: parseFloat(match[1]),
                        g: parseFloat(match[2]),
                        b: parseFloat(match[3]),
                        a: parseFloat((_ref = match[4]) != null ? _ref : 1)
                    }, match[4] != null ? "rgba" : "rgb");
                }
                return null;
            };

            Color.componentToHex = function(c) {
                var hex;
                hex = c.toString(16);
                if (hex.length === 1) {
                    return "0" + hex;
                } else {
                    return hex;
                }
            };

            Color.prototype.toHex = function() {
                return "#" + Color.componentToHex(this.rgb.r) + Color.componentToHex(this.rgb.g) + Color.componentToHex(this.rgb.b);
            };

            Color.prototype.toRgb = function() {
                return "rgb(" + this.rgb.r + ", " + this.rgb.g + ", " + this.rgb.b + ")";
            };

            Color.prototype.toRgba = function() {
                return "rgba(" + this.rgb.r + ", " + this.rgb.g + ", " + this.rgb.b + ", " + this.rgb.a + ")";
            };

            return Color;

        })();

        InterpolableColor = (function() {
            function InterpolableColor(color) {
                this.color = color;
                this.format = __bind(this.format, this);
                this.interpolate = __bind(this.interpolate, this);
            }

            InterpolableColor.prototype.interpolate = function(endInterpolable, t) {
                var end, k, rgb, start, v, _i, _len, _ref;
                start = this.color;
                end = endInterpolable.color;
                rgb = {};
                _ref = ['r', 'g', 'b'];
                for (_i = 0, _len = _ref.length; _i < _len; _i++) {
                    k = _ref[_i];
                    v = Math.round((end.rgb[k] - start.rgb[k]) * t + start.rgb[k]);
                    rgb[k] = Math.min(255, Math.max(0, v));
                }
                k = "a";
                v = roundf((end.rgb[k] - start.rgb[k]) * t + start.rgb[k], 5);
                rgb[k] = Math.min(1, Math.max(0, v));
                return new InterpolableColor(new Color(rgb, end.format));
            };

            InterpolableColor.prototype.format = function() {
                if (this.color.format === "hex") {
                    return this.color.toHex();
                } else if (this.color.format === "rgb") {
                    return this.color.toRgb();
                } else if (this.color.format === "rgba") {
                    return this.color.toRgba();
                }
            };

            InterpolableColor.create = function(value) {
                var color;
                if (typeof value !== "string") {
                    return;
                }
                color = Color.fromHex(value) || Color.fromRgb(value);
                if (color != null) {
                    return new InterpolableColor(color);
                }
                return null;
            };

            return InterpolableColor;

        })();

        DecomposedMatrix2D = (function() {
            function DecomposedMatrix2D(props) {
                this.props = props;
                this.applyRotateCenter = __bind(this.applyRotateCenter, this);
                this.format = __bind(this.format, this);
                this.interpolate = __bind(this.interpolate, this);
            }

            DecomposedMatrix2D.prototype.interpolate = function(endMatrix, t) {
                var i, k, newProps, _i, _j, _k, _l, _len, _len1, _ref, _ref1, _ref2;
                newProps = {};
                _ref = ['translate', 'scale', 'rotate'];
                for (_i = 0, _len = _ref.length; _i < _len; _i++) {
                    k = _ref[_i];
                    newProps[k] = [];
                    for (i = _j = 0, _ref1 = this.props[k].length; 0 <= _ref1 ? _j < _ref1 : _j > _ref1; i = 0 <= _ref1 ? ++_j : --_j) {
                        newProps[k][i] = (endMatrix.props[k][i] - this.props[k][i]) * t + this.props[k][i];
                    }
                }
                for (i = _k = 1; _k <= 2; i = ++_k) {
                    newProps['rotate'][i] = endMatrix.props['rotate'][i];
                }
                _ref2 = ['skew'];
                for (_l = 0, _len1 = _ref2.length; _l < _len1; _l++) {
                    k = _ref2[_l];
                    newProps[k] = (endMatrix.props[k] - this.props[k]) * t + this.props[k];
                }
                return new DecomposedMatrix2D(newProps);
            };

            DecomposedMatrix2D.prototype.format = function() {
                return "translate(" + (this.props.translate.join(',')) + ") rotate(" + (this.props.rotate.join(',')) + ") skewX(" + this.props.skew + ") scale(" + (this.props.scale.join(',')) + ")";
            };

            DecomposedMatrix2D.prototype.applyRotateCenter = function(rotateC) {
                var i, m, m2d, negativeTranslate, _i, _results;
                m = baseSVG.createSVGMatrix();
                m = m.translate(rotateC[0], rotateC[1]);
                m = m.rotate(this.props.rotate[0]);
                m = m.translate(-rotateC[0], -rotateC[1]);
                m2d = new Matrix2D(m);
                negativeTranslate = m2d.decompose().props.translate;
                _results = [];
                for (i = _i = 0; _i <= 1; i = ++_i) {
                    _results.push(this.props.translate[i] -= negativeTranslate[i]);
                }
                return _results;
            };

            return DecomposedMatrix2D;

        })();

        baseSVG = typeof document !== "undefined" && document !== null ? document.createElementNS("http://www.w3.org/2000/svg", "svg") : void 0;

        Matrix2D = (function() {
            function Matrix2D(m) {
                this.m = m;
                this.applyProperties = __bind(this.applyProperties, this);
                this.decompose = __bind(this.decompose, this);
                if (!this.m) {
                    this.m = baseSVG.createSVGMatrix();
                }
            }

            Matrix2D.prototype.decompose = function() {
                var kx, ky, kz, r0, r1;
                r0 = new Vector([this.m.a, this.m.b]);
                r1 = new Vector([this.m.c, this.m.d]);
                kx = r0.length();
                kz = r0.dot(r1);
                r0 = r0.normalize();
                ky = r1.combine(r0, 1, -kz).length();
                return new DecomposedMatrix2D({
                    translate: [this.m.e, this.m.f],
                    rotate: [Math.atan2(this.m.b, this.m.a) * 180 / Math.PI, this.rotateCX, this.rotateCY],
                    scale: [kx, ky],
                    skew: kz / ky * 180 / Math.PI
                });
            };

            Matrix2D.prototype.applyProperties = function(properties) {
                var hash, k, props, v, _i, _len, _ref, _ref1;
                hash = {};
                for (_i = 0, _len = properties.length; _i < _len; _i++) {
                    props = properties[_i];
                    hash[props[0]] = props[1];
                }
                for (k in hash) {
                    v = hash[k];
                    if (k === "translateX") {
                        this.m = this.m.translate(v, 0);
                    } else if (k === "translateY") {
                        this.m = this.m.translate(0, v);
                    } else if (k === "scaleX") {
                        this.m = this.m.scaleNonUniform(v, 1);
                    } else if (k === "scaleY") {
                        this.m = this.m.scaleNonUniform(1, v);
                    } else if (k === "rotateZ") {
                        this.m = this.m.rotate(v);
                    } else if (k === "skewX") {
                        this.m = this.m.skewX(v);
                    } else if (k === "skewY") {
                        this.m = this.m.skewY(v);
                    }
                }
                this.rotateCX = (_ref = hash.rotateCX) != null ? _ref : 0;
                return this.rotateCY = (_ref1 = hash.rotateCY) != null ? _ref1 : 0;
            };

            return Matrix2D;

        })();

        Vector = (function() {
            function Vector(els) {
                this.els = els;
                this.combine = __bind(this.combine, this);
                this.normalize = __bind(this.normalize, this);
                this.length = __bind(this.length, this);
                this.cross = __bind(this.cross, this);
                this.dot = __bind(this.dot, this);
                this.e = __bind(this.e, this);
            }

            Vector.prototype.e = function(i) {
                if (i < 1 || i > this.els.length) {
                    return null;
                } else {
                    return this.els[i - 1];
                }
            };

            Vector.prototype.dot = function(vector) {
                var V, n, product;
                V = vector.els || vector;
                product = 0;
                n = this.els.length;
                if (n !== V.length) {
                    return null;
                }
                n += 1;
                while (--n) {
                    product += this.els[n - 1] * V[n - 1];
                }
                return product;
            };

            Vector.prototype.cross = function(vector) {
                var A, B;
                B = vector.els || vector;
                if (this.els.length !== 3 || B.length !== 3) {
                    return null;
                }
                A = this.els;
                return new Vector([(A[1] * B[2]) - (A[2] * B[1]), (A[2] * B[0]) - (A[0] * B[2]), (A[0] * B[1]) - (A[1] * B[0])]);
            };

            Vector.prototype.length = function() {
                var a, e, _i, _len, _ref;
                a = 0;
                _ref = this.els;
                for (_i = 0, _len = _ref.length; _i < _len; _i++) {
                    e = _ref[_i];
                    a += Math.pow(e, 2);
                }
                return Math.sqrt(a);
            };

            Vector.prototype.normalize = function() {
                var e, i, length, newElements, _ref;
                length = this.length();
                newElements = [];
                _ref = this.els;
                for (i in _ref) {
                    e = _ref[i];
                    newElements[i] = e / length;
                }
                return new Vector(newElements);
            };

            Vector.prototype.combine = function(b, ascl, bscl) {
                var i, result, _i, _ref;
                result = [];
                for (i = _i = 0, _ref = this.els.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {
                    result[i] = (ascl * this.els[i]) + (bscl * b.els[i]);
                }
                return new Vector(result);
            };

            return Vector;

        })();

        DecomposedMatrix = (function() {
            function DecomposedMatrix() {
                this.toMatrix = __bind(this.toMatrix, this);
                this.format = __bind(this.format, this);
                this.interpolate = __bind(this.interpolate, this);
            }

            DecomposedMatrix.prototype.interpolate = function(decomposedB, t, only) {
                var angle, decomposed, decomposedA, i, invscale, invth, k, qa, qb, scale, th, _i, _j, _k, _l, _len, _ref, _ref1;
                if (only == null) {
                    only = null;
                }
                decomposedA = this;
                decomposed = new DecomposedMatrix;
                _ref = ['translate', 'scale', 'skew', 'perspective'];
                for (_i = 0, _len = _ref.length; _i < _len; _i++) {
                    k = _ref[_i];
                    decomposed[k] = [];
                    for (i = _j = 0, _ref1 = decomposedA[k].length - 1; 0 <= _ref1 ? _j <= _ref1 : _j >= _ref1; i = 0 <= _ref1 ? ++_j : --_j) {
                        if ((only == null) || only.indexOf(k) > -1 || only.indexOf("" + k + ['x', 'y', 'z'][i]) > -1) {
                            decomposed[k][i] = (decomposedB[k][i] - decomposedA[k][i]) * t + decomposedA[k][i];
                        } else {
                            decomposed[k][i] = decomposedA[k][i];
                        }
                    }
                }
                if ((only == null) || only.indexOf('rotate') !== -1) {
                    qa = decomposedA.quaternion;
                    qb = decomposedB.quaternion;
                    angle = qa[0] * qb[0] + qa[1] * qb[1] + qa[2] * qb[2] + qa[3] * qb[3];
                    if (angle < 0.0) {
                        for (i = _k = 0; _k <= 3; i = ++_k) {
                            qa[i] = -qa[i];
                        }
                        angle = -angle;
                    }
                    if (angle + 1.0 > .05) {
                        if (1.0 - angle >= .05) {
                            th = Math.acos(angle);
                            invth = 1.0 / Math.sin(th);
                            scale = Math.sin(th * (1.0 - t)) * invth;
                            invscale = Math.sin(th * t) * invth;
                        } else {
                            scale = 1.0 - t;
                            invscale = t;
                        }
                    } else {
                        qb[0] = -qa[1];
                        qb[1] = qa[0];
                        qb[2] = -qa[3];
                        qb[3] = qa[2];
                        scale = Math.sin(piDouble * (.5 - t));
                        invscale = Math.sin(piDouble * t);
                    }
                    decomposed.quaternion = [];
                    for (i = _l = 0; _l <= 3; i = ++_l) {
                        decomposed.quaternion[i] = qa[i] * scale + qb[i] * invscale;
                    }
                } else {
                    decomposed.quaternion = decomposedA.quaternion;
                }
                return decomposed;
            };

            DecomposedMatrix.prototype.format = function() {
                return this.toMatrix().toString();
            };

            DecomposedMatrix.prototype.toMatrix = function() {
                var decomposedMatrix, i, j, match, matrix, quaternion, skew, temp, w, x, y, z, _i, _j, _k, _l;
                decomposedMatrix = this;
                matrix = Matrix.I(4);
                for (i = _i = 0; _i <= 3; i = ++_i) {
                    matrix.els[i][3] = decomposedMatrix.perspective[i];
                }
                quaternion = decomposedMatrix.quaternion;
                x = quaternion[0];
                y = quaternion[1];
                z = quaternion[2];
                w = quaternion[3];
                skew = decomposedMatrix.skew;
                match = [
                    [1, 0],
                    [2, 0],
                    [2, 1]
                ];
                for (i = _j = 2; _j >= 0; i = --_j) {
                    if (skew[i]) {
                        temp = Matrix.I(4);
                        temp.els[match[i][0]][match[i][1]] = skew[i];
                        matrix = matrix.multiply(temp);
                    }
                }
                matrix = matrix.multiply(new Matrix([
                    [1 - 2 * (y * y + z * z), 2 * (x * y - z * w), 2 * (x * z + y * w), 0],
                    [2 * (x * y + z * w), 1 - 2 * (x * x + z * z), 2 * (y * z - x * w), 0],
                    [2 * (x * z - y * w), 2 * (y * z + x * w), 1 - 2 * (x * x + y * y), 0],
                    [0, 0, 0, 1]
                ]));
                for (i = _k = 0; _k <= 2; i = ++_k) {
                    for (j = _l = 0; _l <= 2; j = ++_l) {
                        matrix.els[i][j] *= decomposedMatrix.scale[i];
                    }
                    matrix.els[3][i] = decomposedMatrix.translate[i];
                }
                return matrix;
            };

            return DecomposedMatrix;

        })();

        Matrix = (function() {
            function Matrix(els) {
                this.els = els;
                this.toString = __bind(this.toString, this);
                this.decompose = __bind(this.decompose, this);
                this.inverse = __bind(this.inverse, this);
                this.augment = __bind(this.augment, this);
                this.toRightTriangular = __bind(this.toRightTriangular, this);
                this.transpose = __bind(this.transpose, this);
                this.multiply = __bind(this.multiply, this);
                this.dup = __bind(this.dup, this);
                this.e = __bind(this.e, this);
            }

            Matrix.prototype.e = function(i, j) {
                if (i < 1 || i > this.els.length || j < 1 || j > this.els[0].length) {
                    return null;
                }
                return this.els[i - 1][j - 1];
            };

            Matrix.prototype.dup = function() {
                return new Matrix(this.els);
            };

            Matrix.prototype.multiply = function(matrix) {
                var M, c, cols, elements, i, j, ki, kj, nc, ni, nj, returnVector, sum;
                returnVector = matrix.modulus ? true : false;
                M = matrix.els || matrix;
                if (typeof M[0][0] === 'undefined') {
                    M = new Matrix(M).els;
                }
                ni = this.els.length;
                ki = ni;
                kj = M[0].length;
                cols = this.els[0].length;
                elements = [];
                ni += 1;
                while (--ni) {
                    i = ki - ni;
                    elements[i] = [];
                    nj = kj;
                    nj += 1;
                    while (--nj) {
                        j = kj - nj;
                        sum = 0;
                        nc = cols;
                        nc += 1;
                        while (--nc) {
                            c = cols - nc;
                            sum += this.els[i][c] * M[c][j];
                        }
                        elements[i][j] = sum;
                    }
                }
                M = new Matrix(elements);
                if (returnVector) {
                    return M.col(1);
                } else {
                    return M;
                }
            };

            Matrix.prototype.transpose = function() {
                var cols, elements, i, j, ni, nj, rows;
                rows = this.els.length;
                cols = this.els[0].length;
                elements = [];
                ni = cols;
                ni += 1;
                while (--ni) {
                    i = cols - ni;
                    elements[i] = [];
                    nj = rows;
                    nj += 1;
                    while (--nj) {
                        j = rows - nj;
                        elements[i][j] = this.els[j][i];
                    }
                }
                return new Matrix(elements);
            };

            Matrix.prototype.toRightTriangular = function() {
                var M, els, i, j, k, kp, multiplier, n, np, p, _i, _j, _ref, _ref1;
                M = this.dup();
                n = this.els.length;
                k = n;
                kp = this.els[0].length;
                while (--n) {
                    i = k - n;
                    if (M.els[i][i] === 0) {
                        for (j = _i = _ref = i + 1; _ref <= k ? _i < k : _i > k; j = _ref <= k ? ++_i : --_i) {
                            if (M.els[j][i] !== 0) {
                                els = [];
                                np = kp;
                                np += 1;
                                while (--np) {
                                    p = kp - np;
                                    els.push(M.els[i][p] + M.els[j][p]);
                                }
                                M.els[i] = els;
                                break;
                            }
                        }
                    }
                    if (M.els[i][i] !== 0) {
                        for (j = _j = _ref1 = i + 1; _ref1 <= k ? _j < k : _j > k; j = _ref1 <= k ? ++_j : --_j) {
                            multiplier = M.els[j][i] / M.els[i][i];
                            els = [];
                            np = kp;
                            np += 1;
                            while (--np) {
                                p = kp - np;
                                els.push(p <= i ? 0 : M.els[j][p] - M.els[i][p] * multiplier);
                            }
                            M.els[j] = els;
                        }
                    }
                }
                return M;
            };

            Matrix.prototype.augment = function(matrix) {
                var M, T, cols, i, j, ki, kj, ni, nj;
                M = matrix.els || matrix;
                if (typeof M[0][0] === 'undefined') {
                    M = new Matrix(M).els;
                }
                T = this.dup();
                cols = T.els[0].length;
                ni = T.els.length;
                ki = ni;
                kj = M[0].length;
                if (ni !== M.length) {
                    return null;
                }
                ni += 1;
                while (--ni) {
                    i = ki - ni;
                    nj = kj;
                    nj += 1;
                    while (--nj) {
                        j = kj - nj;
                        T.els[i][cols + j] = M[i][j];
                    }
                }
                return T;
            };

            Matrix.prototype.inverse = function() {
                var M, divisor, els, i, inverse_elements, j, ki, kp, new_element, ni, np, p, _i;
                ni = this.els.length;
                ki = ni;
                M = this.augment(Matrix.I(ni)).toRightTriangular();
                kp = M.els[0].length;
                inverse_elements = [];
                ni += 1;
                while (--ni) {
                    i = ni - 1;
                    els = [];
                    np = kp;
                    inverse_elements[i] = [];
                    divisor = M.els[i][i];
                    np += 1;
                    while (--np) {
                        p = kp - np;
                        new_element = M.els[i][p] / divisor;
                        els.push(new_element);
                        if (p >= ki) {
                            inverse_elements[i].push(new_element);
                        }
                    }
                    M.els[i] = els;
                    for (j = _i = 0; 0 <= i ? _i < i : _i > i; j = 0 <= i ? ++_i : --_i) {
                        els = [];
                        np = kp;
                        np += 1;
                        while (--np) {
                            p = kp - np;
                            els.push(M.els[j][p] - M.els[i][p] * M.els[j][i]);
                        }
                        M.els[j] = els;
                    }
                }
                return new Matrix(inverse_elements);
            };

            Matrix.I = function(n) {
                var els, i, j, k, nj;
                els = [];
                k = n;
                n += 1;
                while (--n) {
                    i = k - n;
                    els[i] = [];
                    nj = k;
                    nj += 1;
                    while (--nj) {
                        j = k - nj;
                        els[i][j] = i === j ? 1 : 0;
                    }
                }
                return new Matrix(els);
            };

            Matrix.prototype.decompose = function() {
                var els, i, inversePerspectiveMatrix, j, k, matrix, pdum3, perspective, perspectiveMatrix, quaternion, result, rightHandSide, rotate, row, rowElement, s, scale, skew, t, translate, transposedInversePerspectiveMatrix, type, typeKey, v, w, x, y, z, _i, _j, _k, _l, _m, _n, _o, _p, _q, _r;
                matrix = this;
                translate = [];
                scale = [];
                skew = [];
                quaternion = [];
                perspective = [];
                els = [];
                for (i = _i = 0; _i <= 3; i = ++_i) {
                    els[i] = [];
                    for (j = _j = 0; _j <= 3; j = ++_j) {
                        els[i][j] = matrix.els[i][j];
                    }
                }
                if (els[3][3] === 0) {
                    return false;
                }
                for (i = _k = 0; _k <= 3; i = ++_k) {
                    for (j = _l = 0; _l <= 3; j = ++_l) {
                        els[i][j] /= els[3][3];
                    }
                }
                perspectiveMatrix = matrix.dup();
                for (i = _m = 0; _m <= 2; i = ++_m) {
                    perspectiveMatrix.els[i][3] = 0;
                }
                perspectiveMatrix.els[3][3] = 1;
                if (els[0][3] !== 0 || els[1][3] !== 0 || els[2][3] !== 0) {
                    rightHandSide = new Vector(els.slice(0, 4)[3]);
                    inversePerspectiveMatrix = perspectiveMatrix.inverse();
                    transposedInversePerspectiveMatrix = inversePerspectiveMatrix.transpose();
                    perspective = transposedInversePerspectiveMatrix.multiply(rightHandSide).els;
                    for (i = _n = 0; _n <= 2; i = ++_n) {
                        els[i][3] = 0;
                    }
                    els[3][3] = 1;
                } else {
                    perspective = [0, 0, 0, 1];
                }
                for (i = _o = 0; _o <= 2; i = ++_o) {
                    translate[i] = els[3][i];
                    els[3][i] = 0;
                }
                row = [];
                for (i = _p = 0; _p <= 2; i = ++_p) {
                    row[i] = new Vector(els[i].slice(0, 3));
                }
                scale[0] = row[0].length();
                row[0] = row[0].normalize();
                skew[0] = row[0].dot(row[1]);
                row[1] = row[1].combine(row[0], 1.0, -skew[0]);
                scale[1] = row[1].length();
                row[1] = row[1].normalize();
                skew[0] /= scale[1];
                skew[1] = row[0].dot(row[2]);
                row[2] = row[2].combine(row[0], 1.0, -skew[1]);
                skew[2] = row[1].dot(row[2]);
                row[2] = row[2].combine(row[1], 1.0, -skew[2]);
                scale[2] = row[2].length();
                row[2] = row[2].normalize();
                skew[1] /= scale[2];
                skew[2] /= scale[2];
                pdum3 = row[1].cross(row[2]);
                if (row[0].dot(pdum3) < 0) {
                    for (i = _q = 0; _q <= 2; i = ++_q) {
                        scale[i] *= -1;
                        for (j = _r = 0; _r <= 2; j = ++_r) {
                            row[i].els[j] *= -1;
                        }
                    }
                }
                rowElement = function(index, elementIndex) {
                    return row[index].els[elementIndex];
                };
                rotate = [];
                rotate[1] = Math.asin(-rowElement(0, 2));
                if (Math.cos(rotate[1]) !== 0) {
                    rotate[0] = Math.atan2(rowElement(1, 2), rowElement(2, 2));
                    rotate[2] = Math.atan2(rowElement(0, 1), rowElement(0, 0));
                } else {
                    rotate[0] = Math.atan2(-rowElement(2, 0), rowElement(1, 1));
                    rotate[1] = 0;
                }
                t = rowElement(0, 0) + rowElement(1, 1) + rowElement(2, 2) + 1.0;
                if (t > 1e-4) {
                    s = 0.5 / Math.sqrt(t);
                    w = 0.25 / s;
                    x = (rowElement(2, 1) - rowElement(1, 2)) * s;
                    y = (rowElement(0, 2) - rowElement(2, 0)) * s;
                    z = (rowElement(1, 0) - rowElement(0, 1)) * s;
                } else if ((rowElement(0, 0) > rowElement(1, 1)) && (rowElement(0, 0) > rowElement(2, 2))) {
                    s = Math.sqrt(1.0 + rowElement(0, 0) - rowElement(1, 1) - rowElement(2, 2)) * 2.0;
                    x = 0.25 * s;
                    y = (rowElement(0, 1) + rowElement(1, 0)) / s;
                    z = (rowElement(0, 2) + rowElement(2, 0)) / s;
                    w = (rowElement(2, 1) - rowElement(1, 2)) / s;
                } else if (rowElement(1, 1) > rowElement(2, 2)) {
                    s = Math.sqrt(1.0 + rowElement(1, 1) - rowElement(0, 0) - rowElement(2, 2)) * 2.0;
                    x = (rowElement(0, 1) + rowElement(1, 0)) / s;
                    y = 0.25 * s;
                    z = (rowElement(1, 2) + rowElement(2, 1)) / s;
                    w = (rowElement(0, 2) - rowElement(2, 0)) / s;
                } else {
                    s = Math.sqrt(1.0 + rowElement(2, 2) - rowElement(0, 0) - rowElement(1, 1)) * 2.0;
                    x = (rowElement(0, 2) + rowElement(2, 0)) / s;
                    y = (rowElement(1, 2) + rowElement(2, 1)) / s;
                    z = 0.25 * s;
                    w = (rowElement(1, 0) - rowElement(0, 1)) / s;
                }
                quaternion = [x, y, z, w];
                result = new DecomposedMatrix;
                result.translate = translate;
                result.scale = scale;
                result.skew = skew;
                result.quaternion = quaternion;
                result.perspective = perspective;
                result.rotate = rotate;
                for (typeKey in result) {
                    type = result[typeKey];
                    for (k in type) {
                        v = type[k];
                        if (isNaN(v)) {
                            type[k] = 0;
                        }
                    }
                }
                return result;
            };

            Matrix.prototype.toString = function() {
                var i, j, str, _i, _j;
                str = 'matrix3d(';
                for (i = _i = 0; _i <= 3; i = ++_i) {
                    for (j = _j = 0; _j <= 3; j = ++_j) {
                        str += roundf(this.els[i][j], 10);
                        if (!(i === 3 && j === 3)) {
                            str += ',';
                        }
                    }
                }
                str += ')';
                return str;
            };

            Matrix.matrixForTransform = cacheFn(function(transform) {
                var matrixEl, result, style, _ref, _ref1, _ref2;
                matrixEl = document.createElement('div');
                matrixEl.style.position = 'absolute';
                matrixEl.style.visibility = 'hidden';
                matrixEl.style[propertyWithPrefix("transform")] = transform;
                document.body.appendChild(matrixEl);
                style = window.getComputedStyle(matrixEl, null);
                result = (_ref = (_ref1 = style.transform) != null ? _ref1 : style[propertyWithPrefix("transform")]) != null ? _ref : (_ref2 = dynamics.tests) != null ? _ref2.matrixForTransform(transform) : void 0;
                document.body.removeChild(matrixEl);
                return result;
            });

            Matrix.fromTransform = function(transform) {
                var digits, elements, i, match, matrixElements, _i;
                match = transform != null ? transform.match(/matrix3?d?\(([-0-9,e \.]*)\)/) : void 0;
                if (match) {
                    digits = match[1].split(',');
                    digits = digits.map(parseFloat);
                    if (digits.length === 6) {
                        elements = [digits[0], digits[1], 0, 0, digits[2], digits[3], 0, 0, 0, 0, 1, 0, digits[4], digits[5], 0, 1];
                    } else {
                        elements = digits;
                    }
                } else {
                    elements = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];
                }
                matrixElements = [];
                for (i = _i = 0; _i <= 3; i = ++_i) {
                    matrixElements.push(elements.slice(i * 4, i * 4 + 4));
                }
                return new Matrix(matrixElements);
            };

            return Matrix;

        })();

        prefixFor = cacheFn(function(property) {
            var k, prefix, prop, propArray, propertyName, _i, _j, _len, _len1, _ref;
            if (document.body.style[property] !== void 0) {
                return '';
            }
            propArray = property.split('-');
            propertyName = "";
            for (_i = 0, _len = propArray.length; _i < _len; _i++) {
                prop = propArray[_i];
                propertyName += prop.substring(0, 1).toUpperCase() + prop.substring(1);
            }
            _ref = ["Webkit", "Moz", "ms"];
            for (_j = 0, _len1 = _ref.length; _j < _len1; _j++) {
                prefix = _ref[_j];
                k = prefix + propertyName;
                if (document.body.style[k] !== void 0) {
                    return prefix;
                }
            }
            return '';
        });

        propertyWithPrefix = cacheFn(function(property) {
            var prefix;
            prefix = prefixFor(property);
            if (prefix === 'Moz') {
                return "" + prefix + (property.substring(0, 1).toUpperCase() + property.substring(1));
            }
            if (prefix !== '') {
                return "-" + (prefix.toLowerCase()) + "-" + (toDashed(property));
            }
            return toDashed(property);
        });

        rAF = typeof window !== "undefined" && window !== null ? window.requestAnimationFrame : void 0;

        animations = [];

        animationsTimeouts = [];

        slow = false;

        slowRatio = 1;

        if (typeof window !== "undefined" && window !== null) {
            window.addEventListener('keyup', function(e) {
                if (e.keyCode === 68 && e.shiftKey && e.ctrlKey) {
                    return dynamics.toggleSlow();
                }
            });
        }

        if (rAF == null) {
            lastTime = 0;
            rAF = function(callback) {
                var currTime, id, timeToCall;
                currTime = Date.now();
                timeToCall = Math.max(0, 16 - (currTime - lastTime));
                id = window.setTimeout(function() {
                    return callback(currTime + timeToCall);
                }, timeToCall);
                lastTime = currTime + timeToCall;
                return id;
            };
        }

        runLoopRunning = false;

        runLoopPaused = false;

        startRunLoop = function() {
            if (!runLoopRunning) {
                runLoopRunning = true;
                return rAF(runLoopTick);
            }
        };

        runLoopTick = function(t) {
            var animation, toRemoveAnimations, _i, _len;
            if (runLoopPaused) {
                rAF(runLoopTick);
                return;
            }
            toRemoveAnimations = [];
            for (_i = 0, _len = animations.length; _i < _len; _i++) {
                animation = animations[_i];
                if (!animationTick(t, animation)) {
                    toRemoveAnimations.push(animation);
                }
            }
            animations = animations.filter(function(animation) {
                return toRemoveAnimations.indexOf(animation) === -1;
            });
            if (animations.length === 0) {
                return runLoopRunning = false;
            } else {
                return rAF(runLoopTick);
            }
        };

        animationTick = function(t, animation) {
            var key, properties, property, tt, y, _base, _base1, _ref;
            if (animation.tStart == null) {
                animation.tStart = t;
            }
            tt = (t - animation.tStart) / animation.options.duration;
            y = animation.curve(tt);
            properties = {};
            if (tt >= 1) {
                if (animation.curve.returnsToSelf) {
                    properties = animation.properties.start;
                } else {
                    properties = animation.properties.end;
                }
            } else {
                _ref = animation.properties.start;
                for (key in _ref) {
                    property = _ref[key];
                    properties[key] = interpolate(property, animation.properties.end[key], y);
                }
            }
            applyFrame(animation.el, properties);
            if (typeof(_base = animation.options).change === "function") {
                _base.change(animation.el, Math.min(1, tt));
            }
            if (tt >= 1) {
                if (typeof(_base1 = animation.options).complete === "function") {
                    _base1.complete(animation.el);
                }
            }
            return tt < 1;
        };

        interpolate = function(start, end, y) {
            if ((start != null) && (start.interpolate != null)) {
                return start.interpolate(end, y);
            }
            return null;
        };

        startAnimation = function(el, properties, options, timeoutId) {
            var endProperties, isSVG, k, matrix, startProperties, transforms, v;
            if (timeoutId != null) {
                animationsTimeouts = animationsTimeouts.filter(function(timeout) {
                    return timeout.id !== timeoutId;
                });
            }
            dynamics.stop(el, {
                timeout: false
            });
            if (!options.animated) {
                dynamics.css(el, properties);
                if (typeof options.complete === "function") {
                    options.complete(this);
                }
                return;
            }
            startProperties = getCurrentProperties(el, Object.keys(properties));
            properties = parseProperties(properties);
            endProperties = {};
            transforms = [];
            for (k in properties) {
                v = properties[k];
                if ((el.style != null) && transformProperties.contains(k)) {
                    transforms.push([k, v]);
                } else {
                    endProperties[k] = createInterpolable(v);
                }
            }
            if (transforms.length > 0) {
                isSVG = isSVGElement(el);
                if (isSVG) {
                    matrix = new Matrix2D();
                    matrix.applyProperties(transforms);
                } else {
                    v = (transforms.map(function(transform) {
                        return transformValueForProperty(transform[0], transform[1]);
                    })).join(" ");
                    matrix = Matrix.fromTransform(Matrix.matrixForTransform(v));
                }
                endProperties['transform'] = matrix.decompose();
                if (isSVG) {
                    startProperties.transform.applyRotateCenter([endProperties.transform.props.rotate[1], endProperties.transform.props.rotate[2]]);
                }
            }
            addUnitsToNumberInterpolables(el, endProperties);
            animations.push({
                el: el,
                properties: {
                    start: startProperties,
                    end: endProperties
                },
                options: options,
                curve: options.type.call(options.type, options)
            });
            return startRunLoop();
        };

        timeouts = [];

        timeoutLastId = 0;

        setRealTimeout = function(timeout) {
            if (!isDocumentVisible()) {
                return;
            }
            return rAF(function() {
                if (timeouts.indexOf(timeout) === -1) {
                    return;
                }
                return timeout.realTimeoutId = setTimeout(function() {
                    timeout.fn();
                    return cancelTimeout(timeout.id);
                }, timeout.delay);
            });
        };

        addTimeout = function(fn, delay) {
            var timeout;
            timeoutLastId += 1;
            timeout = {
                id: timeoutLastId,
                tStart: Date.now(),
                fn: fn,
                delay: delay,
                originalDelay: delay
            };
            setRealTimeout(timeout);
            timeouts.push(timeout);
            return timeoutLastId;
        };

        cancelTimeout = function(id) {
            return timeouts = timeouts.filter(function(timeout) {
                if (timeout.id === id && timeout.realTimeoutId) {
                    clearTimeout(timeout.realTimeoutId);
                }
                return timeout.id !== id;
            });
        };

        leftDelayForTimeout = function(time, timeout) {
            var consumedDelay;
            if (time != null) {
                consumedDelay = time - timeout.tStart;
                return timeout.originalDelay - consumedDelay;
            } else {
                return timeout.originalDelay;
            }
        };

        if (typeof window !== "undefined" && window !== null) {
            window.addEventListener('unload', function() {});
        }

        timeBeforeVisibilityChange = null;

        observeVisibilityChange(function(visible) {
            var animation, difference, timeout, _i, _j, _k, _len, _len1, _len2, _results;
            runLoopPaused = !visible;
            if (!visible) {
                timeBeforeVisibilityChange = Date.now();
                _results = [];
                for (_i = 0, _len = timeouts.length; _i < _len; _i++) {
                    timeout = timeouts[_i];
                    _results.push(clearTimeout(timeout.realTimeoutId));
                }
                return _results;
            } else {
                if (runLoopRunning) {
                    difference = Date.now() - timeBeforeVisibilityChange;
                    for (_j = 0, _len1 = animations.length; _j < _len1; _j++) {
                        animation = animations[_j];
                        if (animation.tStart != null) {
                            animation.tStart += difference;
                        }
                    }
                }
                for (_k = 0, _len2 = timeouts.length; _k < _len2; _k++) {
                    timeout = timeouts[_k];
                    timeout.delay = leftDelayForTimeout(timeBeforeVisibilityChange, timeout);
                    setRealTimeout(timeout);
                }
                return timeBeforeVisibilityChange = null;
            }
        });

        dynamics = {};

        dynamics.linear = function() {
            return function(t) {
                return t;
            };
        };

        dynamics.spring = function(options) {
            var A1, A2, decal, frequency, friction, s;
            if (options == null) {
                options = {};
            }
            applyDefaults(options, dynamics.spring.defaults);
            frequency = Math.max(1, options.frequency / 20);
            friction = Math.pow(20, options.friction / 100);
            s = options.anticipationSize / 1000;
            decal = Math.max(0, s);
            A1 = function(t) {
                var M, a, b, x0, x1;
                M = 0.8;
                x0 = s / (1 - s);
                x1 = 0;
                b = (x0 - (M * x1)) / (x0 - x1);
                a = (M - b) / x0;
                return (a * t * options.anticipationStrength / 100) + b;
            };
            A2 = function(t) {
                return Math.pow(friction / 10, -t) * (1 - t);
            };
            return function(t) {
                var A, At, a, angle, b, frictionT, y0, yS;
                frictionT = (t / (1 - s)) - (s / (1 - s));
                if (t < s) {
                    yS = (s / (1 - s)) - (s / (1 - s));
                    y0 = (0 / (1 - s)) - (s / (1 - s));
                    b = Math.acos(1 / A1(yS));
                    a = (Math.acos(1 / A1(y0)) - b) / (frequency * (-s));
                    A = A1;
                } else {
                    A = A2;
                    b = 0;
                    a = 1;
                }
                At = A(frictionT);
                angle = frequency * (t - s) * a + b;
                return 1 - (At * Math.cos(angle));
            };
        };

        dynamics.bounce = function(options) {
            var A, fn, frequency, friction;
            if (options == null) {
                options = {};
            }
            applyDefaults(options, dynamics.bounce.defaults);
            frequency = Math.max(1, options.frequency / 20);
            friction = Math.pow(20, options.friction / 100);
            A = function(t) {
                return Math.pow(friction / 10, -t) * (1 - t);
            };
            fn = function(t) {
                var At, a, angle, b;
                b = -3.14 / 2;
                a = 1;
                At = A(t);
                angle = frequency * t * a + b;
                return At * Math.cos(angle);
            };
            fn.returnsToSelf = true;
            return fn;
        };

        dynamics.gravity = function(options) {
            var L, bounciness, curves, elasticity, fn, getPointInCurve, gravity;
            if (options == null) {
                options = {};
            }
            applyDefaults(options, dynamics.gravity.defaults);
            bounciness = Math.min(options.bounciness / 1250, 0.8);
            elasticity = options.elasticity / 1000;
            gravity = 100;
            curves = [];
            L = (function() {
                var b, curve;
                b = Math.sqrt(2 / gravity);
                curve = {
                    a: -b,
                    b: b,
                    H: 1
                };
                if (options.returnsToSelf) {
                    curve.a = 0;
                    curve.b = curve.b * 2;
                }
                while (curve.H > 0.001) {
                    L = curve.b - curve.a;
                    curve = {
                        a: curve.b,
                        b: curve.b + L * bounciness,
                        H: curve.H * bounciness * bounciness
                    };
                }
                return curve.b;
            })();
            getPointInCurve = function(a, b, H, t) {
                var c, t2;
                L = b - a;
                t2 = (2 / L) * t - 1 - (a * 2 / L);
                c = t2 * t2 * H - H + 1;
                if (options.returnsToSelf) {
                    c = 1 - c;
                }
                return c;
            };
            (function() {
                var L2, b, curve, _results;
                b = Math.sqrt(2 / (gravity * L * L));
                curve = {
                    a: -b,
                    b: b,
                    H: 1
                };
                if (options.returnsToSelf) {
                    curve.a = 0;
                    curve.b = curve.b * 2;
                }
                curves.push(curve);
                L2 = L;
                _results = [];
                while (curve.b < 1 && curve.H > 0.001) {
                    L2 = curve.b - curve.a;
                    curve = {
                        a: curve.b,
                        b: curve.b + L2 * bounciness,
                        H: curve.H * elasticity
                    };
                    _results.push(curves.push(curve));
                }
                return _results;
            })();
            fn = function(t) {
                var curve, i, v;
                i = 0;
                curve = curves[i];
                while (!(t >= curve.a && t <= curve.b)) {
                    i += 1;
                    curve = curves[i];
                    if (!curve) {
                        break;
                    }
                }
                if (!curve) {
                    v = options.returnsToSelf ? 0 : 1;
                } else {
                    v = getPointInCurve(curve.a, curve.b, curve.H, t);
                }
                return v;
            };
            fn.returnsToSelf = options.returnsToSelf;
            return fn;
        };

        dynamics.forceWithGravity = function(options) {
            if (options == null) {
                options = {};
            }
            applyDefaults(options, dynamics.forceWithGravity.defaults);
            options.returnsToSelf = true;
            return dynamics.gravity(options);
        };

        dynamics.bezier = (function() {
            var Bezier, Bezier_, yForX;
            Bezier_ = function(t, p0, p1, p2, p3) {
                return (Math.pow(1 - t, 3) * p0) + (3 * Math.pow(1 - t, 2) * t * p1) + (3 * (1 - t) * Math.pow(t, 2) * p2) + Math.pow(t, 3) * p3;
            };
            Bezier = function(t, p0, p1, p2, p3) {
                return {
                    x: Bezier_(t, p0.x, p1.x, p2.x, p3.x),
                    y: Bezier_(t, p0.y, p1.y, p2.y, p3.y)
                };
            };
            yForX = function(xTarget, Bs, returnsToSelf) {
                var B, aB, i, lower, percent, upper, x, xTolerance, _i, _len;
                B = null;
                for (_i = 0, _len = Bs.length; _i < _len; _i++) {
                    aB = Bs[_i];
                    if (xTarget >= aB(0).x && xTarget <= aB(1).x) {
                        B = aB;
                    }
                    if (B !== null) {
                        break;
                    }
                }
                if (!B) {
                    if (returnsToSelf) {
                        return 0;
                    } else {
                        return 1;
                    }
                }
                xTolerance = 0.0001;
                lower = 0;
                upper = 1;
                percent = (upper + lower) / 2;
                x = B(percent).x;
                i = 0;
                while (Math.abs(xTarget - x) > xTolerance && i < 100) {
                    if (xTarget > x) {
                        lower = percent;
                    } else {
                        upper = percent;
                    }
                    percent = (upper + lower) / 2;
                    x = B(percent).x;
                    i += 1;
                }
                return B(percent).y;
            };
            return function(options) {
                var Bs, fn, points;
                if (options == null) {
                    options = {};
                }
                points = options.points;
                Bs = (function() {
                    var i, k, _fn;
                    Bs = [];
                    _fn = function(pointA, pointB) {
                        var B2;
                        B2 = function(t) {
                            return Bezier(t, pointA, pointA.cp[pointA.cp.length - 1], pointB.cp[0], pointB);
                        };
                        return Bs.push(B2);
                    };
                    for (i in points) {
                        k = parseInt(i);
                        if (k >= points.length - 1) {
                            break;
                        }
                        _fn(points[k], points[k + 1]);
                    }
                    return Bs;
                })();
                fn = function(t) {
                    if (t === 0) {
                        return 0;
                    } else if (t === 1) {
                        return 1;
                    } else {
                        return yForX(t, Bs, this.returnsToSelf);
                    }
                };
                fn.returnsToSelf = points[points.length - 1].y === 0;
                return fn;
            };
        })();

        dynamics.easeInOut = function(options) {
            var friction, _ref;
            if (options == null) {
                options = {};
            }
            friction = (_ref = options.friction) != null ? _ref : dynamics.easeInOut.defaults.friction;
            return dynamics.bezier({
                points: [{
                    x: 0,
                    y: 0,
                    cp: [{
                        x: 0.92 - (friction / 1000),
                        y: 0
                    }]
                }, {
                    x: 1,
                    y: 1,
                    cp: [{
                        x: 0.08 + (friction / 1000),
                        y: 1
                    }]
                }]
            });
        };

        dynamics.easeIn = function(options) {
            var friction, _ref;
            if (options == null) {
                options = {};
            }
            friction = (_ref = options.friction) != null ? _ref : dynamics.easeIn.defaults.friction;
            return dynamics.bezier({
                points: [{
                    x: 0,
                    y: 0,
                    cp: [{
                        x: 0.92 - (friction / 1000),
                        y: 0
                    }]
                }, {
                    x: 1,
                    y: 1,
                    cp: [{
                        x: 1,
                        y: 1
                    }]
                }]
            });
        };

        dynamics.easeOut = function(options) {
            var friction, _ref;
            if (options == null) {
                options = {};
            }
            friction = (_ref = options.friction) != null ? _ref : dynamics.easeOut.defaults.friction;
            return dynamics.bezier({
                points: [{
                    x: 0,
                    y: 0,
                    cp: [{
                        x: 0,
                        y: 0
                    }]
                }, {
                    x: 1,
                    y: 1,
                    cp: [{
                        x: 0.08 + (friction / 1000),
                        y: 1
                    }]
                }]
            });
        };

        dynamics.spring.defaults = {
            frequency: 300,
            friction: 200,
            anticipationSize: 0,
            anticipationStrength: 0
        };

        dynamics.bounce.defaults = {
            frequency: 300,
            friction: 200
        };

        dynamics.forceWithGravity.defaults = dynamics.gravity.defaults = {
            bounciness: 400,
            elasticity: 200
        };

        dynamics.easeInOut.defaults = dynamics.easeIn.defaults = dynamics.easeOut.defaults = {
            friction: 500
        };

        dynamics.css = makeArrayFn(function(el, properties) {
            return applyProperties(el, properties, true);
        });

        dynamics.animate = makeArrayFn(function(el, properties, options) {
            var id;
            if (options == null) {
                options = {};
            }
            options = clone(options);
            applyDefaults(options, {
                type: dynamics.easeInOut,
                duration: 1000,
                delay: 0,
                animated: true
            });
            options.duration = Math.max(0, options.duration * slowRatio);
            options.delay = Math.max(0, options.delay);
            if (options.delay === 0) {
                return startAnimation(el, properties, options);
            } else {
                id = dynamics.setTimeout(function() {
                    return startAnimation(el, properties, options, id);
                }, options.delay);
                return animationsTimeouts.push({
                    id: id,
                    el: el
                });
            }
        });

        dynamics.stop = makeArrayFn(function(el, options) {
            if (options == null) {
                options = {};
            }
            if (options.timeout == null) {
                options.timeout = true;
            }
            if (options.timeout) {
                animationsTimeouts = animationsTimeouts.filter(function(timeout) {
                    if (timeout.el === el && ((options.filter == null) || options.filter(timeout))) {
                        dynamics.clearTimeout(timeout.id);
                        return false;
                    }
                    return true;
                });
            }
            return animations = animations.filter(function(animation) {
                return animation.el !== el;
            });
        });

        dynamics.setTimeout = function(fn, delay) {
            return addTimeout(fn, delay * slowRatio);
        };

        dynamics.clearTimeout = function(id) {
            return cancelTimeout(id);
        };

        dynamics.toggleSlow = function() {
            slow = !slow;
            if (slow) {
                slowRatio = 3;
            } else {
                slowRatio = 1;
            }
            return typeof console !== "undefined" && console !== null ? typeof console.log === "function" ? console.log("dynamics.js: slow animations " + (slow ? "enabled" : "disabled")) : void 0 : void 0;
        };

        if (typeof module === "object" && typeof module.exports === "object") {
            module.exports = dynamics;
        } else if (typeof define === "function") {
            define('dynamics', function() {
                return dynamics;
            });
        } else {
            window.dynamics = dynamics;
        }

    }).call(this);

    /**
     *  StartAudioContext.js
     *  @author Yotam Mann
     *  @license http://opensource.org/licenses/MIT MIT License
     *  @copyright 2016 Yotam Mann
     */
    (function(root, factory) {
        if (typeof define === "function" && define.amd) {
            define([], factory)
        } else if (typeof module === "object" && module.exports) {
            module.exports = factory()
        } else {
            root.StartAudioContext = factory()
        }
    }(this, function() {

        //TAP LISTENER/////////////////////////////////////////////////////////////

        /**
         * @class  Listens for non-dragging tap ends on the given element
         * @param {Element} element
         * @internal
         */
        var TapListener = function(element, context) {

            this._dragged = false

            this._element = element

            this._bindedMove = this._moved.bind(this)
            this._bindedEnd = this._ended.bind(this, context)

            element.addEventListener("touchstart", this._bindedEnd)
            element.addEventListener("touchmove", this._bindedMove)
            element.addEventListener("touchend", this._bindedEnd)
            element.addEventListener("mouseup", this._bindedEnd)
        }

        /**
         * drag move event
         */
        TapListener.prototype._moved = function(e) {
            this._dragged = true
        };

        /**
         * tap ended listener
         */
        TapListener.prototype._ended = function(context) {
            if (!this._dragged) {
                startContext(context)
            }
            this._dragged = false
        };

        /**
         * remove all the bound events
         */
        TapListener.prototype.dispose = function() {
            this._element.removeEventListener("touchstart", this._bindedEnd)
            this._element.removeEventListener("touchmove", this._bindedMove)
            this._element.removeEventListener("touchend", this._bindedEnd)
            this._element.removeEventListener("mouseup", this._bindedEnd)
            this._bindedMove = null
            this._bindedEnd = null
            this._element = null
        };

        //END TAP LISTENER/////////////////////////////////////////////////////////

        /**
         * Plays a silent sound and also invoke the "resume" method
         * @param {AudioContext} context
         * @private
         */
        function startContext(context) {
            // this accomplishes the iOS specific requirement
            var buffer = context.createBuffer(1, 1, context.sampleRate)
            var source = context.createBufferSource()
            source.buffer = buffer
            source.connect(context.destination)
            source.start(0)

            // resume the audio context
            if (context.resume) {
                context.resume()
            }
        }

        /**
         * Returns true if the audio context is started
         * @param  {AudioContext}  context
         * @return {Boolean}
         * @private
         */
        function isStarted(context) {
            return context.state === "running"
        }

        /**
         * Invokes the callback as soon as the AudioContext
         * is started
         * @param  {AudioContext}   context
         * @param  {Function} callback
         */
        function onStarted(context, callback) {

            function checkLoop() {
                if (isStarted(context)) {
                    callback()
                } else {
                    requestAnimationFrame(checkLoop)
                    if (context.resume) {
                        context.resume()
                    }
                }
            }

            if (isStarted(context)) {
                callback()
            } else {
                checkLoop()
            }
        }

        /**
         * Add a tap listener to the audio context
         * @param  {Array|Element|String|jQuery} element
         * @param {Array} tapListeners
         */
        function bindTapListener(element, tapListeners, context) {
            if (Array.isArray(element) || (NodeList && element instanceof NodeList)) {
                for (var i = 0; i < element.length; i++) {
                    bindTapListener(element[i], tapListeners, context)
                }
            } else if (typeof element === "string") {
                bindTapListener(document.querySelectorAll(element), tapListeners, context)
            } else if (element.jquery && typeof element.toArray === "function") {
                bindTapListener(element.toArray(), tapListeners, context)
            } else if (Element && element instanceof Element) {
                //if it's an element, create a TapListener
                var tap = new TapListener(element, context)
                tapListeners.push(tap)
            }
        }

        /**
         * @param {AudioContext} context The AudioContext to start.
         * @param {Array|String|Element|jQuery=} elements For iOS, the list of elements
         *                                               to bind tap event listeners
         *                                               which will start the AudioContext. If
         *                                               no elements are given, it will bind
         *                                               to the document.body.
         * @param {Function=} callback The callback to invoke when the AudioContext is started.
         * @return {Promise} The promise is invoked when the AudioContext
         *                       is started.
         */
        function StartAudioContext(context, elements, callback) {

            //the promise is invoked when the AudioContext is started
            var promise = new Promise(function(success) {
                onStarted(context, success)
            })

            // The TapListeners bound to the elements
            var tapListeners = []

            // add all the tap listeners
            if (!elements) {
                elements = document.body
            }
            bindTapListener(elements, tapListeners, context)

            //dispose all these tap listeners when the context is started
            promise.then(function() {
                for (var i = 0; i < tapListeners.length; i++) {
                    tapListeners[i].dispose()
                }
                tapListeners = null

                if (callback) {
                    callback()
                }
            })

            return promise
        }

        return StartAudioContext
    }));

    function euclid(k, n) {
        let seq = _.times(k, _.constant([1])).concat(_.times(n - k, _.constant([0])));
        while (true) {
            let [head, remainder] = _.partition(seq, i => _.isEqual(i, seq[0]));
            if (remainder.length < 2) break;
            for (let i = 0; i < Math.min(head.length, remainder.length); i++) {
                seq[i] = seq[i].concat(seq.pop());
            }
        }
        return _.flatten(seq);
    }

    function buildPattern(k, n, visEl, centerX, centerY, radius) {
        let evts = euclid(k, n);
        let pattern = evts.map((evt, i) => {
            let angle = i / n * Math.PI * 2;

            let width = evt ? radius / 3 : radius / 5;
            let height = evt ? radius / 7 : radius / 10;
            let x = centerX + Math.cos(angle) * radius;
            let y = centerY + Math.sin(angle) * radius;

            let group = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            group.setAttribute(
                'style',
                `transform-origin: ${x}px ${y}px; transform: rotate(${angle}rad)`);

            visEl.appendChild(group);

            let node = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
            node.setAttribute('x', x - width / 2);
            node.setAttribute('y', y - height / 2);
            node.setAttribute('rx', 5);
            node.setAttribute('ry', 5);
            node.setAttribute('width', width);
            node.setAttribute('height', height);
            node.setAttribute('class', `event ${evt ? 'active' : ''}`);
            group.appendChild(node);

            return { evt, angle, node, group };
        });
        return pattern;
    }

    function startPattern(k, n, players, containerEl) {
        let visEl = containerEl.querySelector('.vis');
        let width = visEl.getBoundingClientRect().width;
        let height = visEl.getBoundingClientRect().height;
        let size = Math.min(width, height);
        let centerX = width / 2;
        let centerY = height / 2;
        let radius = size / 4;

        let handEl = document.createElementNS('http://www.w3.org/2000/svg', 'line');
        handEl.setAttribute('x1', centerX);
        handEl.setAttribute('y1', centerY);
        handEl.setAttribute('x2', centerX + radius + 10);
        handEl.setAttribute('y2', centerY);
        handEl.setAttribute('class', 'hand');
        visEl.appendChild(handEl);

        let centerEl = document.createElementNS(
            'http://www.w3.org/2000/svg',
            'circle');

        centerEl.setAttribute('cx', centerX);
        centerEl.setAttribute('cy', centerY);
        centerEl.setAttribute('r', 3);
        centerEl.setAttribute('class', 'center');
        visEl.appendChild(centerEl);

        let pattern = buildPattern(k, n, visEl, centerX, centerY, radius);

        let seq = new Tone.Sequence(
            (time, { evt, angle, node }) => {
                if (evt === 1) {
                    let sample = _.sample(['1', '2', '3', '4']);
                    players.get(sample).start(time);
                }
                if (evt) {
                    Tone.Draw.schedule(() => {
                        node.setAttribute('transform', `translate(0, 15)`);
                        dynamics.animate(
                            node, { translateX: 0, translateY: 0 }, { type: dynamics.spring, frequency: 400 });

                    }, time);
                }
            },
            pattern,
            '16n');

        seq.humanize = 0.01;
        seq.start();

        let rangeEl = containerEl.querySelector('.range');
        noUiSlider.create(rangeEl, {
            range: { min: 0, max: 16 },
            start: [k, n],
            margin: 0,
            connect: true,
            behaviour: 'tap-drag',
            tooltips: true,
            step: 1,
            format: {
                to: v => Math.round(v),
                from: v => Math.round(v)
            }
        });


        rangeEl.noUiSlider.on('update', ([k, n]) => {
            seq.removeAll();
            pattern.forEach(({ group }) => group.remove());
            pattern = buildPattern(k, n, visEl, centerX, centerY, radius);
            pattern.forEach((v, i) => seq.add(i, v));
            seq.loopEnd = `${pattern.length} * 16n`;
        });

        return { centerX, centerY, seq, handEl };
    }

    let e3Players = new Tone.Players({
        '1': './sounds/eucl-e3-1.mp3',
        '2': './sounds/eucl-e3-2.mp3',
        '3': './sounds/eucl-e3-3.mp3',
        '4': './sounds/eucl-e3-4.mp3'
    }).
    connect(new Tone.Panner(-0.6).connect(new Tone.Gain(0.5).toMaster()));
    let fs4Players = new Tone.Players({
        '1': './sounds/eucl-fs3-1.mp3',
        '2': './sounds/eucl-fs3-2.mp3',
        '3': './sounds/eucl-fs3-3.mp3',
        '4': './sounds/eucl-fs3-4.mp3'
    }).
    connect(new Tone.Panner(-0.2).connect(new Tone.Gain(0.5).toMaster()));
    let a3Players = new Tone.Players({
        '1': './sounds/eucl-a3-1.mp3',
        '2': './sounds/eucl-a3-2.mp3',
        '3': './sounds/eucl-a3-3.mp3',
        '4': './sounds/eucl-a3-4.mp3'
    }).
    connect(new Tone.Panner(0.2).connect(new Tone.Gain(0.5).toMaster()));
    let cs4Players = new Tone.Players({
        '1': './sounds/eucl-cs4-1.mp3',
        '2': './sounds/eucl-cs4-2.mp3',
        '3': './sounds/eucl-cs4-3.mp3',
        '4': './sounds/eucl-cs4-4.mp3'
    }).
    connect(new Tone.Panner(0.6).connect(new Tone.Gain(0.5).toMaster()));

    Tone.Buffer.on('load', () => {
        const patternElements = Array.from(document.querySelectorAll('.pattern'));
        let e3Pattern = startPattern(3, 7, e3Players, patternElements[0]);
        let fs4Pattern = startPattern(1, 8, fs4Players, patternElements[1]);
        let a3Pattern = startPattern(4, 10, a3Players, patternElements[2]);
        let cs4Pattern = startPattern(2, 5, cs4Players, patternElements[3]);
        Tone.Transport.start();

        function updateHand({ handEl, centerX, centerY, seq }) {
            handEl.setAttribute(
                'transform',
                `translate(${centerX} ${centerY}) rotate(${seq.progress *
    360}) translate(${-centerX} ${-centerY})`);

        }

        function animateHands() {
            updateHand(e3Pattern);
            updateHand(fs4Pattern);
            updateHand(a3Pattern);
            updateHand(cs4Pattern);
            requestAnimationFrame(animateHands);
        }
        requestAnimationFrame(animateHands);
    });

    StartAudioContext(Tone.context, document.documentElement);
    </script>
</body>

</html>